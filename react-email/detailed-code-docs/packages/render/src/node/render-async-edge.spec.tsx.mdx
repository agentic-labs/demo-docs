---
title: "render-async-edge.spec.tsx"
---

## High-level description
This file contains unit tests for the `renderAsync` function in an edge runtime environment. It tests the function's ability to convert React components into HTML and plain text, handling different scenarios including Next.js 14 error stubs and various rendering options.

## Code Structure
The file consists of a single `describe` block containing four test cases (`it` blocks) that test different aspects of the `renderAsync` function.

## References
- `renderAsync` function from "./render-async"
- `Template` component from "../shared/utils/template"
- `Preview` component from "../shared/utils/preview"

## Symbols

### `describe("renderAsync on the edge", ...)`
#### Description
This is the main test suite for the `renderAsync` function in an edge runtime environment.

#### Internal Logic
The suite contains four test cases that cover different scenarios for the `renderAsync` function.

### `it("converts a React component into HTML with Next 14 error stubs", ...)`
#### Description
This test case mocks the `react-dom/server` module to simulate Next.js 14 error stubs and checks if `renderAsync` still works correctly.

#### Internal Logic
1. Mocks `react-dom/server` to throw errors for legacy APIs.
2. Calls `renderAsync` with a `Template` component.
3. Asserts that the output matches the expected HTML snapshot.

### `it("converts a React component into HTML", ...)`
#### Description
This test case checks if `renderAsync` correctly converts a React component into HTML without any mocking.

#### Internal Logic
1. Calls `renderAsync` with a `Template` component.
2. Asserts that the output matches the expected HTML snapshot.

### `it("converts a React component into PlainText", ...)`
#### Description
This test case verifies if `renderAsync` can convert a React component into plain text.

#### Internal Logic
1. Calls `renderAsync` with a `Template` component and `{ plainText: true }` option.
2. Asserts that the output matches the expected plain text snapshot.

### `it("converts to plain text and removes reserved ID", ...)`
#### Description
This test case checks if `renderAsync` correctly converts a component to plain text while removing reserved IDs.

#### Internal Logic
1. Calls `renderAsync` with a `Preview` component and `{ plainText: true }` option.
2. Asserts that the output matches the expected plain text snapshot, which should not include the content of the div with the reserved ID.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| React | Used for creating and rendering React components |
| vitest | Testing framework used for running the tests |

## Configuration
The file uses the `@vitest-environment edge-runtime` configuration to set up the testing environment for edge runtime.

Note: This documentation provides a comprehensive overview of the test file, explaining its structure, test cases, and their purposes. The file is well-organized and covers various scenarios for testing the `renderAsync` function in an edge runtime environment.
---
title: "render-edge.spec.tsx"
---

## High-level description
This file contains unit tests for the `render` function in an edge runtime environment. It tests the rendering of React components to HTML and plain text, including error handling for legacy React DOM server APIs and specific rendering scenarios.

## Code Structure
The file consists of a single `describe` block containing four test cases (`it` blocks) that test different aspects of the `render` function's behavior in an edge runtime environment.

## References
- `render` function from "./render"
- `Template` component from "../shared/utils/template"
- `Preview` component from "../shared/utils/preview"

## Symbols

### `describe("render on the edge", ...)`
#### Description
This is the main test suite for the `render` function in an edge runtime environment.

#### Internal Logic
The test suite contains four test cases that cover different scenarios for rendering React components.

### `it("converts a React component into HTML with Next 14 error stubs", ...)`
#### Description
This test case mocks the `react-dom/server` module to throw errors for legacy APIs and then tests the `render` function with a `Template` component.

#### Internal Logic
1. Mocks `react-dom/server` to throw errors for legacy APIs.
2. Calls `render` with a `Template` component.
3. Asserts that the output matches the expected HTML snapshot.
4. Resets all mocks after the test.

### `it("converts a React component into HTML", ...)`
#### Description
This test case verifies that the `render` function correctly converts a React component into HTML.

#### Internal Logic
1. Calls `render` with a `Template` component.
2. Asserts that the output matches the expected HTML snapshot.

### `it("converts a React component into PlainText", ...)`
#### Description
This test case checks if the `render` function can convert a React component into plain text.

#### Internal Logic
1. Calls `render` with a `Template` component and `{ plainText: true }` option.
2. Asserts that the output matches the expected plain text snapshot.

### `it("converts to plain text and removes reserved ID", ...)`
#### Description
This test case verifies that the `render` function correctly converts a component to plain text and removes elements with reserved IDs.

#### Internal Logic
1. Calls `render` with a `Preview` component and `{ plainText: true }` option.
2. Asserts that the output matches the expected plain text snapshot, which should not include the content of the element with the reserved ID.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| React | Used for creating and rendering React components |
| vitest | Testing framework used for running the tests |

## Configuration
The file uses the `@vitest-environment edge-runtime` configuration to set up the testing environment for edge runtime.

## Error Handling
The first test case mocks `react-dom/server` to throw errors for legacy APIs, simulating the behavior of Next.js 14 error stubs. This tests the error handling capabilities of the `render` function when dealing with unsupported APIs in an edge runtime environment.
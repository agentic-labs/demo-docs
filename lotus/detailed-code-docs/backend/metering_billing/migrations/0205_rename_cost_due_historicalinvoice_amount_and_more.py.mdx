---
title: "0205_rename_cost_due_historicalinvoice_amount_and_more.py"
---

## High-level description
This Django migration script renames several fields in the metering_billing app's database schema and introduces a new model for tracking invoice line item adjustments. It also updates the choices for a webhook trigger field.

## Code Structure
This code defines a single Django migration class, `Migration`, which contains instructions for modifying the database schema. The `operations` list within this class outlines the specific changes to be applied.

## Symbols

### `Migration`
#### Description
This class represents a single Django migration. It defines changes to be applied to the database schema, such as renaming fields, adding new models, or altering existing ones.

#### Inputs
This class does not take any explicit inputs.

#### Outputs
This class does not return any explicit outputs.

#### Internal Logic
The `operations` list within the `Migration` class defines the specific changes to be applied to the database schema:

- **Renaming fields:**
    - Renames the `cost_due` field to `amount` in both the `HistoricalInvoice` and `Invoice` models.
    - Renames the `subtotal` field to `base` in the `InvoiceLineItem` model.
- **Adding fields:**
    - Adds an `amount` field to the `InvoiceLineItem` model to store the line item amount after adjustments.
- **Altering fields:**
    - Modifies the `trigger_name` field in the `WebhookTrigger` model to update its available choices.
    - Updates the help text of the `base` field in the `InvoiceLineItem` model.
- **Creating models:**
    - Creates a new model named `InvoiceLineItemAdjustment` to track adjustments applied to invoice line items. This model includes fields for the adjustment amount, account, type, and references to the related invoice line item and organization.

## Side Effects
This migration script modifies the database schema by applying the changes defined in the `operations` list.

## Dependencies
This code depends on the following external libraries:

| Dependency | Purpose |
|:-----------|:--------|
| `decimal` | Used for working with `Decimal` objects, ensuring precise decimal arithmetic. |
| `django.db.models` | Provides the necessary classes and functions for defining and manipulating database models in Django. |
| `django.db.models.deletion` | Used for specifying how related objects should be handled when a referenced object is deleted. |
| `django.db.migrations` | Provides the framework for creating and applying database migrations in Django. |

### Configuration
This code does not define any specific configuration options.

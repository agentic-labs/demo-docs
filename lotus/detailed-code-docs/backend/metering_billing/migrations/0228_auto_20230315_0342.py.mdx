---
title: "0228_auto_20230315_0342.py"
---

## High-level description
This Django migration script, `0228_auto_20230315_0342.py`, aims to populate the `pricing_unit` field for existing `RecurringCharge` instances where it is currently null. It sets the `pricing_unit` to match the `currency` of the associated `plan_version` for each `RecurringCharge`.

## Symbols

### `fill_null_pricing_unit_in`
#### Description
This function retrieves all `RecurringCharge` objects with a null `pricing_unit` and sets it to the `currency` of the corresponding `plan_version`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| apps | django.db.migrations.state.StateApps | Represents the Django app registry state during migrations. |
| schema_editor | django.db.backends.base.schema.BaseDatabaseSchemaEditor | Provides methods for manipulating the database schema during migrations. |

#### Outputs
This function doesn't return any value, it directly modifies the database.

#### Internal Logic
1. Retrieves the `RecurringCharge` model from the Django app registry.
2. Filters for `RecurringCharge` instances where `pricing_unit` is null.
3. Iterates through the filtered `RecurringCharge` objects.
4. For each `recurring_charge`, sets its `pricing_unit` to the `currency` of its associated `plan_version`.
5. Saves the updated `recurring_charge` object.

### `Migration`
#### Description
This class represents a Django migration that applies the `fill_null_pricing_unit_in` function to the database.

#### Inputs
This class doesn't take any explicit inputs.

#### Outputs
This class doesn't return any value, it defines the migration actions.

#### Internal Logic
- **dependencies:** Specifies the previous migration on which this migration depends.
- **operations:** Defines a list of operations to perform during the migration. In this case, it runs the `fill_null_pricing_unit_in` function using `migrations.RunPython`.

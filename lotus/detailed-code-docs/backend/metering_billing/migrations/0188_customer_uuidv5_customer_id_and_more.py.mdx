---
title: "0188_customer_uuidv5_customer_id_and_more.py"
---

## High-level description
This Django migration script adds a new `uuidv5_customer_id` field to the `Customer` and `HistoricalCustomer` models. This field stores a UUIDv5 hash generated from the `customer_id`, improving the efficiency of database lookups, particularly for the `Events` table.

## References
This migration references the following symbols:
- `metering_billing.utils.utils.customer_uuid`: A function to generate a UUID for a customer.

## Symbols
### `Migration`
#### Description
This class represents a database migration, applying changes to the database schema.

#### Inputs
N/A - This is a migration class, not a function.

#### Outputs
N/A - This is a migration class, not a function.

#### Internal Logic
This migration performs the following operations:
- **Adds `uuidv5_customer_id` field:** Adds a new `UUIDField` named `uuidv5_customer_id` to both the `Customer` and `HistoricalCustomer` models. This field will store a UUIDv5 hash generated from the `customer_id`, intended for optimizing database lookups.
- **Modifies `customer_id` field:** Alters the `customer_id` field in both `Customer` and `HistoricalCustomer` models to use a default value generated by the `metering_billing.utils.utils.customer_uuid` function.
- **Modifies `taxjar_code` field:** Alters the `taxjar_code` field in both `Plan` and `HistoricalPlan` models to allow blank and null values, increasing flexibility.

## Side Effects
This migration modifies the database schema by adding a new field and altering existing ones.

## Dependencies
- `django.db.migrations`: Django's migration framework.
- `metering_billing.utils.utils`: Utility functions for the metering and billing application.

---
title: "0229_historicalsubscriptionrecord_subscription_filters_and_more.py"
---

## High-level description
This Django migration script adds a new field named `subscription_filters` to both the `HistoricalSubscriptionRecord` and `SubscriptionRecord` models in the `metering_billing` app. This field is intended to store an array of arrays, where each sub-array represents a filter applied to a subscription.

## Symbols

### `Migration`
#### Description
This class defines the database migration to be applied. It adds the `subscription_filters` field to the `HistoricalSubscriptionRecord` and `SubscriptionRecord` models.

#### Inputs
None

#### Outputs
None

#### Internal Logic
The migration script performs the following actions:

1. **AddField:** Adds the `subscription_filters` field to the `HistoricalSubscriptionRecord` model.
    - The field is defined as a PostgreSQL `ArrayField` containing nested `ArrayField`s.
    - Each nested array has a fixed size of 2, likely representing a key-value pair for the filter.
    - The field defaults to an empty list.
2. **AddField:** Adds the `subscription_filters` field to the `SubscriptionRecord` model with the same configuration as in step 1.

## References
- `metering_billing.models.HistoricalSubscriptionRecord`: The historical model for subscription records.
- `metering_billing.models.SubscriptionRecord`: The model representing active subscription records.
- `django.contrib.postgres.fields.ArrayField`: A PostgreSQL-specific field for storing arrays.
- `django.db.models.TextField`: A field for storing text data.

## Dependencies
- `django.contrib.postgres.fields`: This module provides PostgreSQL-specific field types, including `ArrayField`. 

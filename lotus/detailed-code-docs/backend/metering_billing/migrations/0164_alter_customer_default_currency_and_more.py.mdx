---
title: "0164_alter_customer_default_currency_and_more.py"
---

## High-level description
This migration file (0164_alter_customer_default_currency_and_more.py) modifies several models in the metering_billing app, primarily updating foreign key relationships to the PricingUnit model. It changes the on_delete behavior to SET_NULL and adds related_name attributes to improve query efficiency and code readability.

## Code Structure
The migration consists of a single Migration class with dependencies and operations. The operations list contains multiple AlterField operations, each modifying a specific field in different models.

## Symbols

### Migration
#### Description
This class defines the migration operations to be applied to the database schema.

#### Internal Logic
1. Specifies the dependencies for this migration.
2. Defines a list of operations to be executed, each altering a field in a specific model.

## Operations
Each operation in the list is an AlterField operation, modifying a foreign key relationship to the PricingUnit model. The common changes across these operations are:

1. Setting on_delete=django.db.models.deletion.SET_NULL
2. Adding or updating the related_name attribute
3. Making the field nullable (null=True) and optional (blank=True)

The affected models and fields are:

1. Customer.default_currency
2. CustomerBalanceAdjustment.amount_paid_currency
3. CustomerBalanceAdjustment.pricing_unit
4. Invoice.currency
5. InvoiceLineItem.pricing_unit
6. Organization.default_currency
7. PlanComponent.pricing_unit
8. PlanVersion.pricing_unit

## Dependencies
This migration depends on the previous migration:
```python
("metering_billing", "0163_alter_historicalorganizationsetting_setting_group_and_more")
```

In summary, this migration updates foreign key relationships to the PricingUnit model across multiple models in the metering_billing app, improving the database schema and query efficiency.
---
title: "0100_remove_historicalsubscriptionrecord_scheduled_end_date_and_more.py"
---

## High-level description
This Django migration script removes the `scheduled_end_date` field from both the `HistoricalSubscriptionRecord` and `SubscriptionRecord` models. It then adds a new field, `unadjusted_duration_days`, to both models. This suggests a shift in how subscription durations are managed, likely moving away from pre-calculated end dates to a more flexible approach based on duration in days.

## Code Structure
This code doesn't have complex interconnected symbols, so the "Code Structure" section is omitted.

## References
This migration file references the following models:

* `metering_billing.HistoricalSubscriptionRecord`
* `metering_billing.SubscriptionRecord`

These models are defined in the `backend/metering_billing/models.py` file.

## Symbols

### `Migration`
#### Description
This class defines a Django migration that modifies the database schema by removing the `scheduled_end_date` field and adding the `unadjusted_duration_days` field to both the `HistoricalSubscriptionRecord` and `SubscriptionRecord` models.

#### Inputs
This class doesn't take any specific inputs.

#### Outputs
This class doesn't return any specific outputs.

#### Internal Logic
The `operations` list within the `Migration` class defines the database changes:

1. **`RemoveField`**: Removes the `scheduled_end_date` field from both `HistoricalSubscriptionRecord` and `SubscriptionRecord` models.
2. **`AddField`**: Adds the `unadjusted_duration_days` field as an integer field to both `HistoricalSubscriptionRecord` and `SubscriptionRecord` models. This field allows for null and blank values.

## Side Effects
This migration directly modifies the database schema. After applying this migration:

* The `scheduled_end_date` field will be removed from the `HistoricalSubscriptionRecord` and `SubscriptionRecord` tables.
* A new `unadjusted_duration_days` field will be added to the `HistoricalSubscriptionRecord` and `SubscriptionRecord` tables.

## Dependencies
This code depends on Django's migration framework (`django.db.migrations`).

## Error Handling
This migration script doesn't implement specific error handling beyond the basic exception handling provided by Django's migration framework.

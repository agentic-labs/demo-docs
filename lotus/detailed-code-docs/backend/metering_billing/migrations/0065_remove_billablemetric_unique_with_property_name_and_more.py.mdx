---
title: "0065_remove_billablemetric_unique_with_property_name_and_more.py"
---

## High-level description
This migration file modifies the `BillableMetric` model by removing constraints, adding new fields, and updating existing fields. It also removes fields from `PlanVersion` and `HistoricalPlanVersion` models. The changes primarily focus on enhancing the flexibility and granularity of billable metrics.

## Symbols

### Migration
#### Description
This Django migration class defines changes to be applied to the database schema, specifically for the `metering_billing` app.

#### Internal Logic
1. Removes constraints from the `BillableMetric` model.
2. Removes fields from `HistoricalPlanVersion` and `PlanVersion` models.
3. Adds new fields to `BillableMetric` and `HistoricalBillableMetric` models:
   - `billable_aggregation_type`
   - `event_type`
   - `granularity`
4. Updates existing fields in `BillableMetric` and `HistoricalBillableMetric` models:
   - `metric_type`
   - `usage_aggregation_type`

### RemoveConstraint
#### Description
Removes specified constraints from the `BillableMetric` model.

### RemoveField
#### Description
Removes the `proration_granularity` field from both `HistoricalPlanVersion` and `PlanVersion` models.

### AddField
#### Description
Adds new fields to the `BillableMetric` and `HistoricalBillableMetric` models.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model_name | string | The name of the model to modify |
| name | string | The name of the new field |
| field | models.Field | The field instance to add |

### AlterField
#### Description
Modifies existing fields in the `BillableMetric` and `HistoricalBillableMetric` models.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model_name | string | The name of the model to modify |
| name | string | The name of the field to alter |
| field | models.Field | The new field instance |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| django.db | Provides database-related functionality for Django |

## Notes
- This migration introduces more granular control over billable metrics by adding fields like `billable_aggregation_type`, `event_type`, and `granularity`.
- The removal of `proration_granularity` from plan versions suggests a change in how proration is handled.
- The changes to `metric_type` and `usage_aggregation_type` fields indicate an update to the available choices for these attributes.
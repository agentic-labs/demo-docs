---
title: "0108_auto_20221210_0410.py"
---

## High-level description
This Django migration script cleans up duplicate `Customer` entries in the database. It identifies duplicates as entries with the same `organization` and `email`, keeping the one with the lowest primary key (`pk`) value.

## Symbols

### `delete_dups`
#### Description
This function finds and deletes duplicate `Customer` objects in the database. 

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| apps | django.db.migrations.state.StateApps |  Provides access to the current Django application registry and models. |
| schema_editor | django.db.migrations.state.SchemaEditor |  Provides methods for manipulating the database schema. |

#### Outputs
This function does not return any value.

#### Internal Logic
1. **Retrieves the `Customer` model:** Obtains the `Customer` model from the Django app registry.
2. **Iterates through existing customers:** Loops through all `Customer` objects in the database, ordered by their primary key (`pk`).
3. **Identifies duplicates:** For each customer, it finds other customers with the same `organization` and `email` but different `pk` values.
4. **Deletes duplicates:** Deletes the identified duplicate `Customer` objects.

## Side Effects
This migration script directly modifies the database by deleting duplicate `Customer` entries. 

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| django.db.migrations | Provides functionality for creating and applying database migrations in Django. |
| metering_billing.models | Contains the definition of the `Customer` model. |

---
title: "0178_oldevent_unique_idempotency_id_per_org1.py"
---

## High-level description
This migration file adds a unique constraint to the `Event` model in the `metering_billing` app. It ensures that the combination of `organization` and `idempotency_id` fields is unique for each event. It also removes any existing `unique_together` constraints on the `Event` model.

## Symbols

### Migration
#### Description
This migration class defines the changes to be applied to the database schema.

#### Internal Logic
1. Adds a unique constraint to the `Event` model:
   - Fields: `organization` and `idempotency_id`
   - Constraint name: `unique_idempotency_id_per_org`
2. Removes any existing `unique_together` constraints on the `Event` model.

## Dependencies
This migration depends on the previous migration `0177_customer_timezone_customer_timezone_set_and_more`.

## Notes
- This migration is part of a series of database schema changes for the `metering_billing` app.
- The unique constraint ensures that each combination of organization and idempotency_id is unique, which is likely used to prevent duplicate events from being processed.
- Removing the `unique_together` constraint suggests that the previous uniqueness requirements are being replaced or refined by the new constraint.

This migration is relatively simple but important for maintaining data integrity in the event tracking system of the application.
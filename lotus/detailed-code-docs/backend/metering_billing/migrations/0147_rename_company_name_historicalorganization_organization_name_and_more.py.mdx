---
title: "0147_rename_company_name_historicalorganization_organization_name_and_more.py"
---

## High-level description
This Django migration file renames fields, modifies default values, and introduces a new model named `Tag` to the database schema. It also establishes relationships between existing models and the newly created `Tag` model.

## Code Structure
The code primarily consists of operations defined within a `Migration` class. These operations include renaming fields (`RenameField`), altering field properties (`AlterField`), creating a new model (`CreateModel`), and adding a many-to-many field to an existing model (`AddField`).

## References
This migration file references the `metering_billing.utils.utils` module for a custom function `now_utc`.

## Symbols
### `Migration`
#### Description
This class encapsulates a set of database schema changes to be applied.

#### Inputs
None

#### Outputs
None

#### Internal Logic
The `operations` list defines the database operations to be performed:
- **Renaming fields:** `RenameField` operations rename the `company_name` field to `organization_name` in both the `HistoricalOrganization` and `Organization` models.
- **Altering field properties:** `AlterField` operations modify the `created_on` field in both the `HistoricalPlan` and `Plan` models to use a default value provided by the `metering_billing.utils.utils.now_utc` function.
- **Creating a new model:** `CreateModel` defines a new model named `Tag` with fields for tag name, group, hex color code, and a foreign key relationship to the `Organization` model.
- **Adding a many-to-many field:** `AddField` adds a many-to-many field named `tags` to the `Plan` model, linking it to the `Tag` model.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| `django.db.models.deletion` | Provides the `CASCADE` option for handling foreign key relationships on deletion. |
| `django.db` | Offers database abstraction functionalities including migrations and models. |
| `metering_billing.utils.utils` | Provides the `now_utc` function for generating the current UTC timestamp. |


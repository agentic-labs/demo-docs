---
title: "0130_remove_customer_unique_email_and_more.py"
---

## High-level description
This Django migration file, generated on 2022-12-19, removes unique constraints, alters fields in various models related to metering and billing, and updates default values. It primarily focuses on modifying field properties like data types, validation, and help texts, indicating a schema update.

## References
This migration references the `metering_billing.utils.utils` module for default value generation.

## Symbols
### `Migration`
#### Description
This class represents a database migration operation. It applies a series of changes to the database schema, as defined in the `operations` list.

#### Inputs
N/A - This is a migration class, not a function or method.

#### Outputs
N/A - This class applies changes to the database schema; it doesn't return any specific output.

#### Internal Logic
The `operations` list defines the changes applied by this migration:
- **Removing Constraints:** Removes the "unique_email" constraint from the "Customer" model and the "unique_org_billable_metric_name" constraint from the "Metric" model.
- **Altering Fields:** Modifies numerous fields across various models, including:
    - Changing default values for fields like `backtest_id`, `metric_id`, `subscription_id`, and `subscription_record_id` to use UUIDs generated by utility functions.
    - Updating field types, for example, changing `backtest_results` and `integrations` to `JSONField`.
    - Adding, modifying, or removing validators for fields like `from_qty`, `to_qty`, `cost_due`, and others.
    - Updating help texts for better clarity on field purposes.
- **Foreign Key Handling:** Modifies `on_delete` behavior for several foreign key fields, primarily switching to `SET_NULL` to avoid cascading deletions.

## Side Effects
This migration directly modifies the database schema. The specific changes are detailed in the `operations` list and impact the structure and constraints of the affected models.

## Dependencies
- **Django:** Used for database migrations and model definitions.
- **metering_billing.utils.utils:** Provides utility functions for generating UUIDs.
- **decimal:** Used for handling decimal values in fields like `cost_due`, `flat_rate`, etc.
- **django.core.validators:** Provides validation rules for model fields.

### Configuration
N/A - This migration doesn't define any specific configuration options.

## Error Handling
N/A - This migration doesn't implement specific error handling beyond the built-in mechanisms of Django migrations.

## Logging
N/A - This migration doesn't include any logging statements.

## API/Interface Reference
N/A - This migration doesn't expose any API endpoints or public interfaces.

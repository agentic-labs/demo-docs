---
title: "Overview"
---

## High-level description
The `backend/metering_billing` directory contains the core functionality for a metering and billing system. It includes modules for handling authentication, data models, API views, background tasks, invoice generation, payment processing, and various utility functions.

## What does it do?
This directory implements a comprehensive metering and billing system that:

1. Tracks customer usage of services
2. Manages subscription plans and pricing
3. Generates invoices based on usage and plans
4. Integrates with payment processors like Stripe and Braintree
5. Provides API endpoints for managing customers, plans, subscriptions, and invoices
6. Handles user authentication and organization management
7. Implements background tasks for periodic operations like invoice generation
8. Supports CRM integrations for customer data synchronization
9. Generates PDF invoices and manages their storage in S3
10. Implements webhooks for notifying external systems of important events

## Entry points
The main entry points for this codebase are:

1. `views/`: Contains API views that handle HTTP requests and responses
2. `models.py`: Defines the data models for the system
3. `tasks.py`: Defines background tasks executed by Celery
4. `urls.py`: Defines the URL routing for the API endpoints
5. `admin.py`: Configures the Django admin interface

The data flow typically starts with an API request hitting a view, which then interacts with models, performs business logic, and may trigger background tasks or webhooks.

## Key Files
1. `models.py`: Defines the core data structures for customers, plans, subscriptions, invoices, etc.
2. `views/model_views.py`: Contains viewsets for CRUD operations on the main models
3. `tasks.py`: Implements background tasks for invoice generation, alert refreshing, etc.
4. `invoice.py`: Handles the logic for generating invoices
5. `payment_processors.py`: Implements integrations with payment processors
6. `aggregation/billable_metrics.py`: Handles usage calculation for different metric types
7. `utils/`: Contains various utility functions used throughout the system

## Dependencies
The system relies on several external libraries and frameworks:

1. Django: The web framework used for the backend
2. Django REST Framework: For building the API
3. Celery: For handling background tasks
4. Stripe and Braintree SDKs: For payment processing
5. boto3: For interacting with AWS S3
6. reportlab: For generating PDF invoices
7. taxjar: For tax calculations
8. svix: For managing webhooks

## Configuration
The system uses various configuration settings, including:

1. Django settings for database configuration, installed apps, middleware, etc.
2. Environment variables for API keys, secret keys, and other sensitive information
3. Custom settings for features like payment processors, S3 bucket names, and webhook configurations

This directory forms the core of a sophisticated metering and billing system, providing a wide range of functionalities from usage tracking to invoice generation and payment processing. It's designed to be flexible and extensible, supporting various pricing models and integration with external systems.
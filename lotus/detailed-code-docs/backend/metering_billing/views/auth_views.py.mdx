---
title: "auth_views.py"
---

Here's a high-level description of the code's purpose and main functionality:

This code defines the authentication and registration views for a Django application. It handles user login, logout, registration, password reset, and session management. The code also includes views for demo login and registration, which are likely used for testing or demonstration purposes.

## Code Structure

The main symbols in this code are class-based views that inherit from Django Rest Framework's APIView or from Knox's LoginView and LogoutView. These views handle different aspects of user authentication and registration:

1. LoginView and DemoLoginView: Handle user login
2. LogoutView: Handles user logout
3. InitResetPasswordView and ResetPasswordView: Handle password reset functionality
4. RegisterView and DemoRegisterView: Handle user registration
5. SessionView: Provides session information

## Symbols

### LoginView
#### Description
Handles user login by authenticating credentials and creating an auth token.

#### Inputs
- username: str
- password: str

#### Outputs
- token: str
- user: UserSerializer

#### Internal Logic
1. Authenticates user credentials
2. Checks if the user is not a demo account
3. Creates an auth token
4. Returns token and user data

### RegisterView
#### Description
Handles user registration by creating a new user account and organization.

#### Inputs
- register: RegistrationSerializer

#### Outputs
- token: str
- user: UserSerializer

#### Internal Logic
1. Validates registration data
2. Checks for existing users with the same username or email
3. Creates a new organization if needed
4. Creates a new user account
5. Creates an auth token
6. Returns token and user data

### SessionView
#### Description
Provides information about the current user session.

#### Outputs
- isAuthenticated: bool
- organization_id: str (if authenticated)

## Dependencies
- django.contrib.auth
- knox.views
- rest_framework
- metering_billing.models
- metering_billing.serializers.auth_serializers
- metering_billing.serializers.model_serializers

## Error Handling
The code includes custom exception handling for various scenarios such as invalid credentials, duplicate users, and registration failures.

## Logging
The code uses Django's logging system to log events such as successful logins and registrations.

This code provides a comprehensive set of views for handling user authentication and registration in a Django application, with additional features for demo accounts and password reset functionality.
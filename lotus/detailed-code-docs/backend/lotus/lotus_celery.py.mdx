---
title: "lotus_celery.py"
---

## High-level description
This code sets up Celery for asynchronous task processing in the Lotus application. It configures Celery to use Redis as a broker, autodiscovers tasks from installed apps, and integrates with Cronitor for task monitoring.

## References
This code references the following settings from the Django settings file (`lotus/settings.py`):

* `settings.INSTALLED_APPS`: Used to autodiscover Celery tasks.
* `settings.CELERY_*`: Used for Celery configuration.
* `settings.CRONITOR_API_KEY`: Used for Cronitor integration.

## Symbols

### `celery`
#### Description
This symbol represents the Celery application instance. It is responsible for managing and executing asynchronous tasks.

#### Inputs
This symbol does not take any direct inputs.

#### Outputs
This symbol does not return any direct outputs.

#### Internal Logic
1. **Initialization:** A Celery app instance is created with the name "lotus".
2. **Configuration:**
    * It loads Celery configuration from Django settings with the prefix `CELERY_`.
3. **Cronitor Integration:**
    * If `CRONITOR_API_KEY` is set in Django settings, it initializes Cronitor monitoring for Celery tasks.
4. **Task Autodiscovery:**
    * It automatically discovers and registers Celery tasks defined in installed Django apps.

#### Side Effects
* Initializes a Celery application.
* Configures Celery to use Redis as a broker.
* Integrates Celery with Cronitor for task monitoring.
* Discovers and registers Celery tasks from installed Django apps.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| celery      | Asynchronous task queue |
| cronitor.celery | Cronitor integration for Celery |
| django.conf | Accessing Django settings |

### Configuration
This code relies on the following configuration options defined in the Django settings file (`lotus/settings.py`):

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `CELERY_*` | Various | - | Celery configuration options |
| `CRONITOR_API_KEY` | String | "" | Cronitor API key for task monitoring |

## Error Handling
This code does not implement specific error handling beyond basic exception raising.

## Logging
This code logs a message if the `SECRET_KEY` is not set and defaults to a random one.

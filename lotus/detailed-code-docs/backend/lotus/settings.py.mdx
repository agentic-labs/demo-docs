---
title: "settings.py"
---

## High-level description
This file defines the configuration settings for the Lotus Django project. It includes settings for databases, security, applications, middleware, templates, internationalization, static files, and more. The file is responsible for configuring the behavior of the Lotus application.

## Code Structure
The code in `settings.py` primarily consists of variable assignments and dictionary definitions. It leverages environment variables for sensitive information and provides default values for development environments. The settings are grouped logically based on their purpose, such as database settings, application settings, etc.

## References
This file references several other parts of the codebase, including:

* `metering_billing.models`: For model definitions like `User`, `Organization`, etc.
* `metering_billing.permissions`: For custom permission classes.
* `metering_billing.middleware`: For custom middleware.
* `api.serializers`: For serializer definitions.
* `metering_billing.utils`: For utility functions and enums.
* `metering_billing.kafka`: For Kafka-related settings and components.
* `metering_billing.webhooks`: For webhook definitions.

## Symbols

### `DOCKERIZED`
#### Description
A boolean setting indicating whether the application is running inside a Docker container.

#### Inputs
Environment variable: `DOCKERIZED`

#### Outputs
* `True` if `DOCKERIZED` environment variable is set to a truthy value.
* `False` otherwise.

### `DEBUG`
#### Description
A boolean setting controlling Django's debug mode.

#### Inputs
Environment variable: `DEBUG`

#### Outputs
* `True` if `DEBUG` environment variable is set to a truthy value.
* `False` otherwise.

### `DATABASES`
#### Description
A dictionary containing database connection settings. It supports both PostgreSQL and SQLite depending on the environment.

#### Inputs
Environment variable: `DATABASE_URL`

#### Outputs
A dictionary with database connection parameters.

### `INSTALLED_APPS`
#### Description
A list of Django applications enabled in the project.

#### Inputs
None

#### Outputs
A list of strings representing Django app names.

### `MIDDLEWARE`
#### Description
A list of middleware classes applied to HTTP requests and responses.

#### Inputs
None

#### Outputs
A list of strings representing middleware class paths.

### `TEMPLATES`
#### Description
A list of settings for configuring Django's template engine.

#### Inputs
None

#### Outputs
A list of dictionaries containing template engine settings.

### `STATIC_ROOT`, `STATIC_URL`, `STATICFILES_DIRS`
#### Description
Settings related to managing static files (CSS, JavaScript, Images).

#### Inputs
* `BASE_DIR`: The project's base directory.
* `VITE_APP_DIR`: The directory of the Vite frontend application.

#### Outputs
Strings representing paths and URLs for static files.

### `REST_FRAMEWORK`
#### Description
A dictionary containing settings for configuring Django REST Framework.

#### Inputs
None

#### Outputs
A dictionary with REST Framework settings.

### `CORS_ALLOW_ALL_ORIGINS`, `CORS_ALLOW_CREDENTIALS`, `CORS_ALLOW_HEADERS`
#### Description
Settings for configuring Cross-Origin Resource Sharing (CORS).

#### Inputs
None

#### Outputs
Boolean and list values controlling CORS behavior.

### `SVIX_CONNECTOR`
#### Description
An instance of the Svix client used for sending webhooks.

#### Inputs
Environment variables: `SVIX_API_KEY`, `SVIX_JWT_SECRET`

#### Outputs
An instance of the `Svix` client or `None` if Svix is not configured.

## Dependencies
This file depends on several external libraries and modules, including:

| Dependency | Purpose |
|:-----------|:--------|
| decouple | For loading environment variables |
| dj_database_url | For parsing database URLs |
| django-heroku | For Heroku-specific settings |
| posthog | For product analytics |
| sentry_sdk | For error tracking and performance monitoring |
| svix | For sending webhooks |
| kafka | For event streaming |
| cronitor | For monitoring scheduled tasks |
| boto3 | For interacting with AWS S3 |
| reportlab | For generating PDF invoices |
| braintree | For Braintree payment processing |
| taxjar | For tax calculation |

## Configuration
This file defines numerous configuration options through environment variables. Some notable options include:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `VITE_API_URL` | string | `http://localhost:8000` | URL of the Vite frontend application |
| `SECRET_KEY` | string | Randomly generated | Secret key for cryptographic signing |
| `POSTGRES_DB`, `POSTGRES_USER`, `POSTGRES_PASSWORD` | string | `lotus`, `lotus`, `lotus` | PostgreSQL database credentials |
| `SENTRY_DSN` | string | "" | Sentry DSN for error tracking |
| `STRIPE_LIVE_SECRET_KEY`, `STRIPE_TEST_SECRET_KEY` | string | `None` | Stripe secret keys for live and test modes |
| `BRAINTREE_LIVE_MERCHANT_ID`, `BRAINTREE_TEST_MERCHANT_ID` | string | `None` | Braintree merchant IDs for live and test modes |
| `TAXJAR_API_KEY` | string | `None` | TaxJar API key for tax calculation |
| `SVIX_API_KEY`, `SVIX_JWT_SECRET` | string | "", "" | Svix API key and JWT secret for webhooks |
| `KAFKA_HOST`, `KAFKA_EVENTS_TOPIC` | string | `127.0.0.1:9092`, `test-topic` | Kafka connection settings |
| `REDIS_URL` | string | `redis://redis:6379` (Dockerized) | Redis connection URL |

## Error Handling
The code includes basic error handling using try-except blocks for handling potential exceptions during environment variable loading and database connection setup.

## Logging
The code utilizes the `logging` module to log messages to the console. The log level is set to `INFO` for the `django.server` logger.

## TODOs
There are no explicit TODOs left in the code.

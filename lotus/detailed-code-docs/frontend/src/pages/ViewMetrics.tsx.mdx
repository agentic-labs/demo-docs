---
title: "ViewMetrics.tsx"
---

## High-level description
The `ViewMetrics` component displays a list of metrics and provides functionality to create new ones. It fetches metric data from an API, displays it in a table, and allows users to create new metrics using a modal form.

## Code Structure
The `ViewMetrics` component uses the `useQuery` hook to fetch metric data and the `useMutation` hook to handle metric creation. It renders a `MetricTable` component to display the metrics and a `CreateMetricForm` component within a modal for creating new metrics. The `EventStream` component is also rendered, likely to display a stream of recent events.

## Symbols
### `ViewMetrics`
#### Description
This functional component displays a list of metrics, allows users to create new metrics, and shows a stream of recent events.

#### Inputs
This component does not take any props.

#### Outputs
This component renders the JSX for the metrics view.

#### Internal Logic
1. **State variables:**
    - `visible`: Controls the visibility of the metric creation modal.
    - `metricState`: Holds the state of the metric creation form.
2. **Data fetching:**
    - Uses `useQuery` to fetch the list of metrics from the API endpoint `Metrics.getMetrics()`.
    - Data is stored in the `data` variable, loading state in `isLoading`, and error state in `isError`.
3. **Metric creation:**
    - Uses `useMutation` to handle creating new metrics via the API endpoint `Metrics.createMetric()`.
    - Provides success, error, and loading feedback using `react-toastify`.
4. **UI rendering:**
    - Renders a `PageLayout` component with the title "Metrics" and a button to create a new metric.
    - If loading, renders a `LoadingSpinner`.
    - If there's an error, displays an error message.
    - If data is present, renders a `MetricTable` component with the fetched metric data.
    - Renders an `EventStream` component.
    - Renders a `CreateMetricForm` component within a modal, passing the form state and handlers.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core library for building UI components |
| antd | UI library for design and layout |
| @tanstack/react-query | Data fetching and caching library |
| react-toastify | Library for displaying toast notifications |
| MetricTable | Component for displaying metrics in a table format |
| Metrics (from `../api/api`) | API client for interacting with the metrics API |
| ... (other types) | Type definitions for metrics and related data |
| LoadingSpinner | Component for displaying a loading spinner |
| CreateMetricForm | Component for creating new metrics |
| EventPreview | Component for previewing events |
| PageLayout | Component for the overall page layout |
| @ant-design/icons | Library for icons |
| EventStream | Component for displaying a stream of events |

## Error Handling
The component uses `react-toastify` to display error messages to the user if the metric creation API request fails.

## Logging
The code does not implement any specific logging mechanisms.

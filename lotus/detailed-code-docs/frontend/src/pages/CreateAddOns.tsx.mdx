---
title: "CreateAddOns.tsx"
---

## High-level description
The `CreateAddOns.tsx` file defines a React component for creating new add-ons in the Lotus application. It provides a form for entering add-on information, adding components (for usage-based add-ons), and adding features. The component handles form submission, data validation, and interaction with the backend API to create the add-on.

## Code Structure
The `CreateAddOns` function is the main component that renders the form and handles user interactions. It uses several state variables to manage the form data, visibility of modals, and other UI elements. The component also uses React Query for data fetching and mutations, and Ant Design components for the UI.

## References
- `Plan`, `Organization`, `AddOn` from `../api/api`: API functions for interacting with the backend.
- `FeatureForm` from `../components/Plans/FeatureForm`: Component for adding features to the add-on.
- `UsageComponentForm` from `../components/Plans/UsageComponentForm`: Component for adding usage-based components to the add-on.
- `ComponentDisplay` from `../components/Plans/ComponentDisplay`: Component for displaying added components.
- `FeatureDisplay` from `../components/Plans/FeatureDisplay`: Component for displaying added features.

## Symbols

### `CreateAddOns`
#### Description
This function defines the main component for creating new add-ons. It renders a form with fields for add-on information, components, and features. It handles user interactions, form submission, and API calls to create the add-on.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- The component uses several state variables to manage the form data, visibility of modals, and other UI elements.
- It fetches data for plans and currencies using React Query.
- It uses a mutation from React Query to handle the creation of the add-on via the API.
- It renders different UI elements based on the selected add-on type (flat fee or usage-based).
- It handles adding, editing, and deleting components and features.
- It validates the form data before submission.
- It submits the add-on data to the API on form submission.

## Side Effects
- The component modifies the global state by updating the list of add-ons in the React Query cache after successful creation.
- It displays success or error toasts to the user based on the API response.
- It navigates to the add-ons page after successful creation.

## Dependencies
- `react`: For building the component.
- `react-router-dom`: For navigation.
- `@tanstack/react-query`: For data fetching and mutations.
- `react-toastify`: For displaying toasts.
- `antd`: For UI components.
- `../api/api`: For API functions.
- `../types/plan-type`: For type definitions.
- `../types/feature-type`: For type definitions.
- `../types/pricing-unit-type`: For type definitions.
- `../types/addon-type`: For type definitions.
- `../components/Plans/FeatureForm`: For adding features.
- `../components/Plans/UsageComponentForm`: For adding usage-based components.
- `../components/Plans/ComponentDisplay`: For displaying added components.
- `../components/Plans/FeatureDisplay`: For displaying added features.
- `../components/base/PageLayout`: For the page layout.


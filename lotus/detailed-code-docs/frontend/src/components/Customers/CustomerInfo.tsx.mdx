---
title: "CustomerInfo.tsx"
---

## High-level description
The `CustomerInfoView` component displays detailed information about a specific customer, including their details, revenue details, and a graph of revenue vs. cost per day. It allows users to view and edit customer information, such as name, ID, billing address, timezone, email, default currency, and tax rate.

## Code Structure
The `CustomerInfoView` component is a functional component that uses React hooks to manage state and side effects. It fetches customer data, cost analysis data, and pricing units using React Query. It also uses Ant Design components for UI elements like forms, typography, tooltips, and charts. The component renders customer details in a card format, revenue details in another card, and a graph of revenue vs. cost per day.

## References
- `Customer` from `../../api/api`: Used to fetch and update customer data.
- `country_json` from `../../assets/country_codes`: Used to populate the country select dropdown.
- `integrationsMap` from `../../types/payment-processor-type`: Used to display payment provider and CRM icons.
- `CustomerType` from `../../types/customer-type`: Defines the type of customer data.
- `CustomerCostType` from `../../types/revenue-type`: Defines the type of cost analysis data.
- `CurrencyType` from `../../types/pricing-unit-type`: Defines the type of pricing unit data.
- `CustomerCard` from `./Card/CustomerCard`: Used to display customer details and revenue details in a card format.
- `PencilSquareIcon` from `../base/PencilIcon`: Used to display the edit icon.
- `CopyText` from `../base/CopytoClipboard`: Used to copy customer ID and email.
- `createShortenedText` from `../../helpers/createShortenedText`: Used to shorten customer ID and email for display.
- `useMediaQuery` from `../../hooks/useWindowQuery`: Used to get the window width for responsive design.
- `Divider` from `../base/Divider/Divider`: Used to separate sections in the cards.
- `Badge` from `../base/Badges/Badges`: Used to display cost and revenue badges in the graph legend.
- `fourDP` from `../../helpers/fourDP`: Used to format the tax rate.
- `timezones` from `../../assets/timezones`: Used to populate the timezone select dropdown.

## Symbols

### `CustomerInfoView`
#### Description
This functional component displays detailed information about a specific customer, including their details, revenue details, and a graph of revenue vs. cost per day. It allows users to view and edit customer information.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | `components["schemas"]["CustomerDetail"]` | The customer data fetched from the API. |
| cost_data | `CustomerCostType` | The cost analysis data for the customer. |
| pricingUnits | `CurrencyType[]` | The list of available pricing units. |
| onDateChange | `(start_date: string, end_date: string) =&gt; void` | Callback function to handle date range changes for the graph. |
| refetch | `VoidFunction` | Callback function to refetch customer data. |

#### Outputs
The component renders the customer details, revenue details, and a graph of revenue vs. cost per day.

#### Internal Logic
- The component uses React hooks to manage state and side effects.
- It fetches customer data, cost analysis data, and pricing units using React Query.
- It transforms the cost analysis data into a format suitable for the graph.
- It handles user interactions for editing customer information and updating the graph date range.
- It uses Ant Design components for UI elements like forms, typography, tooltips, and charts.

## Side Effects
- The component updates the customer data in the API when the user edits and saves the customer information.
- It refetches the cost analysis data when the user changes the graph date range.

## Dependencies
- `@ant-design/plots`: Used for the revenue vs. cost graph.
- `@tanstack/react-query`: Used for data fetching and caching.
- `antd`: Used for UI components.
- `dayjs`: Used for date manipulation.
- `react-toastify`: Used for displaying toast notifications.

## TODOs
- The code contains several commented-out lines and unused variables that should be removed or addressed.
- The logic for editing the customer ID is commented out and should be implemented if needed.
- The component includes commented-out code related to pre-paid usage, property separation, and proration granularity, which should be reviewed and implemented if necessary.


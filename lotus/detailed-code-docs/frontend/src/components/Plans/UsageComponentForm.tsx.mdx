---
title: "UsageComponentForm.tsx"
---

## High-level description
The `UsageComponentForm` component is a modal form used to create or edit usage-based components for pricing plans. It allows users to define tiers with different charge types (per unit, free, flat), amounts, units, and rounding types. It also includes options for bulk pricing, pre-paid usage, and component settings like invoicing and reset intervals.

## Code Structure
The `UsageComponentForm` component uses the Ant Design library for its UI elements. It defines several helper functions and constants, including `resetValidationLogic` for validating reset intervals, `validateTiers` for validating tier configurations, and `EditableContext` for managing the editable table. The main component renders a modal with a form that includes a table for defining tiers, checkboxes for bulk pricing and pre-paid usage, and collapse panels for additional settings.

## References
- `Metrics.getMetrics()`: Fetches a list of available metrics from the API.
- `handleComponentAdd`: A function passed as a prop to handle the creation or update of a component.

## Symbols

### `UsageComponentForm`
#### Description
A modal form component for creating or editing usage-based components for pricing plans.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| visible | boolean | Whether the modal is visible. |
| onCancel | () =&gt; void | Function to call when the modal is canceled. |
| componentsData | any | Existing component data. |
| handleComponentAdd | (s: any) =&gt; void | Function to call when a component is added or updated. |
| editComponentItem | any | Component item being edited. |
| setEditComponentsItem | (s: any) =&gt; void | Function to set the component item being edited. |
| currency | CurrencyType | Currency information. |
| planDuration | string | Duration of the plan (e.g., "monthly"). |

#### Outputs
None

#### Internal Logic
- Fetches available metrics from the API and populates a dropdown.
- Renders a table for defining tiers with editable cells for each field.
- Validates tier configurations using the `validateTiers` function.
- Handles adding new tiers and deleting existing ones.
- Includes checkboxes for bulk pricing and pre-paid usage with optional settings.
- Provides collapse panels for component settings like invoicing and reset intervals.
- Calls the `handleComponentAdd` function when the form is submitted with the updated component data.

## Dependencies
- Ant Design: UI library for React.
- React: JavaScript library for building user interfaces.

## Error Handling
- Uses Ant Design's form validation to handle errors in user input.
- Displays error messages to the user when tier configurations are invalid.

## TODOs
- The code includes commented-out sections related to property separation and proration granularity, which may be implemented in the future.

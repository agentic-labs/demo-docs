---
title: "CustomPlanDetails.tsx"
---

## High-level description
This code defines a React component called `CustomPlanDetails` that displays detailed information about a custom plan version. It includes plan summary, plan information, recurring charges, components, features, price adjustments, and customer subscriptions. The component uses various sub-components to render different sections of the plan details.

## Code Structure
The main `CustomPlanDetails` component receives props including version details, plan information, and functions for managing external links and tags. It then renders several sub-components to display different aspects of the plan:

1. `PlanSummary`: Displays basic plan information and allows managing tags and external links.
2. `PlanInfo`: Shows version-specific information.
3. `PlanRecurringCharges`: Lists recurring charges associated with the plan.
4. `PlanComponents`: Displays the components of the plan, including usage-based pricing tiers.
5. `PlanFeatures`: Lists the features included in the plan.
6. `PlanCustomerSubscriptions`: Shows current subscriptions for this plan version.

The component also includes a section for displaying price adjustments.

## Symbols

### CustomPlanDetails
#### Description
The main component that renders the custom plan details page.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| version | object | The specific version of the plan being displayed |
| plan | object | The overall plan information |
| refetch | function | Function to refresh the data |
| activeKey | string | The currently active tab key |
| createPlanExternalLink | function | Function to create an external link for the plan |
| deletePlanExternalLink | function | Function to delete an external link from the plan |

#### Internal Logic
1. Uses React Query's `useMutation` to manage tag creation and deletion.
2. Renders a grid layout with various sub-components to display plan details.
3. Handles price adjustment display using a separate function `getPriceAdjustmentEnding`.

### getPriceAdjustmentEnding
#### Description
A helper function that returns the appropriate JSX for displaying price adjustments based on the adjustment type.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| type | string | The type of price adjustment |
| amount | number | The amount of the adjustment |
| code | string | The currency code |

#### Outputs
Returns JSX elements displaying the price adjustment information.

## Dependencies
The component relies on several external libraries and components:
- React and its hooks
- Ant Design components (Typography, useMutation, useQueryClient from @tanstack/react-query)
- Custom components (PlanSummary, PlanInfo, PlanComponents, PlanFeatures, PlanRecurringCharges, PlanCustomerSubscriptions)
- API functions from the `Plan` object

## Error Handling
The component doesn't implement explicit error handling. Error management is likely handled by the parent components or the global error handling mechanism.

## Performance Considerations
The component uses React Query for data fetching and caching, which can help with performance. However, rendering multiple sub-components with potentially large datasets could impact performance for plans with many components or features.
---
title: "public_api_tests.yml"
---

## High-level description
This GitHub Actions workflow file, named "Public API Tests," is designed to run automated tests for a public API. It sets up a development environment, including PostgreSQL and Redis services, and executes Postman tests against the API. The workflow is triggered on pushes to the main branch and pull requests targeting the main branch.

## Code Structure
The workflow consists of a single job named "postman-and-sdk-tests" that runs on Ubuntu. It sets up the necessary services, installs dependencies, prepares the environment, and runs the API tests using Postman.

## Symbols

### `postman-and-sdk-tests` (job)
#### Description
This job sets up the testing environment and runs the Postman tests for the public API.

#### Internal Logic
1. Set up PostgreSQL and Redis services
2. Configure environment variables
3. Checkout the code
4. Start Redpanda (a Kafka-compatible event streaming platform)
5. Set up Python 3.9
6. Install Poetry (Python dependency management tool)
7. Cache Poetry dependencies
8. Install project dependencies
9. Run database migrations
10. Install jq (JSON processor)
11. Capture outputs from a custom Django management command
12. Prepare environment variables for Postman tests
13. Start the Django development server
14. Run Postman tests using Newman
15. Output test summary

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| PostgreSQL | Database service |
| Redis | In-memory data structure store |
| Redpanda | Kafka-compatible event streaming platform |
| Python 3.9 | Runtime environment |
| Poetry | Python dependency management |
| jq | JSON processor |
| Newman | Postman test runner |

## Configuration
The workflow uses various environment variables and secrets for configuration:

| Option | Type | Description |
|:-------|:-----|:------------|
| DJANGO_SETTINGS_MODULE | string | Specifies the Django settings module |
| PYTHONPATH | string | Sets the Python path |
| SECRET_KEY | secret | Django secret key |
| STRIPE_LIVE_SECRET_KEY | secret | Stripe live mode secret key |
| STRIPE_TEST_SECRET_KEY | secret | Stripe test mode secret key |
| DEBUG | boolean | Disables Django debug mode |
| KAFKA_URL | string | Kafka connection URL |
| SENTRY_DSN | secret | Sentry error tracking configuration |
| SELF_HOSTED | secret | Indicates if the application is self-hosted |

## Error Handling
The workflow does not implement specific error handling mechanisms beyond the default behavior of GitHub Actions. If any step fails, the workflow will stop and report the failure.

## API/Interface Reference
The workflow tests a public API using Postman. The specific endpoints and methods tested are defined in the Postman collection referenced by the collection ID: `18225965-f895719c-ab58-4f3d-ba21-5c918691697e`.

## TODOs
There are no explicit TODOs in the workflow file.
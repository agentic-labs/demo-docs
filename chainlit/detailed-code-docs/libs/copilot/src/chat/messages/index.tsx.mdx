---
title: "index.tsx"
---

## High-level description
This code defines a React component called `Messages` that manages and displays chat messages in a Chainlit application. It handles user interactions, feedback, and actions related to the chat interface.

## Code Structure
The `Messages` component uses various hooks and context providers to manage state and interactions. It renders a `MessageContainer` component, passing down props for messages, actions, and callback functions.

## References
- `WidgetContext` from 'context'
- Various imports from '@chainlit/react-client'
- `MessageContainer` from './container'

## Symbols

### Messages
#### Description
A functional component that serves as the main container for chat messages.

#### Inputs
No direct inputs (props), but uses various hooks and context.

#### Outputs
Returns a JSX.Element (the rendered MessageContainer).

#### Internal Logic
1. Retrieves various pieces of state and functions using hooks and context.
2. Defines callback functions for handling actions and feedback.
3. Renders a MessageContainer with the necessary props.

### callActionWithToast
#### Description
A memoized callback function that wraps the `callAction` function.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| action | IAction | The action to be called |

#### Internal Logic
Calls the `callAction` function with the provided action.

### onFeedbackUpdated
#### Description
A memoized callback function that handles updating feedback for a message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | IStep | The message to update feedback for |
| onSuccess | () =&gt; void | Callback function to be called on success |
| feedback | IFeedback | The feedback data to be set |

#### Internal Logic
1. Calls the API to set feedback.
2. Updates the message state with the new feedback on success.
3. Displays toast notifications for loading, success, and error states.

### onFeedbackDeleted
#### Description
A memoized callback function that handles deleting feedback for a message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | IStep | The message to delete feedback from |
| onSuccess | () =&gt; void | Callback function to be called on success |
| feedbackId | string | The ID of the feedback to be deleted |

#### Internal Logic
1. Calls the API to delete feedback.
2. Updates the message state to remove the feedback on success.
3. Displays toast notifications for loading, success, and error states.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| recoil | State management |
| sonner | Toast notifications |
| @chainlit/react-client | Chainlit-specific hooks and utilities |

## Error Handling
Error handling is implemented in the feedback update and delete functions using try-catch blocks and toast notifications for user feedback.

## Performance Considerations
The component uses memoization (useCallback) for its callback functions to optimize performance and prevent unnecessary re-renders.
---
title: "index.tsx"
---

## High-level description
This code defines the core API client and related interfaces for interacting with a Chainlit server. It includes classes for handling API requests, error management, and specific endpoints for authentication, feedback, and thread management.

## Code Structure
The main symbols in this code are:
1. `APIBase`: A base class for API interactions.
2. `ChainlitAPI`: Extends `APIBase` with specific Chainlit endpoints.
3. `ClientError`: A custom error class for API-related errors.
4. Various interfaces and types for API requests and responses.

The `ChainlitAPI` class uses methods from `APIBase` to implement specific API endpoints.

## Symbols

### `ClientError`
#### Description
A custom error class for API-related errors, extending the built-in `Error` class.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | string | The error message |
| detail | string | Optional detailed error information |

#### Internal Logic
Overrides the `toString` method to include the detail if available.

### `APIBase`
#### Description
A base class for API interactions, providing methods for HTTP requests.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| httpEndpoint | string | The base URL for API requests |
| type | 'webapp' \| 'copilot' \| 'teams' \| 'slack' \| 'discord' | The type of application |
| on401 | () =&gt; void | Optional callback for 401 errors |
| onError | (error: ClientError) =&gt; void | Optional callback for other errors |

#### Methods
- `buildEndpoint`: Constructs the full URL for an API endpoint.
- `checkToken`: Ensures the token has the correct prefix.
- `fetch`: Performs an HTTP request with error handling.
- `get`, `post`, `put`, `patch`, `delete`: Wrapper methods for specific HTTP methods.

### `ChainlitAPI`
#### Description
Extends `APIBase` with specific Chainlit API endpoints.

#### Methods
- `headerAuth`: Performs header-based authentication.
- `passwordAuth`: Performs password-based authentication.
- `logout`: Logs out the user.
- `setFeedback`: Sets feedback for a message or thread.
- `deleteFeedback`: Deletes feedback.
- `listThreads`: Retrieves a list of threads.
- `deleteThread`: Deletes a thread.
- `uploadFile`: Uploads a file with progress tracking.
- `getElementUrl`: Gets the URL for an element.
- `getLogoEndpoint`: Gets the URL for the logo.
- `getOAuthEndpoint`: Gets the URL for OAuth authentication.

## Dependencies
The code imports types and utilities from other parts of the project, including `IThread`, `IFeedback`, and `removeToken`.

## Error Handling
The `APIBase` class includes error handling in its `fetch` method, which catches and processes HTTP errors, including 401 unauthorized errors.

## API/Interface Reference
The `ChainlitAPI` class exposes several methods that correspond to API endpoints:

| Endpoint | Method | Description |
|:---------|:-------|:------------|
| /auth/header | POST | Header-based authentication |
| /login | POST | Password-based authentication |
| /logout | POST | User logout |
| /feedback | PUT, DELETE | Set or delete feedback |
| /project/threads | POST | List threads |
| /project/thread | DELETE | Delete a thread |
| /project/file | POST | Upload a file |

Note: This is not an exhaustive list of all endpoints, but covers the main ones implemented in the `ChainlitAPI` class.
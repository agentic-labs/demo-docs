---
title: "testUtils.ts"
---

## High-level description
This file contains utility functions for Cypress tests in the Chainlit project. It provides helper functions for interacting with the chat interface, running the test server, and managing test execution modes.

## Code Structure
The file exports several functions that are used across different test files to perform common operations like submitting messages, opening/closing history, running the test server, and describing tests for both synchronous and asynchronous execution modes.

## Symbols

### `submitMessage`
#### Description
Submits a message to the chat interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | string | The message to be submitted |

#### Internal Logic
1. Waits for 1 second
2. Ensures the chat input is not disabled
3. Types the message into the chat input and presses enter

### `submitMessageCopilot`
#### Description
Submits a message to the Copilot chat interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | string | The message to be submitted |

#### Internal Logic
1. Waits for 1 second
2. Ensures the Copilot chat input is not disabled
3. Types the message into the Copilot chat input and presses enter

### `openHistory`
#### Description
Opens the chat history.

#### Internal Logic
1. Waits for 1 second
2. Ensures the chat input is not disabled
3. Presses the up arrow key in the chat input

### `closeHistory`
#### Description
Closes the chat history.

#### Internal Logic
Clicks on the body of the page

### `runTestServer`
#### Description
Runs the test server for a specific test.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mode | ExecutionMode (optional) | The execution mode (sync or async) |
| env | Record&lt;string, string&gt; (optional) | Environment variables to be passed to the server |

#### Internal Logic
1. Extracts the test name from the Cypress spec file path
2. Executes the test server using the extracted test name and specified mode
3. Visits the root URL

### `describeSyncAsync`
#### Description
Describes a test suite that runs in both synchronous and asynchronous modes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| title | string | The title of the test suite |
| callback | (mode: ExecutionMode) =&gt; void | The test suite callback function |

#### Internal Logic
1. Creates a describe block for synchronous mode
2. Creates a describe block for asynchronous mode
3. Calls the provided callback function for each mode

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| path | Used to manipulate file paths |
| utils | Imports the ExecutionMode enum |

This file serves as a central location for common test utilities, making it easier to write and maintain Cypress tests for the Chainlit project. It abstracts away common operations and provides a consistent interface for interacting with the chat UI and managing test execution.
---
title: "spec.cy.ts"
---

## High-level description
This Cypress test file (`cypress/e2e/on_chat_start/spec.cy.ts`) contains a test suite for the `on_chat_start` functionality. It verifies that the initial message is correctly displayed when a chat session starts.

## Symbols

### `describe('on_chat_start', ...)`
#### Description
This is the main test suite for the `on_chat_start` functionality. It sets up the test environment and contains a single test case.

#### Internal Logic
1. Before running the tests, it calls `runTestServer()` to set up the test environment.
2. It includes one test case to verify the correct execution of `on_chat_start`.

### `before(() =&gt; { runTestServer(); })`
#### Description
This hook runs before the test suite and sets up the test server.

#### Internal Logic
Calls the `runTestServer()` function from the `testUtils` module to start the test server.

### `it('should correctly run on_chat_start', ...)`
#### Description
This test case verifies that the `on_chat_start` functionality works correctly by checking the initial message displayed in the chat.

#### Internal Logic
1. Selects all elements with the class `.step` and stores them in the `messages` variable.
2. Checks that there is exactly one message (`.step` element) present.
3. Verifies that the first (and only) message contains the text "Hello!".
4. Checks that the message includes HTML with a Python code block.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| `runTestServer` | Imported from `../../support/testUtils` to set up the test environment |

## References
The test file references the following external components:
- `.step` class elements, which represent chat messages in the UI.
- `#chat-input` element, which is likely the chat input field (although not used in this specific test).

## Notes
1. This test focuses on the initial state of the chat when it starts, specifically checking for a welcome message with a Python code block.
2. The test uses Cypress commands and assertions to interact with and verify the DOM elements.
3. The `runTestServer()` function is called before the tests, but its implementation is not provided in the target file. It's imported from a separate utility file.
---
title: "spec.cy.ts"
---

## High-level description
This Cypress test suite verifies the header authentication functionality. It tests two scenarios: one without a custom header (which should fail) and another with a custom header (which should succeed).

## Symbols

### `describe('Header auth', () =&gt; { ... })`
#### Description
This is the main test suite for header authentication. It sets up the test environment and contains two test cases.

#### Internal Logic
1. Before running the tests, it calls `runTestServer()` to set up the test environment.
2. It includes two test cases: one for failed authentication and one for successful authentication.

### `it('should fail to auth without custom header', () =&gt; { ... })`
#### Description
This test case verifies that authentication fails when no custom header is provided.

#### Internal Logic
1. It checks for the existence of an element with the class `.MuiAlert-message`, which is expected to be present when authentication fails.

### `it('should be able to auth with custom header', () =&gt; { ... })`
#### Description
This test case verifies that authentication succeeds when a custom header is provided.

#### Internal Logic
1. It intercepts all requests and adds a custom header 'test-header' with the value 'test header value'.
2. It visits the root page ('/').
3. It checks that the `.MuiAlert-message` element does not exist, indicating successful authentication.
4. It verifies that the first '.step' element contains the text 'Hello admin'.
5. It reloads the page and re-checks for the 'Hello admin' text to ensure the authentication persists.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| cypress | End-to-end testing framework |

## References
- `runTestServer()`: This function is imported from '../../support/testUtils' and is used to set up the test environment.

## Notes
1. The test suite uses Cypress commands like `cy.get()`, `cy.visit()`, and `cy.intercept()` to interact with the web application and assert on its behavior.
2. The custom header 'test-header' with value 'test header value' is used for successful authentication.
3. The tests assume that a Material-UI Alert component is used to display authentication failure messages.
4. The tests also assume that there's a '.step' element that displays 'Hello admin' upon successful authentication.

This test suite provides a comprehensive check of the header authentication mechanism, ensuring that it behaves correctly both with and without the required custom header.
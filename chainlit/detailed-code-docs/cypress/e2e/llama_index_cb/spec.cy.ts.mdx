---
title: "spec.cy.ts"
---

## High-level description
This Cypress test file (`spec.cy.ts`) contains a test suite for the Llama Index Callback functionality. It verifies that messages with prompts and elements can be sent to the UI correctly.

## Symbols

### `describe('Llama Index Callback', ...)`
#### Description
This is the main test suite for the Llama Index Callback functionality.

#### Internal Logic
1. Before running the tests, it calls `runTestServer()` to set up the test environment.
2. Contains a single test case to verify message sending to the UI.

### `it('should be able to send messages to the UI with prompts and elements', ...)`
#### Description
This test case verifies that messages with prompts and elements are correctly sent to the UI.

#### Internal Logic
1. Checks for the presence of three step elements.
2. Interacts with the "retrieve" step element.
3. Verifies the content of the tool call, including the presence of a source link.

#### Arrange
- The test server is run before the test suite begins.

#### Act
1. Locates and clicks on the "retrieve" step element.

#### Assert
1. Checks that there are 3 step elements present.
2. Verifies the existence of the "retrieve" step element.
3. Confirms that the first message content within the tool call contains a source link with the text "Source 0".

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| cypress | End-to-end testing framework used for writing and running the tests |

## References
The test file references the following external function:
- `runTestServer()`: Imported from '../../support/testUtils', this function is used to set up the test environment before running the tests.

## Notes on Related Code
The related code snippet (`testUtils.ts`) provides several utility functions for Cypress tests, including `runTestServer()`. This function is used in the `before` hook of the test suite to set up the test environment. It appears to start a test server for the specific test being run, which is crucial for the proper execution of the Llama Index Callback tests.
---
title: "Overview"
---

## High-level description
This directory contains TypeScript files that define the state management for various aspects of a React application using Recoil. The state includes chat attachments, project-related settings, user preferences, thread filters, user environment variables, and user input history. These state definitions provide a centralized way to manage and access application data across different components.

## What does it do?
The code in this directory sets up the foundation for managing various aspects of the application's state:

1. It handles chat attachments, allowing for tracking of file uploads and their progress.
2. It manages project-related settings such as highlighted messages and chat settings visibility.
3. It stores user preferences like theme and language settings.
4. It maintains filters for thread history, enabling users to search and filter conversations.
5. It manages user environment variables, which are likely used for configuration or authentication.
6. It keeps track of user input history, persisting it across sessions using local storage.

These state management modules enable the application to maintain a consistent state across different components, handle user preferences, and provide features like message highlighting, chat history filtering, and input history recall.

## Key Files

### chat.ts
Defines the structure for chat attachments and creates a Recoil atom to store them. This allows the application to track file uploads, their progress, and provide functions for canceling or removing attachments.

### project.ts
Sets up Recoil atoms for managing highlighted messages and the visibility of chat settings. This enables the application to control which message is currently highlighted and whether the chat settings panel is open or closed.

### settings.ts
Defines the application's settings state, including theme preferences, language selection, and UI state (like whether certain panels are open). It also handles theme selection based on user preference and system defaults.

### threads.ts
Creates a Recoil atom for managing thread filters. This allows users to filter and search through chat history effectively.

### user.ts
Manages user environment variables using a Recoil atom. It retrieves data from local storage and provides a centralized way to access and update user-specific configuration across the application.

### userInputHistory.ts
Implements a Recoil atom for storing and retrieving user input history. It uses a custom localStorage effect to persist the history across sessions, enhancing the user experience by allowing recall of previous inputs.

## Dependencies
The main dependency used across these files is Recoil, a state management library for React applications. Some files also import types or interfaces from `@chainlit/react-client`, suggesting that this is part of a larger application or framework.

| Dependency | Purpose | Version |
|------------|---------|---------|
| recoil | State management | Not specified |
| @chainlit/react-client | Provides types and interfaces | Not specified |

Recoil was likely chosen for its simplicity in setting up atoms of state that can be easily shared and updated across the React component tree. It provides a more flexible and performant alternative to Redux for many use cases.

## Configuration
The code uses some global configuration, particularly in the settings management:

1. The default theme is determined by `window.theme.default` if available, otherwise defaulting to 'dark'.
2. User preferences for theme are stored in localStorage under the key 'themeVariant'.
3. User environment variables are stored in localStorage under the key 'userEnv'.
4. User input history is stored in localStorage (key not explicitly shown in the provided code).

These configuration points allow the application to persist user preferences and environment variables across sessions, providing a personalized experience for each user.

In summary, this directory forms the core of the application's state management, providing a robust foundation for handling various aspects of the user interface, preferences, and data persistence. The use of Recoil allows for efficient state updates and easy integration with React components throughout the application.
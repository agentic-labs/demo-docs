---
title: "userInputHistory.ts"
---

## High-level description
This code defines a Recoil atom for managing user input history in a chat application. It implements a local storage effect to persist the input history across sessions and provides a structure for storing and retrieving user inputs.

## Code Structure
The code defines a single Recoil atom `inputHistoryState` which uses a custom `localStorageEffect` to handle persistence. The atom stores an object containing a boolean `open` state and an array of `UserInput` objects.

## Symbols

### `localStorageEffect`
#### Description
A higher-order function that creates an effect for Recoil atoms to interact with localStorage.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| key | string | The key used for storing and retrieving data from localStorage |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| effect | function | A function that handles the localStorage interactions |

#### Internal Logic
1. Retrieves saved value from localStorage on initialization.
2. Sets the atom's value if a saved value exists.
3. Listens for changes to the atom's value and updates localStorage accordingly.
4. Handles reset events by removing the item from localStorage.

### `inputHistoryState`
#### Description
A Recoil atom that manages the state of user input history.

#### Inputs
None

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| state | object | An object containing `open` boolean and `inputs` array |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| recoil | State management library |
| @chainlit/react-client | Provides the `UserInput` type |

## Side Effects
- Reads from and writes to localStorage to persist user input history.

## Performance Considerations
- The use of localStorage may impact performance for large input histories. Consider implementing a limit on the number of stored inputs or using a more efficient storage method for larger datasets.
---
title: "Overview"
---

## High-level description
This code defines and exports an API client for a web application. It sets up the ChainlitAPI instance with the appropriate endpoint, error handling, and authentication redirection. The client is configured to work in both development and production environments.

## Code Structure
The code imports necessary dependencies, defines the API endpoint based on the environment, sets up error handling functions, and creates an instance of ChainlitAPI. The main symbols (functions and variables) are interconnected to create a cohesive API client setup.

## Symbols

### `devServer`
#### Description
A constant that represents the development server URL.

#### Internal Logic
It combines 'http://localhost:8000' with the result of `getRouterBasename()` function.

### `url`
#### Description
A constant that determines the appropriate URL based on the environment.

#### Internal Logic
Uses `import.meta.env.DEV` to check if the application is running in development mode. If true, it uses `devServer`; otherwise, it uses `window.origin` combined with `getRouterBasename()`.

### `serverUrl`
#### Description
A URL object created from the `url` constant.

### `httpEndpoint`
#### Description
A string representation of the `serverUrl`.

### `on401`
#### Description
A function that handles 401 (Unauthorized) errors.

#### Internal Logic
Checks if the current path is not the login page. If so, it redirects the user to the login page.

### `onError`
#### Description
A function that handles general API errors.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| error | ClientError | The error object thrown by the API |

#### Internal Logic
Displays an error toast message using the `toast.error()` function.

### `apiClient`
#### Description
An instance of the ChainlitAPI class, which serves as the main API client for the application.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| httpEndpoint | string | The API endpoint URL |
| 'webapp' | string | The type of application |
| on401 | function | Function to handle 401 errors |
| onError | function | Function to handle general errors |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| sonner | For displaying toast notifications |
| @chainlit/react-client | Provides the ChainlitAPI class and ClientError type |

## References
- `getRouterBasename()`: A function imported from 'utils/router' that returns the base path for routing.
- `ChainlitAPI`: A class imported from '@chainlit/react-client' used to create the API client.

## Notes
- The code uses `import.meta.env.DEV` to determine if the application is running in development mode, which is a feature specific to certain build tools like Vite.
- The API client is set up to handle both development and production environments, automatically switching between localhost and the actual origin based on the environment.
- Error handling is implemented for both 401 (Unauthorized) errors and general API errors, with appropriate actions taken for each case.
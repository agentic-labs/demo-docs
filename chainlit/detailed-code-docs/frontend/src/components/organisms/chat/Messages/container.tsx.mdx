---
title: "container.tsx"
---

## High-level description
This code defines a `MessageContainer` component in React, which is responsible for rendering chat messages, actions, and elements. It manages the state of the chat interface, handles user interactions, and provides context for child components.

## Code Structure
The main component `MessageContainer` is a memoized functional component that takes props such as `loading`, `actions`, `elements`, `messages`, and callback functions for handling feedback and actions. It uses various hooks from React, Recoil, and custom hooks to manage state and side effects.

## Symbols

### MessageContainer
#### Description
A memoized React component that renders the chat interface, including messages, actions, and elements.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| askUser | IAsk | User input request |
| loading | boolean | Loading state of the chat |
| actions | IAction[] | Available actions for the user |
| elements | IMessageElement[] | Elements to be displayed in the chat |
| messages | IStep[] | Chat messages |
| onFeedbackUpdated | function | Callback for updating feedback |
| onFeedbackDeleted | function | Callback for deleting feedback |
| callAction | function | Callback for calling an action |

#### Internal Logic
1. Uses various hooks to access configuration, state, and navigation.
2. Defines callback functions for file upload, element clicks, and error handling.
3. Memoizes the context object to prevent unnecessary re-renders.
4. Renders the `CMessageContainer` component with processed props and memoized context.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-router-dom | For navigation |
| recoil | State management |
| sonner | Toast notifications |
| @chainlit/react-client | Custom hooks and types |

## Configuration
The component uses configuration from the `useConfig` hook:
| Option | Type | Description |
|:-------|:-----|:------------|
| dataPersistence | boolean | Enables feedback functionality |
| features.unsafe_allow_html | boolean | Allows HTML in messages |
| features.latex | boolean | Enables LaTeX rendering |
| ui.default_collapse_content | boolean | Sets default collapse state for content |
| ui.name | string | UI name for display |

## Error Handling
Errors are handled using the `toast.error` function from the `sonner` library, displaying error messages to the user.

## Performance Considerations
1. The component uses `memo` to prevent unnecessary re-renders.
2. Context object is memoized using `useMemo` to optimize performance.
3. Callback functions are memoized using `useCallback` to maintain referential equality.

This component serves as a container for chat messages, managing the overall state and behavior of the chat interface while delegating the actual rendering to child components.
---
title: "index.tsx"
---

## High-level description
This code defines a React component called `InputBox` that renders a chat input area with file upload capabilities, message submission, and auto-scrolling functionality. It utilizes various hooks and components to manage state and handle user interactions in a chat interface.

## Code Structure
The main `InputBox` component is a memoized functional component that uses several custom hooks and child components to manage its functionality. It imports and uses components like `ScrollDownButton`, `Input`, and `WaterMark`. The component also interacts with global state using Recoil atoms and selectors.

## Symbols

### InputBox
#### Description
A React component that renders the chat input area with file upload and message submission capabilities.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fileSpec | FileSpec | Specifies file upload constraints |
| onFileUpload | (payload: File[]) =&gt; void | Callback for file upload |
| onFileUploadError | (error: string) =&gt; void | Callback for file upload errors |
| setAutoScroll | (autoScroll: boolean) =&gt; void | Function to set auto-scroll state |
| autoScroll | boolean | Current auto-scroll state |

#### Internal Logic
1. Uses custom hooks like `useLayoutMaxWidth`, `useAuth`, and `useChatInteract`.
2. Manages input history using Recoil state.
3. Handles message submission and reply functionality.
4. Renders child components like `ScrollDownButton`, `Input`, and `WaterMark`.

### onSubmit
#### Description
Callback function to handle message submission.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| msg | string | The message content |
| attachments | IAttachment[] | Optional file attachments |

#### Internal Logic
1. Creates a message object with a unique ID and user information.
2. Updates input history in Recoil state.
3. Prepares file references from attachments.
4. Calls `sendMessage` function from `useChatInteract` hook.

### onReply
#### Description
Callback function to handle message replies.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| msg | string | The reply message content |

#### Internal Logic
1. Creates a message object with a unique ID and user information.
2. Calls `replyMessage` function from `useChatInteract` hook.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| recoil | State management |
| uuid | Generating unique IDs |
| @mui/material | UI components |
| @chainlit/react-client | Custom hooks and types |

## Performance Considerations
The component uses `memo` to optimize re-renders and `useCallback` for memoizing callback functions. It also uses Recoil for efficient state management across the application.
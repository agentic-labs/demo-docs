---
title: "AskUploadButton.tsx"
---

## High-level description
The `AskUploadButton` component is a React component that provides a user interface for uploading files. It allows users to drag and drop files or browse for files, and displays upload progress. The component is designed to work within a larger messaging context and handles file upload specifications and error reporting.

## Code Structure
The file contains two main components: `AskUploadChildButton` and `AskUploadButton`. The `AskUploadButton` is the parent component that uses the `MessageContext` to determine if it should render the `AskUploadChildButton`. The `AskUploadChildButton` contains the main logic for file uploads and UI rendering.

## References
- `MessageContext` from 'contexts/MessageContext'
- `useUpload` hook from 'hooks/useUpload'
- Material-UI components (Button, CircularProgress, Stack, Typography)
- Types from 'client-types/' (IAsk, IFileRef)

## Symbols

### AskUploadChildButton
#### Description
This component renders the file upload interface and handles the upload process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| askUser | IAsk | Contains specifications and callback for file upload |
| uploadFile | Function | Function to handle file upload |
| onError | Function | Callback to handle errors |

#### Internal Logic
1. Manages upload state using the `uploads` state variable.
2. Handles file selection and upload initiation.
3. Updates progress for each file being uploaded.
4. Calls the `askUser.callback` with file references upon successful upload.
5. Renders a drag-and-drop area and a button for file selection.
6. Displays upload progress when files are being uploaded.

### AskUploadButton
#### Description
This is the main component that decides whether to render the `AskUploadChildButton` based on the `MessageContext`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| onError | Function | Callback to handle errors |

#### Internal Logic
1. Uses `MessageContext` to check if file upload is required and possible.
2. Renders `AskUploadChildButton` if conditions are met, passing necessary props.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| @mui/material | Material-UI components for UI |
| hooks/useUpload | Custom hook for file upload functionality |

## Error Handling
The component passes an `onError` function to both the `useUpload` hook and the `AskUploadChildButton`. This function is called with error messages when upload failures occur.

## Performance Considerations
The component uses `useState` for managing upload state, which could potentially cause performance issues for a large number of simultaneous uploads. Consider using more efficient state management for large-scale use cases.
---
title: "message_builder.py"
---

## High-level description
The `TeamsAlertMessageBuilder` class is a helper class that simplifies the process of building alert messages for Microsoft Teams using the `pymsteams` library. It provides a more user-friendly interface for constructing the message payload by encapsulating the details of the `pymsteams` API.

## Code Structure
The `TeamsAlertMessageBuilder` class uses a `TeamsClient` object to interact with the Microsoft Teams API. The builder methods delegate the actual message construction to the client object, providing a higher-level interface for building the message.

## References
- `elementary.clients.teams.client.TeamsClient`

## Symbols

### `TeamsAlertMessageBuilder`
#### Description
This class provides a convenient way to build alert messages for Microsoft Teams. It uses a `TeamsClient` object to handle the actual communication with the Teams API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| client | elementary.clients.teams.client.TeamsClient | An instance of the TeamsClient class, used to send the message to Teams. |

#### Outputs
This class does not directly return any values. Its purpose is to build and send a message via the `TeamsClient`.

#### Internal Logic
The class methods provide a more readable way to construct the message payload by encapsulating the details of the `pymsteams` API. For example, the `addSection` method takes a `cardsection` object as input and adds it to the message being built.

### `title`
#### Description
Sets the title of the Teams message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| title | str | The title of the Teams message. |

#### Outputs
This method does not return any value. It sets the title of the message being built.

### `text`
#### Description
Sets the main text content of the Teams message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | str | The main text content of the Teams message. |

#### Outputs
This method does not return any value. It sets the text content of the message being built.

### `addSection`
#### Description
Adds a section to the Teams message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| section | pymsteams.cardsection | The section to add to the Teams message. |

#### Outputs
This method does not return any value. It adds the given section to the message being built.

### `addPotentialAction`
#### Description
Adds a potential action to the Teams message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| action | pymsteams.potentialaction | The potential action to add to the Teams message. |

#### Outputs
This method does not return any value. It adds the given potential action to the message being built.

## Dependencies
- `pymsteams`: Used for constructing the Teams message payload.
- `elementary.clients.teams.client`: Provides the `TeamsClient` class for interacting with the Teams API.

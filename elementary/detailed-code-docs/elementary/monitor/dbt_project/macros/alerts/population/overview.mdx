---
title: "Overview"
---

## High-level description
This directory contains a collection of SQL macros designed to populate and manage alerts within the Elementary data monitoring system. These macros handle various types of alerts, including model alerts, source freshness alerts, and test alerts. The code is structured to efficiently retrieve, process, and store alert data while avoiding duplicates and managing potential data size limitations.

## What does it do?
The macros in this directory work together to:

1. Populate model alerts based on the execution results of dbt models and snapshots.
2. Generate and populate source freshness alerts to monitor the timeliness of data sources.
3. Create test alerts based on failed data quality tests.
4. Populate a centralized alerts table with various types of alerts while avoiding duplicates.
5. Handle potential data size limitations by managing large alert data.
6. Provide utility functions for creating empty alert tables, generating standardized alert objects, and filtering for new alerts.

These macros form the core of the alerting system within the Elementary monitoring framework, enabling users to track and respond to various data quality and pipeline issues effectively.

## Entry points
The main entry points for this directory are:

1. `populate_alerts_table.sql`: This file contains the primary macro for populating the centralized alerts table with various types of alerts.
2. `model_alerts.sql`: Handles the generation and population of model alerts.
3. `source_freshness_alerts.sql`: Manages the creation and population of source freshness alerts.
4. `test_alerts.sql`: Deals with the generation and population of test alerts.

The utils subdirectory contains supporting macros used by the main alert population macros.

## Key Files
1. `populate_alerts_table.sql`: 
   - Contains the `populate_alerts_table` macro, which is the main entry point for populating the alerts table.
   - Handles the insertion of new alerts while avoiding duplicates and managing data size limitations.

2. `model_alerts.sql`:
   - Defines `populate_model_alerts` and `populate_model_alerts_query` macros.
   - Generates and populates model alerts based on dbt model and snapshot execution results.

3. `source_freshness_alerts.sql`:
   - Contains `populate_source_freshness_alerts` and `populate_source_freshness_alerts_query` macros.
   - Handles the generation and population of alerts related to data source freshness.

4. `test_alerts.sql`:
   - Includes `populate_test_alerts` and `populate_test_alerts_query` macros.
   - Manages the creation and population of alerts based on failed data quality tests.

5. `utils/empty_alert_tables.sql`:
   - Defines the structure of tables used to store different types of alerts.

6. `utils/generate_alert_object.sql`:
   - Contains a macro for generating standardized alert objects.

7. `utils/get_alerts_model_detected_at_expr.sql`:
   - Handles backward compatibility for the `detected_at` column in the alerts model.

8. `utils/get_new_alerts_where_clause.sql`:
   - Defines a macro for generating SQL WHERE clauses to filter new alerts.

## Dependencies
The macros in this directory rely on the following dependencies:

1. `elementary`: A custom package that provides utility functions for various operations such as table creation, data type casting, time manipulation, and query execution.
2. `elementary_cli`: Used for generating alert objects and normalizing alert statuses.
3. dbt (data build tool): The underlying framework on which these macros are built and executed.

## Configuration
The macros use several configuration options, including:

1. `days_back`: Number of days to look back for alerts (default: 1)
2. `disable_samples`: Flag to disable sample collection for test alerts (default: false)

Additionally, there are configuration options for managing data size limitations, such as maximum row and column sizes for alert data.

In conclusion, this directory contains a comprehensive set of macros for managing alerts within the Elementary data monitoring system. These macros work together to efficiently collect, process, and store various types of alerts, providing a robust foundation for data quality monitoring and issue detection in dbt projects.
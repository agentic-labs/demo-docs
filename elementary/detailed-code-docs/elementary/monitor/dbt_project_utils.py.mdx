---
title: "dbt_project_utils.py"
---

## High-level description
This file, `dbt_project_utils.py`, contains utility functions for managing and interacting with dbt projects, specifically focusing on the Elementary package. It provides functionality to check if the installed Elementary dbt package is up-to-date and retrieve version information from dbt project files.

## Code Structure
The code defines several constants and utility functions. The main functions are `is_dbt_package_up_to_date`, `_get_elementary_package_path`, `_get_installed_dbt_package_version`, and `_get_required_dbt_package_version`. These functions work together to compare installed and required versions of the Elementary dbt package.

## Symbols

### `is_dbt_package_up_to_date`
#### Description
This function checks if the installed Elementary dbt package is up-to-date by comparing the installed version with the required version.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| project_dir | str | The directory path of the dbt project |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| is_up_to_date | bool | True if the package is up-to-date, False otherwise |

#### Internal Logic
1. Get the installed version using `_get_installed_dbt_package_version`.
2. If no installed version is found, return False.
3. Get the required version using `_get_required_dbt_package_version`.
4. If no required version is found (non-dbt Hub requirement), return True.
5. Compare installed and required versions and return the result.

### `_get_elementary_package_path`
#### Description
This function retrieves the path to the Elementary package in the dbt project.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| project_dir | str | The directory path of the dbt project |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| package_path | Optional[str] | The path to the Elementary package, or None if not found |

### `_get_installed_dbt_package_version`
#### Description
This function retrieves the installed version of the Elementary dbt package from the project's dbt_project.yml file.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| project_dir | str | The directory path of the dbt project |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| version | Optional[str] | The installed version of the Elementary package, or None if not found |

### `_get_required_dbt_package_version`
#### Description
This function retrieves the required version of the Elementary dbt package from the project's packages.yml file.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| project_dir | str | The directory path of the dbt project |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| version | Optional[str] | The required version of the Elementary package, or None if not found |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| os | File path operations |
| typing | Type hinting |
| elementary.utils.ordered_yaml | YAML file parsing |

## Error Handling
The code does not implement specific error handling mechanisms. It relies on the caller to handle potential exceptions, such as file not found errors when accessing YAML files.
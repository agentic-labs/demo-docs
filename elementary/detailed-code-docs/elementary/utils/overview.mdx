---
title: "Overview"
---

## High-level description
The `elementary/utils` directory contains various utility functions and classes that support the main functionality of the Elementary project. These utilities cover a wide range of operations, including time manipulation, logging, JSON handling, environment variable management, and more.

## What does it do?
This utility package provides a set of tools that:
1. Handle time-related operations, such as timezone conversions and formatting.
2. Manage logging with customizable console and file handlers.
3. Process and manipulate JSON data, including flattening nested structures.
4. Work with environment variables and provide context managers for temporary modifications.
5. Offer utilities for string manipulation, including pluralization and list formatting.
6. Provide abstractions for working with cloud storage bucket paths.
7. Implement custom Click options for command-line interfaces.
8. Offer utilities for package version retrieval and comparison.
9. Provide a compatibility layer for different versions of the Pydantic library.

These utilities are designed to be used across the Elementary project to simplify common operations and ensure consistency in handling various data types and operations.

## Key Files
1. `time.py`: Contains functions for time manipulation, timezone conversions, and formatting.
2. `log.py`: Implements a custom logger with colored output and file rotation capabilities.
3. `json_utils.py`: Provides utilities for working with JSON data, including safe loading and flattening nested structures.
4. `env_vars_context.py`: Offers a context manager for temporarily modifying environment variables.
5. `bucket_path.py`: Contains functions for manipulating cloud storage bucket paths.
6. `cli_utils.py`: Implements custom Click options for command-line interfaces.
7. `package.py`: Provides functions for retrieving package versions.
8. `pydantic_shim.py`: Offers a compatibility layer for different versions of the Pydantic library.

## Dependencies
The utility package relies on several external libraries:
1. `ruamel.yaml`: Used for YAML parsing and dumping while preserving order.
2. `click`: Used for creating command-line interfaces.
3. `requests`: Used for making HTTP requests, particularly for package version retrieval.
4. `pydantic`: Used for data validation and settings management.
5. `python-dateutil`: Used for advanced date and time manipulations.

## Configuration
The utility package doesn't have a central configuration file. However, some modules define constants that can be considered as configuration:

1. In `log.py`:
   - `MAX_BYTES_IN_FILE`: Maximum size of log files before rotation (10 MB).
   - `ROTATION_BACKUP_COUNT`: Number of backup log files to keep (4).

2. In `time.py`:
   - `DATETIME_FORMAT`: Default date and time format string ("%Y-%m-%d %H:%M:%S").
   - `DATETIME_WITH_TIMEZONE_FORMAT`: Date and time format string with timezone ("%Y-%m-%d %H:%M:%S %Z").

These constants can be modified to adjust the behavior of the utility functions if needed.

The utilities in this package are designed to be flexible and reusable across different parts of the Elementary project, providing a consistent set of tools for common operations and data handling tasks.
---
title: "log.py"
---

## High-level description
The `log.py` file defines a custom logger for the Elementary application. It provides functions for creating console and file handlers, formatting log messages with colors, and setting up the root logger.

## Code Structure
The code defines a `ColoredFormatter` class for formatting log messages with colors, and several functions for creating and configuring log handlers and loggers. The `get_console_handler` and `get_file_handler` functions create handlers for logging to the console and a rotating file, respectively. The `get_logger` function creates a logger with a given name, and the `set_root_logger_handlers` function sets up the root logger with console and file handlers.

## References
The code references the `is_debug` function from the `elementary.utils.env_vars` module to determine the log level for the console handler.

## Symbols

### `ColoredFormatter`
#### Description
This class extends the `logging.Formatter` class to provide colored log messages. It defines color codes for different log levels and formats the messages accordingly.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| record | logging.LogRecord | The log record to format. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| formatted_message | str | The formatted log message with colors. |

#### Internal Logic
The `format` method retrieves the appropriate format string based on the log level and uses a `logging.Formatter` object to format the message.

### `get_console_handler`
#### Description
This function creates a console handler for logging to the standard output. It sets the formatter to `ColoredFormatter` and the log level based on the `is_debug` function.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| console_handler | logging.StreamHandler | The console handler. |

### `get_file_handler`
#### Description
This function creates a file handler for logging to a rotating file. It sets the formatter to `ColoredFormatter`, the log level to `DEBUG`, and configures the file rotation parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| files_target_path | str | The path to the log file. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| rotation_handler | logging.handlers.RotatingFileHandler | The file handler. |

### `get_logger`
#### Description
This function creates a logger with a given name and sets the log level to `DEBUG`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| logger_name | str | The name of the logger. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| logger | logging.Logger | The logger object. |

### `set_root_logger_handlers`
#### Description
This function sets up the root logger with console and file handlers. It retrieves the root logger using `logging.getLogger` and adds the handlers created by `get_console_handler` and `get_file_handler`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| logger_name | str | The name of the root logger. |
| files_target_path | str | The path to the log file. |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| logging | Provides logging functionality. |
| sys | Provides access to system-specific parameters and functions. |
| logging.handlers | Provides handlers for logging to different destinations. |
| elementary.utils.env_vars | Provides functions for accessing environment variables. |

## Configuration
The code defines the following configuration options:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| MAX_BYTES_IN_FILE | int | 10 * 1024 * 1024 | The maximum size of the log file in bytes. |
| ROTATION_BACKUP_COUNT | int | 4 | The number of backup log files to keep. |

## Logging
The code implements logging to both the console and a rotating file. The console handler logs messages at the `INFO` level by default, but can be set to `DEBUG` if the `is_debug` function returns `True`. The file handler logs messages at the `DEBUG` level.

## Error Handling
The code does not implement specific error handling beyond basic exception raising.

## API/Interface Reference
The code does not expose an API or public interface.

---
title: "test_pending_alerts_schema.py"
---

## High-level description
This file contains unit tests for the `PendingAlertSchema` class, specifically testing the behavior of the `detected_at`, `created_at`, and `updated_at` fields when they are set to None. The tests ensure that these fields are automatically populated with datetime objects when not provided.

## Symbols

### `test_detected_at_none`
#### Description
This test function verifies that when `detected_at` is set to None in the `PendingAlertSchema` constructor, it is automatically populated with a datetime object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| pending_alert_data | dict | A dictionary containing mock data for a pending alert |

#### Internal Logic
1. Creates a `PendingAlertSchema` instance with `detected_at` set to None
2. Asserts that the resulting `detected_at` attribute is an instance of `datetime`

### `test_created_at_none`
#### Description
This test function verifies that when `created_at` is set to None in the `PendingAlertSchema` constructor, it is automatically populated with a datetime object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| pending_alert_data | dict | A dictionary containing mock data for a pending alert |

#### Internal Logic
1. Creates a `PendingAlertSchema` instance with `created_at` set to None
2. Asserts that the resulting `created_at` attribute is an instance of `datetime`

### `test_updated_at_none`
#### Description
This test function verifies that when `updated_at` is set to None in the `PendingAlertSchema` constructor, it is automatically populated with a datetime object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| pending_alert_data | dict | A dictionary containing mock data for a pending alert |

#### Internal Logic
1. Creates a `PendingAlertSchema` instance with `updated_at` set to None
2. Asserts that the resulting `updated_at` attribute is an instance of `datetime`

### `pending_alert_data`
#### Description
This is a pytest fixture that provides mock data for a pending alert.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| pending_alert_data | dict | A dictionary containing mock data for a pending alert |

#### Internal Logic
Returns the first item from the `PENDDING_SOURCE_FRESHNESS_ALERTS_MOCK_DATA` list defined in the `alerts_fetcher_mock.py` file.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pytest | Testing framework used for writing and running the tests |
| datetime | Used for working with date and time objects |
| elementary.monitor.fetchers.alerts.schema.pending_alerts | Contains the `AlertTypes` and `PendingAlertSchema` classes being tested |
| tests.mocks.fetchers.alerts_fetcher_mock | Contains mock data used in the tests |

## Notes
- The tests focus on the automatic population of datetime fields when they are set to None.
- The `PendingAlertSchema` class seems to have a validator that automatically sets these fields to the current datetime when they are not provided or set to None.
- The mock data used in these tests is specifically for source freshness alerts, as indicated by the use of `PENDDING_SOURCE_FRESHNESS_ALERTS_MOCK_DATA`.
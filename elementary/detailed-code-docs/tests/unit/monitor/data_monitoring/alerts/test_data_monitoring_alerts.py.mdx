---
title: "test_data_monitoring_alerts.py"
---

## High-level description
This file contains unit tests for the `DataMonitoringAlerts` class, focusing on various methods related to fetching, sorting, and formatting alerts. The tests cover different types of alerts (test, model, and source freshness) and their handling within the data monitoring system.

## Code Structure
The file defines several test functions, each targeting a specific method of the `DataMonitoringAlertsMock` class, which is a mock version of `DataMonitoringAlerts`. These tests use pytest fixtures and assertions to verify the correct behavior of the alert handling methods.

## Symbols

### `test_get_integration_client`
#### Description
Tests if the `_get_integration_client` method returns an instance of `SlackIntegration`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertion)

### `test_fetch_data`
#### Description
Verifies that the `_fetch_data` method returns the correct alert data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `test_fetch_last_sent_times`
#### Description
Checks if the `_fetch_last_sent_times` method returns the correct last sent times for alerts.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `test_sort_alerts`
#### Description
Tests the `_sort_alerts` method to ensure it correctly sorts alerts into 'send' and 'skip' categories.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `test_get_suppressed_alerts`
#### Description
Verifies that the `_get_suppressed_alerts` method correctly identifies suppressed alerts.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `test_get_latest_alerts`
#### Description
Checks if the `_get_latest_alerts` method correctly identifies the latest alerts, excluding duplicates.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `test_format_alerts`
#### Description
Tests the `_format_alerts` method to ensure it correctly formats alerts and groups them by table when specified.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

#### Outputs
None (uses assertions)

### `data_monitoring_alerts_mock`
#### Description
A pytest fixture that creates and returns an instance of `DataMonitoringAlertsMock`.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data_monitoring_alerts_mock | DataMonitoringAlertsMock | A mock instance of DataMonitoringAlerts |

## Dependencies
- pytest
- elementary.monitor.alerts.model_alert.ModelAlertModel
- elementary.monitor.alerts.source_freshness_alert.SourceFreshnessAlertModel
- elementary.monitor.alerts.test_alert.TestAlertModel
- elementary.monitor.data_monitoring.alerts.integrations.slack.slack.SlackIntegration
- elementary.monitor.fetchers.alerts.schema.alert_data
- elementary.monitor.fetchers.alerts.schema.pending_alerts.PendingAlertSchema
- tests.mocks.api.alerts_api_mock.MockAlertsAPI
- tests.mocks.data_monitoring.alerts.data_monitoring_alerts_mock.DataMonitoringAlertsMock
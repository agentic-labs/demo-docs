---
title: "all-columns-anomalies.mdx"
---

---
sidebarTitle: "All columns anomalies"
title: "all_columns_anomalies"
---

`elementary.all_columns_anomalies`

Executes column level monitors and anomaly detection on all the columns of the table.
Specific monitors are detailed in the table below and can be configured using the `columns_anomalies` configuration.

The test checks the data type of each column and only executes monitors that are relevant to it.
You can use `column_anomalies` param to override the default monitors, and `exclude_prefix` / `exclude_regexp` to exclude columns from the test.

&lt;Snippet file="column-metrics.mdx" /&gt;

### Test configuration

No mandatory configuration, however it is highly recommended to configure a `timestamp_column`.

{/* prettier-ignore */}
&lt;pre&gt;
 &lt;code&gt;
  tests:
    &nbsp;&nbsp;-- elementary.all_columns_anomalies:
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/timestamp-column"&gt;&lt;font color="#CD7D55"&gt;timestamp_column: column name&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/column-anomalies"&gt;&lt;font color="#CD7D55"&gt;column_anomalies: column monitors list&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/dimensions"&gt;&lt;font color="#CD7D55"&gt;dimensions: sql expression&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/exclude_prefix"&gt;&lt;font color="#CD7D55"&gt;exclude_prefix: string&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/exclude_regexp"&gt;&lt;font color="#CD7D55"&gt;exclude_regexp: regex&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/where-expression"&gt;&lt;font color="#CD7D55"&gt;where_expression: sql expression&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/anomaly-sensitivity"&gt;&lt;font color="#CD7D55"&gt;anomaly_sensitivity: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/anomaly-direction"&gt;&lt;font color="#CD7D55"&gt;anomaly_direction: [both | spike | drop]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;detection_period:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;training_period:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;time_bucket:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/seasonality"&gt;&lt;font color="#CD7D55"&gt;seasonality: day_of_week&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;detection_delay:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;ignore_small_changes:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;spike_failure_percent_threshold: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;drop_failure_percent_threshold: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/anomaly-exclude-metrics"&gt;&lt;font color="#CD7D55"&gt;anomaly_exclude_metrics: [SQL expression]&lt;/font&gt;&lt;/a&gt;
 &lt;/code&gt;
&lt;/pre&gt;

&lt;RequestExample&gt;

```yml Models
models:
  - name: &lt; model name &gt;
    config:
      elementary:
        timestamp_column: &lt; timestamp column &gt;
    tests:
      - elementary.all_columns_anomalies:
          column_anomalies: &lt; specific monitors, all if null &gt;
          where_expression: &lt; sql expression &gt;
          time_bucket: # Daily by default
            period: &lt; time period &gt;
            count: &lt; number of periods &gt;
```

```yml Models example
models:
  - name: login_events
    config:
      elementary:
        timestamp_column: "loaded_at"
    tests:
      - elementary.all_columns_anomalies:
          where_expression: "event_type in ('event_1', 'event_2') and country_name != 'unwanted country'"
          time_bucket:
            period: day
            count: 1
          tags: ["elementary"]
          # optional - change global sensitivity
          anomaly_sensitivity: 3.5
```

&lt;/RequestExample&gt;

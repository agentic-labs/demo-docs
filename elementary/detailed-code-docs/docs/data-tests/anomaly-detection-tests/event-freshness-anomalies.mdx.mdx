---
title: "event-freshness-anomalies.mdx"
---

---
sidebarTitle: "Event freshness anomalies"
title: "event_freshness_anomalies"
---

`elementary.event_freshness_anomalies`

Monitors the freshness of event data over time, as the expected time it takes each event to load -
that is, the time between when the event actually occurs (the `event timestamp`), and when it is loaded to the
database (the `update timestamp`).

This test compliments the `freshness_anomalies` test and is primarily intended for data that is updated in a continuous / streaming fashion.

The test can work in a couple of modes:

- If only an `event_timestamp_column` is supplied, the test measures over time the difference between the current
  timestamp ("now") and the most recent event timestamp.
- If both an `event_timestamp_column` and an `update_timestamp_column` are provided, the test will measure over time
  the difference between these two columns.

### Test configuration

_Required configuration: `event_timestamp_column`_
_Default configuration: `anomaly_direction: spike` to alert only on delays._

{/* prettier-ignore */}
&lt;pre&gt;
 &lt;code&gt;
  tests:
    &nbsp;&nbsp;-- elementary.event_freshness_anomalies:
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/event_timestamp_column"&gt;&lt;font color="#CD7D55"&gt;event_timestamp_column: column name&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/update_timestamp_column"&gt;&lt;font color="#CD7D55"&gt;update_timestamp_column: column name&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/where-expression"&gt;&lt;font color="#CD7D55"&gt;where_expression: sql expression&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/anomaly-sensitivity"&gt;&lt;font color="#CD7D55"&gt;anomaly_sensitivity: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;detection_period:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-period"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;training_period:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/training-period"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;time_bucket:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/time-bucket"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/seasonality"&gt;&lt;font color="#CD7D55"&gt;seasonality: day_of_week&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;detection_delay:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;period: [hour | day | week | month]&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/detection-delay"&gt;&lt;font color="#CD7D55"&gt;count: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;ignore_small_changes:&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;spike_failure_percent_threshold: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/ignore_small_changes"&gt;&lt;font color="#CD7D55"&gt;drop_failure_percent_threshold: int&lt;/font&gt;&lt;/a&gt;
      &nbsp;&nbsp;&nbsp;&nbsp;&lt;a href="/data-tests/anomaly-detection-configuration/anomaly-exclude-metrics"&gt;&lt;font color="#CD7D55"&gt;anomaly_exclude_metrics: [SQL expression]&lt;/font&gt;&lt;/a&gt;
 &lt;/code&gt;
&lt;/pre&gt;

&lt;RequestExample&gt;

```yml Models
models:
  - name: &lt; model name &gt;
    tests:
      - elementary.event_freshness_anomalies:
          event_timestamp_column: &lt; timestamp column &gt; # Mandatory
          update_timestamp_column: &lt; timestamp column &gt; # Optional
          where_expression: &lt; sql expression &gt;
          time_bucket: # Daily by default
            period: &lt; time period &gt;
            count: &lt; number of periods &gt;
```

```yml Models example
models:
  - name: login_events
    tests:
      - elementary.event_freshness_anomalies:
          event_timestamp_column: "occurred_at"
          update_timestamp_column: "updated_at"
          # optional - use tags to run elementary tests on a dedicated run
          tags: ["elementary"]
          config:
            # optional - change severity
            severity: warn
```

&lt;/RequestExample&gt;

---
title: "Overview"
---

## High-level description
This directory contains context providers for managing user authentication and organization selection in a React application using SolidJS. It includes two main context providers: UserAuthContext and OrgContext. These contexts work together to handle user authentication, manage the selected organization, and provide this information to other components throughout the application.

## What does it do?
The code in this directory implements two crucial functionalities for the application:

1. User Authentication:
   - It manages the user's authentication state.
   - It handles the login process, including sending authentication requests to the server.
   - It fetches and stores user data upon successful authentication.
   - It provides the authenticated user's information to other parts of the application.

2. Organization Management:
   - It allows the user to select an organization from their available organizations.
   - It manages the state of the currently selected organization.
   - It updates the URL parameters to reflect the selected organization.
   - It provides the selected organization information to other components.

These functionalities work together to ensure that the application has the necessary user and organization context for its operations. They handle the flow of logging in a user, selecting an organization, and making this information available throughout the application.

## Key Files

### UserAuthContext.tsx
This file defines the UserAuthContext and UserAuthContextProvider. Its main responsibilities include:

- Creating a context for storing user information.
- Implementing a login function that authenticates the user and fetches user data.
- Managing the user's authentication state.
- Wrapping child components with the user context, organization context, and top bar layout.

Key code snippet:
```typescript
export function UserAuthContextProvider(props: ParentComponent) {
  const [user, setUser] = createSignal&lt;SlimUser | null&gt;(null);

  const login = async () =&gt; {
    // Authentication logic
  };

  onMount(() =&gt; {
    login();
  });

  return (
    &lt;UserContext.Provider value={{ user, setUser }}&gt;
      &lt;Show when={user()} fallback={&lt;div&gt;Loading...&lt;/div&gt;}&gt;
        &lt;OrgContextProvider user={user()!}&gt;
          &lt;TopBarLayout&gt;{props.children}&lt;/TopBarLayout&gt;
        &lt;/OrgContextProvider&gt;
      &lt;/Show&gt;
    &lt;/UserContext.Provider&gt;
  );
}
```

### OrgContext.tsx
This file defines the OrgContext and OrgContextProvider. Its main responsibilities include:

- Creating a context for storing the selected organization.
- Managing the state of the selected organization.
- Handling the logic for initializing and updating the selected organization based on URL parameters and user data.
- Providing functions to update the selected organization and URL parameters.

Key code snippet:
```typescript
export function OrgContextProvider(props: OrgDatasetContextProps) {
  const [searchParams, setSearchParams] = useSearchParams();

  const getInitialUserOrg = () =&gt; {
    // Logic to determine initial organization
  };

  const [selectedOrg, setSelectedOrg] = createSignal&lt;Organization&gt;(
    getInitialUserOrg()
  );

  const setSelectedOrgWithParams = (org: Organization) =&gt; {
    // Update selected org and URL params
  };

  return (
    &lt;OrgContext.Provider
      value={{
        selectedOrg,
        setSelectedOrg: setSelectedOrgWithParams,
      }}
    &gt;
      {props.children}
    &lt;/OrgContext.Provider&gt;
  );
}
```

## Dependencies
The code in this directory relies on the following main dependencies:

1. SolidJS (solid-js): Used for creating and managing reactive state and components.
   - Version: Not specified in the provided code.
   - Chosen for its efficient reactivity system and performance benefits.

2. @solidjs/router: Used for routing and URL parameter management.
   - Version: Not specified in the provided code.
   - Chosen for its integration with SolidJS and handling of routing in the application.

3. shared/types: Used for type definitions (e.g., Organization, SlimUser).
   - Version: Not specified in the provided code.
   - Chosen to maintain consistent type definitions across the application.

## Configuration
The code uses configuration from the following sources:

1. API Host Configuration:
   - Imported from `../utils/apiHost`.
   - Used for making API requests in the UserAuthContext.

2. Environment Variables:
   - The code may rely on environment variables for API endpoints or other configuration, but these are not explicitly shown in the provided code snippets.

3. URL Parameters:
   - The OrgContext uses URL parameters to manage the selected organization.
   - Example: `org` parameter in the URL is used to determine and update the selected organization.

Error handling:
- The UserAuthContext redirects to a login page if authentication fails (status 401).
- The OrgContext redirects to an error page ("/error") if the user has no organizations or if an invalid organization is selected.

These context providers form the backbone of user authentication and organization management in the application, ensuring that components have access to the necessary user and organization information throughout the application's lifecycle.
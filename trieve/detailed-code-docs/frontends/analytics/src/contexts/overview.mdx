---
title: "Overview"
---

## High-level description
This directory contains context providers for managing organization and user authentication states in the analytics frontend of the application. It includes two main files: `OrgContext.tsx` and `UserAuthContext.tsx`, which create and manage SolidJS contexts for organization selection and user authentication, respectively.

## What does it do?
The contexts in this directory serve as central state management solutions for the application, handling two critical aspects:

1. Organization Management: The `OrgContext` allows users to select and switch between different organizations they have access to. It persists the selected organization in the URL parameters and provides this information to other components.

2. User Authentication: The `UserAuthContext` manages the user's authentication state. It fetches user data from the API, handles login redirects, and provides user information to the rest of the application.

These contexts work together to ensure that the application has access to the current user's information and their selected organization, which is crucial for displaying relevant data and controlling access to features based on user roles and permissions.

## Key Files

### OrgContext.tsx
This file defines the `OrgContext` and `OrgContextProvider`. It manages the selection of an organization from the user's available organizations and persists this selection in the URL parameters.

Key features:
- Provides a `selectedOrg` accessor and a `selectOrg` function to update the selection.
- Handles URL parameter management for the selected organization.
- Redirects to an error page if the user has no organizations or if an invalid organization ID is provided.

### UserAuthContext.tsx
This file defines the `UserContext` and `UserAuthContextProvider`. It manages user authentication and provides user data to the rest of the application.

Key features:
- Fetches user data from the API on component mount.
- Handles redirects to the login page if the user is not authenticated.
- Provides user information to child components through the `UserContext`.
- Integrates with `OrgContextProvider` and `TopBarLayout` to ensure they have access to user data.

## Dependencies
The contexts rely on the following external libraries and frameworks:

1. SolidJS: Used for creating reactive components and managing state.
   - Version: Not specified in the provided code.
   - Chosen for its efficient reactivity system and performance benefits.

2. @solidjs/router: Used for handling URL parameters and navigation.
   - Version: Not specified in the provided code.
   - Chosen for its integration with SolidJS and routing capabilities.

3. shared/types: A custom module providing shared type definitions like `SlimUser` and `Organization`.
   - Version: Not specified in the provided code.
   - Chosen for maintaining consistency in type definitions across the application.

## Configuration
While there are no explicit configuration files mentioned, the contexts use environment-specific settings:

1. API Host: The `UserAuthContext` uses an `apiHost` utility function to determine the base URL for API calls. This likely comes from an environment variable or configuration file.

2. Login Redirect: The login redirect URL is constructed using `window.location.origin`, which adapts to the current environment.

3. Error Page: Both contexts use a hardcoded `/error` path for redirecting in case of errors. This might be configurable in a more complete setup.

These contexts form the backbone of state management for user authentication and organization selection in the analytics frontend. They ensure that components throughout the application have access to critical user and organization data, enabling proper rendering and access control based on the user's permissions and selected organization.
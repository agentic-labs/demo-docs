---
title: "formatDate.ts"
---

## High-level description
This code defines utility functions for formatting and parsing dates in the context of an analytics application. It provides methods to format dates for API requests, parse custom date strings, and transform date parameters for analytics filters. The code also includes a function to format timestamps based on the time range of the analytics data.

## Code Structure
The main symbols in this code are standalone functions that handle different aspects of date formatting and parsing. They are not directly interconnected but are designed to work together in the context of the analytics application.

## Symbols

### `formatDateForApi`
#### Description
Formats a given Date object into a string suitable for API requests.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| date | Date | The date to be formatted |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| formattedDate | string | The formatted date string |

#### Internal Logic
1. Uses `toLocaleString` with specific options to format the date.
2. Removes the comma from the resulting string.

### `parseCustomDateString`
#### Description
Parses a custom date string format into a Date object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dateString | string | The custom date string to be parsed |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| parsedDate | Date | The parsed Date object |

#### Internal Logic
1. Splits the date string into date and time parts.
2. Extracts year, month, day, hour, minute, and second.
3. Pads values with leading zeros if necessary.
4. Constructs an ISO date string.
5. Creates a new Date object from the ISO string.

### `transformAnalyticsFilter`
#### Description
Transforms an analytics filter object by applying date transformations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| filter | HasDateRange | The filter object to be transformed |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| transformedFilter | object | The transformed filter object |

#### Internal Logic
1. Spreads the original filter object.
2. Applies `transformDateParams` to the `date_range` property if it exists.

### `transformDateParams`
#### Description
Transforms date parameters by formatting them for API use.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | DateRangeFilter | The date range parameters to be transformed |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| transformedParams | object | The transformed date parameters |

#### Internal Logic
Applies `formatDateForApi` to each date property (gt, lt, gte, lte) if they exist.

### `formatSensibleTimestamp`
#### Description
Formats a timestamp based on the time range of the analytics data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| date | Date | The date to be formatted |
| range | AnalyticsFilter["date_range"] | The date range of the analytics data |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| formattedTimestamp | string | The formatted timestamp |

#### Internal Logic
1. Determines the high and low time bounds from the range.
2. Calculates the hour difference between high and low times.
3. Formats the date based on the hour difference:
   - 24 hours or less: time only
   - 7 days or less: date only
   - 30 days or less: date only
   - More than 30 days: date only

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| date-fns | Used for date manipulation and formatting |
| shared/types | Imports type definitions used in the code |

This code is crucial for handling date-related operations in the analytics frontend, ensuring consistent date formatting for API requests and user display.
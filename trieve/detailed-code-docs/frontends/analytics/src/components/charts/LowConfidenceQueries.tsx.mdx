---
title: "LowConfidenceQueries.tsx"
---

## High-level description
The `LowConfidenceQueries` component displays a table of search queries with the lowest top scores, indicating low confidence in the search results. It allows users to set a threshold for the minimum top score to be displayed and provides pagination for navigating through the results.

## Code Structure
The `LowConfidenceQueries` component uses the `usePagination` hook to manage pagination and the `createQuery` hook from `@tanstack/solid-query` to fetch and cache the low confidence queries data. It also utilizes the `DatasetContext` and `OrgContext` to access the selected dataset and organization information. The `QueryCard` component is used to display individual query details in a table row, and it references the `FullScreenModal` and `SearchQueryEventModal` components for displaying detailed query information in a modal dialog.

## References
- `getLowConfidenceQueries`: A function imported from `../../api/analytics` that fetches low confidence queries data from the backend.
- `DatasetContext`: A context imported from `../../layouts/TopBarLayout` that provides access to the selected dataset information.
- `usePagination`: A hook imported from `../../hooks/usePagination` that provides pagination functionality.
- `PaginationButtons`: A component imported from `../PaginationButtons` that renders pagination buttons.
- `FullScreenModal`, `Table`, `Td`, `Th`, `Tr`: Components imported from `shared/ui` for rendering UI elements.
- `SearchQueryEventModal`: A component imported from `../../pages/TrendExplorer` that displays detailed information about a search query event in a modal dialog.
- `OrgContext`: A context imported from `../../contexts/OrgContext` that provides access to the selected organization information.
- `ChartCard`: A component imported from `./ChartCard` that provides a card layout for displaying charts and other content.

## Symbols

### `LowConfidenceQueries`
#### Description
This component fetches and displays a list of low-confidence queries from the backend, allowing the user to set a threshold for the minimum top score and navigate through paginated results.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | AnalyticsParams | An object containing analytics filters and granularity for fetching data. |

#### Outputs
JSX.Element representing the Low Confidence Queries chart card.

#### Internal Logic
1. **Retrieves Context:** Accesses the selected dataset from `DatasetContext`.
2. **Initializes Pagination:** Utilizes the `usePagination` hook to manage pagination state.
3. **Sets up Query Client:** Uses `useQueryClient` from `@tanstack/solid-query` for caching and prefetching.
4. **Threshold Input:** Manages a signal `thresholdText` to store and update the user-defined threshold for low-confidence queries.
5. **Data Fetching and Prefetching:**
   - Fetches low-confidence queries data using the `createQuery` hook from `@tanstack/solid-query`.
   - Prefetches the next page of data to improve user experience.
   - Updates pagination state based on fetched data.
6. **Rendering:**
   - Renders a `ChartCard` component to display the results.
   - Shows a loading indicator while data is being fetched.
   - Displays a table of low-confidence queries using the `Table` component.
   - Renders individual query details using the `QueryCard` component.
   - Shows pagination buttons using the `PaginationButtons` component.

### `parseThreshold`
#### Description
This function parses a string into a number, returning undefined if the parsing fails.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | string | The string to parse. |

#### Outputs
`number | undefined`: The parsed number or undefined if parsing fails.

### `QueryCard`
#### Description
This component displays a single query with its score and an expand icon. Clicking on the row opens a modal dialog displaying detailed information about the query.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | SearchQueryEvent | The search query event data to display. |
| filters | AnalyticsFilter | (Optional) Analytics filters applied to the query. |

#### Outputs
JSX.Element representing a table row with query details.

#### Internal Logic
1. **State Management:** Uses the `createSignal` hook to manage the open/closed state of the modal dialog.
2. **Context Access:** Retrieves the selected dataset and organization information from `DatasetContext` and `OrgContext`, respectively.
3. **Search Playground URL Generation:** Constructs the URL for the search playground based on the selected organization, dataset, query, and filters.
4. **Rendering:**
   - Renders a table row (`Tr` component) displaying the query, score, and an expand icon.
   - Clicking the row toggles the modal dialog's visibility.
   - The modal dialog (`FullScreenModal` component) displays the query in the title and renders the `SearchQueryEventModal` component to show detailed query information.
   - An external link icon in the modal dialog's header opens the search playground in a new tab.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/solid-query | Used for fetching, caching, and updating asynchronous data. |
| solid-js | The core library for building the user interface. |
| shared/types | Provides shared types used across the application. |
| shared/ui | Contains reusable UI components. |
| solid-icons/* | Provides icons used in the component. |

## Error Handling
The component handles errors during data fetching by catching errors thrown by the `getLowConfidenceQueries` function. If an error occurs, a loading indicator is displayed.

## Logging
The component does not implement any specific logging mechanisms.

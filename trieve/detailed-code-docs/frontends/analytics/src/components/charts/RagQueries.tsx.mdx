---
title: "RagQueries.tsx"
---

## High-level description
The `RagQueries` component displays a table of RAG (Retrieval Augmented Generation) queries for a given dataset. It allows users to filter, sort, and paginate through the queries. The component fetches data from the backend API and uses the `Table` component to render the results.

## Code Structure
The `RagQueries` component uses the `createQuery` hook from `@tanstack/solid-query` to fetch and manage the RAG queries data. It also utilizes the `usePagination` hook for pagination and the `DatasetContext` for accessing the selected dataset. The component renders a `ChartCard` that contains the table of RAG queries. The `Select` component is used to provide sorting options for the table.

## References
- `getRAGQueries`: A function imported from `../../api/analytics` that fetches RAG queries data from the backend API.
- `DatasetContext`: A context imported from `../../layouts/TopBarLayout` that provides access to the selected dataset.
- `usePagination`: A hook imported from `../../hooks/usePagination` that provides pagination functionality.
- `ChartCard`: A component imported from `./ChartCard` that renders a card for displaying charts and tables.
- `Select`, `Table`, `Td`, `Tr`: Components imported from `shared/ui` for rendering UI elements.

## Symbols

### `RagQueries`
#### Description
This component fetches and displays a table of RAG queries for the selected dataset. It allows users to filter, sort, and paginate through the queries.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| filter | `RAGAnalyticsFilter` | An object containing filter options for the RAG queries. |

#### Outputs
This component renders a `ChartCard` containing a table of RAG queries.

#### Internal Logic
1. **Retrieves dataset ID and current page:** Gets the selected dataset ID from the `DatasetContext` and the current page from the `usePagination` hook.
2. **Prefetches next page data:** Uses `queryClient.prefetchQuery` to prefetch data for the next page based on the current filter and sort options.
3. **Defines `ragQueriesQuery`:** Creates a query using `createQuery` to fetch RAG queries data from the backend API based on the current page, filter, sort options, and dataset ID.
4. **Renders `ChartCard`:** Renders a `ChartCard` component with the title "RAG Queries" and a subtitle.
5. **Renders sorting controls:** Inside the `ChartCard`, renders two `Select` components for choosing the sort by column and sort order.
6. **Renders RAG queries table:** Conditionally renders a `Table` component based on the `ragQueriesQuery.data`. If data is loading, shows a "Loading..." message. If no data is available, shows a "No Data" message.
7. **Renders table rows:** Uses the `Table` component to render each `RagQueryEvent` from the `ragQueriesQuery.data`.

### `formatSortBy`
#### Description
This function formats the `RAGSortBy` enum value to a human-readable string for display in the sort by dropdown.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| sortBy | `RAGSortBy` | The sort by value to format. |

#### Outputs
Returns a formatted string representation of the `RAGSortBy` value.

### `formatSortOrder`
#### Description
This function formats the `SortOrder` enum value to a human-readable string for display in the sort order dropdown.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| sortOrder | `SortOrder` | The sort order value to format. |

#### Outputs
Returns a formatted string representation of the `SortOrder` value.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/solid-query | Used for fetching, caching, and managing asynchronous data. |
| shared/types | Provides shared types used throughout the application. |
| shared/ui | Provides shared UI components. |

## Error Handling
The component handles loading and error states of the `ragQueriesQuery` by displaying appropriate messages. If the API request fails, an error is thrown and can be handled by an error boundary higher up in the component tree.

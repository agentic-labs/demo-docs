---
title: "SingleChunkPage.tsx"
---

## High-level description
This code defines a `SingleChunkPage` component in React that displays detailed information about a single chunk of data. It fetches chunk data, allows for editing and deleting chunks, and provides functionality for bookmarking, chatting, and recommending related chunks.

## Code Structure
The main component `SingleChunkPage` uses various sub-components and utilities to render different parts of the UI. It manages state for chunk metadata, error handling, fetching status, and user interactions. The component interacts with an API to fetch and manipulate data.

## Symbols

### SingleChunkPage
#### Description
The main component that renders the single chunk page. It manages the state and logic for displaying chunk information, handling user interactions, and fetching related data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chunkId | string \| undefined | The ID of the chunk to display |
| defaultResultChunk | SingleChunkDTO | Default chunk data to display |

#### Internal Logic
1. Fetches chunk data and related information (chunk groups, bookmarks, recommendations)
2. Manages state for chunk metadata, errors, loading status, and user interactions
3. Renders chunk information, including metadata, content, and related chunks
4. Provides functionality for editing, deleting, bookmarking, and chatting about the chunk
5. Implements polling for recently uploaded chunks

### fetchChunk
#### Description
Fetches the chunk data from the API.

#### Internal Logic
1. Makes an API call to retrieve chunk data
2. Updates state with fetched data or error messages
3. Handles cases for recently uploaded chunks by implementing polling

### fetchRecommendations
#### Description
Fetches recommended chunks based on the current chunk.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ids | string[] | IDs of chunks to base recommendations on |
| prev_recommendations | ScoreChunkDTO[] | Previously fetched recommendations |

#### Internal Logic
1. Makes an API call to get recommended chunks
2. Updates state with new recommendations, avoiding duplicates

### getChunk
#### Description
A memoized function that returns the JSX for rendering the chunk information.

#### Internal Logic
1. Renders chunk metadata and content using the `ScoreChunk` component
2. Handles error states and loading states

## Side Effects
- Fetches data from external API endpoints
- Updates local storage with chat messages
- Modifies the DOM for chat functionality

## Dependencies
- SolidJS for reactive programming
- SolidJS Router for routing
- Various utility functions and types from local files

## Error Handling
The component implements error handling for API requests and displays error messages to the user when necessary.

## API/Interface Reference
The component interacts with several API endpoints:
| Endpoint | Method | Description |
|:---------|:-------|:------------|
| /chunk/${chunkId} | GET | Fetches chunk data |
| /dataset/groups/${datasetId}/1 | GET | Fetches chunk groups |
| /chunk_group/chunks | POST | Fetches bookmarks for chunks |
| /chunk/recommend | POST | Fetches recommended chunks |

Note: The actual API host is determined by the `VITE_API_HOST` environment variable.
---
title: "DatasetAndUserContext.tsx"
---

## High-level description
This code defines the `DatasetAndUserContextWrapper` component, which provides a context for managing dataset and user information in a search application. It handles user authentication, organization selection, dataset selection, and various data fetching operations related to these entities.

## Code Structure
The main symbols in this code are:
- `DatasetAndUserContext`: A context object that holds the state and functions related to datasets and users.
- `DatasetAndUserContextWrapper`: A component that wraps the application and provides the context to its children.
- Various state variables and effects that manage the application's state and side effects.

## Symbols

### DatasetAndUserContext
#### Description
A context object that provides dataset and user-related information and functions to the application.

#### Internal Logic
- Initializes with default values for user, organizations, datasets, and related functions.

### DatasetAndUserContextWrapper
#### Description
A component that wraps the application and provides the DatasetAndUserContext to its children.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| props | RouteSectionProps | Props for the route section |

#### Internal Logic
1. Initializes various state variables for user, organization, dataset, and related data.
2. Defines functions for login, logout, and data fetching.
3. Uses effects to handle user authentication, organization selection, and dataset fetching.
4. Provides the context value to its children through the DatasetAndUserContext.Provider.

### login
#### Description
A function that handles user authentication.

#### Internal Logic
1. Fetches user data from the API.
2. Updates the user and organization state if successful.
3. Handles errors and displays toasts for failed logins.

### createEffect (for organization selection)
#### Description
An effect that handles the selection and persistence of the current organization.

#### Internal Logic
1. Determines the current organization based on URL parameters, local storage, or user data.
2. Updates the selected organization state and persists it in local storage and URL.

### createEffect (for dataset fetching)
#### Description
An effect that fetches datasets for the selected organization.

#### Internal Logic
1. Fetches datasets from the API when the selected organization changes.
2. Updates the current dataset and datasets list state.
3. Handles the selection of the current dataset based on URL parameters or local storage.

## Side Effects
- Fetches user data on mount and updates the application state.
- Persists selected organization and dataset in local storage and URL parameters.
- Fetches datasets when the selected organization changes.

## Dependencies
- SolidJS for reactivity and component structure.
- @solidjs/router for routing functionality.

## Error Handling
- Displays error toasts for failed login attempts.
- Handles cases where the user is not authenticated or datasets are not found.

This code provides a centralized management of user, organization, and dataset data, making it available throughout the application via the context API.
---
title: "ThemeModeController.tsx"
---

## High-level description
This code implements a theme mode controller component for a web application. It allows users to switch between light, dark, and system-based themes, persisting the user's choice in local storage and applying the appropriate CSS classes to the document.

## Code Structure
The code consists of utility functions for managing theme modes and a main `ThemeModeController` component. The utility functions interact with the DOM and local storage, while the component uses these functions to render a UI for theme selection.

## Symbols

### `setThemeMode`
#### Description
Sets the theme mode for the application by updating the document's CSS classes and storing the choice in local storage.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mode | "light" \| "dark" | The desired theme mode |

#### Internal Logic
1. Determines the opposite mode
2. Removes the opposite mode's CSS class from the document
3. Stores the selected mode in local storage
4. Adds the selected mode's CSS class to the document

### `getThemeMode`
#### Description
Retrieves the current theme mode from local storage.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mode | "light" \| "dark" \| "system" | The current theme mode |

### `clearThemeMode`
#### Description
Clears the theme mode from local storage and sets the theme based on the system preference.

#### Internal Logic
1. Removes the theme from local storage
2. Checks the system's color scheme preference
3. Adds or removes the "dark" CSS class based on the system preference

### `ThemeModeController`
#### Description
A component that renders a theme mode selection UI using a popover menu.

#### Internal Logic
1. Creates a signal for the current theme
2. Uses an effect to apply the dark theme if necessary
3. Renders a button that toggles a popover menu
4. The menu contains options for light, dark, and system themes
5. Clicking an option updates the theme using the utility functions

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-headless | Provides UI components like Menu, Popover, and Transition |
| solid-js | Provides reactive primitives like createSignal and createEffect |
| solid-icons | Provides icons for the UI |

## Side Effects
- Modifies the document's CSS classes to apply the selected theme
- Interacts with local storage to persist the user's theme preference

## Performance Considerations
The component uses transitions for smooth visual effects, which may impact performance on lower-end devices.

## Error Handling
The code doesn't implement explicit error handling, relying on default behavior for potential issues like local storage access failures.
---
title: "downloadFile.ts"
---

## High-level description
This code defines a utility function `downloadFile` that allows users to download a file associated with a specific file ID and dataset ID. It fetches the file information from an API endpoint and triggers the download process using the browser's download functionality.

## Symbols

### `downloadFile`
#### Description
This asynchronous function handles the process of downloading a file based on the provided file ID and dataset ID.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fileId | string | The unique identifier of the file to be downloaded |
| datasetId | string | The identifier of the dataset associated with the file |

#### Internal Logic
1. Constructs the API endpoint URL using the `apiHost` and `fileId`.
2. Sends a GET request to the API endpoint with appropriate headers, including credentials and dataset information.
3. Checks if the response is successful (ok).
4. If successful, parses the JSON response to get the file data.
5. Extracts the `s3_url` from the file data.
6. If a valid URL is found:
   - Creates a new anchor (`&lt;a&gt;`) element.
   - Sets the `href` attribute to the file's URL.
   - Sets the `download` attribute to the file's name.
   - Sets the `target` attribute to "_blank".
   - Programmatically clicks the link to trigger the download.

#### Error Handling
If the fetch request fails or returns a non-OK status, the function throws an error with the message "Failed to fetch dataset".

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ChunkFile | Type definition imported from "../utils/apiTypes" |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| VITE_API_HOST | string | N/A | The API host URL, retrieved from environment variables |

## Side Effects
- Creates and triggers a click event on a dynamically created `&lt;a&gt;` element in the DOM.
- Initiates a file download in the user's browser.

This utility function provides a convenient way to download files associated with specific datasets, leveraging the browser's built-in download capabilities.
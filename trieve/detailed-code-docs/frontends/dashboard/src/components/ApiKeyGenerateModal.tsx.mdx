---
title: "ApiKeyGenerateModal.tsx"
---

## High-level description
This code defines a React component called `ApiKeyGenerateModal` that allows users to generate new API keys with specific permissions and scopes. It provides a form for users to input key details and handles the API key generation process.

## Code Structure
The main component `ApiKeyGenerateModal` uses various Solid.js primitives and components from external libraries. It manages the state of the form, handles user interactions, and communicates with the backend API to generate and retrieve API keys.

## References
- UserContext
- createToast
- MultiSelect
- Tooltip
- ApiRoutes

## Symbols

### ApiKeyGenerateModal
#### Description
A modal component for generating new API keys with customizable permissions and scopes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| openModal | Accessor&lt;boolean&gt; | Controls the visibility of the modal |
| closeModal | () =&gt; void | Function to close the modal |
| refetch | (info?: unknown) =&gt; ApiKeyRespBody[] \| Promise&lt;ApiKeyRespBody[]&gt; \| null \| undefined | Function to refetch API keys after generation |

#### Internal Logic
1. Initializes state variables for form inputs and API key generation.
2. Fetches available datasets for selected organizations.
3. Handles form submission and API key generation.
4. Manages the display of generated API key and copy functionality.
5. Provides options for selecting organizations, datasets, and API routes.

## Side Effects
- Fetches datasets when selected organizations change.
- Refetches API keys after successful generation.
- Copies generated API key to clipboard.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-js | For reactive state management and component rendering |
| terracotta | For UI components like Dialog, Disclosure, etc. |
| shared/types | For type definitions |
| solid-icons/fa | For icons |

## Error Handling
The component uses `createToast` to display error messages if API key generation fails.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /user/api_key | POST | API key details | SetUserApiKeyResponse | Generates a new API key |

___

This component provides a comprehensive interface for generating API keys with fine-grained control over permissions and scopes. It integrates with the user context and handles various aspects of the key generation process, including form management, API communication, and user feedback.
---
title: "PlansTable.tsx"
---

## High-level description
This code defines a `PlansTable` component in React that displays subscription plans for an organization. It allows users to view, upgrade, downgrade, or cancel their subscription plans. The component fetches available plans from an API, displays them in a table format, and provides functionality to change the subscription.

## Code Structure
The main `PlansTable` component uses several helper components and functions. It manages state for available plans, current plan, current subscription, and processing status. It also includes functions for fetching data, updating plans, and handling user interactions.

## Symbols

### PlansTable
#### Description
The main component that renders the subscription plans table and handles plan management.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| currentOrgSubPlan | OrganizationAndSubAndPlan \| null | The current organization's subscription and plan details |

#### Internal Logic
1. Fetches available plans from the API
2. Displays current plan and available plans in a table format
3. Provides buttons for upgrading, downgrading, or canceling plans
4. Handles plan changes and cancellations
5. Shows a notice for upcoming plan changes

### ActiveTag
#### Description
A small component that displays a tag for the current active plan or upcoming plan change.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | string | The text to display in the tag |

### createStripeSetupCheckoutSession
#### Description
A function that creates a Stripe checkout session for updating the payment method.

### refetchOrgSubPlan
#### Description
A function that refetches the current organization's subscription and plan details.

### cancelPlan
#### Description
A function that handles the cancellation of the current subscription plan.

### updatePlan
#### Description
A function that handles updating the subscription to a new plan.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| solid-js | For reactive state management and component rendering |
| solid-icons | For displaying icons in the component |
| shared/types | For type definitions used in the component |
| ../formatters | For formatting currency and numbers |
| ./ShowToasts | For displaying toast notifications |
| ../types/apiTypes | For API-related type definitions |

## Error Handling
The component uses toast notifications to display errors and success messages for various operations like plan changes and cancellations.

## Performance Considerations
The component uses `createMemo` for derived state calculations to optimize performance by memoizing the result of expensive computations.

---

This component is crucial for managing subscription plans in the application. It provides a user-friendly interface for viewing and modifying plans, integrating with Stripe for payment processing. The code is well-structured with clear separation of concerns between display logic and data management.
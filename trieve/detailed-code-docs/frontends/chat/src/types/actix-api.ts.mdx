---
title: "actix-api.ts"
---

## High-level description
This TypeScript file defines interfaces and utility functions for handling API responses, user plans, and referral tokens in a web application. It includes type definitions for API responses, functions for managing referral tokens in local storage, and type guards for validating response structures.

## Symbols

### `ActixApiDefaultError`
#### Description
An interface representing the default error structure returned by the Actix API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | string | The error message |

### `StripeCheckoutSessionResponse`
#### Description
An interface representing the response structure for a Stripe checkout session.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| checkout_session_url | string | The URL for the Stripe checkout session |

### `detectReferralToken`
#### Description
A function that detects and stores referral tokens in the browser's local storage.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| queryParamT | string \| undefined | The referral token from the query parameter |

#### Internal Logic
1. Checks if a referral token is provided
2. Retrieves previously stored tokens from local storage
3. Adds the new token if it's not already present
4. Updates the local storage with the new token list

### `getReferralTokenArray`
#### Description
A function that retrieves the array of referral tokens from local storage.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| referralTokens | string[] | An array of stored referral tokens |

### `isStripeCheckoutSessionResponse`
#### Description
A type guard function to check if a given object is a valid StripeCheckoutSessionResponse.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | unknown | The object to be checked |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| isValid | boolean | True if the object is a valid StripeCheckoutSessionResponse, false otherwise |

### `UserPlan`
#### Description
An interface representing a user's subscription plan.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| id | string | The plan ID |
| stripe_customer_id | string | The Stripe customer ID |
| stripe_subscription_id | string | The Stripe subscription ID |
| plan | "silver" \| "gold" | The plan type |
| status | string | The subscription status |
| created_at | string | The creation timestamp |
| updated_at | string | The last update timestamp |

### `isUserPlan`
#### Description
A type guard function to check if a given object is a valid UserPlan.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | unknown | The object to be checked |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| isValid | boolean | True if the object is a valid UserPlan, false otherwise |

## Dependencies
This file doesn't explicitly import any external libraries, but it relies on the browser's `window` object and `localStorage` API for managing referral tokens.

## Error Handling
The code doesn't implement explicit error handling. It uses type guards (`isStripeCheckoutSessionResponse` and `isUserPlan`) to validate data structures, which can help prevent runtime errors when working with API responses.

## Performance Considerations
The `detectReferralToken` and `getReferralTokenArray` functions interact with `localStorage`, which can be a relatively slow operation. However, given the small amount of data being stored and retrieved, this is unlikely to cause significant performance issues in most cases.
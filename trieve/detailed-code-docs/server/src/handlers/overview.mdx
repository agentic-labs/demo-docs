---
title: "Overview"
---

## High-level description
The `handlers` directory contains modules that define API endpoints and request handlers for various functionalities of the Trieve server. These handlers cover operations related to analytics, authentication, data management, file handling, organization management, user management, and integration with external services like Stripe.

## What does it do?
The handlers in this directory collectively form the API layer of the Trieve server. They process incoming HTTP requests, interact with the database and other services, and return appropriate responses. Here's a brief overview of what each handler does:

- `analytics_handler`: Manages analytics data collection and retrieval.
- `auth_handler`: Handles user authentication and authorization.
- `chunk_handler`: Manages operations on data chunks, including creation, retrieval, and search.
- `dataset_handler`: Handles dataset-related operations.
- `event_handler`: Manages event logging and retrieval.
- `file_handler`: Handles file upload, retrieval, and management.
- `group_handler`: Manages operations on groups of chunks.
- `invitation_handler`: Handles user invitations to organizations.
- `message_handler`: Manages chat messages and topics.
- `metrics_handler`: Exposes server metrics for monitoring.
- `organization_handler`: Handles organization-related operations.
- `stripe_handler`: Manages Stripe integration for payments and subscriptions.
- `topic_handler`: Handles chat topic management.
- `user_handler`: Manages user-related operations.

## Entry points
The main entry point for the handlers is the `mod.rs` file, which re-exports all the individual handler modules. Each handler module typically contains multiple functions that correspond to different API endpoints. These functions are usually decorated with Actix Web attributes that define the HTTP method and path for each endpoint.

The flow of control typically goes from the incoming HTTP request to the appropriate handler function, which then interacts with the database or other services (often through operators defined elsewhere in the codebase), and finally constructs and returns an HTTP response.

## Key Files
1. `auth_handler.rs`: Crucial for user authentication and session management.
2. `chunk_handler.rs`: Central to the core functionality of managing and searching data chunks.
3. `organization_handler.rs`: Important for multi-tenant functionality, managing organizations and their members.
4. `stripe_handler.rs`: Key for handling payments and subscriptions.

## Dependencies
The handlers rely on several external libraries:
- `actix-web`: Web framework for building the API.
- `serde`: For serialization and deserialization of JSON data.
- `diesel`: ORM for database interactions.
- `utoipa`: For generating OpenAPI documentation.
- `stripe`: For interacting with the Stripe API.
- `redis`: For caching and session management.

## Configuration
The handlers often use configuration values from environment variables, such as:
- `OIDC_ISSUER_URL`, `OIDC_CLIENT_ID`, `OIDC_AUTH_REDIRECT_URL`: For OpenID Connect configuration.
- `BASE_SERVER_URL`: For constructing URLs.
- `STRIPE_WEBHOOK_SECRET`: For verifying Stripe webhooks.

These handlers form the core of the Trieve server's API, processing requests, interacting with the database and external services, and returning responses to clients. They implement the business logic of the application and serve as the interface between the client applications and the server's internal components.
---
title: "Overview"
---

## High-level description
This directory contains the data models and schema definitions for the Trieve application. It includes two main files: `models.rs` and `schema.rs`. The `models.rs` file defines the data structures and their associated methods, while `schema.rs` outlines the database schema using the Diesel ORM.

## What does it do?
The `data` directory serves as the core data layer for the Trieve application. It defines the structure of various entities such as users, organizations, datasets, chunks, files, and more. These structures are used throughout the application for database interactions, API requests and responses, and internal data processing.

The `schema.rs` file provides a blueprint for the database, defining tables and their relationships. This allows for type-safe database operations using the Diesel ORM.

Together, these files enable the application to:
1. Store and retrieve user information
2. Manage organizations and their subscriptions
3. Handle datasets and their configurations
4. Process and store chunks of data with associated metadata
5. Manage file uploads and their metadata
6. Handle search operations and analytics
7. Process and store messages and topics for chat functionality
8. Manage API keys and their permissions
9. Handle billing and subscription information through Stripe integration

## Key Files

### models.rs
This file contains the core data structures used throughout the application. Some key structures include:

1. `User`: Represents a user in the system
2. `Organization`: Represents an organization, which can have multiple users
3. `Dataset`: Represents a collection of data with specific configurations
4. `ChunkMetadata`: Represents metadata for a chunk of data
5. `File`: Represents a file uploaded to the system
6. `Topic` and `Message`: Represent chat topics and messages
7. `UserApiKey`: Represents API keys for user authentication
8. `StripeSubscription` and `StripePlan`: Handle billing and subscription information

The file also includes various enums, helper functions, and data transfer objects (DTOs) to support the application's functionality.

### schema.rs
This file defines the database schema using Diesel ORM macros. It includes table definitions for all major entities in the system, such as:

1. `users`
2. `organizations`
3. `datasets`
4. `chunk_metadata`
5. `files`
6. `topics`
7. `messages`
8. `stripe_subscriptions`

The file also defines relationships between tables using `joinable!` macros and allows tables to be used together in queries with the `allow_tables_to_appear_in_same_query!` macro.

## Dependencies
The data layer relies on several external libraries:

1. Diesel: For ORM functionality and database interactions
2. Serde: For serialization and deserialization of data structures
3. Chrono: For handling date and time operations
4. UUID: For generating and handling unique identifiers
5. Qdrant: For vector search functionality
6. Blake3: For hashing API keys

## Configuration
While the `data` directory itself doesn't contain configuration files, it defines structures that are used for configuration in other parts of the application. For example, the `DatasetConfiguration` struct in `models.rs` defines various configurable options for datasets, including:

- LLM and embedding base URLs and API keys
- Model names and prompts
- Retrieval parameters
- Embedding size and distance metric
- BM25 parameters
- Search flags and options

These configurations would typically be set and managed in other parts of the application that interact with the data layer.

In conclusion, the `data` directory serves as the foundation for the Trieve application's data management, defining the structure and relationships of the core entities and providing a schema for database operations. It enables the application to handle complex data processing tasks, manage user and organization information, and support advanced search and analytics functionalities.
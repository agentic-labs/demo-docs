---
title: "models.rs"
---

## High-level description
This code defines data structures (structs and enums) representing various entities and concepts within the Trieve application, such as users, topics, messages, chunks, datasets, organizations, and more. These data structures are used for database interactions, API requests and responses, and internal data processing.

## Code Structure
The code defines a series of structs and enums, each representing a specific entity or concept. Some structs have associated `impl` blocks that define methods for creating, manipulating, and converting between different representations of the data.

## References
This code references the `schema` module, which likely defines the database schema used for storing these entities. It also references various `operator` modules, which likely contain functions for interacting with databases, external APIs, and performing data processing tasks.

## Symbols

### `User`
#### Description
Represents a user in the Trieve application.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `User` instance from email and optional name.
- `from_details_with_id`: Creates a new `User` instance with a specified ID, email, and optional name.

### `Topic`
#### Description
Represents a chat topic within a dataset.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `Topic` instance from name, owner ID, and dataset ID.

### `Message`
#### Description
Represents a message within a chat topic.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `Message` instance to an `openai_dive::v1::resources::chat::ChatMessage`.
- `from_details`: Creates a new `Message` instance from content, topic ID, sort order, role, prompt and completion token counts, and dataset ID.

### `RoleProxy`
#### Description
An enum representing the role of a chat message (system, user, or assistant).

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `RoleProxy` instance to an `openai_dive::v1::resources::chat::Role`.

### `ChatMessageProxy`
#### Description
A struct representing a chat message with role and content.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChatMessageProxy` instance to an `openai_dive::v1::resources::chat::ChatMessage`.

### `GeoTypes`
#### Description
An enum representing geographic coordinate types (integer or float).

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `GeoTypes` instance to an `f64`.

### `GeoInfoWithBias`
#### Description
A struct representing geographic information with a bias value for location-based ranking.

#### Inputs
None

#### Outputs
None

### `GeoInfo`
#### Description
A struct representing geographic coordinates (latitude and longitude).

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `haversine_distance_to`: Calculates the Haversine distance between two `GeoInfo` instances.

### `UpdateSpecificChunkMetadata`
#### Description
A struct representing specific fields of `ChunkMetadata` that can be updated.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts an `UpdateSpecificChunkMetadata` instance to a `ChunkMetadata` instance.
- `from`: Converts a `ChunkMetadata` instance to an `UpdateSpecificChunkMetadata` instance.

### `ChunkMetadata`
#### Description
Represents metadata associated with a chunk of data.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `ChunkMetadata` instance from various fields.
- `from_details_with_id`: Creates a new `ChunkMetadata` instance with a specified ID and other fields.
- `from_table_and_tag_set`: Creates a new `ChunkMetadata` instance from a `ChunkMetadataTable` and a vector of tags.
- `from_table_and_tag_set_option_string`: Creates a new `ChunkMetadata` instance from a `ChunkMetadataTable` and an optional vector of tags.

### `ChunkMetadataTable`
#### Description
Represents the database table structure for storing chunk metadata.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadata` instance to a `ChunkMetadataTable` instance.

### `IngestSpecificChunkMetadata`
#### Description
A struct representing specific fields of `ChunkMetadata` used during data ingestion.

#### Inputs
None

#### Outputs
None

### `ChunkMetadataWithScore`
#### Description
Represents chunk metadata with an associated score, typically used for search results.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadataWithScore` instance to a `ScoreChunk` instance.
- `from`: Converts a `ChunkMetadataWithScore` instance to a `ChunkMetadataStringTagSet` instance.
- `from`: Converts a `ChunkMetadataWithScore` instance to a `ChunkMetadata` instance.
- `from`: Converts a tuple of `ChunkMetadata` and `f32` (score) to a `ChunkMetadataWithScore` instance.

### `ScoreChunkDTO`
#### Description
Represents a scored chunk with metadata, highlights, and a score.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `slim`: Creates a slimmed-down version of the `ScoreChunkDTO` with only essential metadata.

### `ScoreChunk`
#### Description
Represents a scored chunk with metadata, highlights, and a score.

#### Inputs
None

#### Outputs
None

### `SlimChunkMetadataWithArrayTagSet`
#### Description
Represents a slimmed-down version of chunk metadata with an array of tags.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `SlimChunkMetadata` instance to a `SlimChunkMetadataWithArrayTagSet` instance.

### `NewChunkMetadataTypes`
#### Description
An enum representing different types of chunk metadata.

#### Inputs
None

#### Outputs
None

### `ChunkMetadataTypes`
#### Description
An enum representing different types of chunk metadata.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadataTypes` instance to a `ChunkMetadata` instance.
- `from`: Converts a `ChunkMetadata` instance to a `ChunkMetadataTypes` instance.
- `from`: Converts a `SlimChunkMetadata` instance to a `ChunkMetadataTypes` instance.
- `from`: Converts a `ContentChunkMetadata` instance to a `ChunkMetadataTypes` instance.
- `metadata`: Returns the `ChunkMetadata` representation of the `ChunkMetadataTypes` instance.

### `SlimChunkMetadataWithScore`
#### Description
Represents a slimmed-down version of chunk metadata with an associated score.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadataWithScore` instance to a `SlimChunkMetadataWithScore` instance.

### `ChunkMetadataStringTagSet`
#### Description
Represents chunk metadata with tags stored as a comma-separated string.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadata` instance to a `ChunkMetadataStringTagSet` instance.
- `from`: Converts a `ContentChunkMetadata` instance to a `ChunkMetadataStringTagSet` instance.

### `SlimChunkMetadataTable`
#### Description
Represents the database table structure for storing slimmed-down chunk metadata.

#### Inputs
None

#### Outputs
None

### `SlimChunkMetadata`
#### Description
Represents a slimmed-down version of chunk metadata.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_table_and_tag_set`: Creates a new `SlimChunkMetadata` instance from a `SlimChunkMetadataTable` and a vector of tags.
- `from`: Converts a `ChunkMetadata` instance to a `SlimChunkMetadata` instance.
- `from`: Converts a `ChunkMetadataStringTagSet` instance to a `SlimChunkMetadata` instance.
- `from`: Converts a `ContentChunkMetadata` instance to a `SlimChunkMetadata` instance.

### `ContentChunkMetadata`
#### Description
Represents metadata for a chunk containing only content, without additional fields like link or tags.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `ChunkMetadata` instance to a `ContentChunkMetadata` instance.

### `SlimUser`
#### Description
Represents a slimmed-down version of user data, including user organizations and organizations.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `SlimUser` instance from a `User`, a vector of `UserOrganization`, and a vector of `Organization`.

### `UserDTO`
#### Description
Represents a basic user data transfer object.

#### Inputs
None

#### Outputs
None

### `ChunkGroup`
#### Description
Represents a group of chunks.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `ChunkGroup` instance from various fields.
- `from_details_with_id`: Creates a new `ChunkGroup` instance with a specified ID and other fields.

### `ChunkGroupAndFileId`
#### Description
Represents a chunk group with an associated file ID.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_group`: Creates a new `ChunkGroupAndFileId` instance from a `ChunkGroup` and an optional file ID.
- `to_group`: Converts a `ChunkGroupAndFileId` instance to a `ChunkGroup` instance.

### `ChunkGroupBookmark`
#### Description
Represents a bookmark linking a chunk to a chunk group.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `ChunkGroupBookmark` instance from group ID and chunk metadata ID.

### `FileGroup`
#### Description
Represents a link between a file and a chunk group.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `FileGroup` instance from file ID and group ID.

### `UserDTOWithChunks`
#### Description
Represents user data with associated chunks.

#### Inputs
None

#### Outputs
None

### `File`
#### Description
Represents a file uploaded to the system.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `File` instance from various fields.

### `FileAndGroupId`
#### Description
Represents a file with an associated group ID.

#### Inputs
None

#### Outputs
None

### `FileDTO`
#### Description
Represents a file data transfer object.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `File` instance to a `FileDTO` instance.

### `WorkerEventClickhouse`
#### Description
Represents a worker event stored in ClickHouse.

#### Inputs
None

#### Outputs
None

### `WorkerEvent`
#### Description
Represents an event generated by a worker process.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `WorkerEventClickhouse` instance to a `WorkerEvent` instance.
- `from`: Converts a `WorkerEvent` instance to a `WorkerEventClickhouse` instance.
- `from_details`: Creates a new `WorkerEvent` instance from dataset ID and event type.

### `EventType`
#### Description
An enum representing different types of worker events.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `get_all_event_types`: Returns a vector of all possible `EventTypeRequest` values.

### `DatasetGroupCount`
#### Description
Represents the count of chunk groups within a dataset.

#### Inputs
None

#### Outputs
None

### `DatasetEventCount`
#### Description
Represents the count of events associated with a dataset.

#### Inputs
None

#### Outputs
None

### `Dataset`
#### Description
Represents a dataset containing chunks and chunk groups.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_details`: Creates a new `Dataset` instance from name, organization ID, tracking ID, and server configuration.

### `DatasetDTO`
#### Description
Represents a dataset data transfer object.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from`: Converts a `Dataset` instance to a `DatasetDTO` instance.

### `DatasetUsageCount`
#### Description
Represents the usage count of a dataset (number of chunks).

#### Inputs
None

#### Outputs
None

### `DatasetAndUsage`
#### Description
Represents a dataset with its associated usage count.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_components`: Creates a new `DatasetAndUsage` instance from a `DatasetDTO` and a `DatasetUsageCount`.

### `DistanceMetric`
#### Description
An enum representing different distance metrics for embedding similarity.

#### Inputs
None

#### Outputs
None

### `DatasetConfiguration`
#### Description
Represents the server-side configuration for a dataset.

#### Inputs
None

#### Outputs
None

#### Internal Logic
- `from_json`: Creates a new `DatasetConfiguration` instance from a JSON value.
- `to_json`: Converts a `DatasetConfiguration` instance to a JSON value.

### `DatasetConfigurationDTO`
#### Description
Represents a data transfer object for dataset
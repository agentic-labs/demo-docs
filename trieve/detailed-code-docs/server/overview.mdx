---
title: "Overview"
---

## High-level description
The `server` directory contains the core implementation of the Trieve server application, a comprehensive API service for managing and searching datasets, handling user authentication, processing files, and integrating with external services. The server is built using the Rust programming language and the Actix Web framework, with integrations for multiple databases and third-party services.

## What does it do?
The Trieve server provides a wide range of functionalities, including:

1. User and organization management
2. Dataset and chunk management
3. File processing and ingestion
4. Advanced search operations (hybrid semantic and full-text search)
5. Analytics and event tracking
6. Authentication and authorization
7. API versioning
8. Integration with external services (e.g., OpenAI for language models, Stripe for payments)
9. Background processing for tasks like data ingestion and reindexing

The server handles various aspects of data management, from ingestion and storage to retrieval and analysis, while also providing user management and authentication features.

## Entry points
The main entry point for the server is the `main.rs` file, which delegates to the `trieve_server::main()` function defined in `lib.rs`. The `lib.rs` file is responsible for setting up the server configuration, initializing databases and services, and defining the API routes.

The server's functionality is organized into several key modules:

- `handlers`: Implements API endpoints
- `operators`: Contains core business logic and database operations
- `data`: Defines data models and database schema
- `middleware`: Implements request processing middleware (e.g., authentication, API versioning)
- `errors`: Defines custom error types and handling

## Key Files
1. `lib.rs`: Main server setup and configuration
2. `handlers/chunk_handler.rs`: Manages operations on data chunks
3. `handlers/auth_handler.rs`: Handles user authentication
4. `operators/search_operator.rs`: Implements search functionality
5. `data/models.rs`: Defines core data structures
6. `middleware/auth_middleware.rs`: Implements authentication middleware

## Dependencies
The server relies on several external libraries and services:

- Actix Web: Web framework for building the server
- Diesel: ORM for database operations with PostgreSQL
- Qdrant: Vector database for semantic search capabilities
- Redis: Used for caching and as a message queue
- OpenAI: Integration for language model functionality
- Stripe: Payment processing integration
- Sentry: Error tracking and logging
- Clickhouse: Analytics database for event tracking and analysis

## Configuration
The server uses environment variables for configuration, including:

- Database connection strings (PostgreSQL, Redis, Qdrant, Clickhouse)
- API keys for external services (OpenAI, Stripe)
- Server settings (e.g., host, port)
- Feature flags and versioning information

Configuration is managed through a combination of the `Cargo.toml` file, environment variables, and the `.env` file (which is processed during the build phase).

## Error Handling
The application uses a custom `ServiceError` enum for consistent error handling across different components. This allows for proper error propagation and conversion to appropriate HTTP responses.

In conclusion, the `server` directory contains a complex and feature-rich server application that provides a wide range of functionalities for managing and searching datasets, with integrations for various external services and a focus on scalability and performance. The use of Rust ensures high performance and safety, while the modular structure allows for easy maintenance and extensibility.
---
title: "down.sql"
---

## High-level description
This SQL script is designed to undo the changes made by the corresponding `up.sql` migration. It removes several indices that were previously added to the 'files' and 'card_files' tables in the database.

## Symbols

### DROP INDEX statements
#### Description
These SQL statements are used to remove specific indices from the 'files' and 'card_files' tables.

#### Internal Logic
The script uses `DROP INDEX IF EXISTS` statements to remove indices. This approach ensures that the script will not fail if an index doesn't exist, making the migration more robust.

1. For the 'files' table, it removes indices on:
   - `user_id`
   - `private`
   - `created_at`
   - `updated_at`

2. For the 'card_files' table, it removes indices on:
   - `card_id`
   - `file_id`
   - `created_at`
   - `updated_at`

## Side Effects
Removing these indices will likely impact the query performance for operations that were previously using these indices. Queries that filter or sort by the affected columns may become slower after this migration is applied.

## Performance Considerations
Removing indices can improve the performance of INSERT, UPDATE, and DELETE operations as the database no longer needs to maintain these indices. However, it may negatively impact the performance of SELECT queries that were utilizing these indices.

## Error Handling
The script uses `IF EXISTS` clause with each `DROP INDEX` statement. This prevents the script from failing if an index doesn't exist, ensuring the migration can complete even if some indices were already removed or never created.

## TODOs
There are no explicit TODOs in this code. However, it's worth noting that this is a 'down' migration script, which is typically used to revert changes made by an 'up' migration. Ensure that there's a corresponding 'up' migration that creates these indices.
---
title: "down.sql"
---

## High-level description
This SQL migration script is designed to revert changes made to the `chunk_metadata` table, specifically undoing modifications to the `location` column. It removes the existing `location` column and then recreates it with different properties.

## Symbols

### ALTER TABLE chunk_metadata DROP COLUMN location;
#### Description
This SQL command removes the `location` column from the `chunk_metadata` table.

#### Internal Logic
1. Identifies the `chunk_metadata` table.
2. Removes the `location` column entirely from the table structure.

### ALTER TABLE chunk_metadata ADD COLUMN location JSONB DEFAULT '{}' NULL;
#### Description
This SQL command adds a new `location` column to the `chunk_metadata` table with specific properties.

#### Internal Logic
1. Identifies the `chunk_metadata` table.
2. Adds a new column named `location`.
3. Sets the data type of the column to `JSONB` (JSON Binary), which is optimized for storing JSON data.
4. Sets a default value of an empty JSON object (`'{}'`).
5. Allows NULL values in this column.

## Side Effects
- The structure of the `chunk_metadata` table is modified.
- Any existing data in the original `location` column will be lost when it is dropped.
- Applications or queries relying on the previous structure of the `location` column may need to be updated.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| PostgreSQL | This SQL script uses PostgreSQL-specific syntax (JSONB type) |

## Notes
1. This is a "down" migration script, meant to revert changes made in a corresponding "up" migration.
2. The script assumes that the original `location` column was of type JSONB with a default empty object and allowing NULL values.
3. Care should be taken when running this migration, as it will result in data loss for the `location` column.
4. The comment at the top of the file indicates that this script is intended to undo changes made in an `up.sql` file.
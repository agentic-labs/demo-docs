---
title: "up.sql"
---

## High-level description
This SQL migration script adds a new column `tracking_id` to the `chunk_group` table and creates a unique constraint combining `tracking_id` and `dataset_id`. This enhancement allows for better tracking and identification of chunk groups within datasets.

## Symbols

### ALTER TABLE chunk_group ADD COLUMN tracking_id TEXT UNIQUE
#### Description
This SQL statement adds a new column named `tracking_id` to the `chunk_group` table. The column is of type TEXT and has a UNIQUE constraint.

#### Internal Logic
1. Identifies the `chunk_group` table
2. Adds a new column named `tracking_id`
3. Sets the data type of the new column to TEXT
4. Applies a UNIQUE constraint to ensure each `tracking_id` is unique across the entire table

### ALTER TABLE chunk_group ADD CONSTRAINT chunk_group_tracking_id_dataset_id_key UNIQUE (tracking_id, dataset_id)
#### Description
This SQL statement adds a new unique constraint to the `chunk_group` table, ensuring that the combination of `tracking_id` and `dataset_id` is unique.

#### Internal Logic
1. Identifies the `chunk_group` table
2. Adds a new constraint named `chunk_group_tracking_id_dataset_id_key`
3. Specifies that the constraint is a UNIQUE constraint
4. Applies the constraint to the combination of `tracking_id` and `dataset_id` columns

## Side Effects
- The `chunk_group` table structure is modified, adding a new column and constraint.
- Existing rows in the `chunk_group` table will have NULL values for the new `tracking_id` column unless a default value is specified (which is not the case in this migration).
- The new UNIQUE constraints may cause issues if there are existing duplicate values in the `tracking_id` column or in the combination of `tracking_id` and `dataset_id`.

## Performance Considerations
- Adding a new column to an existing table with a UNIQUE constraint may require a full table scan and could be slow for large tables.
- The new unique constraints will create indexes, which may slightly increase the storage requirements and affect the performance of INSERT and UPDATE operations on the `chunk_group` table.
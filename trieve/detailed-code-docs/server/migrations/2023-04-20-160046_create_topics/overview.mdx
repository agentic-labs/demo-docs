---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for creating and dropping a `topics` table in the database. It consists of two files: `up.sql` for creating the table and `down.sql` for dropping it. These migrations are part of a database versioning system, allowing for easy application of changes and rollbacks to the database schema.

## What does it do?
The migration scripts in this directory manage the lifecycle of the `topics` table in the database. Here's what they do in simple terms:

1. The `up.sql` script creates a new table called `topics`. This table is designed to store information about debate topics. Each topic has a unique identifier, is associated with a user, has a resolution (the statement being debated), a side (probably indicating which side of the debate it represents), and some administrative fields like whether it's deleted and when it was created or last updated.

2. The `down.sql` script does the opposite. It removes the `topics` table from the database. This is useful if you need to undo the changes made by the `up.sql` script, for example, if you're rolling back a software update.

These scripts allow the database structure to be version-controlled alongside the application code, making it easier to manage changes to the database over time and across different environments (like development, testing, and production).

## Key Files

1. `up.sql`: This file contains the SQL commands to create the `topics` table. It defines the structure of the table, including all its columns and their data types, as well as constraints like primary keys and foreign keys.

   Here's a breakdown of the table structure it creates:
   ```sql
   CREATE TABLE topics (
     id UUID PRIMARY KEY NOT NULL,
     user_id UUID NOT NULL REFERENCES users(id),
     resolution TEXT NOT NULL,
     side BOOLEAN NOT NULL,
     deleted BOOLEAN NOT NULL DEFAULT FALSE,
     created_at TIMESTAMP NOT NULL,
     updated_at TIMESTAMP NOT NULL
   );
   ```

   This creates a table with columns for a unique ID, the ID of the user who created the topic, the resolution text, a boolean indicating the side, a deletion flag, and timestamps for creation and last update.

2. `down.sql`: This file contains the SQL command to drop the `topics` table. It's a simple one-line script:
   ```sql
   DROP TABLE IF EXISTS topics;
   ```
   This command will remove the `topics` table if it exists, effectively undoing the changes made by the `up.sql` script.

These files work together to provide a reversible change to the database schema. The `up.sql` script applies the change, while the `down.sql` script reverts it. This is a common pattern in database migration systems, allowing developers to easily move forward or backward through database schema versions.

## Configuration
While there are no explicit configuration files in this directory, the migration scripts themselves serve as a form of configuration for the database schema. The naming convention of the directory (2023-04-20-160046_create_topics) suggests that this migration was created on April 20, 2023, at 16:00:46. This timestamp-based naming is likely used by the migration system to determine the order in which to apply migrations.

The `topics` table structure defined in `up.sql` configures several aspects of how topic data will be stored:

- `id`: Uses a UUID as the primary key, ensuring globally unique identifiers for topics.
- `user_id`: References the `users` table, establishing a relationship between topics and users.
- `resolution`: Stores the topic statement as text.
- `side`: A boolean field, possibly used to indicate which side of a debate the topic represents.
- `deleted`: A boolean with a default value of FALSE, allowing for soft deletion of topics.
- `created_at` and `updated_at`: Timestamps to track when topics are created and modified.

These choices in table structure will influence how the application interacts with topic data, and may require corresponding structures in the application code to fully utilize this schema.
---
title: "down.sql"
---

## High-level description
This SQL script reverts the database changes made by the migration `2024-01-03-221426_set-default-org-usage-data`. It drops the trigger `set_default_org_usage_data_trigger`, the function `set_default_org_usage_data`, and re-adds a unique constraint on the `name` column of the `organizations` table.

## Symbols

### `DROP TRIGGER IF EXISTS set_default_org_usage_data_trigger ON organizations;`
#### Description
This statement attempts to drop a trigger named `set_default_org_usage_data_trigger` on the `organizations` table if it exists. The `IF EXISTS` clause ensures that the statement doesn't fail if the trigger is already absent.

#### Internal Logic
1. **Check for Existence:** The database checks if a trigger named `set_default_org_usage_data_trigger` exists on the `organizations` table.
2. **Drop Trigger:** If the trigger exists, it is dropped. If it doesn't exist, the statement completes without any action.

### `DROP FUNCTION IF EXISTS set_default_org_usage_data;`
#### Description
This statement attempts to drop a function named `set_default_org_usage_data` if it exists. The `IF EXISTS` clause ensures that the statement doesn't fail if the function is already absent.

#### Internal Logic
1. **Check for Existence:** The database checks if a function named `set_default_org_usage_data` exists.
2. **Drop Function:** If the function exists, it is dropped. If it doesn't exist, the statement completes without any action.

### `ALTER TABLE organizations ADD CONSTRAINT organizations_name_key UNIQUE (name);`
#### Description
This statement adds a unique constraint named `organizations_name_key` on the `name` column of the `organizations` table. This ensures that no two rows in the `organizations` table can have the same value for the `name` column.

#### Internal Logic
1. **Check for Existing Constraint:** The database checks if a constraint with the name `organizations_name_key` already exists on the `organizations` table.
2. **Add Constraint:** If the constraint doesn't exist, it is added to the `name` column of the `organizations` table. If it already exists, the statement might result in an error or a warning depending on the database system.

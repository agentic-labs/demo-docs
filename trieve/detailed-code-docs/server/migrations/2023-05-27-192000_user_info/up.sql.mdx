---
title: "up.sql"
---

## High-level description
This SQL script defines an `up` migration for the `users` table. It adds three new columns: `username`, `website`, and `visible_email`. It also sets the `visible_email` column to `true` for all existing users.

## Symbols

### `up.sql`
#### Description
This SQL script defines the `up` migration for the `users` table, adding new columns and updating existing data.

#### Internal Logic
1. **Add Columns:**
   - `ALTER TABLE users`: Modifies the existing `users` table.
   - `ADD COLUMN username TEXT NULL UNIQUE`: Adds a new column named `username` of type `TEXT`. It allows `NULL` values and enforces uniqueness.
   - `ADD COLUMN website TEXT NULL`: Adds a new column named `website` of type `TEXT` and allows `NULL` values.
   - `ADD COLUMN visible_email BOOLEAN DEFAULT false NOT NULL`: Adds a new column named `visible_email` of type `BOOLEAN`. It defaults to `false` and does not allow `NULL` values.

2. **Update Existing Data:**
   - `UPDATE users`: Modifies data in the `users` table.
   - `SET visible_email = true`: Sets the `visible_email` column to `true` for all existing rows in the table. This ensures that all existing users have their email addresses visible by default after the migration.

## Side Effects
- **Database Schema Change:** This migration modifies the schema of the `users` table by adding three new columns.
- **Data Modification:** The migration updates the `visible_email` column for all existing users. 

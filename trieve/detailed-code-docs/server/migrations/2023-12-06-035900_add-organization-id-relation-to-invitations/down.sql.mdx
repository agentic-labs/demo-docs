---
title: "down.sql"
---

## High-level description
This SQL migration script is designed to revert the changes made in the corresponding `up.sql` file. It removes the `organization_id` column from the `invitations` table and adds back a `referral_tokens` column.

## Symbols

### ALTER TABLE invitations DROP COLUMN IF EXISTS organization_id
#### Description
This SQL command removes the `organization_id` column from the `invitations` table if it exists.

#### Internal Logic
1. Checks if the `organization_id` column exists in the `invitations` table.
2. If the column exists, it is dropped from the table.

### ALTER TABLE invitations ADD COLUMN referral_tokens TEXT
#### Description
This SQL command adds a new column named `referral_tokens` of type TEXT to the `invitations` table.

#### Internal Logic
1. Adds a new column called `referral_tokens` to the `invitations` table.
2. Sets the data type of the new column to TEXT.

## Side Effects
- The structure of the `invitations` table is modified.
- Any data in the `organization_id` column (if it existed) will be permanently lost.
- A new `referral_tokens` column is added, which will be initially empty for existing rows.

## Dependencies
This migration script depends on the existence of the `invitations` table in the database.

## Error Handling
The script uses `IF EXISTS` clause when dropping the `organization_id` column to prevent errors if the column doesn't exist.

## TODOs
The comment at the beginning of the file suggests that this script should undo anything done in the corresponding `up.sql` file. It's important to ensure that this down migration accurately reverses all changes made in the up migration for consistency and proper version control of the database schema.
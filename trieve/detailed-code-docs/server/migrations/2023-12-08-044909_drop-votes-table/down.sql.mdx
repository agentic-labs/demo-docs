---
title: "down.sql"
---

## High-level description
This SQL script is a migration file designed to revert the changes made in the corresponding `up.sql` file. It recreates the `card_votes` table and associated indexes, which were presumably dropped in the `up.sql` migration.

## Symbols

### `card_votes` table
#### Description
This table is created to store information about votes cast by users on card metadata.

#### Columns
| Name | Type | Constraints | Description |
|:-----|:-----|:------------|:------------|
| id | UUID | PRIMARY KEY | Unique identifier for each vote |
| voted_user_id | UUID | NOT NULL, REFERENCES users(id) | ID of the user who cast the vote |
| card_metadata_id | UUID | NOT NULL, REFERENCES card_metadata(id) | ID of the card metadata being voted on |
| vote | BOOLEAN | NOT NULL | The vote value (true/false) |
| created_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | Timestamp of when the vote was created |
| updated_at | TIMESTAMP | NOT NULL, DEFAULT NOW() | Timestamp of when the vote was last updated |

### Indexes
Two indexes are created to improve query performance:

1. `idx_card_votes_voted_user_id` on the `voted_user_id` column
2. `idx_card_votes_card_metadata_id` on the `card_metadata_id` column

## Dependencies
This migration script depends on the existence of two other tables in the database:
1. `users` table (referenced by `voted_user_id`)
2. `card_metadata` table (referenced by `card_metadata_id`)

## Error Handling
The script does not include explicit error handling. If there are any issues during execution (e.g., referenced tables don't exist), the database system will raise an error and roll back the transaction.

## Performance Considerations
The creation of indexes on `voted_user_id` and `card_metadata_id` columns is intended to improve query performance, especially for lookups based on these columns. However, these indexes will slightly increase the overhead for insert and update operations on the `card_votes` table.
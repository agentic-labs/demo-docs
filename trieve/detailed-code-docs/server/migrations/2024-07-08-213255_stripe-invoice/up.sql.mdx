---
title: "up.sql"
---

## High-level description
This SQL script creates a new table named `stripe_invoices` to store information about invoices generated by Stripe. The table includes columns for invoice ID, associated organization ID, total amount, creation timestamp, status, and a URL to the hosted invoice.

## Code Structure
The code defines a single SQL statement that creates the `stripe_invoices` table. It specifies columns for the table along with their data types and constraints. A foreign key constraint ensures referential integrity with the `organizations` table.

## Symbols

### `CREATE TABLE stripe_invoices`
#### Description
This SQL statement creates a new table named `stripe_invoices` with the specified columns and constraints.

#### Inputs
N/A - This is a SQL statement, not a function with inputs.

#### Outputs
N/A - This statement creates a table as a side effect.

#### Internal Logic
1. **`CREATE TABLE stripe_invoices`**: This clause initiates the creation of a new table named `stripe_invoices`.
2. **`(id UUID DEFAULT gen_random_uuid() PRIMARY KEY`**: Defines the `id` column as a UUID with a default value generated by `gen_random_uuid()` function and sets it as the primary key.
3. **`org_id UUID NOT NULL`**: Defines the `org_id` column as a UUID that cannot be NULL.
4. **`total INT NOT NULL`**: Defines the `total` column as an integer that cannot be NULL.
5. **`created_at TIMESTAMP NOT NULL`**: Defines the `created_at` column as a timestamp that cannot be NULL.
6. **`status TEXT NOT NULL`**: Defines the `status` column as text that cannot be NULL.
7. **`hosted_invoice_url TEXT NOT NULL`**: Defines the `hosted_invoice_url` column as text that cannot be NULL.
8. **`FOREIGN KEY (org_id) REFERENCES organizations(id) ON DELETE CASCADE`**:  Establishes a foreign key constraint on the `org_id` column, referencing the `id` column of the `organizations` table. The `ON DELETE CASCADE` clause ensures that if an organization is deleted, all associated invoices will also be deleted.

## Side Effects
- **Creates a new table:** This script creates the `stripe_invoices` table in the database.

## References
- **`organizations` table:** The `org_id` column references the `id` column of the `organizations` table.

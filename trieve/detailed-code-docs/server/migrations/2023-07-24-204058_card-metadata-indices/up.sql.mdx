---
title: "up.sql"
---

## High-level description
This SQL migration file creates several indices on the `card_metadata` and `card_collisions` tables to optimize query performance. The indices are created on various columns that are likely to be frequently used in search or filtering operations.

## Symbols

### CREATE INDEX statements
#### Description
Each `CREATE INDEX` statement creates an index on a specific column of either the `card_metadata` or `card_collisions` table. Indices are database structures that improve the speed of data retrieval operations on a database table at the cost of additional writes and storage space.

#### Internal Logic
The migration creates the following indices:

1. `idx_card_metadata_private` on the `private` column of `card_metadata`
2. `idx_card_metadata_oc_file_path` on the `oc_file_path` column of `card_metadata`
3. `idx_card_metadata_link` on the `link` column of `card_metadata`
4. `idx_card_metadata_created_at` on the `created_at` column of `card_metadata`
5. `idx_card_metadata_updated_at` on the `updated_at` column of `card_metadata`
6. `idx_card_collisions_collision_qdrant_id` on the `collision_qdrant_id` column of `card_collisions`
7. `idx_card_metadata_id` on the `id` column of `card_metadata`

Each index is named using a convention that includes the table name and the column name, prefixed with `idx_`.

## Performance Considerations
The creation of these indices will significantly improve the performance of queries that filter or sort by the indexed columns. However, it's important to note that while indices speed up read operations, they can slow down write operations (inserts, updates, and deletes) as the indices need to be updated along with the table data.

The choice of columns to index suggests that these are frequently used in WHERE clauses, JOIN conditions, or ORDER BY clauses in queries involving the `card_metadata` and `card_collisions` tables.

## Dependencies
This migration depends on the existence of the `card_metadata` and `card_collisions` tables in the database schema.
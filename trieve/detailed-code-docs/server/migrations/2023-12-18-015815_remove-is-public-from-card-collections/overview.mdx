---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for removing the `is_public` column from the `card_collection` table in the database. It consists of two files: `up.sql` for applying the change and `down.sql` for reverting it. These migrations are part of a database schema update, likely aimed at simplifying the structure or removing an unused feature related to the public visibility of card collections.

## What does it do?
The migration scripts in this directory perform the following actions:

1. The `up.sql` script removes the `is_public` column from the `card_collection` table. This action eliminates the ability to mark card collections as public or private directly in the database.

2. The `down.sql` script adds the `is_public` column back to the `card_collection` table. This serves as a rollback mechanism, allowing the database to be reverted to its previous state if needed.

These changes affect how the application handles the visibility of card collections. By removing the `is_public` column, the system may be moving towards a different method of managing collection visibility, or it might be eliminating the feature altogether.

## Key Files

### up.sql
This file contains the SQL command to remove the `is_public` column from the `card_collection` table:

```sql
ALTER TABLE card_collection DROP COLUMN is_public;
```

This change will permanently remove the `is_public` column and all its data from the `card_collection` table.

### down.sql
This file contains the SQL command to add the `is_public` column back to the `card_collection` table:

```sql
ALTER TABLE card_collection ADD COLUMN is_public boolean NOT NULL DEFAULT true;
```

This script reverses the change made by `up.sql`, restoring the `is_public` column with a boolean type, a NOT NULL constraint, and a default value of true.

## Dependencies
These migration scripts rely on:

1. SQL (Structured Query Language): Used to perform the database schema changes.
2. The existence of the `card_collection` table in the database.

## Configuration
The `down.sql` script introduces a configuration option when adding back the `is_public` column:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| is_public | boolean | true | Determines whether a card collection is public or not |

## Side Effects
Executing these migration scripts will have the following side effects:

1. When running `up.sql`:
   - The `is_public` column and all its data will be permanently removed from the `card_collection` table.
   - Queries, views, or application code that previously relied on the `is_public` column will need to be updated.
   - Storage space used by the `is_public` column will be freed up in the database.

2. When running `down.sql`:
   - The `is_public` column will be added back to the `card_collection` table.
   - Existing rows in the `card_collection` table will have the `is_public` column added with a default value of `true`.
   - Queries or application code that were modified to work without the `is_public` column may need to be updated again to handle its presence.

It's crucial to ensure that the application code is updated accordingly when applying these migrations to maintain consistency between the database schema and the application's expectations.
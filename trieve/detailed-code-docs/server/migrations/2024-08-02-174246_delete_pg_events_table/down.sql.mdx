---
title: "down.sql"
---

## High-level description
This SQL script is a database migration file designed to revert the changes made in the corresponding `up.sql` file. It recreates the `events` table in the `public` schema, which was presumably deleted in the `up.sql` migration.

## Symbols

### `CREATE TABLE public.events`
#### Description
This SQL command creates a new table named `events` in the `public` schema. The table is designed to store event-related information, likely for tracking various events associated with datasets.

#### Internal Logic
The table is created with the following columns and constraints:

1. `id`: A UUID (Universally Unique Identifier) serving as the primary key.
2. `created_at`: A timestamp column with a default value of the current time (`now()`).
3. `updated_at`: A timestamp column with a default value of the current time (`now()`).
4. `dataset_id`: A UUID column referencing the `id` column in the `datasets` table.
5. `event_type`: A varchar column limited to 255 characters, storing the type of event.
6. `event_data`: A JSONB column to store event-related data in a flexible JSON format.

The table also includes the following constraints:
- A primary key constraint on the `id` column.
- A foreign key constraint on the `dataset_id` column, referencing the `datasets` table with cascading delete and update actions.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| public.datasets | The `events` table has a foreign key relationship with the `datasets` table |

## Notes
1. The primary key constraint is named `file_upload_completed_notifications_pkey`, which suggests that this table might have been originally designed for file upload notifications and later repurposed or renamed to a more general `events` table.
2. The `ON DELETE CASCADE` and `ON UPDATE CASCADE` clauses in the foreign key constraint ensure that when a dataset is deleted or its ID is updated, the corresponding events are automatically deleted or updated, maintaining referential integrity.
3. The use of `jsonb` for the `event_data` column allows for flexible storage of event-specific information without needing to alter the table structure for different event types.
---
title: "down.sql"
---

## High-level description
This SQL script contains database migration commands to reverse the changes introduced in the `up.sql` migration file, specifically related to the `user_api_key` table. It aims to undo modifications made to optimize API key lookups.

## Symbols
### `ALTER TABLE user_api_key ALTER COLUMN api_key_hash SET NOT NULL`
#### Description
This statement modifies the `api_key_hash` column in the `user_api_key` table, making it mandatory (not nullable) again. This likely reverses a change that allowed this column to be empty.

#### Internal Logic
- `ALTER TABLE user_api_key`: Specifies the table to be modified.
- `ALTER COLUMN api_key_hash`: Targets the specific column for alteration.
- `SET NOT NULL`: Applies the "not null" constraint to the column.

### `ALTER TABLE user_api_key DROP COLUMN blake3_hash`
#### Description
This statement removes the `blake3_hash` column from the `user_api_key` table. This suggests that the `up.sql` migration likely added this column for optimization purposes, and this statement reverts that change.

#### Internal Logic
- `ALTER TABLE user_api_key`: Specifies the table to be modified.
- `DROP COLUMN blake3_hash`: Removes the specified column from the table.

---
title: "up.sql"
---

## High-level description
This SQL script alters the `user_api_key` table to add a new column `blake3_hash` and make the existing `api_key_hash` column non-nullable. This likely prepares the table for a change in how API keys are hashed and stored. 

## Symbols
### `ALTER TABLE user_api_key ADD COLUMN blake3_hash TEXT;`
#### Description
This statement adds a new column named `blake3_hash` to the `user_api_key` table. The column will store text values and likely represents the hash of the API key using the Blake3 hashing algorithm.

#### Inputs
N/A - This is a SQL statement, not a function with inputs.

#### Outputs
N/A - This statement modifies the database schema and doesn't return any output.

#### Internal Logic
This statement uses the `ALTER TABLE` command to modify the existing `user_api_key` table. 
- `ADD COLUMN blake3_hash TEXT` adds a new column named `blake3_hash` with the data type `TEXT`.

### `ALTER TABLE user_api_key ALTER COLUMN api_key_hash DROP NOT NULL;`
#### Description
This statement modifies the existing `api_key_hash` column in the `user_api_key` table to make it non-nullable. This means that all future entries in this column must have a value.

#### Inputs
N/A - This is a SQL statement, not a function with inputs.

#### Outputs
N/A - This statement modifies the database schema and doesn't return any output.

#### Internal Logic
This statement uses the `ALTER TABLE` command to modify the existing `user_api_key` table.
- `ALTER COLUMN api_key_hash DROP NOT NULL` modifies the existing `api_key_hash` column to remove the `NULL` constraint, making it a required field. 

---
title: "down.sql"
---

## High-level description
This SQL script contains database migration commands to reverse the changes introduced by the `up.sql` migration file, specifically related to the `user_api_key` table and the `api_key_hash` column in the `users` table. 

The script drops the `user_api_key` table and adds back the `api_key_hash` column to the `users` table, effectively reverting the database schema to its state before the migration in `up.sql` was applied.

## Symbols
### `DROP TABLE IF EXISTS user_api_key;`
#### Description
This SQL statement attempts to drop the table named `user_api_key`. The `IF EXISTS` clause ensures that the statement executes successfully even if the table doesn't exist.

#### Internal Logic
1. **Check for existence:** The database checks if a table named `user_api_key` exists.
2. **Drop if exists:** If the table exists, it is permanently deleted along with all its data.
3. **No action if not exists:** If the table doesn't exist, no action is taken.

### `ALTER TABLE users ADD COLUMN api_key_hash TEXT;`
#### Description
This SQL statement adds a new column named `api_key_hash` to the `users` table. The column is defined with the data type `TEXT`.

#### Internal Logic
1. **Find the table:** The database locates the table named `users`.
2. **Add the column:** A new column named `api_key_hash` is added to the `users` table.
3. **Set data type:** The data type of the new column is set to `TEXT`, allowing it to store text strings. 

---
title: "down.sql"
---

## High-level description
This SQL migration script is designed to revert changes made in the corresponding `up.sql` file. It focuses on undoing the removal of the `chunk_collisions` table and modifying the `chunk_metadata` table structure.

## Symbols

### ALTER TABLE chunk_metadata
#### Description
This SQL command modifies the `chunk_metadata` table by making the `qdrant_point_id` column nullable again.

#### Internal Logic
The command uses the `ALTER TABLE` statement to modify the `chunk_metadata` table. It then uses `ALTER COLUMN` to change the `qdrant_point_id` column, specifically dropping the `NOT NULL` constraint.

### CREATE TABLE chunk_collisions
#### Description
This SQL command recreates the `chunk_collisions` table that was presumably dropped in the corresponding `up.sql` migration.

#### Internal Logic
The `CREATE TABLE` statement is used to define the structure of the `chunk_collisions` table. It specifies the following columns:
1. `id`: A UUID serving as the primary key
2. `chunk_id`: A UUID that cannot be null
3. `collision_qdrant_id`: A UUID that can be null
4. `created_at`: A timestamp that cannot be null
5. `updated_at`: A timestamp that cannot be null

## Side Effects
1. The `qdrant_point_id` column in the `chunk_metadata` table becomes nullable, potentially allowing for NULL values where they were previously not permitted.
2. The `chunk_collisions` table is recreated, reintroducing the ability to store collision data that was removed in the corresponding `up` migration.

## TODOs
The script includes a comment "This file should undo anything in `up.sql`", which serves as a reminder and guideline for the purpose of this down migration script.
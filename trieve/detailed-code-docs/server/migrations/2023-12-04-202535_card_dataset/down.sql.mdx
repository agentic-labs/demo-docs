---
title: "down.sql"
---

## High-level description
This SQL script contains database migration commands to reverse the changes introduced in the `up.sql` migration file, specifically related to the addition of a "datasets" table and a "dataset_id" column to several other tables. 

This "down" migration script is typically used to rollback the database schema to a previous state, removing the "datasets" table and the associated foreign key relationships.

## Code Structure
The code consists of a series of SQL `DROP` and `ALTER TABLE` statements that are executed sequentially to undo the changes made in the `up.sql` migration.

## Symbols

### `DROP TABLE IF EXISTS datasets;`
#### Description
This statement attempts to drop the "datasets" table from the database. The `IF EXISTS` clause ensures that the statement doesn't fail if the table doesn't exist.

#### Internal Logic
1. **Check for existence:** The database checks if a table named "datasets" exists.
2. **Drop table:** If the table exists, it is permanently deleted from the database, along with all its data and indexes. If the table doesn't exist, the statement completes without any action.

### `ALTER TABLE card_metadata DROP COLUMN IF EXISTS dataset_id;`
#### Description
This statement removes the `dataset_id` column from the `card_metadata` table if it exists.

#### Internal Logic
1. **Check for column existence:** The database checks if a column named `dataset_id` exists in the `card_metadata` table.
2. **Drop column:** If the column exists, it is permanently removed from the table. If the column doesn't exist, the statement completes without any action.

### `ALTER TABLE card_collection DROP COLUMN IF EXISTS dataset_id;`
#### Description
This statement removes the `dataset_id` column from the `card_collection` table if it exists. The logic is identical to the previous statement, just applied to a different table.

### `ALTER TABLE card_collection_bookmarks DROP COLUMN IF EXISTS dataset_id;`
#### Description
This statement removes the `dataset_id` column from the `card_collection_bookmarks` table if it exists. The logic is identical to the previous statements, just applied to a different table.

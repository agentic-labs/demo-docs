---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for creating and managing a new "datasets" table and related modifications to existing tables in the database. The migration is dated 2023-12-04 and is specifically focused on introducing a card dataset feature to the system.

## What does it do?
These migration scripts perform the following actions:

1. Create a new "datasets" table to store information about different card datasets.
2. Add a "dataset_id" column to existing tables (card_metadata, card_collection, and card_collection_bookmarks) to associate cards and collections with specific datasets.
3. Provide a way to rollback these changes if needed.

This allows the system to organize cards and collections into distinct datasets, which could be useful for managing different sets of cards, perhaps for different games, editions, or purposes.

## Key Files

1. up.sql
   - Creates the new "datasets" table with columns for id, name, created_at, and updated_at.
   - Adds a "dataset_id" column to the card_metadata, card_collection, and card_collection_bookmarks tables.

2. down.sql
   - Removes the "dataset_id" column from the card_metadata, card_collection, and card_collection_bookmarks tables.
   - Drops the "datasets" table.

These files work together to provide a reversible database migration, allowing the system to be updated or rolled back as needed.

## Configuration
The migration scripts use SQL statements that are likely compatible with PostgreSQL, given the use of UUID and the `gen_random_uuid()` function. The specific database configuration (such as connection details) is not included in these files and would typically be managed elsewhere in the application.

Key configurable fields in the "datasets" table include:

- `id`: A UUID that serves as the primary key.
- `name`: A text field for the dataset name.
- `created_at` and `updated_at`: Timestamp fields for tracking creation and modification times.

The "dataset_id" column added to other tables is configured as a UUID, presumably to match the id in the datasets table, although foreign key constraints are not explicitly defined in these scripts.

Here's a sample of the SQL used to create the datasets table:

```sql
CREATE TABLE datasets (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name TEXT NOT NULL,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

This structure allows for efficient organization and querying of card-related data based on dataset associations, while also maintaining temporal metadata about each dataset.
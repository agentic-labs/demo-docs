---
title: "down.sql"
---

## High-level description
This SQL script performs database migration rollback operations, specifically reverting changes introduced by the `up.sql` script related to user collection counts. It drops a trigger, a function, and a table associated with maintaining and updating user collection counts.

## Symbols
### `DROP TRIGGER IF EXISTS update_collection_counts_trigger ON card_collection`
#### Description
This statement attempts to drop a trigger named `update_collection_counts_trigger` on the `card_collection` table if it exists. This trigger was likely responsible for updating user collection counts whenever changes occurred in the `card_collection` table. The `IF EXISTS` clause ensures that the statement executes successfully even if the trigger doesn't exist.

#### Internal Logic
1. **Check for Trigger Existence:** The database checks if the trigger `update_collection_counts_trigger` exists on the `card_collection` table.
2. **Drop Trigger (If Exists):** If the trigger exists, it is dropped, removing any associated actions that were set to occur on `card_collection` table events.

### `DROP FUNCTION IF EXISTS update_collection_counts()`
#### Description
This statement attempts to drop a function named `update_collection_counts()` if it exists. This function was likely involved in the process of calculating and updating user collection counts. The `IF EXISTS` clause ensures that the statement executes successfully even if the function doesn't exist.

#### Internal Logic
1. **Check for Function Existence:** The database checks if the function `update_collection_counts()` exists.
2. **Drop Function (If Exists):** If the function exists, it is dropped, removing its definition and making it unavailable for use.

### `DROP TABLE IF EXISTS user_collection_counts`
#### Description
This statement attempts to drop a table named `user_collection_counts` if it exists. This table likely stored user-specific collection counts. The `IF EXISTS` clause ensures that the statement executes successfully even if the table doesn't exist.

#### Internal Logic
1. **Check for Table Existence:** The database checks if the table `user_collection_counts` exists.
2. **Drop Table (If Exists):** If the table exists, it is dropped, removing all its data and its schema definition.

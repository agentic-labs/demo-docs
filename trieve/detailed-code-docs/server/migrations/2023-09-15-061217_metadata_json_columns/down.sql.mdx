---
title: "down.sql"
---

## High-level description
This SQL script reverts database schema changes that were presumably made by an "up" migration script named `2023-09-15-061217_metadata_json_columns/up.sql`. It specifically targets the `card_metadata` and `files` tables.

## Symbols
### `down.sql`
#### Description
This script undoes changes related to adding or modifying columns likely related to metadata and file paths in the `card_metadata` and `files` tables.

#### Internal Logic
1. **`card_metadata` Table Reversion:**
   - Renames the `tag_set` column back to its original name, `oc_file_path`. This suggests that the "up" migration might have renamed `oc_file_path` to `tag_set`.
   - Drops the `metadata` column. This indicates that the "up" migration likely added this column, and it's now being reverted.

2. **`files` Table Reversion:**
   - Renames the `tag_set` column back to `oc_file_path`, similar to the operation performed on the `card_metadata` table. This suggests a consistent renaming pattern in the "up" migration.

#### Side Effects
- Modifies the database schema by renaming and dropping columns in the `card_metadata` and `files` tables.
- Data within the renamed columns will be preserved, while data in the dropped `metadata` column will be lost.

---
title: "down.sql"
---

## High-level description
This SQL migration script is designed to revert changes made in the corresponding `up.sql` file. It adds back the `author_id` column to the `chunk_metadata` table and reestablishes foreign key constraints for several tables that reference the `users` table.

## Symbols

### ALTER TABLE chunk_metadata
#### Description
This statement adds the `author_id` column back to the `chunk_metadata` table.

#### Internal Logic
- Adds a new column named `author_id` to the `chunk_metadata` table
- Sets the column type as UUID
- Makes the column NOT NULL
- Establishes a foreign key reference to the `id` column in the `users` table

### ALTER TABLE user_organizations
#### Description
This statement adds a foreign key constraint to the `user_organizations` table.

#### Internal Logic
- Adds a foreign key constraint named `fk_user_id`
- Links the `user_id` column in `user_organizations` to the `id` column in the `users` table
- Specifies ON DELETE CASCADE behavior

### ALTER TABLE user_api_key
#### Description
This statement adds a foreign key constraint to the `user_api_key` table.

#### Internal Logic
- Adds a foreign key constraint named `user_api_key_user_id_fkey`
- Links the `user_id` column in `user_api_key` to the `id` column in the `users` table
- Specifies ON DELETE CASCADE behavior

### ALTER TABLE files
#### Description
This statement adds a foreign key constraint to the `files` table.

#### Internal Logic
- Adds a foreign key constraint named `files_user_id_fkey`
- Links the `user_id` column in `files` to the `id` column in the `users` table
- Specifies ON DELETE CASCADE behavior

### ALTER TABLE topics
#### Description
This statement adds a foreign key constraint to the `topics` table.

#### Internal Logic
- Adds a foreign key constraint named `topics_user_id_fkey`
- Links the `user_id` column in `topics` to the `id` column in the `users` table
- Specifies ON DELETE CASCADE behavior

## Side Effects
- The `chunk_metadata` table will have an additional column `author_id`
- Foreign key constraints will be reestablished, potentially affecting data integrity and deletion behavior in the referenced tables

## Dependencies
This migration script assumes the existence of the following tables:
- `chunk_metadata`
- `users`
- `user_organizations`
- `user_api_key`
- `files`
- `topics`
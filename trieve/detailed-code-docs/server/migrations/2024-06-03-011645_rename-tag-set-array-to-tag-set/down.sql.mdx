---
title: "down.sql"
---

## High-level description
This SQL script reverts the database schema changes made by the migration `2024-06-03-011645_rename-tag-set-array-to-tag-set`. It renames the `tag_set` column back to `tag_set_array` and adds a new `tag_set` column with a default value of NULL for the tables `chunk_metadata`, `files`, and `chunk_group`.

## Symbols
### `down.sql`
#### Description
This SQL script contains a series of `ALTER TABLE` statements that revert the database schema changes made in the corresponding `up.sql` migration file. It specifically targets three tables: `chunk_metadata`, `files`, and `chunk_group`.

#### Internal Logic
The script performs the following actions for each of the mentioned tables:

1. **Renames the `tag_set` column back to `tag_set_array`**: This reverts the renaming action likely performed in the `up.sql` file.
   - `ALTER TABLE table_name RENAME COLUMN tag_set TO tag_set_array;`

2. **Adds a new `tag_set` column with type `TEXT` and a default value of `NULL`**: This reintroduces the `tag_set` column, which might have been removed or repurposed in the `up.sql` file.
   - `ALTER TABLE table_name ADD COLUMN tag_set TEXT DEFAULT NULL;`

These actions suggest that the original migration (`up.sql`) might have involved changing the way tags are stored, perhaps from a simple text-based approach to a more structured array format. This "down" migration undoes those changes, restoring the schema to its previous state. 

---
title: "Overview"
---

## High-level description
This directory contains SQL migration files for adding a new table called `file_upload_completed_notifications` to the database schema. The migration is part of a series, as indicated by the timestamp in the directory name (2023-07-16-151652). The purpose of this migration is to introduce a new feature for tracking and managing notifications related to completed file uploads associated with specific collections and users.

## What does it do?
The migration creates a new table in the database to store notifications for users when file uploads are completed. Each notification is associated with a specific user and collection. The table keeps track of whether the user has read the notification and when it was created or last updated. This allows the system to inform users about completed file uploads and manage the notification status effectively.

When the migration is reversed, it removes this table from the database, effectively undoing the changes made by the initial migration.

## Key Files
The directory contains two important SQL files:

1. `up.sql`: This file contains the SQL commands to create the new `file_upload_completed_notifications` table. It defines the structure of the table, including columns for identification, user and collection association, read status, and timestamps.

2. `down.sql`: This file contains the SQL command to drop the `file_upload_completed_notifications` table, effectively reversing the changes made by the `up.sql` file.

## Dependencies
The migration scripts rely on the PostgreSQL database system, as evidenced by the use of PostgreSQL-specific data types like UUID.

## Configuration
The `file_upload_completed_notifications` table is configured with the following structure and default behaviors:

```sql
CREATE TABLE file_upload_completed_notifications (
    id UUID PRIMARY KEY,
    user_uuid UUID NOT NULL,
    collection_uuid UUID NOT NULL,
    user_read BOOLEAN NOT NULL DEFAULT false,
    created_at TIMESTAMP NOT NULL DEFAULT NOW(),
    updated_at TIMESTAMP NOT NULL DEFAULT NOW()
);
```

Key configuration details:
- The `id`, `user_uuid`, and `collection_uuid` fields use UUID data type for globally unique identifiers.
- The `user_read` field is a boolean defaulting to `false`, indicating an unread notification by default.
- Both `created_at` and `updated_at` fields default to the current timestamp (`NOW()`).

This configuration allows for efficient tracking and management of file upload completion notifications, enabling features such as:
- Associating notifications with specific users and collections
- Marking notifications as read or unread
- Sorting and filtering notifications based on creation or update times

The `down.sql` file is configured to safely remove the table if it exists:

```sql
DROP TABLE IF EXISTS file_upload_completed_notifications;
```

This ensures that the migration can be reversed without causing errors, even if the table has already been removed.
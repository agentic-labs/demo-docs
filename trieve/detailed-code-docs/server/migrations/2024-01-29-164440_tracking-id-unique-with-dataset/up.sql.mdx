---
title: "up.sql"
---

## High-level description
This SQL script modifies the `chunk_metadata` table by dropping the existing unique constraint on the `tracking_id` column and adding a new unique constraint on the combination of `tracking_id` and `dataset_id` columns. This change ensures that each `tracking_id` is unique within the scope of a specific `dataset_id`.

## Symbols

### `ALTER TABLE chunk_metadata DROP CONSTRAINT card_metadata_tracking_id_key`
#### Description
This statement drops the existing unique constraint named `card_metadata_tracking_id_key` from the `chunk_metadata` table. This constraint likely enforced the uniqueness of the `tracking_id` column.

#### Internal Logic
- `ALTER TABLE chunk_metadata`: This part specifies that the `chunk_metadata` table is being modified.
- `DROP CONSTRAINT card_metadata_tracking_id_key`: This part specifies the action (DROP) and the target constraint name (`card_metadata_tracking_id_key`).

### `ALTER TABLE chunk_metadata ADD CONSTRAINT chunk_metadata_tracking_id_dataset_id_key UNIQUE (tracking_id, dataset_id)`
#### Description
This statement adds a new unique constraint named `chunk_metadata_tracking_id_dataset_id_key` to the `chunk_metadata` table. This constraint enforces the uniqueness of the combination of `tracking_id` and `dataset_id` columns.

#### Internal Logic
- `ALTER TABLE chunk_metadata`: This part specifies that the `chunk_metadata` table is being modified.
- `ADD CONSTRAINT chunk_metadata_tracking_id_dataset_id_key`: This part specifies the action (ADD), the new constraint name (`chunk_metadata_tracking_id_dataset_id_key`), and the type (UNIQUE).
- `UNIQUE (tracking_id, dataset_id)`: This part defines the columns (`tracking_id`, `dataset_id`) included in the unique constraint. 

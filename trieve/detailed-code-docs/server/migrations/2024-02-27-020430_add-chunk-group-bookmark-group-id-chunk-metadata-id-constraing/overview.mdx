---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for modifying the `chunk_group_bookmarks` table in a database. The migration adds a unique constraint to ensure that for each `group_id`, the `chunk_metadata_id` is unique. This change helps maintain data integrity by preventing duplicate entries within a group.

## What does it do?
The migration scripts in this directory perform the following actions:

1. In the "up" migration:
   - It adds a unique constraint to the `chunk_group_bookmarks` table.
   - This constraint ensures that for each `group_id`, there can't be duplicate `chunk_metadata_id` values.
   - It helps prevent accidental duplication of chunk metadata within a group.

2. In the "down" migration:
   - It removes the unique constraint from the `chunk_group_bookmarks` table.
   - This allows the database to revert to its previous state if needed.

These changes affect how data can be inserted or updated in the `chunk_group_bookmarks` table. After applying the "up" migration, the database will enforce the uniqueness of `chunk_metadata_id` within each group, which can help maintain data consistency and prevent potential issues related to duplicate entries.

## Key Files

1. `up.sql`:
   - This file contains the SQL command to add the unique constraint to the `chunk_group_bookmarks` table.
   - The constraint is named `group_id_chunk_metadata_id_key`.
   - It uses the `ALTER TABLE` command to modify the existing table structure.

   ```sql
   ALTER TABLE chunk_group_bookmarks
   ADD CONSTRAINT group_id_chunk_metadata_id_key UNIQUE (group_id, chunk_metadata_id);
   ```

2. `down.sql`:
   - This file contains the SQL command to remove the unique constraint from the `chunk_group_bookmarks` table.
   - It uses the `ALTER TABLE` command to drop the constraint.

   ```sql
   ALTER TABLE chunk_group_bookmarks
   DROP CONSTRAINT group_id_chunk_metadata_id_key;
   ```

These files work together to provide a reversible database migration. The `up.sql` file applies the change, while the `down.sql` file allows for rolling back the change if necessary.

## Configuration
This migration doesn't require any specific configuration files or environment variables. However, it's important to note that the migration is designed for a specific database schema:

- Table name: `chunk_group_bookmarks`
- Columns involved: `group_id` and `chunk_metadata_id`

When applying this migration, ensure that:
1. The `chunk_group_bookmarks` table exists in the database.
2. The table has columns named `group_id` and `chunk_metadata_id`.
3. The database user executing the migration has the necessary permissions to alter the table structure.

It's also worth mentioning that the naming convention of the directory (2024-02-27-020430_add-chunk-group-bookmark-group-id-chunk-metadata-id-constraing) suggests that this migration was created on February 27, 2024, at 02:04:30. This timestamp-based naming is common in migration systems to ensure proper ordering of migrations.
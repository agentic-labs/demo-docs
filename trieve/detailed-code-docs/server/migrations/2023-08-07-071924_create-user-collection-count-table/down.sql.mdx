---
title: "down.sql"
---

## High-level description
This SQL script defines the "down" migration for reverting changes introduced by the "up" migration related to tracking user card collection counts. It drops the `user_collection_counts` table, the `update_collection_counts` function, and the `update_collection_counts_trigger` trigger.

## Code Structure
The script sequentially drops database objects in reverse order of their dependency. It first drops the trigger that depends on the function, then the function itself, and finally the table.

## Symbols

### `DROP TRIGGER IF EXISTS update_collection_counts_trigger ON card_collection`
#### Description
This statement drops the trigger named `update_collection_counts_trigger` on the `card_collection` table if it exists. The `IF EXISTS` clause ensures that the statement doesn't fail if the trigger doesn't exist.

#### Internal Logic
- Checks if a trigger named `update_collection_counts_trigger` exists on the `card_collection` table.
- If it exists, the trigger is dropped.
- If it doesn't exist, the statement does nothing.

### `DROP FUNCTION IF EXISTS update_collection_counts()`
#### Description
This statement drops the function named `update_collection_counts` if it exists. The `IF EXISTS` clause ensures that the statement doesn't fail if the function doesn't exist.

#### Internal Logic
- Checks if a function named `update_collection_counts` exists.
- If it exists, the function is dropped.
- If it doesn't exist, the statement does nothing.

### `DROP TABLE IF EXISTS user_collection_counts`
#### Description
This statement drops the table named `user_collection_counts` if it exists. The `IF EXISTS` clause ensures that the statement doesn't fail if the table doesn't exist.

#### Internal Logic
- Checks if a table named `user_collection_counts` exists.
- If it exists, the table is dropped.
- If it doesn't exist, the statement does nothing.

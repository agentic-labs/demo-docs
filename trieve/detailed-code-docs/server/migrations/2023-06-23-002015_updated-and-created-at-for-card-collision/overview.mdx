---
title: "Overview"
---

## High-level description
This directory contains SQL migration scripts for adding and removing timestamp columns (`created_at` and `updated_at`) to the `card_collisions` table in the database. The migration is dated 2023-06-23 and is identified by the timestamp 002015.

## What does it do?
These migration scripts modify the structure of the `card_collisions` table in the database. The "up" migration adds two new columns:
1. `created_at`: This column will store the timestamp when a record is created.
2. `updated_at`: This column will store the timestamp when a record is last updated.

Both columns are set to not allow null values and have a default value of the current timestamp when a new record is inserted.

The "down" migration does the opposite by removing these two columns from the table. This allows for reverting the changes if needed.

## Key Files
1. `up.sql`: This file contains the SQL commands to add the `created_at` and `updated_at` columns to the `card_collisions` table.

   ```sql
   ALTER TABLE card_collisions
   ADD COLUMN created_at TIMESTAMP NOT NULL DEFAULT NOW(),
   ADD COLUMN updated_at TIMESTAMP NOT NULL DEFAULT NOW();
   ```

2. `down.sql`: This file contains the SQL commands to remove the `created_at` and `updated_at` columns from the `card_collisions` table.

   ```sql
   ALTER TABLE card_collisions
   DROP COLUMN created_at,
   DROP COLUMN updated_at;
   ```

## Side Effects
When applying the "up" migration:
- The structure of the `card_collisions` table will be modified.
- Existing rows in the table will have their `created_at` and `updated_at` columns populated with the current timestamp at the time of migration.
- Future inserts into this table will automatically set these timestamp values.

When applying the "down" migration:
- The `created_at` and `updated_at` columns will be permanently removed from the `card_collisions` table.
- Any data stored in these columns will be lost.
- Applications or queries that rely on these columns will need to be updated to avoid errors.

## Performance Considerations
1. For the "up" migration:
   - Adding new columns to an existing table can be a potentially expensive operation, especially if the table contains a large number of rows.
   - The execution time of this migration may vary depending on the size of the `card_collisions` table.

2. For the "down" migration:
   - Dropping columns is generally a fast operation, but it may take longer if the table contains a large amount of data.
   - This operation may briefly lock the table, potentially affecting concurrent operations on the `card_collisions` table.

## Notes
- The `updated_at` column will need to be manually updated or managed through application logic or database triggers to reflect the actual last update time of each record. The migration scripts only handle the initial setup of these columns.
- When implementing these changes, it's important to update any related application code or database queries that interact with the `card_collisions` table to account for these new columns.
- Always test these migrations in a non-production environment before applying them to a production database to ensure they work as expected and don't cause any unintended side effects.
---
title: "up.sql"
---

## High-level description
This SQL script creates a new table named `verification_notifications` in the database. This table is designed to store information about notifications related to card verification, linking them to users, cards, and verification attempts.

## Code Structure
The code consists of a single SQL statement that defines the structure of the `verification_notifications` table, including its columns and their data types, constraints, and default values.

## Symbols

### `verification_notifications` table
#### Description
This table stores data about notifications generated during the card verification process. Each row represents a single notification and its associated details.

#### Columns
| Name | Type | Description |
|:-----|:-----|:------------|
| `id` | UUID | Unique identifier for the notification (Primary Key) |
| `user_uuid` | UUID | Foreign key referencing the `users` table, indicating the user associated with the notification |
| `card_uuid` | UUID | Foreign key referencing the `card_metadata` table, indicating the card related to the notification |
| `verification_uuid` | UUID | Foreign key referencing the `card_verification` table, linking the notification to a specific verification attempt |
| `similarity_score` | BigInt |  The similarity score calculated during the verification process |
| `user_read` | boolean | Flag indicating whether the user has read the notification (defaults to false) |
| `created_at` | TIMESTAMP | Timestamp indicating when the notification was created (defaults to current timestamp) |
| `updated_at` | TIMESTAMP | Timestamp indicating when the notification was last updated (defaults to current timestamp) |

#### Internal Logic
The script defines several constraints:

- `id UUID PRIMARY KEY`: Ensures each notification has a unique identifier (`id`) and designates it as the primary key.
- `user_uuid UUID NOT NULL REFERENCES users (id)`: Establishes a foreign key relationship with the `users` table, ensuring that each notification is associated with a valid user.
- `card_uuid UUID NOT NULL REFERENCES card_metadata (id)`: Establishes a foreign key relationship with the `card_metadata` table, linking each notification to a specific card.
- `verification_uuid UUID NOT NULL REFERENCES card_verification (id)`: Establishes a foreign key relationship with the `card_verification` table, connecting the notification to a particular verification attempt.

The script also sets default values for certain columns:

- `user_read boolean NOT NULL DEFAULT false`: By default, new notifications are marked as unread.
- `created_at TIMESTAMP NOT NULL DEFAULT NOW()`: The creation timestamp is automatically set to the current time.
- `updated_at TIMESTAMP NOT NULL DEFAULT NOW()`: The update timestamp is automatically set to the current time.

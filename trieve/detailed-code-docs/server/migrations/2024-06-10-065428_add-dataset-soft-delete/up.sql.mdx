---
title: "up.sql"
---

## High-level description
This SQL script adds a new column named `deleted` to the `datasets` table and creates an index on this column. This is a common pattern for implementing soft deletes in a database. 

## Symbols

### `ALTER TABLE datasets ADD COLUMN deleted INT DEFAULT 0 NOT NULL;`
#### Description
This SQL statement adds a new column named `deleted` to the `datasets` table. 

#### Internal Logic
* `ALTER TABLE datasets`: This part specifies that we are altering the existing table named `datasets`.
* `ADD COLUMN deleted`: This adds a new column to the table.
    * `deleted`: The name of the new column.
    * `INT`: The data type of the column is set to integer.
    * `DEFAULT 0`: The default value for the column is set to 0. This means that when a new row is inserted into the table and no value is provided for the `deleted` column, it will default to 0.
    * `NOT NULL`: This constraint ensures that the `deleted` column cannot be NULL. It must always contain a value.

### `CREATE INDEX IF NOT EXISTS idx_dataset_deleted ON datasets (deleted);`
#### Description
This SQL statement creates an index on the `deleted` column of the `datasets` table if one doesn't already exist.

#### Internal Logic
* `CREATE INDEX IF NOT EXISTS idx_dataset_deleted`: This part creates a new index if an index with the same name doesn't already exist.
    * `idx_dataset_deleted`: The name of the index being created.
* `ON datasets`: This specifies the table on which the index is being created.
* `(deleted)`: This specifies the column on which the index is being created. 

## Side Effects
This script modifies the database schema by adding a new column and an index to the `datasets` table. 

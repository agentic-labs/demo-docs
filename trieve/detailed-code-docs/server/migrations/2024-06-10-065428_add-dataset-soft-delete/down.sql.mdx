---
title: "down.sql"
---

## High-level description
This SQL migration file is designed to revert the changes made in the corresponding `up.sql` file. It removes the `deleted` column from the `datasets` table and drops the associated index, effectively undoing a soft delete functionality for datasets.

## Symbols

### ALTER TABLE datasets DROP COLUMN IF EXISTS deleted;
#### Description
This SQL command removes the `deleted` column from the `datasets` table if it exists.

#### Internal Logic
1. Checks if the `deleted` column exists in the `datasets` table.
2. If the column exists, it is removed from the table structure.
3. If the column doesn't exist, the command has no effect, preventing errors.

### DROP INDEX IF EXISTS idx_dataset_deleted;
#### Description
This SQL command drops the index named `idx_dataset_deleted` if it exists.

#### Internal Logic
1. Checks if the index `idx_dataset_deleted` exists.
2. If the index exists, it is removed from the database.
3. If the index doesn't exist, the command has no effect, preventing errors.

## Side Effects
- Removes the `deleted` column from the `datasets` table, which may have been used for soft delete functionality.
- Removes the `idx_dataset_deleted` index, which may have been used to optimize queries involving the `deleted` column.
- These changes could affect any queries or application logic that relied on the `deleted` column or its associated index.

## Performance Considerations
Dropping a column and an index are generally fast operations, but they may briefly lock the table during execution. The impact should be minimal unless the `datasets` table is very large or under heavy concurrent use during the migration.
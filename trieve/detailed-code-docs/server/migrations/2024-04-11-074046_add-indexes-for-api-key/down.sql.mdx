---
title: "down.sql"
---

## High-level description
This SQL migration file is designed to undo the changes made in the corresponding `up.sql` file. It removes two indexes that were previously created for the `user_api_key` table, specifically the indexes on the `api_key_hash` and `blake3_hash` columns.

## Symbols

### DROP INDEX IF EXISTS user_api_key_api_key_hash_index
#### Description
This SQL command removes the index named `user_api_key_api_key_hash_index` if it exists.

#### Internal Logic
- The `DROP INDEX` statement is used to remove an existing index from the database.
- `IF EXISTS` is used to prevent an error if the index doesn't exist.
- The index name `user_api_key_api_key_hash_index` suggests it was created on the `api_key_hash` column of the `user_api_key` table.

### DROP INDEX IF EXISTS user_api_key_blake3_hash_index
#### Description
This SQL command removes the index named `user_api_key_blake3_hash_index` if it exists.

#### Internal Logic
- Similar to the previous command, this `DROP INDEX` statement removes an existing index.
- `IF EXISTS` is used to prevent an error if the index doesn't exist.
- The index name `user_api_key_blake3_hash_index` suggests it was created on the `blake3_hash` column of the `user_api_key` table.

## Side Effects
- Removing these indexes will likely decrease the query performance for operations that were using these indexes, particularly for searches or lookups based on the `api_key_hash` and `blake3_hash` columns in the `user_api_key` table.
- The database size may slightly decrease due to the removal of the index structures.

## Performance Considerations
- After running this migration, queries that were previously using these indexes may become slower, especially for large datasets.
- The impact on write operations (INSERT, UPDATE, DELETE) on the `user_api_key` table may slightly improve, as the database no longer needs to update these indexes.

## Dependencies
This SQL script doesn't rely on any external libraries or modules. It uses standard SQL syntax that should be compatible with most relational database management systems.

## Error Handling
The `IF EXISTS` clause in both `DROP INDEX` statements provides a basic form of error handling. It prevents the script from failing if the indexes don't exist, allowing the migration to proceed even if the indexes were never created or were already removed.
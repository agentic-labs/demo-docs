---
title: "Overview"
---

## High-level description
This directory contains SQL migration files for adding a new `referral_tokens` column to the `invitations` table in the database. The migration is dated 2023-05-02 and is identified by the timestamp 043154. The directory includes both `up.sql` and `down.sql` files, which are used to apply and revert the migration, respectively.

## What does it do?
This migration modifies the database structure by adding a new capability to store referral token information within invitation records. Here's a simple explanation of what it does:

1. When applied (using the `up.sql` file), it adds a new column called `referral_tokens` to the `invitations` table. This column can store text data, which is likely used to keep track of referral tokens associated with each invitation.

2. If the migration needs to be reversed (using the `down.sql` file), it removes the `referral_tokens` column from the `invitations` table, effectively undoing the changes made by the `up.sql` file.

This change allows the system to associate referral information with invitations, which could be used for tracking or rewarding referrals in the application.

## Key Files

1. `up.sql`: This file contains the SQL command to add the `referral_tokens` column to the `invitations` table. Here's the content of the file:

   ```sql
   ALTER TABLE invitations
   ADD COLUMN referral_tokens TEXT;
   ```

   This command modifies the `invitations` table by adding a new `TEXT` column named `referral_tokens`.

2. `down.sql`: This file contains the SQL command to remove the `referral_tokens` column from the `invitations` table. Here's the content of the file:

   ```sql
   ALTER TABLE invitations
   DROP COLUMN referral_tokens;
   ```

   This command removes the `referral_tokens` column from the `invitations` table, effectively reverting the changes made by the `up.sql` file.

## Side Effects
Applying this migration will have the following side effects:

1. The schema of the `invitations` table will be modified.
2. Existing rows in the `invitations` table will have a `NULL` value for the new `referral_tokens` column since no default value is specified.
3. Applications or queries that rely on the structure of the `invitations` table may need to be updated to accommodate the new column.

Reverting this migration will permanently remove the `referral_tokens` column from the `invitations` table, along with any data stored in that column.

## Performance Considerations
1. Adding or dropping a column is generally a fast operation, especially when no default value is specified for the new column.
2. However, for very large tables, these operations might take some time and could potentially lock the table during the migration.
3. The impact on performance depends on the size of the table and the specific database system being used.

## Configuration
This migration does not require any specific configuration. However, it's important to note that:

1. The migration uses the `TEXT` data type for the `referral_tokens` column, which allows for storing strings of any length.
2. No default value or constraints are specified for the new column.

Depending on the application's requirements, you might want to consider the following in future migrations:

1. Adding a default value for the `referral_tokens` column.
2. Adding constraints to the `referral_tokens` column (e.g., NOT NULL, unique constraints).
3. Considering a more specific data type if the expected content of `referral_tokens` has a known maximum length or specific format.

When applying or reverting this migration, ensure that your database migration tool is correctly configured to use these SQL files in the appropriate order.
---
title: "up.sql"
---

## High-level description
This SQL script defines two tables, `stripe_plans` and `stripe_subscriptions`, to store information about Stripe subscription plans and the subscriptions associated with organizations. It specifies the schema for each table, including column names, data types, constraints, and relationships.

## Code Structure
The code defines two tables: `stripe_plans` and `stripe_subscriptions`. The `stripe_subscriptions` table has a foreign key relationship with the `stripe_plans` table through the `plan_id` column, indicating which plan a particular subscription belongs to. It also has a foreign key relationship with the `organizations` table through the `organization_id` column, linking the subscription to a specific organization.

## References
- `organizations` table (referenced in `stripe_subscriptions`)

## Symbols

### `stripe_plans`
#### Description
This table stores information about different Stripe subscription plans.

#### Inputs
N/A - This is a table definition, not a function.

#### Outputs
N/A - This is a table definition, not a function.

#### Internal Logic
The table schema defines the following columns:
- `id`: Unique identifier for the plan (UUID).
- `stripe_id`: Unique identifier from Stripe for the plan (TEXT).
- `card_count`: Number of cards allowed in this plan (INTEGER).
- `file_storage`: Amount of file storage included in this plan (INTEGER).
- `user_count`: Number of users allowed in this plan (INTEGER).
- `dataset_count`: Number of datasets allowed in this plan (INTEGER).
- `message_count`: Number of messages allowed in this plan (INTEGER).
- `amount`: Price of the plan (BIGINT).
- `created_at`: Timestamp of when the plan was created (TIMESTAMP).
- `updated_at`: Timestamp of when the plan was last updated (TIMESTAMP).

### `stripe_subscriptions`
#### Description
This table stores information about subscriptions to Stripe plans by organizations.

#### Inputs
N/A - This is a table definition, not a function.

#### Outputs
N/A - This is a table definition, not a function.

#### Internal Logic
The table schema defines the following columns:
- `id`: Unique identifier for the subscription (UUID).
- `stripe_id`: Unique identifier from Stripe for the subscription (TEXT).
- `plan_id`: Foreign key referencing the `id` of the subscribed plan in the `stripe_plans` table (UUID).
- `organization_id`: Foreign key referencing the `id` of the organization that owns the subscription in the `organizations` table (UUID).
- `created_at`: Timestamp of when the subscription was created (TIMESTAMP).
- `updated_at`: Timestamp of when the subscription was last updated (TIMESTAMP).

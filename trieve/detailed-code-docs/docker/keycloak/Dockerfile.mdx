---
title: "Dockerfile"
---

## High-level description
This Dockerfile defines a custom Keycloak image based on the official Keycloak 23.0.7 image. It adds a custom theme, imports a realm configuration, and sets up a custom entrypoint script for the container.

## Symbols

### FROM
#### Description
Specifies the base image for building the custom Keycloak container.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| quay.io/keycloak/keycloak:23.0.7 | Image | Official Keycloak image version 23.0.7 from Quay.io registry |

### WORKDIR
#### Description
Sets the working directory inside the container to `/opt/keycloak`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| /opt/keycloak | Path | Directory where Keycloak is installed in the container |

### COPY (Theme)
#### Description
Copies a custom theme named "trieve" into the Keycloak themes directory.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ./themes/trieve | Path | Source path of the custom theme |
| /opt/keycloak/themes/trieve | Path | Destination path in the container |

### COPY (Realm Export)
#### Description
Copies a realm export file into the container for importing during startup.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ./realm-export.json | File | Source realm configuration file |
| /imports/realm-export.json | Path | Destination path in the container |

### COPY (Entrypoint Script)
#### Description
Copies a custom Docker entrypoint script into the container.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ./docker-entrypoint.sh | File | Source entrypoint script |
| /docker-entrypoint.sh | Path | Destination path in the container |

### EXPOSE
#### Description
Informs Docker that the container will listen on port 8080 at runtime.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| 8080 | Port | The port number Keycloak will listen on |

### USER
#### Description
Sets the user ID to run the container processes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| 0 | User ID | Specifies that the container should run as root |

### ENTRYPOINT
#### Description
Specifies the command to run when the container starts.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ["/bin/bash"] | Command | Uses bash as the entrypoint shell |

### CMD
#### Description
Provides the default command to execute when running the container.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ["/docker-entrypoint.sh"] | Command | Executes the custom entrypoint script |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| Keycloak 23.0.7 | Base image for the custom Keycloak container |

## Configuration
The Dockerfile sets up the following configuration:
1. Custom theme named "trieve"
2. Realm configuration import from `realm-export.json`
3. Custom entrypoint script for container startup

## Side Effects
- The container runs as root (USER 0), which may have security implications.
- The default Keycloak port (8080) is exposed.

## Notes
- The custom entrypoint script (`docker-entrypoint.sh`) is not provided in this Dockerfile, but it's likely responsible for starting Keycloak with the imported realm configuration.
- Running as root (USER 0) is generally not recommended for security reasons. Consider using a non-root user if possible.
- The realm export file and custom theme are expected to be present in the build context.
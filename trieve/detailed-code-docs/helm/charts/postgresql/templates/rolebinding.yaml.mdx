---
title: "rolebinding.yaml"
---

## High-level description
This code defines a Kubernetes RoleBinding named after the release, which binds the PostgreSQL service account to the PostgreSQL Role. This allows the PostgreSQL instance to interact with the Kubernetes API server with the permissions defined in the Role. The RoleBinding is only created if the `rbac.create` value is set to true.

## Code Structure
This code uses a conditional statement to check the value of `rbac.create`. If true, it renders a Kubernetes RoleBinding manifest. The manifest references the service account name and uses helper templates for names, labels, and annotations.

## References
* `postgresql.v1.serviceAccountName`: Refers to a helper template that likely defines the name of the PostgreSQL service account.
* `common.names.fullname`: Refers to a helper template that likely generates the full name for the RoleBinding.
* `common.capabilities.rbac.apiVersion`: Refers to a helper template that likely defines the appropriate RBAC API version.
* `common.labels.standard`: Refers to a helper template that likely defines standard labels for the RoleBinding.
* `common.tplvalues.render`: Refers to a helper template that likely renders annotations.

## Symbols
### `helm/charts/postgresql/templates/rolebinding.yaml`
#### Description
This code defines a Kubernetes RoleBinding that grants permissions to the PostgreSQL service account. It uses a conditional statement to control the creation of the RoleBinding based on the `rbac.create` value.

#### Inputs
This code snippet doesn't define any explicit input parameters. It relies on values passed from the Helm chart engine, such as:
* `.Values.rbac.create`: A boolean value indicating whether RBAC resources should be created.
* `.Release.Namespace`: The Kubernetes namespace where the release is being installed.
* `.Values.commonLabels`: A dictionary of custom labels to apply to the RoleBinding.
* `.Values.commonAnnotations`: A dictionary of annotations to apply to the RoleBinding.

#### Outputs
This code outputs a Kubernetes RoleBinding manifest in YAML format if the `rbac.create` value is true.

#### Internal Logic
1. **Conditional Creation:** The code first checks the value of `.Values.rbac.create`. If it's true, it proceeds to render the RoleBinding manifest. Otherwise, it doesn't output anything.
2. **Manifest Generation:** If `rbac.create` is true, the code generates a RoleBinding manifest with the following key properties:
    * `kind`: Set to "RoleBinding".
    * `apiVersion`: Determined by the `common.capabilities.rbac.apiVersion` helper template.
    * `metadata`:
        * `name`: Set using the `common.names.fullname` helper template.
        * `namespace`: Set to the release namespace (`Release.Namespace`).
        * `labels`: Includes standard labels generated by `common.labels.standard` and any custom labels provided in `.Values.commonLabels`.
        * `annotations`: If `.Values.commonAnnotations` is provided, it's rendered using the `common.tplvalues.render` helper template.
    * `roleRef`:
        * `kind`: Set to "Role".
        * `name`: Set using the `common.names.fullname` helper template.
        * `apiGroup`: Set to "rbac.authorization.k8s.io".
    * `subjects`:
        * A list containing a single subject:
            * `kind`: Set to "ServiceAccount".
            * `name`: Set using the `postgresql.v1.serviceAccountName` helper template.
            * `namespace`: Set to the release namespace (`Release.Namespace`).

## Dependencies
This code snippet doesn't directly depend on any external libraries. However, it relies on Helm's templating engine and helper templates for generating the final manifest.

## Configuration
This code snippet doesn't define any specific configuration options. It relies on values passed from the Helm chart.

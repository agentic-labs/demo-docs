---
title: "serviceaccount.yaml"
---

## High-level description
This Kubernetes YAML file defines a ServiceAccount for a PostgreSQL deployment, but only if the `serviceAccount.create` value in the Helm chart's values.yaml is set to true. It sets up the service account with configurable metadata, labels, annotations, and controls whether the service account token is automatically mounted.

## Code Structure
This code defines a single Kubernetes resource, a ServiceAccount. It uses conditional logic based on Helm values to determine whether the resource should be created and to customize its properties.

## Symbols
### `serviceAccount.yaml`
#### Description
This file defines a Kubernetes ServiceAccount resource for a PostgreSQL deployment using Helm templating.

#### Inputs
This template uses values from a Helm values.yaml file. The relevant values are:

| Name | Type | Description |
|:-----|:-----|:------------|
| `serviceAccount.create` | boolean | Determines whether the ServiceAccount resource is created. |
| `serviceAccount.name` | string | The name of the ServiceAccount. Defaults to a generated name based on the release name and chart name. |
| `serviceAccount.namespace` | string | The namespace where the ServiceAccount will be created. Defaults to the Helm release namespace. |
| `serviceAccount.labels` | object |  A map of labels to apply to the ServiceAccount. Merges with standard labels from the `common.labels.standard` template. |
| `serviceAccount.annotations` | object | A map of annotations to apply to the ServiceAccount. Merges with common annotations from the `commonAnnotations` value. |
| `serviceAccount.automountServiceAccountToken` | boolean | Whether to automatically mount the service account token into pods using this ServiceAccount. |
| `commonLabels` | object | A map of labels to apply to all resources in the chart. |
| `commonAnnotations` | object | A map of annotations to apply to all resources in the chart. |

#### Outputs
This template renders a Kubernetes YAML manifest for a ServiceAccount resource if `serviceAccount.create` is true.

#### Internal Logic
1. **Conditional Creation:** The template first checks the value of `serviceAccount.create`. If it's true, it proceeds to render the ServiceAccount resource. Otherwise, it renders nothing.
2. **Metadata:** It sets the `name` and `namespace` of the ServiceAccount based on the provided values or defaults.
3. **Labels:** It applies labels to the ServiceAccount. It includes standard labels from the `common.labels.standard` template and merges them with any custom labels provided in `serviceAccount.labels`.
4. **Annotations:** Similar to labels, it applies annotations from both `serviceAccount.annotations` and `commonAnnotations`, merging them together.
5. **Automount Token:** It sets the `automountServiceAccountToken` field based on the `serviceAccount.automountServiceAccountToken` value.

## Dependencies
This template uses the following Helm template functions:

* `include`: Includes another template.
* `dict`: Creates a dictionary.
* `list`: Creates a list.
* `nindent`: Indents text.
* `quote`: Quotes a string.

## Side Effects
This template, when applied with `serviceAccount.create` set to true, creates a ServiceAccount resource in the Kubernetes cluster. 

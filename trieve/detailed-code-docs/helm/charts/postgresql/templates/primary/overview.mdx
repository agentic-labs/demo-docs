---
title: "Overview"
---

## High-level description
This directory contains Kubernetes resource definitions for deploying the primary instance of a PostgreSQL database using Helm. It includes configurations for ConfigMaps, Services, StatefulSet, NetworkPolicy, and monitoring resources.

## What does it do?
The templates in this directory work together to deploy and configure a primary PostgreSQL instance in a Kubernetes cluster. Here's a breakdown of the main components:

1. ConfigMaps: Store configuration files and initialization scripts for PostgreSQL.
2. Services: Expose the PostgreSQL instance within the cluster and optionally to external clients.
3. StatefulSet: Manages the deployment and scaling of the PostgreSQL primary instance.
4. NetworkPolicy: Controls network traffic to and from the PostgreSQL pod.
5. Monitoring: Sets up ServiceMonitor for Prometheus-based monitoring.

These resources ensure that the PostgreSQL primary instance is deployed with proper configuration, networking, and monitoring capabilities.

## Entry points
The main entry point for deploying the primary PostgreSQL instance is the `statefulset.yaml` file. This file defines the core deployment configuration, including container specifications, volume mounts, and pod management policies.

Other important files include:
- `svc.yaml` and `svc-headless.yaml`: Define services for accessing the PostgreSQL instance.
- `configmap.yaml` and `extended-configmap.yaml`: Store PostgreSQL configuration.
- `networkpolicy.yaml`: Controls network access to the PostgreSQL pod.
- `servicemonitor.yaml`: Sets up monitoring for the PostgreSQL instance.

## Key Files
1. `statefulset.yaml`: Defines the StatefulSet for deploying the primary PostgreSQL instance.
2. `svc.yaml`: Creates a regular Kubernetes Service for accessing the PostgreSQL instance.
3. `svc-headless.yaml`: Defines a headless Service for StatefulSet pod discovery.
4. `configmap.yaml`: Stores main PostgreSQL configuration files.
5. `extended-configmap.yaml`: Contains additional PostgreSQL configuration settings.
6. `networkpolicy.yaml`: Defines network access rules for the PostgreSQL pod.
7. `servicemonitor.yaml`: Sets up Prometheus monitoring for the PostgreSQL instance.

## Dependencies
The templates in this directory rely on the following external dependencies:
- Kubernetes: The underlying container orchestration platform.
- Helm: The package manager used for templating and deploying the PostgreSQL chart.
- Prometheus Operator: Required for the ServiceMonitor resource (optional, only if monitoring is enabled).

## Configuration
The templates in this directory are highly configurable through Helm values. Key configuration options include:

1. PostgreSQL version and image settings
2. Resource allocation (CPU, memory)
3. Persistence configuration
4. Networking options (service type, ports)
5. Security settings (RBAC, network policies)
6. Monitoring configuration
7. Initialization scripts and custom configurations

Refer to the `values.yaml` file in the parent directory for a complete list of configurable options.
---
title: "Overview"
---

## High-level description
This directory contains Kubernetes resource templates for deploying and managing the primary PostgreSQL instance in a Helm chart. It includes configurations for StatefulSets, Services, ConfigMaps, NetworkPolicies, and monitoring resources.

## What does it do?
The templates in this directory work together to deploy a primary PostgreSQL instance with the following capabilities:

1. Persistent storage and stateful deployment using a StatefulSet
2. Network access through regular and headless Services
3. Custom configuration via ConfigMaps
4. Initialization scripts for database setup
5. Metrics collection and monitoring
6. Network policy for controlling traffic
7. Flexible deployment options with various customizable settings

These resources allow for a robust, configurable, and production-ready PostgreSQL deployment in a Kubernetes environment.

## Key Files

1. **statefulset.yaml**: Defines the core PostgreSQL deployment as a StatefulSet, including container specifications, volume mounts, and environment variables.

2. **svc.yaml** and **svc-headless.yaml**: Create Kubernetes Services for network access to the PostgreSQL instance. The headless service is crucial for pod-to-pod communication within the StatefulSet.

3. **configmap.yaml** and **extended-configmap.yaml**: Provide custom configuration options for PostgreSQL through ConfigMaps.

4. **initialization-configmap.yaml**: Contains initialization scripts for setting up the database during first deployment.

5. **networkpolicy.yaml**: Defines network access rules for the PostgreSQL pods, enhancing security.

6. **metrics-svc.yaml** and **servicemonitor.yaml**: Set up resources for collecting and exposing PostgreSQL metrics, integrating with Prometheus for monitoring.

## Dependencies
The templates in this directory rely on several external libraries and tools:

1. Kubernetes: These templates are designed to work with Kubernetes cluster version 1.19+.
2. Helm: The chart uses Helm v3 for templating and deployment management.
3. PostgreSQL: The specific version of PostgreSQL is configurable, but the templates are designed to work with PostgreSQL 14.x and later.
4. Prometheus Operator: For the ServiceMonitor resource, which integrates with Prometheus for metrics collection.

## Configuration
The templates offer extensive configuration options through Helm values. Key configurable aspects include:

1. PostgreSQL version and settings
2. Resource allocation (CPU, memory)
3. Persistence configuration
4. Replication settings
5. Security settings (RBAC, NetworkPolicy)
6. Metrics and monitoring options
7. Custom initialization scripts
8. Service types and network configurations

Users can customize these settings in the `values.yaml` file or by passing values during Helm installation or upgrade.

The flexibility in configuration allows this chart to be used in various environments, from development to production, with appropriate settings for each scenario.
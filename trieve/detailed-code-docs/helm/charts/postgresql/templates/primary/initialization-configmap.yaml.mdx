---
title: "initialization-configmap.yaml"
---

## High-level description
This code defines a Kubernetes ConfigMap that holds initialization scripts for a PostgreSQL primary instance deployed using Helm. It is conditionally created based on the presence of `initdb.scripts` in the Helm values and the absence of `initdb.scriptsConfigMap`.

## Code Structure
The code uses conditional logic to determine whether to create the ConfigMap. If the conditions are met, it defines the ConfigMap with metadata and data.

## Symbols
### `helm/charts/postgresql/templates/primary/initialization-configmap.yaml`
#### Description
This code defines a Kubernetes ConfigMap named `&lt;release-name&gt;-init-scripts` in the namespace specified by `Release.Namespace`. The ConfigMap stores initialization scripts for a PostgreSQL primary instance.

#### Inputs
This code snippet does not define any explicit input parameters. It relies on Helm values passed during deployment.

#### Outputs
This code does not produce any direct output. It defines a Kubernetes ConfigMap resource.

#### Internal Logic
1. **Conditional Creation:** The ConfigMap is created only if:
    - `Values.primary.initdb.scripts` is defined (user provided initialization scripts).
    - `Values.primary.initdb.scriptsConfigMap` is not defined (user did not opt for a separate ConfigMap).
2. **Metadata:**
    - The `name` is set to `&lt;release-name&gt;-init-scripts`.
    - The `namespace` is set to the value of `Release.Namespace`.
    - `labels` are included from the `common.labels.standard` template, merging standard labels with custom labels from `Values.commonLabels`.
    - If `Values.commonAnnotations` are defined, they are included in the `annotations` section.
3. **Data:**
    - The `data` section is populated using the `common.tplvalues.render` template, which renders the content of `Values.primary.initdb.scripts` into the ConfigMap.

## Dependencies
- This code depends on Helm templates and functions for rendering values and including other templates.

## Configuration
This code relies on Helm values for configuration:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `Values.primary.initdb.scripts` | map |  | A map of initialization scripts to be loaded into the ConfigMap. |
| `Values.primary.initdb.scriptsConfigMap` | boolean |  | If true, a separate ConfigMap for initialization scripts is expected, and this ConfigMap will not be created. |
| `Values.commonLabels` | map |  | Custom labels to be applied to the ConfigMap. |
| `Values.commonAnnotations` | map |  | Custom annotations to be applied to the ConfigMap. |
| `Release.Namespace` | string |  | The Kubernetes namespace where the ConfigMap will be created. |

## Side Effects
- This code defines a Kubernetes ConfigMap resource in the cluster.

## TODOs
This code snippet does not contain any TODOs or notes.

---
title: "svc-headless.yaml"
---

## High-level description
This Kubernetes YAML file defines a headless service for the primary PostgreSQL instance in a deployment. It exposes the PostgreSQL port and allows other pods, even those not yet ready, to connect to the primary instance.

## Code Structure
The code defines a Kubernetes Service resource with metadata, spec, and annotations. The spec section defines the service type, port, and selector for the pods.

## Symbols
### `helm/charts/postgresql/templates/primary/svc-headless.yaml`
#### Description
This code defines a Kubernetes Service of type `ClusterIP` named `postgresql-v1-primary-svc-headless` in the namespace specified by `.Release.Namespace`. It exposes the PostgreSQL database on a dynamically allocated port and uses a selector to target pods labeled as `app.kubernetes.io/component: primary`.

#### Inputs
This template uses values from the `Values` object passed by Helm. Relevant values include:
* `.Release.Namespace`: The namespace where the service will be deployed.
* `.Values.commonLabels`: Common labels to apply to the service.
* `.Values.primary.service.headless.annotations`: Annotations specific to the headless service.
* `.Values.commonAnnotations`: Common annotations to apply to the service.
* `.Values.primary.podLabels`: Labels used to select the primary PostgreSQL pods.

#### Internal Logic
The template uses Helm's templating language to dynamically generate the service definition. It includes other templates like `postgresql.v1.primary.svc.headless`, `common.labels.standard`, `common.tplvalues.merge`, `common.tplvalues.render`, and `common.labels.matchLabels` to construct the final YAML output.

#### Side Effects
This code, when deployed, will create a new Kubernetes Service resource.

## Dependencies
This code depends on the following Helm libraries:
| Dependency | Purpose |
|:-----------|:--------|
| `common.labels.standard` | Provides standard labels for Kubernetes resources. |
| `common.tplvalues.merge` | Merges multiple values into a single dictionary. |
| `common.tplvalues.render` | Renders a template with given values. |
| `common.labels.matchLabels` | Generates label selectors for Kubernetes resources. |
| `postgresql.v1.primary.svc.headless` | Provides the name for the headless service. |
| `postgresql.v1.service.port` | Provides the port number for the PostgreSQL service. |

## Configuration
This code relies on configuration values passed through Helm's `Values` object. See the "Inputs" section for details on the specific values used.

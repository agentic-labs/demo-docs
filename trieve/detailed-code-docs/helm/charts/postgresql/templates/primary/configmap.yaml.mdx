---
title: "configmap.yaml"
---

## High-level description
This code defines a Kubernetes ConfigMap resource for a PostgreSQL primary instance deployed using Helm. It allows customization of PostgreSQL configuration files (`postgresql.conf` and `pg_hba.conf`) through user-provided values.

## Code Structure
The code uses conditional logic to include different parts of the ConfigMap definition based on the provided values. It leverages Helm template functions and includes to generate the final resource definition.

## References
* `postgresql.v1.primary.createConfigmap`: This appears to be a Helm template function or variable that determines whether to create the ConfigMap.
* `postgresql.v1.primary.fullname`: This likely refers to another template function or variable that generates the full name for the primary PostgreSQL instance.
* `common.labels.standard`: This is likely a template function that generates standard Kubernetes labels based on provided values.
* `common.tplvalues.render`: This appears to be a template function that renders values from the provided context.

## Symbols
### `configmap.yaml`
#### Description
This file defines a Kubernetes ConfigMap named `&lt;release-name&gt;-configuration` in the namespace specified by `.Release.Namespace`. It contains configuration files for a PostgreSQL primary instance.

#### Inputs
This template uses values from the provided Helm context, including:
* `.Release.Namespace`: The Kubernetes namespace for the deployment.
* `.Values.commonLabels`: Custom labels to apply to the ConfigMap.
* `.Values.commonAnnotations`: Custom annotations to apply to the ConfigMap.
* `.Values.primary.configuration`: User-provided content for the `postgresql.conf` file.
* `.Values.primary.pgHbaConfiguration`: User-provided content for the `pg_hba.conf` file.

#### Outputs
A Kubernetes ConfigMap resource definition in YAML format.

#### Internal Logic
1. **Conditional Creation:** The ConfigMap is created only if `postgresql.v1.primary.createConfigmap` evaluates to true.
2. **Name and Labels:** The ConfigMap is named using the release name and includes standard labels and any custom labels provided in `Values.commonLabels`.
3. **Annotations:** If `Values.commonAnnotations` are provided, they are added to the ConfigMap metadata.
4. **Configuration Data:**
    * If `Values.primary.configuration` is provided, it is used as the content of the `postgresql.conf` data key.
    * If `Values.primary.pgHbaConfiguration` is provided, it is used as the content of the `pg_hba.conf` data key.

## Dependencies
* This code depends on the Helm templating engine for rendering the final YAML output.

## Configuration
This template does not define any specific configuration options. However, it relies on values provided through the Helm context, as described in the Inputs section.

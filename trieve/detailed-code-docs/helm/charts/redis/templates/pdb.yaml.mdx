---
title: "pdb.yaml"
---

## High-level description
This code defines a Kubernetes PodDisruptionBudget (PDB) for a Redis deployment using Helm templating. It ensures a minimum number of Redis pods are available during maintenance operations like node draining, preventing complete service disruption. The PDB is only created if the `pdb.create` flag is set to true in the Helm values.

## Code Structure
This code does not define multiple interconnected symbols. It primarily uses conditional logic and Helm templating functions to generate a Kubernetes YAML manifest.

## Symbols
### `helm/charts/redis/templates/pdb.yaml`
#### Description
This code defines a Helm template for a Kubernetes PodDisruptionBudget (PDB) resource. It controls how many pods of a replicated application can be down simultaneously during voluntary disruptions.

#### Inputs
This code uses values from a Helm values file, likely passed during deployment. Key input values include:

| Name | Type | Description |
|:-----|:-----|:------------|
| `.Values.pdb.create` | boolean | Flag to enable/disable PDB creation. |
| `.Values.pdb.minAvailable` | integer or string | Minimum number/percentage of pods that must remain available. |
| `.Values.pdb.maxUnavailable` | integer or string | Maximum number/percentage of pods that can be unavailable. |
| `.Values.commonLabels` | object | Custom labels to apply to the PDB. |
| `.Values.commonAnnotations` | object | Custom annotations to apply to the PDB. |

#### Internal Logic
1. **Conditional Creation:** The PDB is created only if `.Values.pdb.create` is true.
2. **Metadata:**
   - The PDB name is generated using `template "common.names.fullname" .`, likely based on the release name and chart name.
   - The namespace is set using `include "common.names.namespace" .`.
   - Standard and custom labels are added using `include "common.labels.standard"` and `include "common.labels.matchLabels"` respectively.
   - If provided, common annotations are added using `include "common.tplvalues.render"`.
3. **PDB Spec:**
   - `minAvailable` and `maxUnavailable` are set based on the provided values, controlling the allowed disruption.
   - The `selector` field uses `include "common.labels.matchLabels"` to target the correct pods based on labels.

#### Side Effects
This code, when deployed via Helm, creates a PodDisruptionBudget resource in the Kubernetes cluster. This PDB then influences how deployments handle pod disruptions, potentially preventing accidental service outages.

## Dependencies
This code depends on Helm templating functions and likely references other template files for common labels, names, and namespaces.

## Configuration
Configuration is managed through Helm values files. Key configurable options include:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `pdb.create` | boolean |  | Enables/disables PDB creation. |
| `pdb.minAvailable` | integer or string |  | Minimum available pods during disruption. |
| `pdb.maxUnavailable` | integer or string |  | Maximum unavailable pods during disruption. |
| `commonLabels` | object |  | Custom labels for the PDB. |
| `commonAnnotations` | object |  | Custom annotations for the PDB. |

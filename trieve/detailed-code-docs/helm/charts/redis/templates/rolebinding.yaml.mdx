---
title: "rolebinding.yaml"
---

## High-level description
This code defines a Kubernetes RoleBinding named after the Helm chart's release name in the specified namespace. It binds the ServiceAccount associated with the Redis deployment to the Role with the same name, granting it the permissions defined in the Role. This RoleBinding is conditionally created based on the `rbac.create` value in the Helm chart's values file.

## Code Structure
This code defines a single Kubernetes resource, a RoleBinding. It uses Helm templating to dynamically generate the resource definition based on the values provided during deployment.

## References
* `include "common.capabilities.rbac.apiVersion" .`: References a helper template to determine the appropriate RBAC API version.
* `template "common.names.fullname" .`: References a helper template to generate the full name of the resource.
* `include "common.names.namespace" .`: References a helper template to determine the target namespace.
* `include "common.labels.standard" ( dict "customLabels" .Values.commonLabels "context" $ )`: References a helper template to generate standard labels.
* `include "common.tplvalues.render" ( dict "value" .Values.commonAnnotations "context" $ )`: References a helper template to render annotations.
* `template "redis.serviceAccountName" .`: References a helper template to retrieve the name of the Redis ServiceAccount.

## Symbols
### `helm/charts/redis/templates/rolebinding.yaml`
#### Description
This code defines a Kubernetes RoleBinding that associates a ServiceAccount with a Role, granting the ServiceAccount the permissions defined in the Role.

#### Inputs
This code uses values from the Helm chart's values file:
| Name | Type | Description |
|:-----|:-----|:------------|
| `.Values.rbac.create` | boolean | Determines whether the RoleBinding should be created. |
| `.Values.commonLabels` | object | Custom labels to apply to the RoleBinding. |
| `.Values.commonAnnotations` | object | Custom annotations to apply to the RoleBinding. |

#### Internal Logic
1. **Conditional Creation:** The RoleBinding is created only if `.Values.rbac.create` is true.
2. **Resource Definition:** The code defines a Kubernetes RoleBinding resource with the following properties:
    * `apiVersion`: Determined dynamically using the `common.capabilities.rbac.apiVersion` helper template.
    * `kind`: Set to `RoleBinding`.
    * `metadata.name`: Set to the full name of the release, generated using the `common.names.fullname` helper template.
    * `metadata.namespace`: Set to the target namespace, determined using the `common.names.namespace` helper template.
    * `metadata.labels`: Includes standard labels generated using the `common.labels.standard` helper template and any custom labels provided in `.Values.commonLabels`.
    * `metadata.annotations`: Includes any custom annotations provided in `.Values.commonAnnotations`, rendered using the `common.tplvalues.render` helper template.
    * `roleRef`: Specifies the Role to bind to, using the full name of the release generated by the `common.names.fullname` helper template.
    * `subjects`: Specifies the ServiceAccount to bind to, retrieved using the `redis.serviceAccountName` helper template.

## Dependencies
This code depends on the following Helm libraries:
| Dependency | Purpose |
|:-----------|:--------|
| `common.capabilities.rbac.apiVersion` | Determines the appropriate RBAC API version. |
| `common.names.fullname` | Generates the full name of the resource. |
| `common.names.namespace` | Determines the target namespace. |
| `common.labels.standard` | Generates standard labels. |
| `common.tplvalues.render` | Renders annotations. |
| `redis.serviceAccountName` | Retrieves the name of the Redis ServiceAccount. |

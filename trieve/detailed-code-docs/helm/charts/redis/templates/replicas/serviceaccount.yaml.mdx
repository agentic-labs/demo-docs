---
title: "serviceaccount.yaml"
---

## High-level description
This Kubernetes YAML file defines a ServiceAccount for Redis replicas when using a replication architecture and Sentinel is disabled. It sets up the service account with appropriate metadata, labels, and annotations.

## Code Structure
This code uses conditional logic to determine whether to create the ServiceAccount based on the values of `Values.replica.serviceAccount.create`, `Values.architecture`, and `Values.sentinel.enabled`. If the conditions are met, it defines the ServiceAccount with the specified properties.

## Symbols
### `helm/charts/redis/templates/replicas/serviceaccount.yaml`
#### Description
This code defines a Kubernetes ServiceAccount for Redis replicas in a replication architecture when Sentinel is not enabled. It sets up the service account with the necessary metadata, labels, and annotations.

#### Inputs
This code snippet doesn't have explicit inputs. It relies on values passed from Helm charts during deployment.

#### Outputs
This code generates a Kubernetes YAML configuration file for a ServiceAccount.

#### Internal Logic
1. **Conditional Creation:** The ServiceAccount is created only if the following conditions are met:
    - `Values.replica.serviceAccount.create` is true.
    - `Values.architecture` is set to "replication".
    - `Values.sentinel.enabled` is false.
2. **Metadata and Labels:** The ServiceAccount is assigned a name based on the `redis.replicaServiceAccountName` template and the namespace from `common.names.namespace`. It also includes standard labels from `common.labels.standard`.
3. **Annotations:** If `Values.replica.serviceAccount.annotations` or `Values.commonAnnotations` are defined, they are merged and applied as annotations to the ServiceAccount.

## Dependencies
This code depends on Helm templates and functions for generating the final YAML output. It also relies on values passed from the Helm chart during deployment.

## Configuration
This code relies on configuration values passed from the Helm chart, including:
| Option | Description |
|:-------|:------------|
| `Values.replica.serviceAccount.create` | Boolean value indicating whether to create the ServiceAccount. |
| `Values.architecture` | String value indicating the Redis architecture ("replication" in this case). |
| `Values.sentinel.enabled` | Boolean value indicating whether Redis Sentinel is enabled. |
| `Values.replica.serviceAccount.automountServiceAccountToken` | Boolean value indicating whether to automatically mount the service account token. |
| `Values.replica.serviceAccount.annotations` | Map of annotations specific to the replica service account. |
| `Values.commonAnnotations` | Map of common annotations to be applied to the service account. |

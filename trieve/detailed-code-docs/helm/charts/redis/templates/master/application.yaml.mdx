---
title: "application.yaml"
---

## High-level description
This code defines a Kubernetes YAML template for deploying a Redis master instance using Helm. It supports various configurations for deployment, persistence, authentication, TLS, resource limits, probes, and metrics collection.

## Code Structure
This template uses conditional logic based on provided Helm values to generate different parts of the deployment configuration. It defines a StatefulSet or Deployment for the Redis master, along with optional sidecar containers for metrics and init containers for volume permissions and system settings.

## References
This template references several other files and Helm functions, including:
- `common.capabilities.statefulset.apiVersion`: Determines the appropriate API version for StatefulSets.
- `common.names.fullname`, `common.names.namespace`: Generate namespaced resource names.
- `common.labels.standard`, `common.labels.matchLabels`: Manage labels for resources.
- `redis.createConfigmap`, `redis.image`, `redis.metrics.image`: Check for configmap creation and determine image names.
- `redis.masterServiceAccountName`, `redis.secretName`, `redis.secretPasswordKey`: Define service account and secret names.
- `common.affinities.pods`, `common.affinities.nodes`: Manage pod and node affinities.
- `redis.tlsCert`, `redis.tlsCertKey`, `redis.tlsCACert`, `redis.tlsDHParams`: Define paths to TLS certificates.
- `redis.volumePermissions.image`, `redis.sysctl.image`: Define images for init containers.
- `redis.configmapName`, `redis.tlsSecretName`: Define configmap and secret names.
- `common.storage.class`: Define storage class for persistent volumes.

## Symbols
### `helm/charts/redis/templates/master/application.yaml`
#### Description
This template defines the Kubernetes resources for deploying a Redis master instance. It uses Helm templating to dynamically generate the configuration based on provided values.

#### Inputs
This template takes a Helm values object as input, which can contain various configuration options defined in `values.schema.json`. Key configuration options include:
- `architecture`: Defines the Redis architecture (standalone or replication).
- `auth.enabled`: Enables password authentication for Redis.
- `auth.password`: Sets the Redis password.
- `master.kind`: Specifies the workload kind for master replicas (Deployment, StatefulSet, or DaemonSet).
- `master.persistence.enabled`: Enables persistence for master replicas using PersistentVolumeClaims.
- `master.persistence.size`: Sets the size of the PersistentVolumeClaim for master replicas.
- `replica.replicaCount`: Defines the number of Redis replicas (only applicable for `replication` architecture).
- `replica.persistence.enabled`: Enables persistence for Redis replicas.
- `replica.persistence.size`: Sets the size of the PersistentVolumeClaim for Redis replicas.
- `metrics.enabled`: Enables the Prometheus metrics exporter sidecar container.
- `tls.enabled`: Enables TLS encryption for Redis.

#### Outputs
This template renders a Kubernetes YAML file containing the following resources:
- A StatefulSet or Deployment for the Redis master instance.
- Optional sidecar containers for metrics collection.
- Optional init containers for setting volume permissions and system settings.
- PersistentVolumeClaims for data persistence (if enabled).
- ConfigMaps and Secrets for configuration and secrets management.

#### Internal Logic
The template uses conditional logic based on the provided Helm values to determine which resources to create and how to configure them. It leverages Helm functions and includes other templates to generate specific parts of the configuration.

## Side Effects
This template creates Kubernetes resources in the cluster when deployed using Helm.

## Dependencies
This template depends on the following Helm charts and Kubernetes APIs:
- `common`: Provides common templates and functions for resource management.
- `redis`: Provides Redis-specific templates and functions.
- `metrics`: Provides templates and functions for metrics collection.
- Kubernetes API: For deploying and managing resources like StatefulSets, Deployments, PersistentVolumeClaims, ConfigMaps, and Secrets.

### Configuration
This template uses a Helm values file for configuration. The available options are defined in the `values.schema.json` file.

## Error Handling
This template relies on Kubernetes' built-in error handling mechanisms for resource creation and management.

## Logging
This template does not implement specific logging mechanisms. Logging for the Redis instance and other containers is configured through their respective configuration files.

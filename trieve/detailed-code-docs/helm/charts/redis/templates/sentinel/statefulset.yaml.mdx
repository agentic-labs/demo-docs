---
title: "statefulset.yaml"
---

Here's a high-level description and documentation of the provided Kubernetes StatefulSet configuration for Redis replicas with Sentinel:

## High-level description

This YAML file defines a Kubernetes StatefulSet for deploying Redis replicas with Sentinel in a replication architecture. It sets up Redis nodes with configurable parameters for authentication, persistence, networking, and scaling. The configuration includes options for customizing probes, security contexts, affinity rules, and various other deployment aspects.

## Code Structure

The configuration is structured as a Kubernetes StatefulSet resource, with nested specifications for the Pod template, containers, volumes, and services. It uses Helm templating syntax extensively to allow for customization of various parameters.

## Symbols

### StatefulSet
#### Description
Defines a StatefulSet for Redis replicas with Sentinel.

#### Inputs
- Various Helm template values for customizing the deployment

#### Internal Logic
- Sets up Redis replica pods with configurable parameters
- Configures persistence, networking, security, and scaling options
- Includes container definitions for Redis, Sentinel, and optionally metrics exporter

### Containers
#### Redis Container
##### Description
Main container running the Redis server.

##### Internal Logic
- Configures Redis with custom settings
- Sets up authentication if enabled
- Mounts necessary volumes for data and configuration

#### Sentinel Container
##### Description
Container running Redis Sentinel for high availability.

##### Internal Logic
- Configures Sentinel with custom settings
- Sets up authentication if enabled
- Monitors Redis master and manages failover

#### Metrics Container (Optional)
##### Description
Optional container for exporting Redis metrics.

##### Internal Logic
- Runs a Redis exporter to collect and expose metrics
- Configures authentication and TLS if enabled

## Dependencies
- Bitnami Redis container images
- Kubernetes v1.23+
- Helm v3.8.0+

## Configuration
The StatefulSet configuration includes numerous options for customizing the Redis deployment, including:
- Authentication settings
- Persistence configuration
- Networking and service settings
- Resource allocation
- Security contexts
- Probes and health checks
- Affinity and anti-affinity rules
- Scaling and update strategies

## Error Handling
The configuration includes various probes (startup, liveness, readiness) to handle and recover from potential errors or failures in the Redis pods.

This documentation provides an overview of the main components and configuration options available in the Redis replica StatefulSet with Sentinel. For more detailed information on specific parameters, refer to the inline comments and the associated Helm chart documentation.
---
title: "ingress.yaml"
---

## High-level description
This code defines a Kubernetes Ingress resource for the Qdrant service using a Helm template. It allows external access to the Qdrant service based on the provided configuration values. The template conditionally creates the Ingress resource based on the `ingress.enabled` flag and supports customization for hosts, paths, TLS, and annotations.

## Code Structure
The code uses Helm templating to define an Ingress resource. It conditionally includes sections based on the values provided in the `Values` object, which is typically defined in a values.yaml file or passed during Helm installation. The template iterates over lists of hosts, paths, and TLS configurations to generate the corresponding Ingress rules.

## References
This template references the following values:
- `.Values.ingress.enabled`: A boolean flag indicating whether to enable the Ingress resource.
- `.Values.ingress.ingressClassName`: The name of the IngressClass to use for this Ingress.
- `.Values.ingress.hosts`: A list of host configurations, each defining a host name and paths.
- `.Values.ingress.additionalLabels`: Additional labels to apply to the Ingress resource.
- `.Values.ingress.annotations`: Annotations to apply to the Ingress resource.
- `.Values.ingress.tls`: A list of TLS configurations, each defining hosts and a secret name.
- `include "qdrant.fullname" .`: A Helm template function that returns the full name of the Qdrant release.
- `include "qdrant.labels" .`: A Helm template function that returns the default labels for the Qdrant release.

## Symbols
### `helm/charts/qdrant/templates/ingress.yaml`
#### Description
This code defines a Kubernetes Ingress resource for the Qdrant service using a Helm template. It allows external access to the Qdrant service based on the provided configuration values.

#### Inputs
This template uses values provided by the Helm values file.

#### Outputs
A Kubernetes Ingress resource configuration in YAML format.

#### Internal Logic
1. **Conditional Ingress Creation:** The template first checks if `.Values.ingress.enabled` is true. If true, it proceeds to create the Ingress resource.
2. **Metadata Definition:** It defines the metadata for the Ingress resource, including the name, labels, and annotations. The name is set using the `qdrant.fullname` template function. Labels include default Qdrant labels and any additional labels provided in `.Values.ingress.additionalLabels`. Annotations are applied from `.Values.ingress.annotations`.
3. **Ingress Class:** If `.Values.ingress.ingressClassName` is defined, it sets the `ingressClassName` for the Ingress resource.
4. **Rules Definition:** It iterates over the `.Values.ingress.hosts` list to define rules for each host.
    - For each host, it sets the `host` field and defines paths under `http.paths`.
    - For each path, it sets the `path`, `pathType` (defaults to "Prefix"), and `backend.service`.
    - The `backend.service.name` defaults to the Qdrant release name using `qdrant.fullname` template function.
    - The `backend.service.port.number` is set using the `servicePort` value from the host configuration.
5. **TLS Configuration:** If `.Values.ingress.tls` is defined, it configures TLS for the Ingress resource.
    - It iterates over the `.Values.ingress.tls` list to define TLS settings for each host.
    - For each TLS configuration, it sets the `hosts` and `secretName`.

## Dependencies
This code depends on the Kubernetes Ingress API version `networking.k8s.io/v1`. It also uses Helm template functions like `include` and `toYaml`.

## Configuration
This template uses values provided in the Helm values file, typically located at `values.yaml`. The following options are available for configuring the Ingress resource:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `ingress.enabled` | boolean | `false` | Enables or disables the creation of the Ingress resource. |
| `ingress.ingressClassName` | string | `""` | Sets the IngressClass to use for this Ingress. |
| `ingress.hosts` | list | `[]` | A list of host configurations, each defining a host name, paths, and optionally a service name and port. |
| `ingress.additionalLabels` | map | `{}` | Additional labels to apply to the Ingress resource. |
| `ingress.annotations` | map | `{}` | Annotations to apply to the Ingress resource. |
| `ingress.tls` | list | `[]` | A list of TLS configurations, each defining hosts and a secret name. | 

---
title: "Overview"
---

## High-level description
This directory contains Helm templates for deploying various components of the Trieve application to a Kubernetes cluster. The templates define Kubernetes resources such as Deployments, Services, Ingress rules, and ConfigMaps for different microservices and supporting infrastructure.

## What does it do?
These Helm templates automate the deployment and configuration of the Trieve application in a Kubernetes environment. They define how different components of the application should be deployed, scaled, and connected. The templates cover various aspects of the application, including:

1. Core services: dashboard, chat, search, and server components
2. Background workers: file worker, group worker, delete worker, and sync-qdrant
3. Supporting services: Apache Tika for content extraction
4. Databases: ClickHouse for analytics and potentially PostgreSQL (referenced but not directly deployed)
5. Authentication: Keycloak for identity and access management
6. Ingress configurations for different environments (local, AWS, Google Cloud)
7. Network policies and service configurations

The templates use conditional logic to adapt deployments based on the target environment (local, AWS, or Google Cloud), allowing for flexible and environment-specific configurations.

## Entry points
The main entry points for this directory are the individual template files, each defining specific Kubernetes resources. Some key files include:

1. `server-deployment.yaml`: Defines the deployment for the main server component.
2. `ingress-*.yaml` files: Define ingress rules for different environments.
3. `*-deployment.yaml` files: Define deployments for various microservices.
4. `*-service.yaml` files: Define services for exposing deployments within the cluster.

The deployment process would typically involve using Helm to render these templates and apply them to a Kubernetes cluster, with values provided through a `values.yaml` file or command-line arguments.

## Key Files
1. `server-deployment.yaml`: Defines the main server deployment, including environment variables and optional Cloud SQL proxy for Google Cloud deployments.

2. `ingress-aws.yaml`, `ingress-gcloud.yaml`, `ingress-local.yaml`: Define ingress rules for routing external traffic to services in different environments.

3. `clickhouse-deplolyment.yaml`: Configures the ClickHouse database deployment for analytics.

4. `keycloak.yaml` and `keycloak-realm-configmap.yaml`: Set up Keycloak for authentication and define the realm configuration.

5. `embeddings-deployment.yaml`: Deploys multiple text embedding inference services.

6. `syncqdrant-deployment.yaml`: Deploys a service for synchronizing data with the Qdrant vector database.

7. Various `*-deployment.yaml` and `*-service.yaml` files: Define deployments and services for different components of the application (dashboard, chat, search, file worker, group worker, etc.).

## Dependencies
The templates rely on several external dependencies and services:

1. Kubernetes: The underlying container orchestration platform.
2. Helm: The package manager for Kubernetes, used to template and deploy these resources.
3. Docker: Container runtime for running the application components.
4. ClickHouse: Columnar database used for analytics.
5. Keycloak: Identity and access management solution.
6. Qdrant: Vector database for storing and querying embeddings.
7. Redis: In-memory data store for caching and pub/sub.
8. PostgreSQL: Relational database for persistent data storage.
9. Apache Tika: Content extraction library.
10. Cloud-specific services: 
    - Google Cloud: Cloud SQL, Cloud SQL Proxy
    - AWS: Application Load Balancer (ALB)

## Configuration
The templates are highly configurable through Helm values. Key configuration areas include:

1. Environment selection: Determines which ingress and environment-specific configurations to apply.
2. Container image tags: Specifies versions of different service images.
3. API keys and credentials: Configures access to various services and APIs.
4. Database connection strings: Sets up connections to databases like PostgreSQL and ClickHouse.
5. Feature flags: Enables or disables certain features of the application.
6. Resource allocation: Defines CPU and memory requests/limits for containers.
7. Networking: Configures hostnames, ports, and internal service discovery.

These configurations are typically set in a `values.yaml` file or provided as command-line arguments when deploying with Helm.

The templates make extensive use of conditional logic to adapt deployments based on the target environment, allowing for flexible configuration across different deployment scenarios.
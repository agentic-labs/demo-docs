---
title: "ingress-local.yaml"
---

## High-level description
This Helm template defines Ingress resources for a Kubernetes cluster in a local environment. It sets up routing rules for different services (dashboard, chat, server, and search) using domain-based host routing.

## Code Structure
The file contains four separate Ingress resource definitions, each targeting a different service. They all share a common structure but differ in the host and backend service configuration.

## Symbols

### Ingress Resources
#### Description
Each Ingress resource defines routing rules for a specific service in the Kubernetes cluster. They use the NGINX ingress controller and set up path-based routing to direct traffic to the appropriate service.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| .Values.domain | String | The base domain for the Ingress hosts |
| .Values.environment | String | The environment setting, used to conditionally apply the Ingress resources |

#### Internal Logic
1. The template checks if the environment is "local" using an if statement.
2. If true, it defines four Ingress resources:
   - ingress-dashboard: Routes traffic for dashboard.{{ $domain }}
   - ingress-chat: Routes traffic for chat.{{ $domain }}
   - ingress-server: Routes traffic for api.{{ $domain }}
   - ingress-search: Routes traffic for search.{{ $domain }}
3. Each Ingress uses the NGINX ingress controller and sets up a single rule with a host and path.
4. The path for each Ingress is set to "/" with a Prefix path type, meaning it will match all requests for the specified host.
5. Each Ingress routes traffic to a corresponding service with a specified port.

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| .Values.domain | String | N/A | The base domain for Ingress hosts |
| .Values.environment | String | N/A | The environment setting, used to conditionally apply the Ingress resources |

## Notes
1. This template is specifically for the local environment, as indicated by the condition `{{- if eq .Values.environment "local" }}`.
2. The Ingress resources use the NGINX ingress controller, as specified by `ingressClassName: nginx`.
3. Each service (dashboard, chat, server, and search) is exposed on a subdomain of the main domain specified in `.Values.domain`.
4. The server service uses port 8090, while the others use port 80.
5. All paths are set to "/" with Prefix type, which means they will catch all requests for their respective hosts.
6. This template does not include any annotations or additional configurations like SSL/TLS, which might be necessary for production environments.
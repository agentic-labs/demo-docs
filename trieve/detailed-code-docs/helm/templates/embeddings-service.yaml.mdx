---
title: "embeddings-service.yaml"
---

## High-level description
This Helm template file defines Kubernetes Service resources for embedding services. It iterates over a list of embedding services defined in the Helm values and creates a corresponding Service for each one, allowing for network access to the embedding pods within the Kubernetes cluster.

## Code Structure
The template uses a range loop to iterate over the `.Values.embeddings` list. For each embedding service, it creates a Kubernetes Service resource with specific naming conventions and labels. The Services are separated by `---` when there are multiple services.

## Symbols

### Range Loop
#### Description
Iterates over the `.Values.embeddings` list to create a Service for each embedding service defined in the Helm values.

#### Internal Logic
1. Extracts `port` and `name` from each service in the `.Values.embeddings` list.
2. Generates a unique `serviceName` and `selector` for each service.
3. Creates a Kubernetes Service resource for each embedding service.

### Service Resource
#### Description
Defines a Kubernetes Service of type ClusterIP for each embedding service.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| $serviceName | string | Name of the service, formatted as "embedding-{name}" |
| $selector | string | Selector for the service, formatted as "embedding-{name}" |

#### Internal Logic
1. Sets the service name and labels.
2. Defines the service type as ClusterIP.
3. Configures a single port (80) for the service.
4. Sets the selector to match the corresponding pods.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| Helm | Template rendering and value substitution |
| Kubernetes | Target platform for the generated Service resources |

## Configuration
The template relies on values defined in the Helm chart's values file:

| Option | Type | Description |
|:-------|:-----|:------------|
| .Values.embeddings | list | List of embedding services to be created |
| .Release.Name | string | Name of the Helm release |

Each item in the `.Values.embeddings` list should have the following structure:
| Option | Type | Description |
|:-------|:-----|:------------|
| name | string | Name of the embedding service |
| port | integer | Port number for the service (not currently used in the template) |

## Notes
1. The `port` value extracted from each service is not currently used in the template. It always sets the port to 80.
2. The template uses the `---` separator to create multiple Service resources in a single YAML file when there is more than one embedding service.
3. The selector includes both the service-specific label and the Helm release name, ensuring proper pod selection within the release.
---
title: "embeddings-service.yaml"
---

## High-level description
This Kubernetes YAML file defines one or more `Service` objects for embedding services. Each service exposes a container on port 80 and uses a selector to route traffic to pods with matching labels. 

## Code Structure
The code uses a Go template range to iterate over a list of embedding services defined in the `Values.embeddings` variable. For each service, it creates a `Service` object with a unique name and selector based on the service's name.

## Symbols
### `helm/templates/embeddings-service.yaml`
#### Description
This code defines a Kubernetes Service resource for each embedding service specified in the `Values.embeddings` list. Each service exposes a port (default 80) and uses labels to select the corresponding pods.

#### Inputs
This code snippet doesn't have explicit inputs. It relies on values provided through the `Values.embeddings` variable, presumably from a Helm values file.

#### Outputs
The code generates Kubernetes YAML configurations for Services. Each generated Service object will have a unique name based on the embedding service name and will expose a port for accessing the service.

#### Internal Logic
1. **Iterate through Embeddings:** The code uses a `range` loop to iterate over each embedding service defined in `.Values.embeddings`.
2. **Extract Service Details:** For each service, it extracts the `port` and `name` values.
3. **Generate Service Name and Selector:** It dynamically creates a service name (e.g., `embedding-my-service`) and a selector using the service name.
4. **Define Service:** It defines a Kubernetes `Service` resource with the following key properties:
    - `name`: The generated service name.
    - `labels`: Labels for identifying the service.
    - `spec.type`: Set to `ClusterIP`, making the service internally accessible within the cluster.
    - `spec.ports`: Defines the port mapping, exposing port 80 for the service.
    - `spec.selector`: Uses labels to select pods belonging to this service.

## Dependencies
This code depends on the Helm templating engine for rendering the YAML and Kubernetes for deploying the generated Service objects.

### Configuration
The code relies on the following configuration options provided through `Values.embeddings`:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| `Values.embeddings` | list | N/A | A list of embedding service configurations. Each service configuration should include `name` and `port`. |
| `service.name` | string | N/A | The name of the embedding service. Used to generate the service name and selector. |
| `service.port` | int | N/A | The port number the embedding service is listening on. | 

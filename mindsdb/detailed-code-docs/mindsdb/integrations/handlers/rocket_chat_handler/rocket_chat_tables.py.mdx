---
title: "rocket_chat_tables.py"
---

## High-level description
This code defines several table classes for interacting with the Rocket Chat API. It provides functionality for selecting, inserting, and managing data related to channels, messages, direct messages, and users in Rocket Chat.

## Code Structure
The code defines five main classes: `ChannelsTable`, `ChannelMessagesTable`, `DirectsTable`, `DirectMessagesTable`, and `UsersTable`. These classes inherit from `APITable` and implement methods for selecting and inserting data. The `message_to_dataframe_row` function is a utility for converting message data to a DataFrame row format.

## Symbols

### `message_to_dataframe_row`
#### Description
This function converts a Rocket Chat message dictionary into a standardized format for use in DataFrame rows.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | dict | A dictionary containing Rocket Chat message data |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | dict | A modified dictionary with standardized keys |

#### Internal Logic
- Extracts and renames key fields from the input message
- Handles nested user information and bot data

### `ChannelsTable`
#### Description
Manages operations related to Rocket Chat channels.

#### Methods
1. `select`: Retrieves channel data from the Rocket Chat API.
2. `get_columns`: Returns the list of columns for the channels table.

### `ChannelMessagesTable`
#### Description
Handles operations for messages within Rocket Chat channels.

#### Methods
1. `select`: Retrieves message data for a specific channel.
2. `insert`: Posts a new message to a channel.
3. `get_columns`: Returns the list of columns for the channel messages table.

### `DirectsTable`
#### Description
Manages operations related to direct messages in Rocket Chat.

#### Methods
1. `select`: Retrieves data about direct message conversations.
2. `insert`: Creates a new direct message conversation.
3. `get_columns`: Returns the list of columns for the directs table.

### `DirectMessagesTable`
#### Description
Handles operations for direct messages in Rocket Chat.

#### Methods
1. `select`: Retrieves direct message data for a specific conversation.
2. `insert`: Posts a new direct message.
3. `get_columns`: Returns the list of columns for the direct messages table.

### `UsersTable`
#### Description
Manages operations related to Rocket Chat users.

#### Methods
1. `select`: Retrieves user data from the Rocket Chat API.
2. `get_columns`: Returns the list of columns for the users table.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Data manipulation and analysis |
| mindsdb_sql.parser | SQL query parsing |
| mindsdb.integrations.libs.api_handler | Base API handling functionality |
| mindsdb.integrations.utilities.sql_utils | SQL utility functions |

## Error Handling
The code implements basic error handling, such as raising `NotImplementedError` when required parameters are missing or when certain operations are not supported.

## API/Interface Reference
The code interacts with various Rocket Chat API endpoints:
- channels_list
- channels_history
- chat_post_message
- im_list
- im_create
- im_history
- users_info
- users_list

Each table class corresponds to a specific aspect of the Rocket Chat API, providing a SQL-like interface for interacting with Rocket Chat data.
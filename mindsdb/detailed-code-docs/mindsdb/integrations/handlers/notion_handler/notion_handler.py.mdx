---
title: "notion_handler.py"
---

## High-level description
This code implements a NotionHandler class for integrating Notion API with MindsDB. It provides functionality to connect to Notion, execute queries, and interact with Notion databases, pages, blocks, and comments.

## Code Structure
The NotionHandler class inherits from APIHandler and implements methods for connecting to Notion, checking the connection, and executing native queries. It also registers four table classes (NotionDatabaseTable, NotionPagesTable, NotionBlocksTable, NotionCommentsTable) to handle different Notion objects.

## Symbols

### NotionHandler
#### Description
The main handler class for Notion integration, responsible for connecting to the Notion API and managing table operations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The handler name |
| kwargs | dict | Connection arguments, including the API token |

#### Internal Logic
- Initializes the connection arguments and API token
- Registers table classes for different Notion objects
- Implements methods for connecting to Notion API and checking the connection
- Provides a method for executing native queries

### connect
#### Description
Establishes a connection to the Notion API using the provided API token.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args | Any | Optional arguments (not used) |
| kwargs | dict | Optional keyword arguments (not used) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| notion | Client | Notion API client object |

### check_connection
#### Description
Checks the connection to the Notion API by attempting to connect.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

### native_query
#### Description
Executes a native query on the Notion API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The native query string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Query execution response |

### call_notion_api
#### Description
Calls the Notion API with the specified method and parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| method_name | str | The API method to call |
| params | dict | Parameters for the API call |
| filters | list | Optional filters to apply |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| df | pd.DataFrame | Results of the API call as a DataFrame |

#### Internal Logic
- Parses the method name to determine the API endpoint
- Handles pagination and result limits
- Applies filters to the results
- Enriches the results with additional data if needed

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Data manipulation and analysis |
| notion_client | Notion API client |
| mindsdb.utilities | Logging utilities |
| mindsdb.integrations.libs.api_handler | Base APIHandler class |
| mindsdb.integrations.libs.response | Response handling utilities |

## Error Handling
The code implements basic error handling, particularly in the `check_connection` method, where it catches exceptions and returns an error message in the StatusResponse.

## API/Interface Reference
The NotionHandler class provides the following main methods for interacting with the Notion API:
| Method | Description |
|:-------|:------------|
| connect | Establishes a connection to the Notion API |
| check_connection | Checks the connection status |
| native_query | Executes a native query on the Notion API |
| call_notion_api | Makes a call to the Notion API with specified parameters |

These methods form the core interface for interacting with Notion data through MindsDB.
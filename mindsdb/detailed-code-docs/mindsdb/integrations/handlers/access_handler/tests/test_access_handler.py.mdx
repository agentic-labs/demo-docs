---
title: "test_access_handler.py"
---

## High-level description
This code defines a unit test class `AccessHandlerTest` for testing the `AccessHandler` class, which is responsible for handling connections and queries to Microsoft Access databases. The tests cover basic functionality such as checking connections, executing native queries, and retrieving table and column information.

## Code Structure
The `AccessHandlerTest` class contains several test methods that interact with an `AccessHandler` instance. The tests are designed to verify the core functionalities of the handler.

## References
This code references the `AccessHandler` class from the `mindsdb.integrations.handlers.access_handler.access_handler` module and the `RESPONSE_TYPE` enum from the `mindsdb.api.executor.data_types.response_type` module.

## Symbols

### `AccessHandlerTest`
#### Description
A test class that inherits from `unittest.TestCase`, designed to test the functionality of the `AccessHandler` class.

#### Internal Logic
The class sets up an `AccessHandler` instance in the `setUpClass` method and defines several test methods to verify different aspects of the handler's functionality.

___

### `setUpClass`
#### Description
A class method that sets up the test environment by creating an `AccessHandler` instance with test configuration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cls | class | The test class itself |

#### Internal Logic
- Creates a dictionary `kwargs` with a `db_file` path for an example Access database.
- Initializes an `AccessHandler` instance with a test name and the `kwargs`.

___

### `test_0_check_connection`
#### Description
Tests the `check_connection` method of the `AccessHandler`.

#### Internal Logic
Asserts that the `check_connection` method returns `True`, indicating a successful connection.

___

### `test_1_native_query_select`
#### Description
Tests the `native_query` method of the `AccessHandler` with a SELECT query.

#### Internal Logic
- Executes a SELECT query using the `native_query` method.
- Asserts that the result type is `RESPONSE_TYPE.TABLE`.

___

### `test_2_get_tables`
#### Description
Tests the `get_tables` method of the `AccessHandler`.

#### Internal Logic
- Calls the `get_tables` method.
- Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

___

### `test_3_get_columns`
#### Description
Tests the `get_columns` method of the `AccessHandler`.

#### Internal Logic
- Calls the `get_columns` method with a specific table name ('example_tbl').
- Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.access_handler.access_handler | Contains the AccessHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for checking response types |

## Error Handling
The tests use assertions to check for expected outcomes. If any assertion fails, the test will raise an `AssertionError`.

## Notes
1. The tests assume the existence of an Access database file at the specified path. Ensure this file exists and is accessible before running the tests.
2. The tests are numbered (0-3) to ensure a specific execution order, which might be important for the test suite's logic.
3. The `example_tbl` used in `test_3_get_columns` is assumed to exist in the test database. Make sure this table is present in your test database.

This test suite provides basic coverage for the main functionalities of the `AccessHandler` class, ensuring that it can connect to an Access database, execute queries, and retrieve schema information.
---
title: "access_handler.py"
---

## High-level description
This code implements an AccessHandler class, which is a database handler for Microsoft Access databases. It provides functionality to connect to an Access database, execute queries, and retrieve information about tables and columns.

## Code Structure
The AccessHandler class inherits from DatabaseHandler and implements various methods for database operations. It uses pyodbc for connecting to the Access database and pandas for handling data frames. The class also utilizes the mindsdb_sql library for SQL parsing and rendering.

## Symbols

### AccessHandler
#### Description
This class handles connections and executions of Microsoft Access database operations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | Optional[dict] | Parameters for connecting to the database |
| **kwargs | dict | Additional keyword arguments |

#### Internal Logic
- Initializes the handler with connection data and sets up the parser and dialect.
- Implements methods for connecting, disconnecting, checking connection, executing queries, and retrieving table and column information.

### connect
#### Description
Sets up the connection to the Microsoft Access database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | pyodbc.Connection | The established database connection |

### disconnect
#### Description
Closes the existing database connection.

### check_connection
#### Description
Checks the connection to the handler.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Status of the connection check |

### native_query
#### Description
Executes a raw SQL query on the Access database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | SQL query in native format |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query execution result |

### query
#### Description
Executes a query represented as an AST (Abstract Syntax Tree).

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | SQL query represented as AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query execution result |

### get_tables
#### Description
Retrieves a list of tables in the Access database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of table names |

### get_columns
#### Description
Retrieves a list of columns for a specified table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of column names and data types |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pyodbc | Connecting to and interacting with the Access database |
| pandas | Handling data frames for query results |
| mindsdb_sql | SQL parsing and rendering |
| sqlalchemy_access | Access dialect for SQLAlchemy |

## Error Handling
The code implements basic error handling using try-except blocks. Errors are logged using the logger and returned as part of the response objects.

## Logging
The code uses a logger (log.getLogger(__name__)) to log error messages, particularly when there are issues connecting to the database or executing queries.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
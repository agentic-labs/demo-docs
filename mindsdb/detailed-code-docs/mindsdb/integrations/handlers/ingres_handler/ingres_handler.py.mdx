---
title: "ingres_handler.py"
---

## High-level description
The `IngresHandler` class is a database handler for connecting to and interacting with Ingres databases. It provides methods for establishing connections, executing queries, and retrieving information about tables and columns in the database.

## Code Structure
The `IngresHandler` class inherits from `DatabaseHandler` and implements various methods for database operations. It uses the `pyodbc` library for database connectivity and `pandas` for data manipulation. The class also utilizes SQL parsing and rendering capabilities from the `mindsdb_sql` library.

## Symbols

### IngresHandler
#### Description
This class handles connections and executions of Ingres database statements. It provides methods for connecting to the database, executing queries, and retrieving metadata about tables and columns.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the database handler |
| **kwargs | dict | Connection parameters for the database |

#### Internal Logic
The class initializes connection parameters from the provided kwargs and sets up the necessary attributes for database interaction. It implements methods for connecting, disconnecting, checking connections, executing queries, and retrieving table and column information.

### connect
#### Description
Establishes a connection to the Ingres server using the provided connection parameters.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | pyodbc.Connection | The established database connection |

### check_connection
#### Description
Checks the connection to the Ingres server and returns a status response.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The status of the connection attempt |

### disconnect
#### Description
Closes the connection to the Ingres server if one is established.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| is_connected | bool | The connection status after disconnection |

### native_query
#### Description
Executes a raw SQL query on the Ingres database and returns the result.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### query
#### Description
Executes a query represented as an Abstract Syntax Tree (AST) on the Ingres database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The query represented as an AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### get_tables
#### Description
Retrieves a list of table names in the connected Ingres database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | A response containing a DataFrame of table names |

### get_columns
#### Description
Retrieves a list of column names for a specified table in the Ingres database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table to get column information for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | A response containing a DataFrame of column names |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pyodbc | For connecting to and interacting with the Ingres database |
| pandas | For data manipulation and creating DataFrames |
| mindsdb_sql | For SQL parsing and rendering |
| ingres_sa_dialect | For Ingres-specific SQL dialect |

## Error Handling
The code implements basic error handling using try-except blocks, particularly in the `check_connection` and `native_query` methods. Errors are logged using the `logger` object, and appropriate error responses are returned.

## Logging
The code uses a logger object (`logger`) to log error messages, particularly when there are issues connecting to the database or executing queries.

This documentation provides a comprehensive overview of the `IngresHandler` class and its functionalities for interacting with Ingres databases within the MindsDB framework.
---
title: "test_ingres_handler.py"
---

## High-level description
This code defines a unit test class `IngresHandlerTest` for testing the functionality of the `IngresHandler` class. It includes tests for various operations such as connecting to the database, retrieving tables and columns, executing queries, and performing database operations like creating tables and inserting data.

## Code Structure
The `IngresHandlerTest` class inherits from `unittest.TestCase` and contains several test methods. Each method tests a specific functionality of the `IngresHandler` class. The tests are designed to be run sequentially, as indicated by the numeric prefixes in the method names.

## References
This code references the `IngresHandler` class from the `mindsdb.integrations.handlers.ingres_handler.ingres_handler` module and the `RESPONSE_TYPE` enum from the `mindsdb.api.executor.data_types.response_type` module.

## Symbols

### IngresHandlerTest
#### Description
A test class for the `IngresHandler`, containing various test methods to verify the functionality of the handler.

#### Internal Logic
1. Sets up a class-level `IngresHandler` instance with test connection data.
2. Defines test methods for different operations:
   - Checking connection
   - Retrieving tables
   - Executing a select query
   - Getting columns
   - Dropping a table
   - Creating a table
   - Inserting data
   - Disconnecting from the database

### test_0_check_connection
#### Description
Tests the `check_connection` method of the `IngresHandler`.

#### Internal Logic
Asserts that the `check_connection` method returns a truthy value.

### test_1_get_tables
#### Description
Tests the `get_tables` method of the `IngresHandler`.

#### Internal Logic
Calls `get_tables` and asserts that the response type is not an error.

### test_2_select_query
#### Description
Tests the `native_query` method of the `IngresHandler` with a SELECT query.

#### Internal Logic
Executes a SELECT query and asserts that the response type is a table.

### test_3_get_columns
#### Description
Tests the `get_columns` method of the `IngresHandler`.

#### Internal Logic
Calls `get_columns` for a test table and asserts that the response type is not an error.

### test_4_drop_table
#### Description
Tests the `native_query` method for dropping a table.

#### Internal Logic
Executes a DROP TABLE query and asserts that the response type is not an error.

### test_5_create_table
#### Description
Tests the `native_query` method for creating a table.

#### Internal Logic
Executes a CREATE TABLE query and asserts that the response type is not an error.

### test_6_insert
#### Description
Tests the `native_query` method for inserting data into a table.

#### Internal Logic
Executes an INSERT query and asserts that the response type is not an error.

### test_7_disconnect
#### Description
Tests the `disconnect` method of the `IngresHandler`.

#### Internal Logic
Calls the `disconnect` method and asserts that it returns a truthy value.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.ingres_handler.ingres_handler | Contains the IngresHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for checking response types |

## Error Handling
The test methods use assertions to check for expected outcomes. If any assertion fails, the test will raise an `AssertionError`, indicating a test failure.
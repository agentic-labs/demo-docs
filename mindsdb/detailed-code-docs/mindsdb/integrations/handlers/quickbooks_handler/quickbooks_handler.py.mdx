---
title: "quickbooks_handler.py"
---

## High-level description
This code defines a `QuickbooksHandler` class that manages connections and interactions with the Quickbooks API. It inherits from `APIHandler` and provides methods for connecting to Quickbooks, checking the connection status, and executing native queries.

## Code Structure
The `QuickbooksHandler` class is the main component of this code. It initializes connection arguments, registers various Quickbooks-related tables, and provides methods for connecting to the API, checking the connection, and executing native queries.

## Symbols

### QuickbooksHandler
#### Description
This class handles connections and interactions with the Quickbooks API. It initializes connection arguments, registers Quickbooks-related tables, and provides methods for API operations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Optional name for the handler |
| **kwargs | dict | Additional keyword arguments, including connection_data |

#### Internal Logic
1. Initializes connection arguments from various sources (kwargs, environment variables, config).
2. Registers multiple Quickbooks-related tables (accounts, purchases, bill payments, vendors, bills, employees).
3. Provides methods for connecting to the API, checking the connection, and executing native queries.

### connect
#### Description
Establishes a connection to the Quickbooks API using the provided credentials.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| quickbooks | QuickbooksOnlineSDK | Connected Quickbooks SDK instance |

### check_connection
#### Description
Checks the connection to the Quickbooks API by attempting to retrieve accounts.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

### native_query
#### Description
Receives and processes a raw SQL query by parsing it and executing the query.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | Raw SQL query string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Query execution status response |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| qbosdk | Quickbooks Online SDK for API interactions |
| mindsdb_sql | SQL parsing library |
| pandas | Data manipulation library |

## Configuration
The handler uses the following configuration options:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| client_id | str | None | Quickbooks API client ID |
| client_secret | str | None | Quickbooks API client secret |
| refresh_token | str | None | Quickbooks API refresh token |
| realm_id | str | None | Quickbooks realm ID |
| environment | str | None | Quickbooks API environment |

These options can be provided through connection_data, environment variables, or a configuration file.

## Error Handling
The `check_connection` method implements error handling by catching exceptions and returning a `StatusResponse` with an error message if the connection fails.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging. It logs successful account retrieval and connection errors.

This handler provides a foundation for interacting with the Quickbooks API within the MindsDB framework, allowing for querying and manipulating Quickbooks data using SQL-like syntax.
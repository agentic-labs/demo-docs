---
title: "tdengine_handler.py"
---

## High-level description
This code defines a `TDEngineHandler` class, which is a database handler for TDEngine, a time-series database. The handler manages connections to TDEngine, executes SQL queries, and provides methods for retrieving table and column information.

## Code Structure
The `TDEngineHandler` class inherits from `DatabaseHandler` and implements methods for connecting to TDEngine, executing queries, and retrieving database metadata. It uses the `taosrest` library for database operations and the `mindsdb_sql` library for SQL parsing and rendering.

## References
- `mindsdb.integrations.libs.base.DatabaseHandler`
- `mindsdb.integrations.libs.response.HandlerStatusResponse`
- `mindsdb.integrations.libs.response.HandlerResponse`
- `mindsdb.integrations.libs.response.RESPONSE_TYPE`

## Symbols

### TDEngineHandler
#### Description
A handler class for managing connections and executing queries on TDEngine databases.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| connection_data | Optional[dict] | Connection details for the TDEngine database |

#### Internal Logic
1. Initializes connection parameters and parser
2. Implements methods for connecting, disconnecting, and checking connections
3. Provides methods for executing native queries and parsed SQL queries
4. Implements methods for retrieving table and column information

### connect
#### Description
Establishes a connection to the TDEngine database using the provided connection data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | taosrest.Connection | The established database connection |

### disconnect
#### Description
Closes the current database connection if one exists.

### check_connection
#### Description
Checks if a connection can be established with the TDEngine database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the TDEngine database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### query
#### Description
Executes a parsed SQL query on the TDEngine database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The parsed SQL query |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### get_tables
#### Description
Retrieves a list of all tables in the TDEngine database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The list of tables |

### get_columns
#### Description
Retrieves the column information for a specified table in the TDEngine database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The column information for the specified table |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| taosrest | TDEngine REST API client library |
| pandas | Data manipulation and analysis |
| mindsdb_sql | SQL parsing and rendering |

## Error Handling
The code implements basic error handling by catching exceptions in the `check_connection` and `native_query` methods. Errors are logged using the `logger` object and returned as part of the response.

## Logging
The code uses a logger object (`logger`) to log error messages when exceptions occur during connection checks or query execution.
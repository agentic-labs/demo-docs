---
title: "hsqldb_handler.py"
---

## High-level description
The HSQLDBHandler class is a database handler for connecting to and interacting with HyperSQL databases. It provides methods for establishing connections, executing queries, and retrieving data from HyperSQL databases within the MindsDB framework.

## Code Structure
The HSQLDBHandler class inherits from the DatabaseHandler base class and implements various methods for database operations. It uses pyodbc for database connectivity and pandas for data manipulation. The class includes methods for connecting, disconnecting, checking connections, executing native queries, and retrieving table and column information.

## Symbols

### HSQLDBHandler
#### Description
This class handles connections and executions of HyperSQL database statements. It provides methods for connecting to the database, executing queries, and retrieving metadata.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the particular handler instance |
| connection_data | dict | Parameters for connecting to the database |

#### Internal Logic
1. Initializes connection parameters from the provided connection data.
2. Sets up the connection string for pyodbc.
3. Implements methods for connecting, disconnecting, and checking connections.
4. Provides methods for executing native queries and retrieving table and column information.

### connect
#### Description
Establishes a connection to the HyperSQL database using the provided connection parameters.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | pyodbc.Connection | The established database connection |

### disconnect
#### Description
Closes the existing database connection if one is active.

### check_connection
#### Description
Checks the connection to the HyperSQL database by attempting to connect and then disconnecting if necessary.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the HyperSQL database and returns the result.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### query
#### Description
Executes a query represented as an abstract syntax tree (AST) on the HyperSQL database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The query represented as an AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The query execution result |

### get_tables
#### Description
Retrieves a list of tables from the HyperSQL database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | A list of table names |

### get_columns
#### Description
Retrieves the column information for a specified table in the HyperSQL database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table to get columns for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Column information for the specified table |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Data manipulation and DataFrame creation |
| pyodbc | Database connectivity for HyperSQL |
| mindsdb_sql | SQL parsing and rendering |
| mindsdb.integrations.libs.base | Base class for database handlers |
| mindsdb.integrations.libs.response | Response types for handler operations |
| mindsdb.utilities | Logging utilities |

## Error Handling
The class implements basic error handling, catching exceptions during connection attempts and query executions. Errors are logged and returned as part of the response objects.

## Logging
The class uses the MindsDB logging utility to log error messages during connection attempts and query executions.
---
title: "test_empress_handler.py"
---

## High-level description
This code defines a set of unit tests for the `EmpressHandler` class, which is responsible for interacting with an EmpressDB database. The tests cover basic functionality such as connecting to the database, retrieving tables and columns, executing queries, and handling errors.

## Code Structure
The `EmpressHandlerTest` class contains several test methods, each testing a specific aspect of the `EmpressHandler` class. The tests are independent and rely on a shared setup defined in the `setUpClass` method.

## References
- `mindsdb.integrations.handlers.empress_handler.empress_handler.EmpressHandler`: The class being tested.
- `mindsdb.api.executor.data_types.response_type.RESPONSE_TYPE`: An enum used to represent different response types from the handler.

## Symbols

### `EmpressHandlerTest`
#### Description
A class containing unit tests for the `EmpressHandler` class.

#### Inputs
None

#### Outputs
None

#### Internal Logic
This class defines several test methods, each testing a specific aspect of the `EmpressHandler` class. Each test method follows the arrange-act-assert pattern:

- **Arrange:** Sets up the necessary objects and data for the test.
- **Act:** Calls the method being tested.
- **Assert:** Verifies that the method under test behaves as expected.

Here's a breakdown of each test method:

- `test_0_check_connection`: Tests the `check_connection` method by asserting that it returns True.
- `test_1_get_tables`: Tests the `get_tables` method by asserting that the response type is not `RESPONSE_TYPE.ERROR`.
- `test_2_select_query`: Tests the `native_query` method with a SELECT query by asserting that the response type is `RESPONSE_TYPE.TABLE`.
- `test_3_get_columns`: Tests the `get_columns` method by asserting that the response type is not `RESPONSE_TYPE.ERROR`.
- `test_4_drop_table`: Tests the `native_query` method with a DROP TABLE query by asserting that the response type is not `RESPONSE_TYPE.ERROR`.
- `test_5_create_table`: Tests the `native_query` method with a CREATE TABLE query by asserting that the response type is not `RESPONSE_TYPE.ERROR`.
- `test_6_insert`: Tests the `native_query` method with an INSERT query by asserting that the response type is not `RESPONSE_TYPE.ERROR`.
- `test_7_disconnect`: Tests the `disconnect` method by asserting that it returns True.

## Dependencies
- `unittest`: The standard Python unit testing framework.
- `mindsdb.integrations.handlers.empress_handler.empress_handler`: The module containing the `EmpressHandler` class.
- `mindsdb.api.executor.data_types.response_type`: The module containing the `RESPONSE_TYPE` enum.

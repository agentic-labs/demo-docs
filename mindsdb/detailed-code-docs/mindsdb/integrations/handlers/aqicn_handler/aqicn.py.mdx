---
title: "aqicn.py"
---

## High-level description
This code defines an `AQIClient` class that interacts with the World Air Quality Index (WAQI) API. It provides methods to fetch air quality data for specific cities, geographical coordinates, and the user's current location.

## Symbols

### `AQIClient`
#### Description
A client class for interacting with the World Air Quality Index (WAQI) API. It encapsulates the API key and provides methods to make requests to different endpoints of the API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| api_key | str | The API key for authenticating requests to the WAQI API |

#### Internal Logic
The class initializes with an API key and sets up the base endpoint URL and request parameters. It provides methods to make API requests and retrieve air quality data for different scenarios.

___

### `AQIClient.make_request`
#### Description
A helper method that makes HTTP GET requests to the WAQI API and processes the response.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| url | str | The full URL for the API endpoint |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| content | dict | A dictionary containing the API response and HTTP status code |

#### Internal Logic
1. Makes a GET request to the specified URL with the API key as a parameter.
2. Parses the JSON response.
3. Returns a dictionary with the response content and an appropriate status code (200 for success, 404 for failure).

___

### `AQIClient.air_quality_city`
#### Description
Retrieves air quality data for a specified city.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| city | str | The name of the city for which to fetch air quality data |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| content | dict | A dictionary containing the API response and HTTP status code |

#### Internal Logic
Constructs the appropriate URL for the city endpoint and calls `make_request` to fetch the data.

___

### `AQIClient.air_quality_lat_lng`
#### Description
Retrieves air quality data for specified geographical coordinates.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| lat | float | The latitude coordinate |
| lng | float | The longitude coordinate |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| content | dict | A dictionary containing the API response and HTTP status code |

#### Internal Logic
Constructs the appropriate URL for the geo-coordinates endpoint and calls `make_request` to fetch the data.

___

### `AQIClient.air_quality_user_location`
#### Description
Retrieves air quality data for the user's current location.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| content | dict | A dictionary containing the API response and HTTP status code |

#### Internal Logic
Constructs the appropriate URL for the user's location endpoint and calls `make_request` to fetch the data.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| requests | Used to make HTTP requests to the WAQI API |

## Error Handling
The code implements basic error handling by checking the "status" field in the API response. If the status is not "ok", it returns a 404 status code along with the response content.

## API/Interface Reference
The `AQIClient` class provides the following methods for interacting with the WAQI API:

| Method | Parameters | Description |
|:-------|:-----------|:------------|
| air_quality_city | city (str) | Fetches air quality data for a specific city |
| air_quality_lat_lng | lat (float), lng (float) | Fetches air quality data for specific geographical coordinates |
| air_quality_user_location | None | Fetches air quality data for the user's current location |

Each method returns a dictionary containing the API response and an HTTP status code.
---
title: "ingest.py"
---

## High-level description
This code defines a `RAGIngestor` class that processes input data (from a DataFrame and/or URL) and creates a vector store using specified embeddings models. It's designed to support Retrieval-Augmented Generation (RAG) systems by preparing and storing embedded documents for efficient retrieval.

## Code Structure
The `RAGIngestor` class is the main component, with methods for splitting documents, creating vector stores, and managing the ingestion process. It relies on various utility functions and classes defined in the `settings.py` file for configuration, validation, and vector store operations.

## Symbols

### `RAGIngestor`
#### Description
A class that handles the ingestion of data into a vector store for RAG applications.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args | RAGBaseParameters | Configuration parameters for the ingestion process |
| df | pd.DataFrame | Input data to be processed |

#### Internal Logic
1. Initializes with configuration and input data.
2. Splits documents into chunks.
3. Creates a vector store from the documents using the specified embeddings model.
4. Saves the vector store to disk.

### `RAGIngestor.split_documents`
#### Description
Splits the input documents into smaller chunks for processing.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chunk_size | int | The size of each chunk |
| chunk_overlap | int | The overlap between chunks |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| texts | List[Document] | List of split document chunks |

### `RAGIngestor.create_db_from_documents`
#### Description
Creates a vector store from the provided documents.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| documents | List[Document] | List of documents to be embedded |
| embeddings_model | Embeddings | The embeddings model to use |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| db | VectorStore | The created vector store |

### `RAGIngestor.embeddings_to_vectordb`
#### Description
Main method to process documents and create a vector store.

#### Internal Logic
1. Splits documents into chunks.
2. Loads the embeddings model.
3. Creates a vector store from the documents.
4. Saves the vector store to disk.
5. Logs the process details and timing information.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Data manipulation |
| langchain | Document processing and vector store operations |
| mindsdb.integrations.handlers.rag_handler.settings | Configuration and utility functions |
| mindsdb.utilities | Logging |

## Error Handling
The code includes basic error handling, raising exceptions for invalid documents or errors during vector store creation.

## Logging
The code uses the `mindsdb.utilities.log` module for logging information about the ingestion process, including timing and document statistics.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
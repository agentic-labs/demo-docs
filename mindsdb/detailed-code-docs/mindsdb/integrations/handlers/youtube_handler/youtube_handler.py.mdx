---
title: "youtube_handler.py"
---

## High-level description
This code implements a YouTube handler for MindsDB, allowing interaction with the YouTube API. It provides functionality to connect to the YouTube API, manage authentication, and perform operations on YouTube data such as comments, channels, and videos.

## Code Structure
The `YoutubeHandler` class inherits from `APIHandler` and sets up the connection to the YouTube API. It registers three tables: comments, channels, and videos, each represented by a separate class. The handler manages authentication using Google OAuth2 and provides methods for connecting, checking connection status, and executing native queries.

## Symbols

### YoutubeHandler
#### Description
The main class that handles the connection to the YouTube API and manages the interaction with YouTube data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | dict | Connection details including credentials and API token |

#### Internal Logic
1. Initializes the handler with connection data and credentials.
2. Sets up authentication using GoogleUserOAuth2Manager.
3. Registers three tables: comments, channels, and videos.
4. Provides methods for connecting, checking connection, and executing queries.

### connect
#### Description
Establishes a connection to the YouTube API using the provided credentials.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | object | YouTube API connection object |

### check_connection
#### Description
Verifies the connection to the YouTube API.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

### native_query
#### Description
Processes a raw SQL query by parsing it and executing it using the query method.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | Raw SQL query string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Query execution status and results |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| googleapiclient.discovery | Building the YouTube API client |
| mindsdb_sql | Parsing SQL queries |
| mindsdb.integrations.libs.api_handler | Base class for API handlers |
| mindsdb.utilities.config | Accessing configuration settings |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| credentials_url | str | None | URL to OAuth2 credentials |
| credentials_file | str | None | Location of OAuth2 credentials file |
| youtube_api_token | str | None | YouTube API token |
| scopes | list | DEFAULT_SCOPES | OAuth2 scopes for YouTube API access |

## Error Handling
The code implements basic error handling in the `check_connection` method, catching exceptions and logging errors when connecting to the YouTube API.

## API/Interface Reference
The handler exposes three main tables for interacting with YouTube data:
| Table | Description |
|:------|:------------|
| comments | Handles YouTube video comments |
| channels | Handles YouTube channel data |
| videos | Handles YouTube video data |

These tables are registered using the `_register_table` method and can be queried using SQL-like syntax through the MindsDB interface.
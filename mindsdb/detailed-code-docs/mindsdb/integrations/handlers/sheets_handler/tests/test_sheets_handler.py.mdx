---
title: "test_sheets_handler.py"
---

## High-level description
This code defines a unit test class `SheetsHandlerTest` for testing the `SheetsHandler` class, which is responsible for handling connections and queries to Google Sheets. The tests cover basic functionality such as connection checking, executing native queries, and retrieving table and column information.

## Code Structure
The `SheetsHandlerTest` class contains four test methods that interact with an instance of `SheetsHandler`. Each test method focuses on a specific functionality of the handler.

## References
This code references the `SheetsHandler` class from the `mindsdb.integrations.handlers.sheets_handler.sheets_handler` module and the `RESPONSE_TYPE` enum from the `mindsdb.api.executor.data_types.response_type` module.

## Symbols

### `SheetsHandlerTest`
#### Description
A test class that inherits from `unittest.TestCase`, designed to test the functionality of the `SheetsHandler` class.

#### Internal Logic
The class sets up a `SheetsHandler` instance in the `setUpClass` method, which is used across all test methods. It then defines four test methods to check different aspects of the handler's functionality.

### `setUpClass`
#### Description
A class method that initializes the `SheetsHandler` instance with test configuration data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cls | class | The test class itself |

#### Internal Logic
- Creates a dictionary `kwargs` with test configuration data (spreadsheet ID and sheet name).
- Initializes a `SheetsHandler` instance with the test configuration.

### `test_0_check_connection`
#### Description
Tests the `check_connection` method of the `SheetsHandler`.

#### Internal Logic
Asserts that the `check_connection` method returns `True`, indicating a successful connection.

### `test_1_native_query_select`
#### Description
Tests the `native_query` method of the `SheetsHandler` with a SELECT query.

#### Internal Logic
- Executes a SELECT query on the "iris" sheet.
- Asserts that the result type is `RESPONSE_TYPE.TABLE`.

### `test_2_get_tables`
#### Description
Tests the `get_tables` method of the `SheetsHandler`.

#### Internal Logic
- Calls the `get_tables` method.
- Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

### `test_3_get_columns`
#### Description
Tests the `get_columns` method of the `SheetsHandler`.

#### Internal Logic
- Calls the `get_columns` method.
- Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.sheets_handler.sheets_handler | Contains the SheetsHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for checking response types |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| spreadsheet_id | str | "12wgS-1KJ9ymUM-6VYzQ0nJYGitONxay7cMKLnEE2_d0" | The ID of the Google Sheet to be tested |
| sheet_name | str | "iris" | The name of the specific sheet within the Google Sheet |

These configuration options are used to initialize the `SheetsHandler` for testing.
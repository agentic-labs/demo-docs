---
title: "Overview"
---

## High-level description
This directory contains unit tests for the SheetsHandler class, which is responsible for handling connections and queries to Google Sheets. The tests are designed to verify the basic functionality of the SheetsHandler, including connection checking, executing native queries, and retrieving table and column information.

## What does it do?
The tests in this directory ensure that the SheetsHandler works correctly when interacting with Google Sheets. They verify that:

1. The handler can establish a connection to a Google Sheet.
2. It can execute SELECT queries on a specific sheet within the Google Sheet.
3. It can retrieve a list of available tables (sheets) from the Google Sheet.
4. It can fetch column information for a specific sheet.

These tests help maintain the reliability and functionality of the SheetsHandler, ensuring that it performs as expected when integrated into the larger MindsDB system.

## Key Files

### test_sheets_handler.py
This file contains the `SheetsHandlerTest` class, which is the main test suite for the SheetsHandler. It includes the following test methods:

1. `test_0_check_connection`: Verifies that the handler can successfully connect to the Google Sheet.
2. `test_1_native_query_select`: Tests the execution of a SELECT query on a specific sheet.
3. `test_2_get_tables`: Checks if the handler can retrieve a list of available tables (sheets).
4. `test_3_get_columns`: Ensures that the handler can fetch column information for a specific sheet.

The test class uses a shared `SheetsHandler` instance, which is initialized in the `setUpClass` method with test configuration data.

## Dependencies
The test suite relies on the following dependencies:

1. `unittest`: The Python standard library's testing framework used to structure and run the tests.
2. `mindsdb.integrations.handlers.sheets_handler.sheets_handler`: Contains the `SheetsHandler` class being tested.
3. `mindsdb.api.executor.data_types.response_type`: Provides the `RESPONSE_TYPE` enum for checking response types.

## Configuration
The tests use the following configuration options to initialize the `SheetsHandler`:

| Option | Type | Value | Description |
|:-------|:-----|:------|:------------|
| spreadsheet_id | str | "12wgS-1KJ9ymUM-6VYzQ0nJYGitONxay7cMKLnEE2_d0" | The ID of the Google Sheet used for testing |
| sheet_name | str | "iris" | The name of the specific sheet within the Google Sheet |

These configuration options are hardcoded in the `setUpClass` method of the `SheetsHandlerTest` class. They specify which Google Sheet and which specific sheet within that spreadsheet should be used for running the tests.

It's worth noting that using hardcoded values for testing purposes is generally not considered best practice, as it may lead to issues if the test data changes or becomes unavailable. In a production environment, it would be better to use environment variables or a separate configuration file to store these values, making the tests more flexible and easier to maintain.
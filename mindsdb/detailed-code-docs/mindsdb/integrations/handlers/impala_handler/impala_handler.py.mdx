---
title: "impala_handler.py"
---

## High-level description
This code implements an ImpalaHandler class, which is a database handler for connecting to and interacting with Apache Impala databases. It provides methods for connecting, executing queries, and retrieving table and column information from Impala databases.

## Code Structure
The ImpalaHandler class inherits from DatabaseHandler and implements various methods for database operations. It uses the impala.dbapi and impala.sqlalchemy libraries for database connectivity and query execution. The class also utilizes the mindsdb_sql library for SQL parsing and rendering.

## Symbols

### ImpalaHandler
#### Description
This class handles connections and executions of Impala statements. It provides methods for connecting to the database, executing queries, and retrieving metadata.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| connection_data | Optional[dict] | Connection details for the Impala database |

#### Internal Logic
- Initializes connection parameters and parser
- Implements methods for connecting, disconnecting, and checking connections
- Provides methods for executing native queries and parsed SQL queries
- Implements methods for retrieving table and column information

### connect
#### Description
Establishes a connection to the Impala database using the provided connection data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | impala.dbapi.Connection | The established database connection |

### disconnect
#### Description
Closes the current database connection if one exists.

### check_connection
#### Description
Checks if a connection can be established with the Impala database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the Impala database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### query
#### Description
Executes a parsed SQL query on the Impala database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The parsed SQL query |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution result |

### get_tables
#### Description
Retrieves a list of all tables in the Impala database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Response | The list of tables |

### get_columns
#### Description
Retrieves the column information for a specified table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Response | The column information |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| impala.dbapi | Provides database API for Impala connections |
| impala.sqlalchemy | Provides SQLAlchemy support for Impala |
| mindsdb_sql | Used for SQL parsing and rendering |
| pandas | Used for data manipulation and storage |

## Error Handling
The code implements basic error handling, catching exceptions during connection attempts and query executions. Errors are logged and returned as part of the response objects.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging error messages.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
---
title: "hive_handler.py"
---

## High-level description
This code defines a `HiveHandler` class that manages connections and executes SQL statements for Apache Hive databases. It provides methods for connecting, disconnecting, checking connections, running native queries, and retrieving table and column information from Hive databases.

## Code Structure
The `HiveHandler` class inherits from `DatabaseHandler` and implements various methods to interact with Hive databases. It uses the `pyhive` library for Hive connections and the `mindsdb_sql` library for SQL parsing and rendering.

## Symbols

### HiveHandler
#### Description
A class that handles connections and executes SQL statements for Apache Hive databases.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| connection_data | Optional[dict] | Connection details for the Hive database |

#### Internal Logic
- Initializes connection parameters and state
- Provides methods for connecting, disconnecting, and checking connections
- Implements methods for executing native queries and parsed SQL statements
- Offers utility methods for retrieving table and column information

### connect
#### Description
Establishes a connection to the Hive database using the provided connection data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | hive.Connection | The established database connection |

### disconnect
#### Description
Closes the current database connection if one exists.

### check_connection
#### Description
Checks the connection to the Hive database and returns a status response.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the Hive database and returns the results.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution results or error information |

### query
#### Description
Executes a parsed SQL query on the Hive database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The parsed SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution results or error information |

### get_tables
#### Description
Retrieves a list of all tables in the Hive database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Response | A response containing the list of tables |

### get_columns
#### Description
Retrieves the column information for a specified table in the Hive database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table to describe |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Response | A response containing the column information |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pyhive | Provides Hive database connectivity |
| pandas | Used for data manipulation and storage |
| mindsdb_sql | Handles SQL parsing and rendering |

## Error Handling
The code implements basic error handling by catching exceptions in the `check_connection` and `native_query` methods. Errors are logged and returned as part of the response objects.

## Logging
The code uses a logger named `logger` for error logging in various methods.

## API/Interface Reference
The `HiveHandler` class provides the following main methods as its interface:
- `connect()`
- `disconnect()`
- `check_connection()`
- `native_query(query: str)`
- `query(query: ASTNode)`
- `get_tables()`
- `get_columns(table_name: str)`

These methods allow users to interact with Hive databases, execute queries, and retrieve metadata about tables and columns.
---
title: "vertica_handler.py"
---

## High-level description
This code implements a VerticaHandler class, which is a database handler for connecting to and interacting with Vertica databases. It provides methods for connecting, disconnecting, checking connections, executing queries, and retrieving table and column information from Vertica databases.

## Code Structure
The VerticaHandler class inherits from DatabaseHandler and implements various methods for database operations. It uses the vertica_python library for connecting to Vertica databases and executing queries. The class also utilizes the mindsdb_sql library for parsing and rendering SQL queries.

## Symbols

### VerticaHandler
#### Description
This class handles connections and executions of Vertica statements. It inherits from DatabaseHandler and implements methods for connecting to Vertica databases, executing queries, and retrieving database information.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| connection_data | Optional[dict] | Dictionary containing connection details |

#### Internal Logic
The class initializes with connection data and sets up the parser, dialect, and schema name. It implements methods for connecting, disconnecting, checking connections, executing native queries, and retrieving table and column information.

### connect
#### Description
Establishes a connection to the Vertica database using the provided connection data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | vertica_python.Connection | The established database connection |

### disconnect
#### Description
Closes the current database connection if one exists.

### check_connection
#### Description
Checks if a connection can be established with the Vertica database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the Vertica database and returns the results.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution results or error message |

### query
#### Description
Executes an SQL query represented as an AST (Abstract Syntax Tree) on the Vertica database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The SQL query as an AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query execution results or error message |

### get_tables
#### Description
Retrieves a list of tables in the specified schema of the Vertica database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The list of tables in the database |

### get_columns
#### Description
Retrieves the column information for a specified table in the Vertica database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table to get column information for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The column information for the specified table |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| vertica_python | Used for connecting to and interacting with Vertica databases |
| mindsdb_sql | Used for parsing and rendering SQL queries |
| pandas | Used for data manipulation and creating DataFrames |
| sqla_vertica_python | Provides the VerticaDialect for SQL rendering |

## Error Handling
The code implements basic error handling using try-except blocks. Errors are logged using the logger and returned as part of the Response objects.

## Logging
The code uses a logger (log.getLogger(__name__)) to log error messages, particularly when there are issues connecting to the database or executing queries.
---
title: "Overview"
---

## High-level description
This directory contains unit tests for the CouchbaseHandler class, which is part of the MindsDB integration with Couchbase. The tests are designed to verify the functionality of connecting to a Couchbase database, retrieving tables and columns, and executing native queries.

## What does it do?
The test suite in this directory performs the following tasks:

1. Establishes a connection to a Couchbase database using predefined connection data.
2. Verifies that the connection to the database is successful.
3. Tests the retrieval of tables from the connected Couchbase database.
4. Checks the ability to fetch columns for a specific table named "onsale".
5. Executes a simple native SQL query to ensure that the handler can perform database operations.

These tests ensure that the CouchbaseHandler can interact correctly with a Couchbase database, providing confidence in its basic functionality within the MindsDB ecosystem.

## Key Files
The directory contains two main files:

1. `__init__.py`: An empty file that marks the directory as a Python package.

2. `test_couchbase_handler.py`: The primary test file containing the `CouchbaseHandlerTest` class. This class includes four test methods:

   - `test_0_connect`: Verifies the connection to the Couchbase database.
   - `test_1_get_tables`: Tests the retrieval of tables from the database.
   - `test_2_get_column`: Checks the ability to fetch columns for a specific table.
   - `test_3_native_query_select`: Executes a native SQL query and verifies the response.

The `CouchbaseHandlerTest` class also includes a `setUpClass` method that initializes the `CouchbaseHandler` with predefined connection data for testing purposes.

## Dependencies
The test suite relies on the following dependencies:

1. `unittest`: The standard Python testing framework used to structure and run the tests.
2. `mindsdb.integrations.handlers.couchbase_handler.couchbase_handler`: Provides the `CouchbaseHandler` class being tested.
3. `mindsdb.api.executor.data_types.response_type`: Imports the `RESPONSE_TYPE` enum used for asserting response types.

## Configuration
The tests use hardcoded connection data in the `setUpClass` method:

```python
cls.connection_data = {
    "host": "localhost",
    "user": "admin",
    "password": "password",
    "bucket": "travel-sample"
}
```

This configuration includes:
- `host`: The Couchbase server address (set to "localhost" for local testing).
- `user`: The username for authentication (set to "admin").
- `password`: The password for authentication (set to "password").
- `bucket`: The name of the Couchbase bucket to connect to (set to "travel-sample").

It's important to note that using hardcoded credentials in test files is not recommended for production environments. In a real-world scenario, these values should be replaced with environment variables or read from a secure configuration file.

The test suite could be improved by:
1. Using environment variables or a configuration file for sensitive information.
2. Adding more comprehensive assertions to verify the content of the responses, not just the response type.
3. Parameterizing the table name in `test_2_get_column` to test multiple tables.
4. Testing more complex queries and edge cases in `test_3_native_query_select`.

These improvements would enhance the robustness and coverage of the test suite, providing greater confidence in the CouchbaseHandler's functionality across various scenarios.
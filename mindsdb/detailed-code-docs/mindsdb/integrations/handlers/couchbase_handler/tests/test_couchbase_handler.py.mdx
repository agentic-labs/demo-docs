---
title: "test_couchbase_handler.py"
---

## High-level description
This code defines a unit test class `CouchbaseHandlerTest` for testing the `CouchbaseHandler` class. It includes tests for connecting to a Couchbase database, retrieving tables and columns, and executing a native query.

## Code Structure
The `CouchbaseHandlerTest` class inherits from `unittest.TestCase` and contains four test methods, each testing a different functionality of the `CouchbaseHandler`. The `setUpClass` method is used to initialize the handler with connection data.

## Symbols

### `CouchbaseHandlerTest`
#### Description
A test class that inherits from `unittest.TestCase`, designed to test the functionality of the `CouchbaseHandler` class.

#### Internal Logic
1. Sets up a `CouchbaseHandler` instance with predefined connection data in the `setUpClass` method.
2. Defines four test methods to check different aspects of the handler's functionality.

### `setUpClass`
#### Description
A class method that sets up the test environment by creating a `CouchbaseHandler` instance with predefined connection data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cls | class | The class itself (automatically passed) |

#### Internal Logic
1. Defines connection data for a Couchbase database.
2. Creates a `CouchbaseHandler` instance with the connection data.

### `test_0_connect`
#### Description
Tests the connection to the Couchbase database using the `check_connection` method of the handler.

#### Internal Logic
Calls the `check_connection` method of the handler.

### `test_1_get_tables`
#### Description
Tests the retrieval of tables from the Couchbase database using the `get_tables` method of the handler.

#### Internal Logic
1. Calls the `get_tables` method of the handler.
2. Asserts that the response type is not an error.

### `test_2_get_column`
#### Description
Tests the retrieval of columns for a specific table ("onsale") using the `get_columns` method of the handler.

#### Internal Logic
1. Calls the `get_columns` method of the handler with the table name "onsale".
2. Asserts that the response type is not an error.

### `test_3_native_query_select`
#### Description
Tests the execution of a native SQL query using the `native_query` method of the handler.

#### Internal Logic
1. Calls the `native_query` method of the handler with a SELECT query.
2. Asserts that the response type is not an error.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.couchbase_handler.couchbase_handler | Imports the CouchbaseHandler class |
| mindsdb.api.executor.data_types.response_type | Imports the RESPONSE_TYPE enum |

## Error Handling
The test methods implicitly handle errors by asserting that the response type is not an error. If any of these assertions fail, the test will fail, indicating an issue with the corresponding functionality.

## TODOs
- The connection data in the `setUpClass` method contains hardcoded values, including a password. It's recommended to use environment variables or a configuration file for sensitive information in real-world scenarios.
- The tests only check if the response is not an error. More comprehensive assertions could be added to verify the content of the responses.
- The "onsale" table name in `test_2_get_column` is hardcoded. Consider parameterizing this or testing multiple tables.
- The SELECT query in `test_3_native_query_select` is very basic. Consider testing more complex queries or edge cases.
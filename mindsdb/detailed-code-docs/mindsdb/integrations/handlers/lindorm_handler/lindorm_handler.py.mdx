---
title: "lindorm_handler.py"
---

## High-level description
This code defines the `LindormHandler` class, which is a database handler for connecting to and interacting with Apache Phoenix databases. It provides methods for connecting, disconnecting, executing queries, and retrieving table and column information from the database.

## Code Structure
The `LindormHandler` class inherits from `DatabaseHandler` and implements various methods for database operations. It uses the `phoenixdb` library to establish connections and execute queries. The class also utilizes the `HandlerResponse` and `HandlerStatusResponse` classes from the `mindsdb.integrations.libs.response` module for structuring responses.

## Symbols

### LindormHandler
#### Description
This class handles connections and executions of Apache Phoenix statements. It provides methods for connecting to the database, executing queries, and retrieving metadata.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the particular handler instance |
| connection_data | Optional[dict] | Parameters for connecting to the database |
| **kwargs | dict | Arbitrary keyword arguments |

#### Internal Logic
1. Initializes connection parameters and sets up the connection.
2. Provides methods for connecting, disconnecting, and checking the connection.
3. Implements methods for executing native queries and AST-based queries.
4. Offers methods to retrieve table and column information from the database.

### connect
#### Description
Sets up the connection to the Apache Phoenix database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | phoenixdb.connection.Connection | The established database connection |

### disconnect
#### Description
Closes any existing connections to the database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| is_connected | bool | The connection status after disconnecting |

### check_connection
#### Description
Checks the connection to the handler by attempting to connect to the database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a raw SQL query on the database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The result of the query execution |

### query
#### Description
Executes a query represented as an Abstract Syntax Tree (AST).

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The SQL query represented as an AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The result of the query execution |

### get_tables
#### Description
Retrieves a list of tables from the database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Response | A list of table names |

### get_columns
#### Description
Retrieves a list of columns for a given table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | The name of the table to get columns for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | A list of column names and their data types |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| phoenixdb | Used for connecting to and interacting with Apache Phoenix databases |
| pandas | Used for data manipulation and creating DataFrames |
| mindsdb_sql | Used for SQL parsing and rendering |
| pyphoenix | Provides the PhoenixDialect for SQL rendering |

## Error Handling
The code implements error handling in various methods, catching exceptions and returning appropriate error responses. Errors are logged using the `logger` object.

## Logging
The code uses a logger object (`logger`) to log error messages when exceptions occur during query execution or connection attempts.

This handler provides a comprehensive interface for interacting with Apache Phoenix databases, allowing for connection management, query execution, and metadata retrieval. It uses the `phoenixdb` library for database operations and integrates with MindsDB's SQL parsing and response handling mechanisms.
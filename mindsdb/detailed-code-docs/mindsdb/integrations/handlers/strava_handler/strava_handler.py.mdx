---
title: "strava_handler.py"
---

## High-level description
This code implements a Strava API handler for MindsDB, allowing users to interact with Strava data through SQL queries. It provides functionality to connect to the Strava API, retrieve athlete clubs, and club activities.

## Code Structure
The `StravaHandler` class is the main entry point, inheriting from `APIHandler`. It sets up the connection to Strava and registers two tables: `all_clubs` and `club_activities`. These tables are implemented as separate classes (`StravaAllClubsTable` and `StravaClubActivitesTable`) that handle specific API endpoints.

## Symbols

### StravaHandler
#### Description
The main handler class for Strava integration, responsible for setting up the connection and registering tables.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | dict | Connection details for Strava API |

#### Internal Logic
1. Initializes the handler with connection data
2. Registers two tables: `all_clubs` and `club_activities`
3. Implements connection and query methods

### connect()
#### Description
Sets up the connection to the Strava API using the provided credentials.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | Client | Strava API client object |

### check_connection()
#### Description
Verifies the connection to the Strava API.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status |

### native_query(query: str)
#### Description
Processes a raw SQL query by parsing it and delegating to the query method.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | Raw SQL query |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Query result |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| stravalib | Strava API client library |
| mindsdb_sql | SQL parsing and handling |
| pandas | Data manipulation and analysis |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| strava_client_id | str | None | Client ID for Strava API |
| strava_access_token | str | None | Access token for Strava API |

## Error Handling
The code implements basic error handling, catching exceptions during connection and logging them. More specific error handling is not evident in the provided code.

## API/Interface Reference
The handler exposes two main tables:
1. `all_clubs`: Retrieves all clubs for the authenticated athlete
2. `club_activities`: Retrieves activities for a specific club

These can be queried using SQL through the MindsDB interface.
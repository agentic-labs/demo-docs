---
title: "openstreetmap_handler.py"
---

## High-level description
This code implements an OpenStreetMap handler for MindsDB, allowing users to interact with OpenStreetMap data through SQL queries. It provides functionality to connect to the OpenStreetMap API, execute queries, and manage different types of OpenStreetMap data (nodes, ways, and relations).

## Code Structure
The `OpenStreetMapHandler` class inherits from `APIHandler` and sets up three tables: nodes, ways, and relations. It implements methods for connecting to the OpenStreetMap API, checking the connection, and executing native queries.

## Symbols

### OpenStreetMapHandler
#### Description
This class is the main handler for OpenStreetMap integration in MindsDB. It sets up the connection to the OpenStreetMap API and manages the different data tables.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| **kwargs | dict | Additional keyword arguments, including connection data |

#### Internal Logic
1. Initializes the handler with the given name and connection data.
2. Registers three tables: nodes, ways, and relations, each with its corresponding data class.
3. Implements methods for connecting to the API, checking the connection, and executing native queries.

### connect
#### Description
Sets up the connection to the OpenStreetMap API using the overpy library.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | overpy.Overpass | The API session object |

### check_connection
#### Description
Checks if the connection to the OpenStreetMap API is working.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The status of the connection attempt |

### native_query
#### Description
Executes a native SQL query on the handler by parsing it and calling the `query` method.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The response from the query execution |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| overpy | Provides the Overpass API client for OpenStreetMap data |
| mindsdb_sql | Used for parsing SQL queries |

## Error Handling
The `check_connection` method implements basic error handling by catching exceptions and returning a `StatusResponse` with an error message if the connection fails.

## API/Interface Reference
This handler exposes three main tables for interacting with OpenStreetMap data:
1. nodes
2. ways
3. relations

These tables can be queried using SQL through the `native_query` method.
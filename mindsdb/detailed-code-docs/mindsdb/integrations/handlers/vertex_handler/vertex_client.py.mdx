---
title: "vertex_client.py"
---

## High-level description
The `VertexClient` class in `vertex_client.py` provides an interface to interact with Google Cloud's Vertex AI platform. It handles authentication, initialization, and various operations such as listing datasets, models, and endpoints, as well as making predictions using deployed models.

## Code Structure
The `VertexClient` class is the main component of this file. It uses the `GoogleServiceAccountOAuth2Manager` for authentication and the `google.cloud.aiplatform` library for interacting with Vertex AI. The class provides methods for initializing the client, listing resources, retrieving models and endpoints, deploying models, and making predictions.

## References
- `mindsdb.utilities.log`
- `google.cloud.aiplatform`
- `mindsdb.integrations.utilities.handlers.auth_utilities.GoogleServiceAccountOAuth2Manager`

## Symbols

### VertexClient
#### Description
A class that provides methods to interact with Google Cloud's Vertex AI platform, including authentication, resource management, and prediction capabilities.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args_json | dict | Configuration parameters for Vertex AI initialization |
| credentials_url | str | Optional URL for Google service account credentials |
| credentials_file | str | Optional file path for Google service account credentials |
| credentials_json | str | Optional JSON string containing Google service account credentials |

#### Internal Logic
1. Authenticates using `GoogleServiceAccountOAuth2Manager`
2. Initializes Vertex AI client with provided configuration
3. Provides methods for listing and retrieving resources (datasets, models, endpoints)
4. Offers functionality for model deployment and prediction

### print_datasets()
#### Description
Prints all datasets and their IDs in the project.

### print_models()
#### Description
Prints all model names and their IDs in the project.

### print_endpoints()
#### Description
Prints all endpoints and their IDs in the project.

### get_model_by_display_name(display_name)
#### Description
Retrieves a model by its display name.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| display_name | str | The display name of the model to retrieve |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model | Model | The retrieved model object, or None if not found |

### get_endpoint_by_display_name(display_name)
#### Description
Retrieves an endpoint by its display name.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| display_name | str | The display name of the endpoint to retrieve |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| endpoint | Endpoint | The retrieved endpoint object, or None if not found |

### get_model_by_id(model_id)
#### Description
Retrieves a model by its ID.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model_id | str | The ID of the model to retrieve |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model | Model | The retrieved model object, or None if not found |

### deploy_model(model)
#### Description
Deploys a model to an endpoint.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model | Model | The model object to deploy |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| endpoint | Endpoint | The deployed endpoint object |

#### Performance Considerations
This operation has a long runtime.

### predict_from_df(endpoint_display_name, df, custom_model=False)
#### Description
Makes a prediction using a deployed model from a Pandas DataFrame.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| endpoint_display_name | str | The display name of the endpoint to use for prediction |
| df | pandas.DataFrame | The input data for prediction |
| custom_model | bool | Flag to indicate if it's a custom model (default: False) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| prediction | Any | The prediction result from the model |

### predict_from_csv(endpoint_display_name, csv_to_predict)
#### Description
Makes a prediction using a deployed model from a CSV file.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| endpoint_display_name | str | The display name of the endpoint to use for prediction |
| csv_to_predict | str | The path to the CSV file containing input data |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| prediction | Any | The prediction result from the model |

### predict_from_dict(endpoint_display_name, data)
#### Description
Makes a prediction using a deployed model from a dictionary of data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| endpoint_display_name | str | The display name of the endpoint to use for prediction |
| data | dict | The input data for prediction in dictionary format |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| prediction | Any | The prediction result from the model |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| google.cloud.aiplatform | Provides the main functionality for interacting with Vertex AI |
| pandas | Used for data manipulation and CSV file reading |
| mindsdb.utilities.log | Provides logging functionality |
| mindsdb.integrations.utilities.handlers.auth_utilities.GoogleServiceAccountOAuth2Manager | Handles Google service account authentication |

## Error Handling
The code implements basic error handling using try-except blocks in methods like `get_model_by_display_name`, `get_endpoint_by_display_name`, and `get_model_by_id`. When a resource is not found, it logs an info message and returns None.

## Logging
The code uses the `mindsdb.utilities.log` module for logging. It logs information about resource retrieval and any errors encountered during operations.
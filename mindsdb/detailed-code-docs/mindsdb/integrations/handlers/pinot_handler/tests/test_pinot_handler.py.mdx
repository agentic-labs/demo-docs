---
title: "test_pinot_handler.py"
---

## High-level description
This code defines a unit test class `PinotHandlerTest` for testing the functionality of the `PinotHandler` class. It includes tests for connection checking, executing native queries, retrieving tables, and getting columns from a specific table in a Pinot database.

## Code Structure
The `PinotHandlerTest` class inherits from `unittest.TestCase` and contains four test methods, each testing a different aspect of the `PinotHandler`. The `setUpClass` method is used to initialize the handler with test configuration.

## Symbols

### `PinotHandlerTest`
#### Description
A test class that inherits from `unittest.TestCase`, designed to test the functionality of the `PinotHandler` class.

#### Internal Logic
1. Sets up a `PinotHandler` instance with test configuration in the `setUpClass` method.
2. Defines four test methods to check different functionalities of the handler.

### `setUpClass`
#### Description
A class method that sets up the test environment by creating a `PinotHandler` instance with test configuration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cls | class | The class itself (automatically passed) |

#### Internal Logic
1. Defines a dictionary `kwargs` with connection parameters for the Pinot database.
2. Creates an instance of `PinotHandler` with the name 'test_pinot_handler' and the `kwargs` configuration.

### `test_0_check_connection`
#### Description
Tests the `check_connection` method of the `PinotHandler`.

#### Internal Logic
Asserts that the `check_connection` method returns `True`.

### `test_1_native_query_select`
#### Description
Tests the `native_query` method of the `PinotHandler` with a SELECT query.

#### Internal Logic
1. Defines a SELECT query to retrieve all data from the 'baseballStats' table.
2. Executes the query using the `native_query` method.
3. Asserts that the result type is `RESPONSE_TYPE.TABLE`.

### `test_2_get_tables`
#### Description
Tests the `get_tables` method of the `PinotHandler`.

#### Internal Logic
1. Calls the `get_tables` method.
2. Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

### `test_3_get_columns`
#### Description
Tests the `get_columns` method of the `PinotHandler` for a specific table.

#### Internal Logic
1. Calls the `get_columns` method with the table name 'baseballStats'.
2. Asserts that the result type is not `RESPONSE_TYPE.ERROR`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.pinot_handler.pinot_handler | Contains the PinotHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for asserting response types |

## Error Handling
The test methods use assertions to check for expected outcomes. If any assertion fails, the test will raise an `AssertionError`.

## Notes
1. The tests assume the existence of a Pinot database with a 'baseballStats' table.
2. The connection parameters in `kwargs` are set for a local Pinot instance. These may need to be adjusted for different test environments.
3. The test methods are numbered (0-3) to ensure a specific execution order if needed.
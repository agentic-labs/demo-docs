---
title: "test_matrixone_handler.py"
---

## High-level description
This code defines a unit test class `MatrixOneHandlerTest` for testing the `MatrixOneHandler` class, which is responsible for handling connections and operations with a MatrixOne database. The tests cover various database operations such as connecting, creating tables, inserting data, and querying.

## Code Structure
The `MatrixOneHandlerTest` class contains multiple test methods that sequentially test different functionalities of the `MatrixOneHandler`. The tests are designed to be run in a specific order, as indicated by the numeric prefixes in their names.

## Symbols

### MatrixOneHandlerTest
#### Description
A test class that inherits from `unittest.TestCase`, containing methods to test various functionalities of the `MatrixOneHandler`.

#### Internal Logic
1. Sets up a `MatrixOneHandler` instance with test connection data in the `setUpClass` method.
2. Defines multiple test methods to check different operations on the MatrixOne database.
3. Each test method performs a specific operation and asserts that the response is not an error.

### test_0_connect
#### Description
Tests the connection to the MatrixOne database.

#### Internal Logic
Calls the `connect` method of the `MatrixOneHandler` instance.

### test_1_drop_table
#### Description
Tests dropping a table named 'PREM' if it exists.

#### Internal Logic
Executes a DROP TABLE query and asserts that the response is not an error.

### test_2_create_table
#### Description
Tests creating a table named 'PREM' with a single column 'Premi'.

#### Internal Logic
Executes a CREATE TABLE query and asserts that the response is not an error.

### test_3_insert_table
#### Description
Tests inserting a row into the 'PREM' table.

#### Internal Logic
Executes an INSERT query and asserts that the response is not an error.

### test_4_get_tables
#### Description
Tests retrieving the list of tables from the database.

#### Internal Logic
Calls the `get_tables` method of the handler and asserts that the response is not an error.

### test_5_select_query
#### Description
Tests executing a SELECT query on the 'PREM' table.

#### Internal Logic
Executes a SELECT query using the `native_query` method and asserts that the response is not an error.

### test_6_get_columns
#### Description
Tests retrieving the columns of the 'PREM' table.

#### Internal Logic
Calls the `get_columns` method of the handler and asserts that the response is not an error.

### test_7_check_connection
#### Description
Tests the connection check functionality.

#### Internal Logic
Calls the `check_connection` method of the handler.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.matrixone_handler.matrixone_handler | Imports the MatrixOneHandler class |
| mindsdb.api.executor.data_types.response_type | Imports the RESPONSE_TYPE enum |

## Error Handling
The test methods use assertions to check if the responses from the `MatrixOneHandler` operations are not of type `RESPONSE_TYPE.ERROR`. This ensures that the operations are executed successfully without raising errors.
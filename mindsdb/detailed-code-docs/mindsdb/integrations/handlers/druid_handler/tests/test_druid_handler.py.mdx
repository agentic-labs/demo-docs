---
title: "test_druid_handler.py"
---

## High-level description
This code defines a unit test class `DruidHandlerTest` for testing the functionality of the `DruidHandler` class. It includes tests for checking the connection, executing a native query, retrieving tables, and getting columns from a specific table in Apache Druid.

## Code Structure
The `DruidHandlerTest` class contains four test methods that verify different aspects of the `DruidHandler` functionality. Each test method focuses on a specific operation and asserts the expected behavior.

## Symbols

### `DruidHandlerTest`
#### Description
A unittest.TestCase subclass that defines test cases for the DruidHandler class.

#### Internal Logic
- Sets up a DruidHandler instance with test connection parameters in the `setUpClass` method.
- Defines four test methods to check various functionalities of the DruidHandler.

### `setUpClass`
#### Description
A class method that initializes the test environment by creating a DruidHandler instance with test connection parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| cls | class | The test class itself |

#### Internal Logic
- Defines a dictionary `kwargs` with connection parameters for a local Druid instance.
- Creates a DruidHandler instance using the test parameters.

### `test_0_check_connection`
#### Description
Tests the `check_connection` method of the DruidHandler.

#### Internal Logic
- Calls the `check_connection` method of the handler.
- Asserts that the connection check is successful.

### `test_1_native_query_select`
#### Description
Tests the `native_query` method of the DruidHandler with a SELECT query.

#### Internal Logic
- Executes a SELECT query on the 'wikipedia' table using the `native_query` method.
- Asserts that the result type is RESPONSE_TYPE.TABLE.

### `test_2_get_tables`
#### Description
Tests the `get_tables` method of the DruidHandler.

#### Internal Logic
- Calls the `get_tables` method of the handler.
- Asserts that the result type is not RESPONSE_TYPE.ERROR.

### `test_3_get_columns`
#### Description
Tests the `get_columns` method of the DruidHandler for a specific table.

#### Internal Logic
- Calls the `get_columns` method with the 'wikipedia' table name.
- Asserts that the result type is not RESPONSE_TYPE.ERROR.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.druid_handler.druid_handler | Contains the DruidHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for asserting response types |

## Error Handling
The test methods use assertions to verify the expected behavior of the DruidHandler methods. If any assertion fails, the test will raise an AssertionError.

This test suite provides a basic set of tests to ensure the core functionality of the DruidHandler is working as expected. It covers connection checking, query execution, and schema information retrieval.
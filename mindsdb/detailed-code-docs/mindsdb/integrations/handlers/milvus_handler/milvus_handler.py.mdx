---
title: "milvus_handler.py"
---

## High-level description
This code implements a handler for the Milvus vector database, providing functionality to connect, query, and manage collections within Milvus. It extends the VectorStoreHandler class and implements various methods for interacting with Milvus, including connection management, table operations, and data manipulation.

## Code Structure
The `MilvusHandler` class is the main component, inheriting from `VectorStoreHandler`. It contains methods for connecting to Milvus, managing collections (tables), and performing operations like inserting, selecting, and deleting data. The class uses the `pymilvus` library to interact with Milvus and implements the necessary logic to translate MindsDB operations into Milvus-specific commands.

## Symbols

### MilvusHandler
#### Description
This class handles the connection and execution of Milvus statements. It provides methods for connecting to Milvus, managing collections, and performing data operations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| **kwargs | dict | Connection data and other parameters |

#### Internal Logic
1. Initializes connection data and search parameters
2. Sets up create table parameters
3. Implements methods for connection management, table operations, and data manipulation
4. Translates MindsDB filter conditions to Milvus-compatible expressions

### connect
#### Description
Establishes a connection to the Milvus database using the provided connection data.

### disconnect
#### Description
Closes the connection to the Milvus database.

### check_connection
#### Description
Checks the status of the connection to the Milvus database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response_code | StatusResponse | Connection status |

### get_tables
#### Description
Retrieves a list of collections (tables) from the Milvus database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| collections_name | HandlerResponse | DataFrame containing table names |

### drop_table
#### Description
Deletes a collection from the Milvus database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to drop |
| if_exists | bool | Whether to ignore if the table doesn't exist |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Operation status |

### select
#### Description
Performs a search operation on a Milvus collection.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to search |
| columns | List[str] | Columns to retrieve |
| conditions | List[FilterCondition] | Search conditions |
| offset | int | Result offset |
| limit | int | Result limit |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Search results |

### create_table
#### Description
Creates a new collection in the Milvus database with default parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to create |
| if_not_exists | bool | Whether to ignore if the table already exists |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Operation status |

### insert
#### Description
Inserts data into a Milvus collection.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to insert into |
| data | pd.DataFrame | Data to insert |
| columns | List[str] | Columns to insert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Operation status |

### delete
#### Description
Deletes data from a Milvus collection based on specified conditions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to delete from |
| conditions | List[FilterCondition] | Delete conditions |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | Operation status |

### get_columns
#### Description
Retrieves the columns of a Milvus collection.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to get columns from |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | HandlerResponse | DataFrame containing column information |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pymilvus | Milvus client library for Python |
| pandas | Data manipulation and analysis |
| mindsdb.integrations.libs.response | Response handling utilities |
| mindsdb.integrations.libs.vectordatabase_handler | Base class for vector database handlers |
| mindsdb.utilities | Logging utilities |

## Error Handling
The code implements error handling throughout its methods, catching exceptions and returning appropriate error responses using the `HandlerResponse` class.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging errors and other information.

## Performance Considerations
- The code implements a search limit parameter to control the number of results returned in search operations.
- It uses Milvus-specific indexing and search parameters for optimized performance.
- The code handles large result sets by implementing offset and limit parameters in the `select` method.

This handler provides a comprehensive interface for interacting with Milvus vector databases, translating MindsDB operations into Milvus-specific commands and managing the complexities of vector search and data manipulation in Milvus.
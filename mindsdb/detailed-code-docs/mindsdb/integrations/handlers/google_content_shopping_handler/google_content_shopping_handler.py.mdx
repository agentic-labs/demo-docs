---
title: "google_content_shopping_handler.py"
---

## High-level description
This code defines a handler class `GoogleContentShoppingHandler` for interacting with the Google Content API for Shopping. It provides methods to authenticate, connect, and perform operations such as retrieving accounts, orders, and products from the Google Content API.

## Code Structure
The `GoogleContentShoppingHandler` class inherits from `APIHandler` and implements methods for connecting to the API, checking the connection, and executing various API operations. It also registers tables for accounts, orders, and products.

## Symbols

### GoogleContentShoppingHandler
#### Description
A class for handling connections and interactions with the Google Content API for Shopping.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler |
| kwargs | dict | Additional arguments including connection data and file storage |

#### Internal Logic
1. Initializes connection data, credentials, and API scopes.
2. Registers tables for accounts, orders, and products.
3. Implements methods for connecting to the API, checking the connection, and executing API operations.

### connect
#### Description
Sets up the connection to the Google Content API for Shopping.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| service | googleapiclient.discovery.Resource | The Google Content API service object |

#### Internal Logic
1. Checks if already connected.
2. Loads or refreshes credentials.
3. Builds and returns the API service object.

### check_connection
#### Description
Checks the connection to the Google Content API for Shopping.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

#### Internal Logic
1. Attempts to connect to the API.
2. Returns a success or error status.

### native_query
#### Description
Executes a native query on the Google Content API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The native query string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query response containing a DataFrame |

#### Internal Logic
1. Parses the query string to extract method name and parameters.
2. Calls the appropriate API method.
3. Returns the result as a DataFrame.

### get_accounts, get_orders, get_products
#### Description
Retrieve accounts, orders, or products from the Google Content API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | dict | Query parameters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | DataFrame | Retrieved data as a DataFrame |

#### Internal Logic
1. Connects to the API.
2. Executes the appropriate API call with given parameters.
3. Processes and returns the results as a DataFrame.

### delete_accounts, delete_orders, delete_products
#### Description
Delete accounts, orders, or products from the Google Content API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | dict | Query parameters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | DataFrame | Deletion status as a DataFrame |

#### Internal Logic
1. Connects to the API.
2. Executes deletion API calls for the specified items.
3. Returns the deletion status.

### update_products
#### Description
Updates product information in the Google Content API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | dict | Update parameters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | DataFrame | Update status as a DataFrame |

#### Internal Logic
1. Connects to the API.
2. Executes update API calls for the specified products.
3. Returns the update status.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| google.auth.transport.requests | For handling Google API requests |
| google.oauth2 | For Google OAuth2 authentication |
| googleapiclient.discovery | For building Google API service objects |
| mindsdb.api.executor.data_types.response_type | For defining response types |
| mindsdb.integrations.libs.api_handler | Base class and utilities for API handlers |
| mindsdb.integrations.libs.response | For creating standardized responses |
| mindsdb.utilities | For logging |

## Error Handling
The code implements basic error handling, primarily in the `check_connection` method, where exceptions are caught and logged.

## Logging
The code uses the `mindsdb.utilities.log` module for logging, primarily for error messages in the `check_connection` method.
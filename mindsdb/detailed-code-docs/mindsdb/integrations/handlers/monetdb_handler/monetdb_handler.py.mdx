---
title: "monetdb_handler.py"
---

## High-level description
This code defines a MonetDBHandler class, which is a database handler for interacting with MonetDB databases. It provides methods for connecting to the database, executing queries, and retrieving information about tables and columns.

## Code Structure
The MonetDBHandler class inherits from DatabaseHandler and implements various methods for database operations. It uses pymonetdb for connecting to MonetDB and sqlalchemy_monetdb for SQL rendering.

## References
- DatabaseHandler from mindsdb.integrations.libs.base
- HandlerStatusResponse and HandlerResponse from mindsdb.integrations.libs.response
- parse_sql from mindsdb_sql
- SqlalchemyRender from mindsdb_sql.render.sqlalchemy_render
- MonetDialect from sqlalchemy_monetdb.dialect

## Symbols

### MonetDBHandler
#### Description
A handler class for interacting with MonetDB databases, providing methods for connection, querying, and schema information retrieval.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | dict | Parameters for connecting to the database |
| **kwargs | dict | Additional keyword arguments |

#### Internal Logic
- Initializes connection parameters from the provided connection_data
- Implements methods for connecting, disconnecting, checking connection, and executing queries
- Provides methods for retrieving table and column information

### connect
#### Description
Establishes a connection to the MonetDB database using the provided connection parameters.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | Connection | MonetDB connection object |

### disconnect
#### Description
Closes the existing database connection.

### check_connection
#### Description
Checks the connection to the MonetDB database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| responseCode | StatusResponse | Status of the connection check |

### native_query
#### Description
Executes a raw SQL query on the MonetDB database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query execution result |

### query
#### Description
Executes a query represented as an AST (Abstract Syntax Tree) on the MonetDB database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | SQL query represented as AST |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query execution result |

### get_tables
#### Description
Retrieves a list of tables in the connected MonetDB database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of tables |

### get_columns
#### Description
Retrieves column information for a specified table in the MonetDB database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Column information for the specified table |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pymonetdb | MonetDB Python client |
| sqlalchemy_monetdb | SQLAlchemy dialect for MonetDB |
| pandas | Data manipulation and analysis |

## Error Handling
The code implements basic error handling using try-except blocks, logging errors, and returning appropriate error responses.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging error messages.

This documentation provides a comprehensive overview of the MonetDBHandler class and its methods, focusing on their purpose, inputs, outputs, and key functionalities.
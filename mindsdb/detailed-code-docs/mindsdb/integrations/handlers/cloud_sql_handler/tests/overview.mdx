---
title: "Overview"
---

## High-level description
This directory contains unit tests for the Cloud SQL Handler, which is responsible for connecting to and interacting with Google Cloud SQL instances. The tests cover both MySQL and Microsoft SQL Server databases running on Cloud SQL. The main purpose of these tests is to ensure the correct functionality of the CloudSQLHandler class in various scenarios, including connection establishment, query execution, and schema retrieval.

## What does it do?
The tests in this directory verify the following functionalities:

1. Establishing a connection to a Cloud SQL instance (both MySQL and MSSQL).
2. Executing simple SELECT queries on the connected databases.
3. Retrieving a list of tables from the databases.
4. Fetching column information for specific tables.

These tests ensure that the CloudSQLHandler can successfully interact with different types of Cloud SQL databases and perform basic operations without errors.

## Key Files
1. `test_cloud_sql_mysql_handler.py`: Contains unit tests for the CloudSQLHandler when interacting with a MySQL database on Google Cloud SQL.
2. `test_cloud_sql_mssql_handler.py`: Contains unit tests for the CloudSQLHandler when interacting with a Microsoft SQL Server database on Google Cloud SQL.

Both files follow a similar structure, defining a test class with multiple test methods, each targeting a specific functionality of the CloudSQLHandler.

## Dependencies
The tests rely on the following main dependencies:

1. `unittest`: The standard Python library for writing and running unit tests.
2. `mindsdb.integrations.handlers.cloud_sql_handler.cloud_sql_handler.CloudSQLHandler`: The main class being tested, responsible for handling Cloud SQL connections and operations.
3. `mindsdb.api.executor.data_types.response_type.RESPONSE_TYPE`: An enum used to verify the types of responses returned by the handler.

## Configuration
The tests use predefined connection parameters to initialize the CloudSQLHandler. These parameters are likely set up in the `setUpClass` method of each test class. The exact configuration details are not provided in the summaries, but they would typically include:

- Host
- Port
- Database name
- Username
- Password
- Project ID (for Google Cloud SQL)
- Instance name (for Google Cloud SQL)

It's important to note that these tests require access to actual Cloud SQL instances with the appropriate permissions and network access configured.

Here's an example of how the CloudSQLHandler might be initialized in the tests:

```python
@classmethod
def setUpClass(cls):
    cls.handler = CloudSQLHandler(
        connection_data={
            "host": "your-cloud-sql-host",
            "port": 3306,  # or 1433 for MSSQL
            "database": "your-database-name",
            "user": "your-username",
            "password": "your-password",
            "project_id": "your-gcp-project-id",
            "instance": "your-cloud-sql-instance-name"
        }
    )
```

The tests follow a common pattern:

1. Check the connection to the database.
2. Execute a simple SELECT query.
3. Retrieve the list of tables.
4. Fetch column information for a specific table.

For example, here's how a test method for executing a SELECT query might look:

```python
def test_native_query_select(self):
    query = "SELECT 1"
    result = self.handler.native_query(query)
    self.assertEqual(result.type, RESPONSE_TYPE.TABLE)
```

These tests ensure that the CloudSQLHandler can perform basic operations on both MySQL and MSSQL databases hosted on Google Cloud SQL, providing confidence in its functionality across different database types and operations.
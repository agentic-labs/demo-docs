---
title: "flaml_handler.py"
---

## High-level description
The `FLAMLHandler` class is a MindsDB integration handler for the FLAML (Fast Lightweight AutoML) library. It provides methods for creating, training, and using FLAML models for both classification and regression tasks within the MindsDB ecosystem.

## Code Structure
The `FLAMLHandler` class is the main component, inheriting from `BaseMLEngine` and implementing its abstract methods. It utilizes the `AutoML` class from the `flaml` library for model training and prediction. The `dill` library is used for model serialization and deserialization.

## References
- `mindsdb.integrations.libs.base.BaseMLEngine`: The base class for ML engine handlers in MindsDB.
- `flaml.AutoML`: The main class from the FLAML library for automated machine learning.
- `dill`: Used for serializing and deserializing the trained FLAML model.

## Symbols

### `FLAMLHandler`
#### Description
This class handles the interaction between MindsDB and the FLAML library. It provides methods for creating, training, and using FLAML models.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| model_storage | mindsdb.integrations.libs.storage.ModelStorage | An object to store model-related data. |
| engine_storage | mindsdb.integrations.libs.storage.EngineStorage | An object to store engine-related data. |
| **kwargs | dict | Additional keyword arguments. |

#### Outputs
This class doesn't directly return any values. Its methods perform actions like model training and prediction.

#### Internal Logic
- **`create(self, target: str, df: Optional[pd.DataFrame] = None, args: Optional[Dict] = None) -&gt; None`**: This method creates and trains a FLAML model. It infers the task type (classification or regression) based on the target variable's data type. The trained model and arguments are then stored using the `model_storage` object.
- **`predict(self, df: pd.DataFrame, args: Optional[Dict] = None) -&gt; pd.DataFrame`**: This method loads the trained FLAML model from `model_storage` and uses it to generate predictions on the input dataframe `df`. The predictions are returned as a pandas DataFrame.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| dill | Serializing and deserializing the trained FLAML model. |
| pandas | Data manipulation and handling. |
| flaml | Provides the AutoML functionality for model training and prediction. |
| type_infer | Used to infer the data type of the target variable. |

## Error Handling
The `create` method raises an exception if the input dataframe is empty.

## TODOs
(There are no TODOs or other notes left in the code)

---
title: "npm_handler.py"
---

## High-level description
This code defines the `NPMHandler` class, which is an API handler for interacting with the NPM (Node Package Manager) API. It provides functionality to connect to the NPM API, check the connection status, and execute native queries.

## Code Structure
The `NPMHandler` class inherits from `APIHandler` and initializes various NPM-related tables. It implements methods for checking connection status, connecting to the NPM API, and executing native queries.

## References
This code references other parts of the codebase, including:
- `mindsdb_sql.parse_sql`
- `mindsdb.integrations.handlers.npm_handler.api.NPM`
- Various NPM-related table classes from `mindsdb.integrations.handlers.npm_handler.npm_tables`
- `mindsdb.integrations.libs.api_handler.APIHandler`
- `mindsdb.integrations.libs.response.HandlerStatusResponse`

## Symbols

### `NPMHandler`
#### Description
This class represents the main handler for interacting with the NPM API. It initializes various NPM-related tables and provides methods for connection management and query execution.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| **kwargs | dict | Additional keyword arguments |

#### Internal Logic
1. Initializes the parent `APIHandler` class.
2. Sets up connection-related attributes.
3. Registers various NPM-related tables using the `_register_table` method.

### `NPMHandler.check_connection`
#### Description
Checks if the connection to the NPM API is established.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | A status response object indicating the connection status |

#### Internal Logic
1. Creates a `StatusResponse` object.
2. Checks if the NPM API is connected using `NPM.is_connected()`.
3. Sets the `success` attribute of the response accordingly.
4. Sets the `is_connected` attribute of the handler to `True`.

### `NPMHandler.connect`
#### Description
Establishes a connection to the NPM API.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | NPM | The NPM API connection object |

#### Internal Logic
1. Sets the `connection` attribute to the `NPM` class.
2. Returns the connection object.

### `NPMHandler.native_query`
#### Description
Executes a native SQL query on the NPM API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query string to be executed |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | The result of the query execution |

#### Internal Logic
1. Parses the input SQL query using `parse_sql` function.
2. Calls the `query` method of the handler with the parsed AST.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb_sql | For parsing SQL queries |
| mindsdb.integrations.handlers.npm_handler.api | For the NPM API functionality |
| mindsdb.integrations.handlers.npm_handler.npm_tables | For various NPM-related table classes |
| mindsdb.integrations.libs.api_handler | For the base APIHandler class |
| mindsdb.integrations.libs.response | For the HandlerStatusResponse class |

This handler provides a way to interact with the NPM API within the MindsDB framework, allowing users to query NPM package data using SQL-like syntax.
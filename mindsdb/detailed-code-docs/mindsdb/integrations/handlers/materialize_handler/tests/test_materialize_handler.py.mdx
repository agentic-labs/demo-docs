---
title: "test_materialize_handler.py"
---

## High-level description
This code defines a unit test class `materializeHandlerTest` for testing the `MaterializeHandler` class. It includes tests for connection, table creation, data insertion, querying, and metadata retrieval operations using the Materialize database.

## Code Structure
The `materializeHandlerTest` class inherits from `unittest.TestCase` and contains several test methods that verify different functionalities of the `MaterializeHandler`. The tests are designed to be run sequentially, as indicated by their numeric prefixes.

## References
- `MaterializeHandler` from `mindsdb.integrations.handlers.materialize_handler.materialize_handler`
- `RESPONSE_TYPE` from `mindsdb.integrations.libs.response`

## Symbols

### `materializeHandlerTest`
#### Description
A test class that verifies the functionality of the `MaterializeHandler` for interacting with a Materialize database.

#### Internal Logic
1. Sets up a connection to a Materialize database in the `setUpClass` method.
2. Runs a series of tests to check various operations:
   - Connection establishment
   - Table creation
   - Data insertion
   - Data querying
   - Metadata retrieval (tables and columns)
3. Cleans up by dropping the created table at the end.

### `setUpClass`
#### Description
Class method that initializes the `MaterializeHandler` with connection details for testing.

#### Inputs
None (class method)

#### Outputs
None

#### Internal Logic
1. Defines connection data for a Materialize database.
2. Initializes a `MaterializeHandler` instance with the connection data.

### `test_0_check_connection`
#### Description
Tests the `check_connection` method of the `MaterializeHandler`.

#### Internal Logic
Asserts that the `check_connection` method returns `True`.

### `test_1_connect`
#### Description
Tests the `connect` method of the `MaterializeHandler`.

#### Internal Logic
Asserts that the `connect` method returns `True`.

### `test_2_create_table`
#### Description
Tests the creation of a table using the `query` method.

#### Internal Logic
1. Executes a CREATE TABLE SQL query.
2. Asserts that the response type is not an error.

### `test_3_insert`
#### Description
Tests data insertion into the created table.

#### Internal Logic
1. Executes an INSERT SQL query.
2. Asserts that the response type is not an error.

### `test_4_native_query_select`
#### Description
Tests the execution of a SELECT query.

#### Internal Logic
1. Executes a SELECT SQL query.
2. Asserts that the response type is TABLE.

### `test_5_get_tables`
#### Description
Tests the `get_tables` method of the `MaterializeHandler`.

#### Internal Logic
1. Calls the `get_tables` method.
2. Asserts that the response type is TABLE.

### `test_6_get_columns`
#### Description
Tests the `get_columns` method and performs cleanup.

#### Internal Logic
1. Calls the `get_columns` method for the 'LOVER' table.
2. Executes a DROP TABLE SQL query to clean up.
3. Asserts that the columns response type is not an error.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.materialize_handler.materialize_handler | Imports the MaterializeHandler class |
| mindsdb.integrations.libs.response | Imports the RESPONSE_TYPE enum |

## Error Handling
The test methods use assertions to verify the expected behavior of the `MaterializeHandler` methods. If any assertion fails, the test will raise an `AssertionError`.
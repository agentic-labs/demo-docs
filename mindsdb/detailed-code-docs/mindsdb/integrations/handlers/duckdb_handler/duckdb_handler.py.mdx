---
title: "duckdb_handler.py"
---

## High-level description
This code implements a DuckDBHandler class, which is a database handler for connecting to and interacting with DuckDB databases in MindsDB. It provides methods for connecting, disconnecting, executing queries, and retrieving table and column information from a DuckDB database.

## Code Structure
The DuckDBHandler class inherits from DatabaseHandler and implements several methods to interact with DuckDB databases. It uses the duckdb Python library to establish connections and execute queries. The class also utilizes the SqlalchemyRender for query rendering and the mindsdb_sql parser for SQL parsing.

## Symbols

### DuckDBHandler
#### Description
This class handles the connection and execution of DuckDB statements. It provides methods for connecting to a DuckDB database, executing queries, and retrieving database information.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler |
| connection_data | dict | Connection parameters for the DuckDB database |

#### Internal Logic
- Initializes connection parameters and renderer
- Implements methods for connecting, disconnecting, and checking connection status
- Provides methods for executing native queries and parsed SQL queries
- Includes methods for retrieving table and column information

### connect
#### Description
Establishes a connection to the DuckDB database using the provided connection parameters.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | DuckDBPyConnection | The database connection object |

### disconnect
#### Description
Closes the database connection if it exists.

### check_connection
#### Description
Checks the connection to the DuckDB database and returns a status response.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection success status and error message if applicable |

### native_query
#### Description
Executes a raw SQL query on the DuckDB database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | The SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query result or error message |

### query
#### Description
Renders and executes a SQL query represented as an AST node.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | The SQL query as an AST node |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | The query result or error message |

### get_tables
#### Description
Retrieves a list of all tables in the connected DuckDB database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of table names in the database |

### get_columns
#### Description
Retrieves details about a specific table in the DuckDB database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to retrieve details for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Details of the specified table |

## Error Handling
The code implements error handling in the `check_connection`, `native_query`, and other methods. Exceptions are caught, logged, and returned as part of the response objects.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging error messages.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| duckdb | Core library for interacting with DuckDB databases |
| pandas | Used for data manipulation and creating DataFrames from query results |
| mindsdb_sql | Used for SQL parsing and rendering |
| mindsdb.integrations.libs.base | Provides the base DatabaseHandler class |
| mindsdb.integrations.libs.response | Provides response types and classes |
| mindsdb.utilities | Provides logging functionality |

This handler provides a comprehensive interface for interacting with DuckDB databases within the MindsDB ecosystem, allowing for seamless integration and data manipulation.
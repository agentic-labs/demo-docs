---
title: "Overview"
---

## High-level description
This directory contains the Microsoft Teams handler for MindsDB, which provides integration capabilities with Microsoft Teams. It allows users to interact with Teams data, including chats, channels, and messages, through the Microsoft Graph API.

## What does it do?
The Microsoft Teams handler enables MindsDB to connect to and interact with Microsoft Teams data. It provides functionality to:

1. Authenticate with Microsoft Graph API using client credentials.
2. Retrieve information about chats, channels, and messages.
3. Send messages to chats and channels.
4. Execute SQL-like queries on Teams data.
5. Implement a chatbot functionality for Teams.

Users can create a database connection to Teams, then use SQL queries to interact with Teams data as if it were a regular database. This allows for seamless integration of Teams data into MindsDB's machine learning and AI capabilities.

## Entry points
The main entry point for this handler is the `MSTeamsHandler` class in `ms_teams_handler.py`. This class initializes the connection to Microsoft Teams and provides methods for executing queries and managing the connection.

Key files and their roles:

1. `ms_teams_handler.py`: Contains the main `MSTeamsHandler` class, which handles connection, authentication, and query execution.
2. `ms_graph_api_teams_client.py`: Implements the `MSGraphAPITeamsClient` class, which interacts directly with the Microsoft Graph API for Teams-specific operations.
3. `ms_teams_tables.py`: Defines classes for different Teams entities (chats, channels, messages) that implement the logic for querying and manipulating these entities.

The data flow typically goes from the user's SQL query, through the `MSTeamsHandler`, which then uses the appropriate table class from `ms_teams_tables.py`. These table classes, in turn, use the `MSGraphAPITeamsClient` to make API calls to Microsoft Graph.

## Key Files
1. `__init__.py`: Sets up the handler, including version information and error handling for imports.
2. `ms_teams_handler.py`: The main handler class that manages the connection and query execution.
3. `ms_graph_api_teams_client.py`: The client for interacting with the Microsoft Graph API.
4. `ms_teams_tables.py`: Defines the structure and methods for different Teams entities (chats, channels, messages).
5. `settings.py`: Contains configuration settings, including API scopes and table column definitions.

## Dependencies
The handler relies on several external libraries and internal MindsDB modules:

1. `msal`: For Microsoft Authentication Library integration.
2. `requests`: For making HTTP requests to the Microsoft Graph API.
3. `pandas`: For data manipulation and analysis.
4. `mindsdb_sql`: For SQL parsing.
5. `mindsdb.integrations.libs.api_handler`: For base API handler functionality.
6. `mindsdb.integrations.utilities.handlers.auth_utilities`: For authentication management.

## Configuration
The handler uses the following configuration parameters:

1. `client_id`: The client ID of the registered Microsoft Entra ID application.
2. `client_secret`: The client secret of the registered Microsoft Entra ID application.
3. `tenant_id`: The tenant ID of the registered Microsoft Entra ID application.

These parameters are used to authenticate with the Microsoft Graph API. The `settings.py` file also contains additional configuration, including API scopes and table column definitions.

The handler supports various SQL operations on Teams data, including SELECT, INSERT, and WHERE clauses, allowing for flexible querying and manipulation of Teams information within MindsDB.
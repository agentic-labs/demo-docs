---
title: "ms_graph_api_teams_client.py"
---

## High-level description
This code defines the `MSGraphAPITeamsClient` class, which is a client for interacting with Microsoft Teams through the Microsoft Graph API. It provides methods to retrieve and send messages in channels and chats, as well as to fetch information about teams, channels, and chats.

## Code Structure
The `MSGraphAPITeamsClient` class inherits from `MSGraphAPIBaseClient`, extending its functionality with Teams-specific methods. It includes methods for working with groups, channels, channel messages, chats, and chat messages.

## References
This code references the `MSGraphAPIBaseClient` class from the `ms_graph_api_utilities` module.

## Symbols

### `MSGraphAPITeamsClient`
#### Description
A client class for interacting with Microsoft Teams through the Microsoft Graph API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| access_token | str | The access token for authenticating with the Microsoft Graph API (inherited from parent class) |

#### Internal Logic
The class provides methods for retrieving and sending messages in Teams channels and chats, as well as fetching information about teams, channels, and chats. It uses the Microsoft Graph API endpoints specific to Teams.

___

### `_get_group_ids`
#### Description
Retrieves all group IDs related to Microsoft Teams.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| group_ids | List[Text] | A list of group IDs associated with Teams |

#### Internal Logic
1. Checks if group IDs are already cached
2. If not, makes an API request to fetch groups
3. Filters groups to include only those related to Teams
4. Caches and returns the filtered group IDs

___

### `_get_channel_ids`
#### Description
Retrieves all channel IDs for a given group.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| group_id | Text | The ID of the group |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| channel_ids | List[Text] | A list of channel IDs for the given group |

___

### `get_channel`
#### Description
Retrieves information about a specific channel.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| group_id | Text | The ID of the group |
| channel_id | Text | The ID of the channel |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| channel | Dict | Channel information including the group ID |

___

### `get_channels`
#### Description
Retrieves information about all channels across all groups.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| channels | List[Dict] | A list of channel information dictionaries |

___

### `get_channel_message`
#### Description
Retrieves a specific message from a channel.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| group_id | Text | The ID of the group |
| channel_id | Text | The ID of the channel |
| message_id | Text | The ID of the message |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | Dict | The message data |

___

### `get_channel_messages`
#### Description
Retrieves all messages from all channels across all groups.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| channel_messages | List[Dict] | A list of all channel messages |

___

### `send_channel_message`
#### Description
Sends a message to a specific channel.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| group_id | Text | The ID of the group |
| channel_id | Text | The ID of the channel |
| message | Text | The message content |
| subject | Optional[Text] | The subject of the message (optional) |

___

### `get_chat`
#### Description
Retrieves information about a specific chat.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_id | Text | The ID of the chat |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat | Dict | Chat information including the last message preview |

___

### `get_chats`
#### Description
Retrieves information about all chats.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chats | List[Dict] | A list of chat information dictionaries |

___

### `get_chat_message`
#### Description
Retrieves a specific message from a chat.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_id | Text | The ID of the chat |
| message_id | Text | The ID of the message |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| message | Dict | The chat message data |

___

### `get_chat_messages`
#### Description
Retrieves all messages from a specific chat.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_id | Text | The ID of the chat |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_messages | List[Dict] | A list of all messages in the chat |

___

### `get_all_chat_messages`
#### Description
Retrieves all messages from all chats.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_messages | List[Dict] | A list of all chat messages across all chats |

___

### `send_chat_message`
#### Description
Sends a message to a specific chat.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_id | Text | The ID of the chat |
| message | Text | The message content |
| subject | Optional[Text] | The subject of the message (optional) |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| typing | Type hinting |
| mindsdb.integrations.utilities.handlers.api_utilities.microsoft.ms_graph_api_utilities | Base class for Microsoft Graph API client |

## Error Handling
The class relies on error handling mechanisms implemented in the parent class `MSGraphAPIBaseClient`.
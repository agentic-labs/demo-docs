---
title: "sharepoint_tables.py"
---

## High-level description
This code defines several classes that handle interactions with SharePoint data through SQL-like queries. It provides a structured way to perform CRUD operations on SharePoint resources such as sites, lists, columns, and list items using a SQL-like interface.

## Code Structure
The file defines four main classes: `SitesTable`, `ListsTable`, `SiteColumnsTable`, and `ListItemsTable`. Each class inherits from `APITable` and implements methods for SELECT, INSERT, UPDATE, and DELETE operations on their respective SharePoint resources. These classes use utility classes from the `mindsdb` library to parse and execute SQL-like queries, translating them into appropriate SharePoint API calls.

## Symbols

### SitesTable
#### Description
Handles operations on SharePoint sites.

#### Methods
- `select`: Retrieves site data based on a SELECT query.
- `update`: Updates site data based on an UPDATE query.
- `get_columns`: Returns the columns available for sites.
- `get_sites`: Retrieves site data from SharePoint.
- `update_sites`: Updates site data in SharePoint.

### ListsTable
#### Description
Handles operations on SharePoint lists.

#### Methods
- `insert`: Inserts new lists based on an INSERT query.
- `select`: Retrieves list data based on a SELECT query.
- `update`: Updates list data based on an UPDATE query.
- `delete`: Deletes lists based on a DELETE query.
- `get_columns`: Returns the columns available for lists.
- `get_lists`: Retrieves list data from SharePoint.
- `delete_lists`: Deletes lists in SharePoint.
- `update_lists`: Updates list data in SharePoint.
- `create_lists`: Creates new lists in SharePoint.

### SiteColumnsTable
#### Description
Handles operations on SharePoint site columns.

#### Methods
- `insert`: Inserts new site columns based on an INSERT query.
- `select`: Retrieves site column data based on a SELECT query.
- `update`: Updates site column data based on an UPDATE query.
- `delete`: Deletes site columns based on a DELETE query.
- `get_columns`: Returns the columns available for site columns.
- `get_site_columns`: Retrieves site column data from SharePoint.
- `delete_site_columns`: Deletes site columns in SharePoint.
- `update_site_columns`: Updates site column data in SharePoint.
- `create_site_columns`: Creates new site columns in SharePoint.

### ListItemsTable
#### Description
Handles operations on SharePoint list items.

#### Methods
- `insert`: Inserts new list items based on an INSERT query.
- `select`: Retrieves list item data based on a SELECT query.
- `update`: Updates list item data based on an UPDATE query.
- `delete`: Deletes list items based on a DELETE query.
- `get_columns`: Returns the columns available for list items.
- `get_list_items`: Retrieves list item data from SharePoint.
- `delete_list_items`: Deletes list items in SharePoint.
- `update_list_items`: Updates list item data in SharePoint.
- `create_list_items`: Creates new list items in SharePoint.

## Dependencies
- pandas
- mindsdb_sql
- mindsdb.integrations.libs.api_handler
- mindsdb.integrations.utilities.handlers.query_utilities

## Error Handling
The code uses try-except blocks to handle potential errors during API calls and data processing. It raises `ValueError` for unsupported query conditions.

## Performance Considerations
The code uses pandas DataFrames for data manipulation, which can be memory-intensive for large datasets. It also makes multiple API calls for certain operations, which could impact performance for large-scale operations.
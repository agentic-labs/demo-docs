---
title: "sharepoint_handler.py"
---

## High-level description
This code defines the SharepointHandler class, which is an implementation of the APIHandler for interacting with Microsoft SharePoint. It provides functionality to connect to SharePoint, execute queries, and manage various SharePoint resources such as lists, sites, columns, and list items.

## Code Structure
The SharepointHandler class inherits from APIHandler and implements methods for connecting to SharePoint, checking the connection, and executing native queries. It also registers several table classes (ListsTable, SitesTable, ListItemsTable, SiteColumnsTable) to handle different SharePoint resources.

## Symbols

### SharepointHandler
#### Description
The main class for handling SharePoint interactions. It sets up the connection to SharePoint and manages different SharePoint resources.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | dict | Connection parameters for SharePoint |

#### Internal Logic
- Initializes the connection to SharePoint using the provided credentials
- Registers table classes for different SharePoint resources
- Implements methods for connecting, checking connection, and executing native queries

### connect
#### Description
Establishes a connection to SharePoint using the provided credentials.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | SharepointAPI | SharePoint API connection object |

### check_connection
#### Description
Checks the validity of the SharePoint connection.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

### native_query
#### Description
Executes a native SQL query on SharePoint data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | SQL query string |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Query execution status and results |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb_sql | SQL parsing and execution |
| SharepointAPI | Interaction with SharePoint API |
| APIHandler | Base class for API handlers |
| HandlerStatusResponse | Response object for handler status |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| clientId | str | None | Client ID for SharePoint app |
| clientSecret | str | None | Client secret for SharePoint app |
| tenantId | str | None | Tenant ID for SharePoint |

## Error Handling
The code implements basic error handling, logging errors when connecting to SharePoint and raising exceptions for missing required connection parameters.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging error messages.

This SharepointHandler provides a comprehensive interface for interacting with SharePoint resources through MindsDB, allowing users to query and manipulate SharePoint data using SQL-like syntax.
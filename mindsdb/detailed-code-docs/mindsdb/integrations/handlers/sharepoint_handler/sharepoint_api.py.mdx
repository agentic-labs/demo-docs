---
title: "sharepoint_api.py"
---

## High-level description
This code defines a `SharepointAPI` class that provides methods to interact with Microsoft SharePoint using the Microsoft Graph API. It includes functionality for authentication, managing sites, lists, columns, and list items within SharePoint.

## Code Structure
The `SharepointAPI` class contains methods for various SharePoint operations, utilizing utility functions from the `utils.py` file for making API requests. The class maintains authentication state and provides methods for CRUD operations on SharePoint entities.

## References
This code references utility functions from `mindsdb/integrations/handlers/sharepoint_handler/utils.py`, including `bearer_token_request`, `get_an_entity`, `delete_an_entity`, `update_an_entity`, and `create_an_entity`.

## Symbols

### SharepointAPI
#### Description
A class that encapsulates SharePoint API operations, handling authentication and providing methods to interact with SharePoint entities.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| client_id | str | The client ID for SharePoint API authentication |
| client_secret | str | The client secret for SharePoint API authentication |
| tenant_id | str | The tenant ID for SharePoint API authentication |

#### Internal Logic
- Initializes with authentication credentials
- Manages bearer token generation and validity
- Provides methods for various SharePoint operations (sites, lists, columns, items)

### get_bearer_token
#### Description
Generates a new bearer token for authentication with the SharePoint API.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | None | Updates the class attributes with the new token |

### check_bearer_token_validity
#### Description
Checks if the current bearer token is valid.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| is_valid | bool | True if the token is valid, False otherwise |

### get_all_sites
#### Description
Retrieves information about all SharePoint sites associated with the account.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| limit | int | Optional limit on the number of sites to return |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| sites | List[Dict[Text, Any]] | List of dictionaries containing site information |

### update_sites
#### Description
Updates multiple SharePoint sites with provided values.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| site_dict | List[Dict[Text, Text]] | List of dictionaries containing site IDs to update |
| values_to_update | Dict[Text, Any] | Dictionary of values to update for each site |

### get_all_lists
#### Description
Retrieves information about all SharePoint lists across all sites.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| limit | int | Optional limit on the number of lists to return |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| lists | List[Dict[Text, Any]] | List of dictionaries containing list information |

### create_lists
#### Description
Creates new SharePoint lists based on provided data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | List[Dict[Text, Any]] | List of dictionaries containing list creation information |

### get_all_site_columns
#### Description
Retrieves information about all site columns across all sites.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| limit | int | Optional limit on the number of columns to return |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| site_columns | List[Dict[Text, Any]] | List of dictionaries containing site column information |

### get_all_items
#### Description
Retrieves information about all list items across all sites and lists.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| limit | int | Optional limit on the number of items to return |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| items | List[Dict[Text, Any]] | List of dictionaries containing list item information |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ast | For literal evaluation of strings to Python objects |
| datetime | For handling date and time operations |
| typing | For type hinting |
| mindsdb.integrations.handlers.sharepoint_handler.utils | For utility functions to interact with SharePoint API |

## Error Handling
The code relies on error handling implemented in the utility functions from `utils.py`. These functions raise exceptions for client and server errors encountered during API requests.
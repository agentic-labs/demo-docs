---
title: "test_sharepoint_handler.py"
---

## High-level description
This code defines a unit test suite for the SharepointHandler class, which is part of the MindsDB integration with Microsoft SharePoint. The tests verify the functionality of various methods in the SharepointHandler, including connection checking, retrieving tables and columns, and executing native queries on different SharePoint entities.

## Code Structure
The code defines a `SharepointHandlerTest` class that inherits from `unittest.TestCase`. It contains several test methods that exercise different aspects of the SharepointHandler. The tests are designed to run sequentially, as indicated by their numeric prefixes.

## References
- `mindsdb.integrations.handlers.sharepoint_handler.Handler`
- `mindsdb.api.executor.data_types.response_type.RESPONSE_TYPE`

## Symbols

### SharepointHandlerTest
#### Description
This class contains unit tests for the SharepointHandler. It sets up a test environment with connection data and runs various tests to ensure the handler's functionality.

#### Internal Logic
1. Sets up a SharepointHandler instance with test credentials in the `setUpClass` method.
2. Runs a series of tests to check different functionalities of the handler.

### test_0_check_connection
#### Description
Tests the `check_connection` method of the SharepointHandler.

#### Internal Logic
Asserts that the `check_connection` method returns True, indicating a successful connection.

### test_1_get_tables
#### Description
Tests the `get_tables` method of the SharepointHandler.

#### Internal Logic
Verifies that the `get_tables` method returns a response that is not of type ERROR.

### test_2_select_sites_query
#### Description
Tests the `native_query` method for querying SharePoint sites.

#### Internal Logic
Executes a SELECT query on the 'sites' table and asserts that the result is of type TABLE.

### test_3_select_lists_query
#### Description
Tests the `native_query` method for querying SharePoint lists.

#### Internal Logic
Executes a SELECT query on the 'lists' table and asserts that the result is of type TABLE.

### test_4_select_siteColumns_query
#### Description
Tests the `native_query` method for querying SharePoint site columns.

#### Internal Logic
Executes a SELECT query on the 'siteColumns' table and asserts that the result is of type TABLE.

### test_5_select_listItems_query
#### Description
Tests the `native_query` method for querying SharePoint list items.

#### Internal Logic
Executes a SELECT query on the 'listItems' table and asserts that the result is of type TABLE.

### test_6_get_columns
#### Description
Tests the `get_columns` method of the SharepointHandler.

#### Internal Logic
Calls the `get_columns` method for the 'siteColumns' table and asserts that the result is not of type ERROR.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| os | Used to access environment variables for connection credentials |
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.sharepoint_handler | Contains the SharepointHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum for asserting response types |

## Configuration
The test suite uses environment variables for SharePoint connection credentials:
| Option | Type | Description |
|:-------|:-----|:------------|
| CLIENT_ID | string | The client ID for SharePoint authentication |
| CLIENT_SECRET | string | The client secret for SharePoint authentication |
| TENANT_ID | string | The tenant ID for SharePoint authentication |

## Error Handling
The test methods use assertions to check for expected outcomes. If any assertion fails, the test will raise an AssertionError, indicating a test failure.

## Notes
- The tests are designed to run in a specific order, as indicated by their numeric prefixes.
- The connection credentials are expected to be set as environment variables.
- The tests cover basic functionality of the SharepointHandler, including connection, table retrieval, and querying different SharePoint entities.
- The `native_query` method is tested with simple SELECT queries for various SharePoint entities (sites, lists, siteColumns, listItems).
- The test suite assumes that the SharePoint environment is set up and accessible with the provided credentials.
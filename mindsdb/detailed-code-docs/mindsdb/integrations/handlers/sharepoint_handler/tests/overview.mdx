---
title: "Overview"
---

## High-level description
This directory contains unit tests for the SharepointHandler class, which is part of the MindsDB integration with Microsoft SharePoint. The tests are designed to verify the functionality of various methods in the SharepointHandler, including connection checking, retrieving tables and columns, and executing native queries on different SharePoint entities.

## What does it do?
The test suite in this directory performs a series of checks to ensure that the SharepointHandler is working correctly. It simulates the process of connecting to a SharePoint instance, retrieving information about sites, lists, columns, and list items, and executing queries on these entities. This helps developers ensure that the SharePoint integration in MindsDB is functioning as expected and can interact with SharePoint data sources properly.

## Key Files
1. `test_sharepoint_handler.py`: This is the main test file containing the `SharepointHandlerTest` class. It includes several test methods that exercise different aspects of the SharepointHandler:

   - `test_0_check_connection`: Verifies that the handler can successfully connect to SharePoint.
   - `test_1_get_tables`: Checks if the handler can retrieve a list of available tables (entities) from SharePoint.
   - `test_2_select_sites_query` to `test_5_select_listItems_query`: These tests execute native queries on different SharePoint entities (sites, lists, site columns, and list items) to ensure that data can be retrieved correctly.
   - `test_6_get_columns`: Verifies that the handler can retrieve column information for a specific entity.

## Dependencies
The test suite relies on the following dependencies:

1. `unittest`: The Python standard library's unit testing framework, used to structure and run the tests.
2. `mindsdb.integrations.handlers.sharepoint_handler`: Contains the SharepointHandler class being tested.
3. `mindsdb.api.executor.data_types.response_type`: Provides the RESPONSE_TYPE enum for asserting response types.

## Configuration
The test suite uses environment variables for SharePoint connection credentials:

| Option | Type | Description |
|:-------|:-----|:------------|
| CLIENT_ID | string | The client ID for SharePoint authentication |
| CLIENT_SECRET | string | The client secret for SharePoint authentication |
| TENANT_ID | string | The tenant ID for SharePoint authentication |

These environment variables need to be set before running the tests to ensure proper authentication with the SharePoint instance.

## Notes
- The tests are designed to run sequentially, as indicated by their numeric prefixes.
- The test suite assumes that the SharePoint environment is set up and accessible with the provided credentials.
- The `native_query` method is tested with simple SELECT queries for various SharePoint entities (sites, lists, siteColumns, listItems).
- Error handling is implemented through assertions. If any assertion fails, the test will raise an AssertionError, indicating a test failure.

This test suite plays a crucial role in ensuring the reliability and correctness of the SharePoint integration in MindsDB, allowing developers to catch potential issues early in the development process.
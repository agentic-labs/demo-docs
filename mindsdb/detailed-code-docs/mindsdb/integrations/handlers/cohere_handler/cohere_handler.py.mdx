---
title: "cohere_handler.py"
---

## High-level description
This code implements a handler for integrating the Cohere AI service with MindsDB. It provides functionality for text summarization, text generation, and language detection using Cohere's API.

## Code Structure
The `CohereHandler` class extends `BaseMLEngine` and implements methods for creating a model, making predictions, and interacting with the Cohere API for specific tasks.

## Symbols

### CohereHandler
#### Description
A class that handles integration with the Cohere Python Library, providing methods for text summarization, text generation, and language detection.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| target | str | The target column for predictions |
| df | Optional[pd.DataFrame] | Input data for predictions |
| args | Optional[Dict] | Additional arguments for model creation and prediction |

#### Internal Logic
- The `create` method stores the provided arguments and sets up the model.
- The `predict` method processes input data and calls the appropriate prediction function based on the specified task.
- Three separate methods (`predict_text_summary`, `predict_text_generation`, `predict_language`) handle specific Cohere API calls for different tasks.

### predict
#### Description
Processes input data and calls the appropriate prediction function based on the specified task.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| df | Optional[pd.DataFrame] | Input data for predictions |
| args | Optional[Dict] | Additional arguments for prediction |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result_df | pd.DataFrame | DataFrame containing prediction results |

#### Internal Logic
1. Retrieves stored arguments and validates input data.
2. Calls the appropriate prediction method based on the specified task.
3. Renames the prediction column to match the target column name.

### predict_text_summary
#### Description
Connects with the Cohere API to generate a summary of the input text.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | str | Input text to be summarized |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text_summary | str | Generated summary of the input text |

### predict_text_generation
#### Description
Connects with the Cohere API to generate text based on the input prompt.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | str | Input text prompt for generation |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text_generated | str | Generated text based on the input prompt |

### predict_language
#### Description
Connects with the Cohere API to detect the language of the input text.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | str | Input text for language detection |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| language_detected | str | Detected language name |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| cohere | Interacting with the Cohere API |
| pandas | Data manipulation and analysis |
| mindsdb.utilities.config | Accessing configuration settings |
| mindsdb.integrations.libs.base | Base class for ML engines |
| mindsdb.utilities | Logging and utility functions |
| mindsdb.integrations.utilities.handler_utils | Utility for retrieving API keys |

## Error Handling
The code includes basic error handling, such as raising exceptions for missing required arguments or unsupported tasks.

## API/Interface Reference
The `CohereHandler` class implements the following main methods:
| Method | Description |
|:-------|:------------|
| create | Sets up the model with provided arguments |
| predict | Processes input data and generates predictions |

These methods are part of the `BaseMLEngine` interface and are used by MindsDB to interact with the Cohere integration.
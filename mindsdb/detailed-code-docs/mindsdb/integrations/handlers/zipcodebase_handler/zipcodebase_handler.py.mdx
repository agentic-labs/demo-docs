---
title: "zipcodebase_handler.py"
---

## High-level description
This code defines the `ZipCodeBaseHandler` class, which is an implementation of an API handler for the ZipCodeBase service. It provides functionality to interact with various ZipCodeBase API endpoints, manage connections, and handle queries related to zip code data.

## Code Structure
The `ZipCodeBaseHandler` class inherits from `APIHandler` and initializes several table objects for different ZipCodeBase API endpoints. It also manages the connection to the ZipCodeBase service and provides methods for connecting, checking the connection, and executing native queries.

## Symbols

### ZipCodeBaseHandler
#### Description
This class is the main handler for interacting with the ZipCodeBase API. It sets up the necessary tables and manages the connection to the service.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| **kwargs | dict | Additional keyword arguments, including connection data |

#### Internal Logic
1. Initializes the parent `APIHandler` class.
2. Sets up connection data and creates a `ZipCodeBaseClient` instance.
3. Registers various table objects for different ZipCodeBase API endpoints.
4. Provides methods for connecting, checking connection, and executing native queries.

### connect
#### Description
Sets up the connection to the ZipCodeBase service.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| resp | StatusResponse | Connection status response |

#### Internal Logic
1. Checks the remaining requests using the ZipCodeBase client.
2. Sets the connection status based on the response.

### check_connection
#### Description
Checks the connection to the ZipCodeBase service.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status response |

#### Internal Logic
1. Attempts to check remaining requests using the ZipCodeBase client.
2. Sets the connection status and error message based on the response.
3. Handles exceptions and logs errors if they occur.

### native_query
#### Description
Receives and processes a raw SQL query.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | SQL query in native format |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| StatusResponse | StatusResponse | Query execution status |

#### Internal Logic
1. Parses the input SQL query using the MindsDB SQL parser.
2. Calls the `query` method with the parsed AST.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb_sql | For parsing SQL queries |
| mindsdb.integrations.libs.api_handler | Base APIHandler class |
| mindsdb.integrations.libs.response | Response classes for handler operations |
| mindsdb.utilities | Logging utilities |

## Error Handling
The code implements basic error handling in the `check_connection` method, catching exceptions and logging errors. It also uses `StatusResponse` objects to communicate success or failure of operations.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging information and errors, particularly in the `check_connection` method.
---
title: "twelve_labs_handler.py"
---

## High-level description
The `TwelveLabsHandler` class provides an interface for MindsDB to interact with the Twelve Labs API for video indexing, search, and summarization tasks. It allows users to create and manage video indexes, index videos, and perform search and summarization operations on the indexed videos.

## Code Structure
The `TwelveLabsHandler` class interacts with the `TwelveLabsAPIClient` to communicate with the Twelve Labs API. It uses the `model_storage` to store model-specific information, such as the index ID and API key. The `create()` method handles the creation of the index and indexing of videos, while the `predict()` method handles search and summarization tasks.

## References
This code references the following classes:
- `BaseMLEngine`: This class defines the base interface for MindsDB ML engines.
- `TwelveLabsAPIClient`: This class handles the communication with the Twelve Labs API.
- `TwelveLabsHandlerModel`: This class defines the model for validating the arguments passed to the handler.
- `MissingConnectionParams`: This exception is raised when required connection parameters are missing.

## Symbols

### `TwelveLabsHandler`
#### Description
This class implements the MindsDB interface for interacting with the Twelve Labs API. It handles the creation, prediction, and description of models for video indexing, search, and summarization tasks.

#### Inputs
This class does not have explicit inputs. It inherits inputs from the `BaseMLEngine` class.

#### Outputs
This class does not have explicit outputs. It returns dataframes or None based on the specific method called.

#### Internal Logic
This class defines several methods for interacting with the Twelve Labs API:
- `create_validation()`: This static method validates the arguments passed during model creation.
- `create()`: This method creates a new video index, indexes videos, and stores the index ID in the `model_storage`.
- `predict()`: This method performs search or summarization tasks based on the provided arguments and returns the results as a Pandas DataFrame.
- `describe()`: This method provides a description of the model, including the arguments used and the videos indexed.
- `_get_api_client()`: This private method retrieves the API key and initializes a `TwelveLabsAPIClient` instance.

## Side Effects
This class modifies the `model_storage` by storing model-specific information, such as the index ID and API key. It also interacts with the Twelve Labs API to create indexes, index videos, and perform search and summarization tasks.

## Dependencies
This code depends on the following external libraries:
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Data manipulation and analysis. |
| mindsdb.utilities | MindsDB utility functions. |
| mindsdb.integrations.libs.base | Base classes for MindsDB integrations. |
| mindsdb.integrations.utilities.handler_utils | Utility functions for MindsDB handlers. |
| mindsdb.integrations.libs.api_handler_exceptions | Custom exceptions for API handler errors. |
| mindsdb.integrations.handlers.twelve_labs_handler.settings | Settings and validation for the Twelve Labs handler. |
| mindsdb.integrations.handlers.twelve_labs_handler.twelve_labs_api_client | Client for interacting with the Twelve Labs API. |

## Error Handling
This code raises a `MissingConnectionParams` exception if the required connection parameters are not provided in the USING clause during model creation.

## TODOs
- The `predict()` method currently supports only a single search query. It should be extended to support multiple queries.
- The `predict()` method could be improved to allow users to select specific columns from the results.
- The nested columns in the results of the `predict()` method could be structured for better readability.

---
title: "teradata_handler.py"
---

## High-level description
This code defines a TeradataHandler class, which is a database handler for connecting to and interacting with Teradata databases. It provides methods for connecting, disconnecting, checking connections, executing queries, and retrieving table and column information from Teradata databases.

## Code Structure
The TeradataHandler class inherits from DatabaseHandler and implements various methods for database operations. It uses the teradatasql and teradatasqlalchemy libraries for Teradata-specific functionality, and integrates with MindsDB's SQL parsing and rendering capabilities.

## References
- DatabaseHandler from mindsdb.integrations.libs.base
- Response and StatusResponse from mindsdb.integrations.libs.response
- parse_sql from mindsdb_sql
- SqlalchemyRender from mindsdb_sql.render.sqlalchemy_render

## Symbols

### TeradataHandler
#### Description
A handler class for Teradata databases, providing methods to connect, disconnect, check connections, and execute queries.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the handler instance |
| connection_data | dict | Connection parameters for the Teradata database |

#### Internal Logic
- Initializes connection parameters and sets up SQL parsing and rendering capabilities.
- Implements methods for connecting, disconnecting, checking connections, and executing queries.
- Provides methods to retrieve table and column information from the Teradata database.

### connect
#### Description
Establishes a connection to the Teradata database using the provided connection data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| connection | teradatasql.Connection | Active database connection |

### disconnect
#### Description
Closes the active connection to the Teradata database.

### check_connection
#### Description
Verifies the connection to the Teradata database by executing a simple query.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | StatusResponse | Connection status and error message if applicable |

### native_query
#### Description
Executes a raw SQL query on the Teradata database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | str | SQL query to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query result or error information |

### query
#### Description
Executes a query represented as an AST (Abstract Syntax Tree) node.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | ASTNode | SQL query as an AST node |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | Query result or error information |

### get_tables
#### Description
Retrieves a list of tables in the current Teradata database.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of tables and their properties |

### get_columns
#### Description
Retrieves a list of columns for a specified table in the Teradata database.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| table_name | str | Name of the table to get columns for |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| response | Response | List of columns and their properties |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| teradatasql | Teradata database connectivity |
| teradatasqlalchemy | Teradata SQLAlchemy dialect |
| mindsdb_sql | SQL parsing and rendering |
| pandas | Data manipulation and storage |

## Error Handling
The code implements basic error handling, catching exceptions during database operations and returning appropriate error responses. Errors are logged using the MindsDB logging utility.

## Logging
The code uses MindsDB's logging utility to log error messages, particularly when there are issues connecting to the database or executing queries.

This TeradataHandler provides a comprehensive interface for interacting with Teradata databases within the MindsDB ecosystem, allowing for seamless integration of Teradata data sources into MindsDB's machine learning and AI capabilities.
---
title: "stripe_tables.py"
---

## High-level description
This file defines several table classes for the Stripe integration in MindsDB. These classes handle various Stripe resources such as Customers, Products, Payment Intents, Refunds, and Payouts. They provide methods for selecting, inserting, updating, and deleting data using SQL-like queries, which are then translated to appropriate Stripe API calls.

## Code Structure
The file contains five main classes: `CustomersTable`, `ProductsTable`, `PaymentIntentsTable`, `RefundsTable`, and `PayoutsTable`. Each class inherits from `APITable` and implements methods for interacting with the corresponding Stripe resource. The classes use utility classes from `mindsdb.integrations.utilities.handlers.query_utilities` to parse and execute SQL-like queries.

## Symbols

### CustomersTable
#### Description
Handles operations related to Stripe Customers.

#### Methods
- `select`: Retrieves customer data based on a SQL SELECT query.
- `get_columns`: Returns the list of columns for the customers table.
- `get_customers`: Fetches customer data from Stripe API.

### ProductsTable
#### Description
Handles operations related to Stripe Products.

#### Methods
- `select`: Retrieves product data based on a SQL SELECT query.
- `insert`: Inserts new product data into Stripe.
- `update`: Updates existing product data in Stripe.
- `delete`: Deletes products from Stripe.
- `get_columns`: Returns the list of columns for the products table.
- `get_products`: Fetches product data from Stripe API.
- `create_products`: Creates new products in Stripe.
- `update_products`: Updates existing products in Stripe.
- `delete_products`: Deletes products from Stripe.

### PaymentIntentsTable
#### Description
Handles operations related to Stripe Payment Intents.

#### Methods
- `select`: Retrieves payment intent data based on a SQL SELECT query.
- `delete`: Cancels payment intents in Stripe.
- `update`: Updates existing payment intent data in Stripe.
- `insert`: Creates new payment intents in Stripe.
- `get_columns`: Returns the list of columns for the payment intents table.
- `get_payment_intents`: Fetches payment intent data from Stripe API.
- `cancel_payment_intents`: Cancels payment intents in Stripe.
- `update_payment_intents`: Updates existing payment intents in Stripe.
- `create_payment_intent`: Creates new payment intents in Stripe.

### RefundsTable
#### Description
Handles operations related to Stripe Refunds.

#### Methods
- `select`: Retrieves refund data based on a SQL SELECT query.
- `get_columns`: Returns the list of columns for the refunds table.
- `get_refunds`: Fetches refund data from Stripe API.

### PayoutsTable
#### Description
Handles operations related to Stripe Payouts.

#### Methods
- `select`: Retrieves payout data based on a SQL SELECT query.
- `get_columns`: Returns the list of columns for the payouts table.
- `get_payouts`: Fetches payout data from Stripe API.

## Dependencies
- pandas
- stripe
- mindsdb_sql
- mindsdb.integrations.libs.api_handler
- mindsdb.integrations.utilities.handlers.query_utilities
- mindsdb.utilities

## Error Handling
The code includes basic error handling, primarily using exceptions. For example, in the `create_products` method, it raises an exception if product creation fails. Similarly, in the `cancel_payment_intents` method, it logs errors when cancelling payment intents fails.

## Logging
The code uses the `log` module from `mindsdb.utilities` for logging. It logs information about product creation, updates, and deletions, as well as errors when cancelling payment intents.

This file is a crucial part of the Stripe integration for MindsDB, providing the necessary functionality to interact with various Stripe resources using SQL-like queries. It translates these queries into appropriate Stripe API calls, allowing for seamless integration between MindsDB and Stripe.
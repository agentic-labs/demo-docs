---
title: "lightdash_handler.py"
---

## High-level description
The `LightdashHandler` class is an API handler for interacting with Lightdash, a business intelligence and data visualization platform. It provides methods for connecting to a Lightdash instance, checking the connection status, and executing native SQL queries.

## Code Structure
The `LightdashHandler` class inherits from the `APIHandler` class and utilizes the `Lightdash` class for communication with the Lightdash API. It also defines several table classes (`UserTable`, `OrgTable`, etc.) that represent different data models within Lightdash.

## References
- `mindsdb_sql.parse_sql`: Used for parsing SQL queries.
- `mindsdb.integrations.libs.api_handler.APIHandler`: Base class for API handlers.
- `mindsdb.integrations.libs.response.HandlerStatusResponse`: Used for returning status responses.
- `mindsdb.integrations.handlers.lightdash_handler.api.Lightdash`: Class for interacting with the Lightdash API.
- `mindsdb.integrations.handlers.lightdash_handler.lightdash_tables`: Module containing table classes representing Lightdash data models.

## Symbols

### `LightdashHandler`
#### Description
This class handles interactions with the Lightdash API, including connecting to an instance, checking the connection status, and executing queries.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | The name of the handler. |
| **kwargs | dict | Keyword arguments for configuring the handler. |

#### Outputs
This class doesn't directly return any values, but its methods return objects like `StatusResponse` or data from Lightdash.

#### Internal Logic
- Initializes the handler with the provided name and connection parameters.
- Registers tables representing Lightdash data models.
- Connects to the Lightdash instance using the provided API key and base URL.

#### Methods
- `connect()`: Establishes a connection to the Lightdash instance.
- `check_connection()`: Verifies if the connection to Lightdash is active.
- `native_query(query: str)`: Parses and executes a native SQL query against Lightdash.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb_sql | Used for parsing SQL queries. |
| mindsdb.integrations.libs.api_handler | Provides the base class for API handlers. |
| mindsdb.integrations.libs.response | Provides classes for handling responses. |
| mindsdb.integrations.handlers.lightdash_handler.api | Contains the `Lightdash` class for interacting with the Lightdash API. |
| mindsdb.integrations.handlers.lightdash_handler.lightdash_tables | Defines table classes representing Lightdash data models. |

### Configuration
The `LightdashHandler` class uses the following configuration options:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| api_key | str | None | API token for accessing the Lightdash instance. |
| base_url | str | None | Base URL of the Lightdash instance. |

## Error Handling
The `check_connection()` method returns a `StatusResponse` object that indicates whether the connection to Lightdash is successful or not. If the connection fails, the `error` attribute of the response object contains an error message.

## API/Interface Reference
This code doesn't expose a public API. It's an internal module for handling Lightdash integration.

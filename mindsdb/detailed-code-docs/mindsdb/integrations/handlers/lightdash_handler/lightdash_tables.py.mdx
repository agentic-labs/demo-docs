---
title: "lightdash_tables.py"
---

## High-level description
This code defines a set of custom API tables that represent various data structures within a Lightdash integration. Each table class handles fetching, filtering, and formatting data from the Lightdash API based on SQL-like queries.

## Code Structure
The code defines a base `CustomAPITable` class that provides common functionality for all API tables. Several specific table classes, such as `UserTable`, `OrgTable`, and `ChartsTable`, inherit from this base class and implement their own logic for fetching and processing data from specific Lightdash API endpoints. These table classes are independent of each other but all rely on the `APIHandler` class for interacting with the Lightdash API.

## References
This code references the following symbols:
- `mindsdb.integrations.utilities.handlers.query_utilities.SELECTQueryExecutor`
- `mindsdb.integrations.utilities.handlers.query_utilities.SELECTQueryParser`
- `mindsdb.integrations.libs.api_handler.APIHandler`
- `mindsdb.integrations.libs.api_handler.APITable`
- `mindsdb.integrations.utilities.sql_utils.conditions_to_filter`

## Symbols

### `CustomAPITable`
#### Description
This abstract base class defines the common interface and functionality for all custom API tables. It provides methods for connecting to the API, retrieving column names, parsing SQL-like select queries, and applying query parameters to filter and sort data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The class defines several methods:
- `__init__`: Initializes the table object and establishes a connection to the Lightdash API.
- `get_columns`: Returns a list of column names for the table, excluding any specified in the `ignore` list.
- `select`: An abstract method that should be implemented by subclasses to fetch data from the API based on the provided SQL query.
- `parse_select`: Parses a SQL-like select query and extracts information about selected columns, where conditions, order by clauses, and result limits.
- `get_where_param`: Extracts the value of a specific parameter from the WHERE clause of a SQL query.
- `apply_query_params`: Applies the extracted query parameters (selected columns, order by, limit) to a Pandas DataFrame.

### `UserTable`
#### Description
This class represents the "user" table and handles fetching and filtering user data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches user data from the API, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `UserAbilityTable`
#### Description
This class represents the "user_ability" table and handles fetching and filtering user ability data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches user ability data from the API, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `OrgTable`
#### Description
This class represents the "org" table and handles fetching and filtering organization data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches organization data from the API, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `OrgProjectsTable`
#### Description
This class represents the "org_projects" table and handles fetching and filtering organization project data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches organization project data from the API, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `OrgMembersTable`
#### Description
This class represents the "org_members" table and handles fetching and filtering organization member data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches organization member data from the API, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ProjectTable`
#### Description
This class represents the "project_table" table and handles fetching and filtering project data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches project data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `WarehouseConnectionTable`
#### Description
This class represents the "warehouse_connection" table and handles fetching and filtering warehouse connection data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches warehouse connection data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `DBTConnectionTable`
#### Description
This class represents the "dbt_connection" table and handles fetching and filtering DBT connection data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches DBT connection data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `DBTEnvironmentVarsTable`
#### Description
This class represents the "dbt_env_vars" table and handles fetching and filtering DBT environment variable data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches DBT environment variable data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ChartsTable`
#### Description
This class represents the "charts" table and handles fetching and filtering chart data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches chart data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `SpacesTable`
#### Description
This class represents the "spaces" table and handles fetching and filtering space data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches space data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `AccessTable`
#### Description
This class represents the "access" table and handles fetching and filtering access data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches access data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ValidationTable`
#### Description
This class represents the "validation" table and handles fetching and filtering validation data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches validation data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `DashboardsTable`
#### Description
This class represents the "dashboards" table and handles fetching and filtering dashboard data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches dashboard data from the API based on the provided project UUID and space UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `QueriesTable`
#### Description
This class represents the "queries" table and handles fetching and filtering query data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches query data from the API based on the provided project UUID and space UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ChartHistoryTable`
#### Description
This class represents the "chart_history" table and handles fetching and filtering chart history data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches chart history data from the API based on the provided chart UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ChartConfigTable`
#### Description
This class represents the "chart_config" table and handles fetching and filtering chart configuration data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches chart configuration data from the API based on the provided chart UUID and version UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ChartAdditionalMetricsTable`
#### Description
Thisclass represents the "chart_additional_metrics" table and handles fetching and filtering additional metrics data for charts from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches additional metrics data for charts from the API based on the provided chart UUID and version UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `ChartTableCalculationsTable`
#### Description
This class represents the "chart_table_calculations" table and handles fetching and filtering table calculation data for charts from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches table calculation data for charts from the API based on the provided chart UUID and version UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `SchedulerLogsTable`
#### Description
This class represents the "scheduler_logs" table and handles fetching and filtering scheduler log data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches scheduler log data from the API based on the provided project UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `SchedulerTable`
#### Description
This class represents the "scheduler" table and handles fetching and filtering scheduler data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches scheduler data from the API based on the provided scheduler UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `SchedulerJobsTable`
#### Description
This class represents the "scheduler_jobs" table and handles fetching and filtering scheduler job data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches scheduler job data from the API based on the provided scheduler UUID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

### `SchedulerJobStatus`
#### Description
This class represents the "scheduler_job_status" table and handles fetching and filtering scheduler job status data from the Lightdash API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handler | mindsdb.integrations.libs.api_handler.APIHandler | An instance of the APIHandler class for interacting with the Lightdash API. |

#### Outputs
This class does not directly return any values.

#### Internal Logic
The `select` method fetches scheduler job status data from the API based on the provided job ID, converts it into a Pandas DataFrame, and applies any filtering or sorting specified in the SQL query.

## Dependencies
The code relies on the following external libraries:
- pandas
- mindsdb_sql

## Error Handling
The code uses basic error handling, primarily raising `NotImplementedError` exceptions for unimplemented features or unsupported query conditions. More robust error handling could be implemented to provide clearer error messages and handle potential API errors.

## Performance Considerations
The performance of these table classes depends largely on the efficiency of the Lightdash API and the volume of data being fetched. For large datasets, pagination or chunking strategies might need to be implemented to avoid memory issues or long response times.
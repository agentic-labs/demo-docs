---
title: "dataset.py"
---

## High-level description
This code defines utility functions and exception classes for handling datasets in a machine learning context. It provides functionality to validate, load, and process datasets for specific machine learning task types, with a focus on question answering tasks.

## Code Structure
The code defines several custom exception classes, followed by utility functions for dataset validation and loading. The main functions interact with each other to ensure proper dataset handling and validation.

## Symbols

### `DATASETS_BASE_PATH`
#### Description
A constant that stores the base path for datasets, set to the parent directory of the current file.

### `SUPPORTED_TASK_TYPES`
#### Description
A tuple containing the supported machine learning task types, currently only including "question_answering".

### Custom Exception Classes
#### Description
Several custom exception classes are defined to handle specific error scenarios:
- `DatasetNameMissing`
- `MLTaskTypeMissing`
- `DatasetNotFound`
- `UnsupportedMLTaskType`
- `MissingColumns`

These exceptions are raised in various functions when specific conditions are not met.

### `validate_dataset`
#### Description
Validates the provided ML task type and dataset name, ensuring they meet the required criteria.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ml_task_type | str | The type of machine learning task |
| dataset_name | str | The name of the dataset |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dataset_path | Path | The validated path to the dataset file |

#### Internal Logic
1. Checks if ml_task_type and dataset_name are provided
2. Verifies if the ml_task_type is supported
3. Constructs and validates the dataset file path

### `load_dataset`
#### Description
Loads a dataset based on the provided ML task type and dataset name.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ml_task_type | str | The type of machine learning task |
| dataset_name | str | The name of the dataset |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dataset | DataFrame | The loaded dataset as a pandas DataFrame |

#### Internal Logic
1. Calls `validate_dataset` to get the validated dataset path
2. Loads the CSV file at the validated path using pandas

### `validate_dataframe`
#### Description
Validates that a given DataFrame contains all the specified mandatory columns.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| df | DataFrame | The DataFrame to validate |
| mandatory_columns | list | List of column names that must be present in the DataFrame |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| df | DataFrame | The validated DataFrame |

#### Internal Logic
1. Checks if all mandatory columns are present in the DataFrame
2. Raises a `MissingColumns` exception if any mandatory columns are missing

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pathlib | For handling file paths |
| pandas | For data manipulation and CSV file reading |

## Error Handling
The code implements custom exception classes to handle specific error scenarios related to dataset validation and loading. These exceptions are raised in the utility functions when certain conditions are not met, allowing for more precise error handling in the calling code.
---
title: "2024-06-06_cbedc4968d5d_store_llm_data.py"
---

## High-level description
This code defines an Alembic migration script to create a new table called 'llm_data' in the database. The table is designed to store input-output pairs for Language Learning Model (LLM) interactions, along with associated metadata such as the model ID and timestamps.

## Symbols

### `upgrade()`
#### Description
This function defines the changes to be applied to the database schema when upgrading to this revision. It creates the 'llm_data' table with specified columns.

#### Internal Logic
1. Uses `op.create_table()` to create a new table named 'llm_data'.
2. Defines the following columns:
   - 'id': An auto-incrementing integer primary key.
   - 'input': A string column to store the input text for the LLM.
   - 'output': A string column to store the output text from the LLM.
   - 'model_id': A string column to store the identifier of the LLM model used.
   - 'created_at': A datetime column with a server default of the current timestamp.
   - 'updated_at': A datetime column with a server default of the current timestamp and an update trigger.

### `downgrade()`
#### Description
This function defines the changes to be applied to the database schema when downgrading from this revision. It drops the 'llm_data' table.

#### Internal Logic
Uses `op.drop_table()` to remove the 'llm_data' table from the database.

## References
The migration script references the following Alembic and SQLAlchemy components:
- `alembic.op`: Used for database operations like creating and dropping tables.
- `sqlalchemy.sa`: Used for defining column types and constraints.

## Dependencies
The script imports `mindsdb.interfaces.storage.db`, which likely contains database-related utilities or configurations specific to the MindsDB project.

## Configuration
The migration is identified by the following configuration:
- Revision ID: 'cbedc4968d5d'
- Down revision: '2958416fbe75'
- Branch labels: None
- Dependencies: None

## Notes
This migration aligns with the `LLMData` class defined in the related `mindsdb/interfaces/storage/db.py` file. The table structure created by this migration matches the attributes of the `LLMData` class, suggesting that this migration is setting up the database schema to support the ORM model defined in the related file.
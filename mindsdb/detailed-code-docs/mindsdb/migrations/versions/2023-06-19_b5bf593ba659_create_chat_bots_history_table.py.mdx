---
title: "2023-06-19_b5bf593ba659_create_chat_bots_history_table.py"
---

## High-level description
This code defines an Alembic migration script that creates a new table called 'chat_bots_history' in the database. The table is designed to store historical data related to chat bot interactions, including messages, errors, and metadata.

## Symbols

### `upgrade()`
#### Description
This function is responsible for creating the 'chat_bots_history' table in the database when the migration is applied.

#### Internal Logic
The function uses Alembic's `op.create_table()` method to define and create the table with the following columns:
- `id`: An integer primary key
- `chat_bot_id`: An integer representing the associated chat bot
- `type`: A string column for the type of entry
- `text`: A string column for the message text
- `user`: A string column for the user identifier
- `destination`: A string column for the message destination
- `sent_at`: A DateTime column for the timestamp
- `error`: A string column for storing any error messages

### `downgrade()`
#### Description
This function is responsible for removing the 'chat_bots_history' table from the database when the migration is rolled back.

#### Internal Logic
The function uses Alembic's `op.drop_table()` method to remove the 'chat_bots_history' table from the database.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| alembic | Used for database migrations |
| sqlalchemy | Used for defining database schema |

## Configuration
The migration script includes configuration metadata at the top:

| Option | Type | Value | Description |
|:-------|:-----|:------|:------------|
| revision | string | 'b5bf593ba659' | Unique identifier for this migration |
| down_revision | string | '9d6271bb2c38' | Identifier of the previous migration |
| branch_labels | None | None | No branch labels are specified |
| depends_on | None | None | No dependencies are specified |

This configuration is used by Alembic to manage the order and application of migrations.
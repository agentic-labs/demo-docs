---
title: "2024-02-02_5a5c49313e52_job_condition.py"
---

## High-level description
This code represents an Alembic migration script for adding a new column `if_query_str` to the `jobs` table in the MindsDB database. The migration is designed to be reversible, allowing both upgrade and downgrade operations.

## Symbols

### `upgrade()`
#### Description
This function defines the changes to be applied to the database schema when upgrading to this revision. It adds a new column `if_query_str` to the `jobs` table.

#### Internal Logic
1. Uses `op.batch_alter_table()` to start a batch operation on the `jobs` table.
2. Adds a new column `if_query_str` of type `String` that is nullable.

### `downgrade()`
#### Description
This function defines the changes to be applied to the database schema when downgrading from this revision. It removes the `if_query_str` column from the `jobs` table.

#### Internal Logic
1. Uses `op.batch_alter_table()` to start a batch operation on the `jobs` table.
2. Drops the `if_query_str` column.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| alembic | Provides database migration tools and utilities |
| sqlalchemy | Used for defining database schema and operations |
| mindsdb.interfaces.storage.db | Imports necessary database-related components from MindsDB |

## References
This migration script references the `jobs` table, which is defined in the related `mindsdb/interfaces/storage/db.py` file. The `Jobs` class in that file represents the structure of the `jobs` table.

## Notes
1. The migration is identified by the revision ID '5a5c49313e52' and is based on the previous revision '4b3c9d63e89c'.
2. The `if_query_str` column is added as a nullable String column, suggesting it's an optional field for conditional query execution in jobs.
3. This migration aligns with the `Jobs` model in the related file, which already includes the `if_query_str` column in its definition.
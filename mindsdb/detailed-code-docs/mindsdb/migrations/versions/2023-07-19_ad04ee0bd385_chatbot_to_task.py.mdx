---
title: "2023-07-19_ad04ee0bd385_chatbot_to_task.py"
---

## High-level description
This code represents an Alembic migration script for a database schema change. It removes several columns from the 'chat_bots' table, effectively transitioning the chatbot model to a more generalized task model.

## Code Structure
The script defines two main functions: `upgrade()` and `downgrade()`, which are used by Alembic to apply or revert the migration respectively.

## Symbols

### `upgrade()`
#### Description
This function applies the migration by removing specific columns from the 'chat_bots' table.

#### Internal Logic
1. Uses a batch alter table operation on the 'chat_bots' table.
2. Drops the following columns:
   - 'chat_engine'
   - 'user_class'
   - 'company_id'
   - 'is_running'

### `downgrade()`
#### Description
This function reverts the migration by adding back the columns that were removed in the `upgrade()` function.

#### Internal Logic
1. Uses a batch alter table operation on the 'chat_bots' table.
2. Adds the following columns:
   - 'is_running' (BOOLEAN)
   - 'company_id' (INTEGER)
   - 'user_class' (INTEGER)
   - 'chat_engine' (VARCHAR)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| alembic | Used for database migrations |
| sqlalchemy | SQL toolkit and ORM |
| mindsdb.interfaces.storage.db | Likely contains custom database types or functions |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| revision | string | 'ad04ee0bd385' | Unique identifier for this migration |
| down_revision | string | 'a57506731839' | Identifier of the previous migration |
| branch_labels | None | None | Used for branching in migration history |
| depends_on | None | None | Dependencies on other migrations |

## Notes
1. This migration is part of a series, as indicated by the 'down_revision' value.
2. The migration appears to be moving away from a chatbot-specific model to a more general task model by removing chatbot-specific columns.
3. The `mindsdb.interfaces.storage.db` import is marked with a `# noqa` comment, indicating that it's necessary even if not directly used in this file.
4. The migration uses SQLAlchemy's `batch_alter_table` context manager, which is typically used for databases that don't support transactional DDL.
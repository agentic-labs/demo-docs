---
title: "2023-09-20_309db3d07cf4_add_knowledge_base.py"
---

## High-level description
This code represents an Alembic migration script that adds a new table called "knowledge_base" to the database schema. The migration creates the table structure with various columns and constraints, including foreign key relationships to other tables.

## Code Structure
The code follows the standard Alembic migration script structure with `upgrade()` and `downgrade()` functions. The `upgrade()` function creates the new table, while the `downgrade()` function removes it.

## Symbols

### upgrade()
#### Description
This function is responsible for creating the "knowledge_base" table in the database schema.

#### Internal Logic
1. Creates a new table named "knowledge_base" using `op.create_table()`.
2. Defines columns for the table, including id, name, project_id, params, vector_database_id, vector_database_table, embedding_model_id, created_at, and updated_at.
3. Sets up foreign key constraints for vector_database_id and embedding_model_id.
4. Establishes a primary key constraint on the id column.
5. Creates a unique constraint on the combination of name and project_id.

### downgrade()
#### Description
This function is responsible for removing the "knowledge_base" table from the database schema.

#### Internal Logic
Drops the "knowledge_base" table using `op.drop_table()`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| sqlalchemy | Used for defining database schema and operations |
| alembic | Migration tool for SQLAlchemy |
| mindsdb.interfaces.storage.db | Imported but not directly used in the script |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| revision | string | "309db3d07cf4" | Unique identifier for this migration |
| down_revision | string | "6cb02dfd7f61" | Identifier of the previous migration |
| branch_labels | None | None | No branch labels specified |
| depends_on | None | None | No dependencies specified |

These configuration options are used by Alembic to manage the migration history and dependencies.
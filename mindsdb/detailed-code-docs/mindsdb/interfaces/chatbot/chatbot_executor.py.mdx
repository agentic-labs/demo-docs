---
title: "chatbot_executor.py"
---

## High-level description
This code defines a `BotExecutor` class and its subclass `MultiModeBotExecutor`, which are responsible for processing chat interactions in a chatbot system. The `AgentExecutor` class is also defined to handle agent-based chat processing. These classes manage the execution of chat models, handle different modes of operation, and process user inputs to generate appropriate responses.

## Code Structure
The main classes in this file are `BotExecutor`, `MultiModeBotExecutor`, and `AgentExecutor`. `MultiModeBotExecutor` inherits from `BotExecutor` and extends its functionality to support multiple modes of operation. `AgentExecutor` is a separate class that handles agent-based chat processing. These classes interact with `ModelExecutor` (imported from `model_executor.py`) to execute the actual chat models.

## Symbols

### `BotExecutor`
#### Description
This class handles the basic execution of a chatbot, including preparing available functions and processing chat interactions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| chat_task | object | Contains information about the chat task |
| chat_memory | object | Manages the chat history and memory |

#### Internal Logic
1. Initializes with chat_task and chat_memory
2. Prepares available functions from the backoffice database
3. Processes chat interactions using a model executor

### `MultiModeBotExecutor`
#### Description
Extends `BotExecutor` to support multiple modes of operation for the chatbot.

#### Internal Logic
1. Inherits from `BotExecutor`
2. Manages different modes of operation defined in `chat_task.bot_params['modes']`
3. Handles mode selection and switching
4. Processes chat interactions based on the current mode

### `AgentExecutor`
#### Description
Handles agent-based chat processing, converting chat history to a specific conversation format.

#### Internal Logic
1. Converts chat history to a specific conversation format
2. Uses an agents controller to process the chat and generate responses

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb.interfaces.agents.constants | Imports constants for user and assistant columns |
| .model_executor | Imports ModelExecutor for executing chat models |
| .types | Imports Function and BotException types |

## Error Handling
The code uses `BotException` to handle and raise errors related to unsupported modes or other bot-specific issues.

## API/Interface Reference
The main interface for these classes is the `process()` method, which is called to handle chat interactions and generate responses.

## Performance Considerations
The code implements a mode switching mechanism in `MultiModeBotExecutor` that may require running the model twice if the mode changes, which could impact performance for frequent mode switches.
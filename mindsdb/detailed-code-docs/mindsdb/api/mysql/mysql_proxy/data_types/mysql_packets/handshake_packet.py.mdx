---
title: "handshake_packet.py"
---

## High-level description
This code defines a `HandshakePacket` class that represents the initial handshake packet sent by a MySQL server to a client when establishing a connection. It implements the structure and content of this packet according to the MySQL protocol specification.

## Code Structure
The `HandshakePacket` class inherits from a `Packet` base class and defines various attributes that correspond to different fields in the handshake packet. The `setup` method initializes these attributes, and the `body` property constructs the packet body by concatenating the attribute values in the correct order.

## Symbols

### HandshakePacket
#### Description
A class representing the initial handshake packet sent by a MySQL server to a client during connection establishment.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| self | HandshakePacket | The instance of the HandshakePacket class |

#### Internal Logic
1. Initializes various attributes in the `setup` method, including protocol version, server version, connection ID, authentication data (salt), and server capabilities.
2. Constructs the packet body in the `body` property by concatenating the attribute values in the correct order.

### setup
#### Description
Initializes the attributes of the HandshakePacket instance.

#### Internal Logic
1. Sets various attributes using the `Datum` class, which likely handles data type conversions and formatting.
2. Uses constants from imported modules to set default values for some fields.

### body
#### Description
A property that constructs and returns the packet body as a byte string.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| string | bytes | The constructed packet body |

#### Internal Logic
1. Defines the order of fields in the packet body.
2. Iterates through the defined order, retrieving each attribute's value.
3. Concatenates the values into a single byte string.
4. Sets the body of the packet using the `setBody` method (likely inherited from the `Packet` base class).

### test
#### Description
A static method that creates a HandshakePacket instance and prints its string representation for testing purposes.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| mindsdb.api.mysql.mysql_proxy.data_types.mysql_packet | Provides the Packet base class |
| mindsdb.api.mysql.mysql_proxy.libs.constants.mysql | Provides MySQL-related constants |
| mindsdb.api.mysql.mysql_proxy.classes.server_capabilities | Provides server capability flags |
| mindsdb.api.mysql.mysql_proxy.data_types.mysql_datum | Provides the Datum class for data handling |

## Notes
- The code includes a copyright notice and license information at the beginning.
- The implementation is based on the MariaDB documentation for the initial handshake packet.
- The class uses the `Datum` class to handle different data types in the packet fields.
- The `test` method is only executed when the script is run directly, not when imported as a module.

This code is crucial for implementing the MySQL protocol in MindsDB, specifically for handling the initial connection handshake between the server and client.
---
title: "Overview"
---

## High-level description
This directory contains utility classes and functions for handling MongoDB queries and their conversion to MindsDB's internal Abstract Syntax Tree (AST) format. The main components are:

1. MongoDB query parser (`mongodb_parser.py`)
2. MongoDB to AST converter (`mongodb_ast.py`)
3. MongoDB query builder and JSON encoder (`mongodb_query.py`)

These utilities work together to facilitate the integration of MongoDB queries with MindsDB's SQL-based system.

## What does it do?
The utilities in this directory perform the following key functions:

1. Parse MongoDB query strings into structured `MongoQuery` objects.
2. Convert MongoDB queries to MindsDB's internal AST format for further processing.
3. Build MongoDB queries programmatically using a fluent interface.
4. Handle MongoDB-specific data types (like `ObjectId` and `ISODate`) during JSON encoding.
5. Parse and convert MongoDB's `$where` clauses to AST format.

These functionalities allow MindsDB to interface with MongoDB queries, translating them into a format that can be processed by MindsDB's SQL engine. This enables users to interact with MindsDB using MongoDB query syntax while leveraging MindsDB's AI and machine learning capabilities.

## Key Files

### mongodb_parser.py
This file contains the `MongodbParser` class, which is responsible for parsing string representations of MongoDB queries into structured `MongoQuery` objects. It uses Python's abstract syntax tree (AST) module to parse the input string and extract query components such as collection names, query steps, and arguments.

Key features:
- Parses complex MongoDB queries, including nested functions and pipelines.
- Handles special MongoDB functions like `ISODate` and `ObjectId`.
- Converts parsed components into a `MongoQuery` object for further processing.

### mongodb_ast.py
This file contains two main classes: `MongoToAst` and `MongoWhereParser`. These classes are responsible for converting MongoDB queries to MindsDB's internal AST format.

Key features:
- `MongoToAst` converts MongoDB find queries to AST format, handling filters, sort, projection, limit, and skip operations.
- `MongoWhereParser` specifically deals with parsing MongoDB's `$where` clauses and converting them to AST format.
- Provides a comprehensive conversion from MongoDB query syntax to MindsDB's internal representation.

### mongodb_query.py
This file defines the `MongoQuery` class and `MongoJSONEncoder` class. These classes are used for building MongoDB queries programmatically and handling JSON encoding of MongoDB-specific data types.

Key features:
- `MongoQuery` provides a fluent interface for building MongoDB queries.
- Allows method chaining for constructing complex queries.
- `MongoJSONEncoder` handles serialization of MongoDB-specific data types like `ObjectId` and `datetime`.

## Dependencies
The utilities in this directory rely on the following external libraries and modules:

1. Python's built-in `ast` module for parsing query strings.
2. `dateutil.parser` for parsing ISO date strings.
3. `bson` for handling MongoDB's `ObjectId`.
4. `mindsdb_sql.parser.ast` for AST node types used in MindsDB.

## Configuration
There are no specific configuration files or environment variables used in this directory. The behavior of these utilities is primarily controlled through their class methods and arguments.

In conclusion, the utilities in this directory form a crucial part of MindsDB's MongoDB integration, allowing for seamless translation between MongoDB query syntax and MindsDB's internal representations. This enables users to leverage MindsDB's AI capabilities while using familiar MongoDB query patterns.
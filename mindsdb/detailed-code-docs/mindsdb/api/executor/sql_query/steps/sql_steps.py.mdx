---
title: "sql_steps.py"
---

## High-level description
This code defines two classes, `LimitOffsetStepCall` and `DataStepCall`, which are implementations of SQL query execution steps. These classes are responsible for handling limit and offset operations on dataframes and creating result sets from data, respectively.

## Code Structure
The code consists of two main classes that inherit from `BaseStepCall`. Each class is bound to a specific step type (`LimitOffsetStep` and `DataStep`) and implements a `call` method to execute the step's logic.

## Symbols

### LimitOffsetStepCall
#### Description
This class handles the limit and offset operations on a dataframe.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| step | LimitOffsetStep | The step object containing limit and offset information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| step_data2 | ResultSet | A new ResultSet object with the limited and offset data |

#### Internal Logic
1. Retrieves the raw dataframe from the previous step's data.
2. Applies the offset if specified.
3. Applies the limit if specified.
4. Creates a new ResultSet with the modified dataframe.

### DataStepCall
#### Description
This class creates a ResultSet from provided data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| step | DataStep | The step object containing the data |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ResultSet | ResultSet | A new ResultSet object created from the input data |

#### Internal Logic
1. Creates a pandas DataFrame from the input data.
2. Converts the DataFrame to a ResultSet object.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pandas | Used for data manipulation and DataFrame creation |
| mindsdb_sql.planner.steps | Imports LimitOffsetStep and DataStep classes |
| mindsdb.api.executor.sql_query.result_set | Imports ResultSet class |

## References
The code references the following external symbols:
- `BaseStepCall`: The base class for both `LimitOffsetStepCall` and `DataStepCall`.
- `ResultSet`: Used to create and manipulate result sets.
- `LimitOffsetStep` and `DataStep`: Step types that the classes are bound to.

This code is part of a larger SQL query execution system in MindsDB, where these classes handle specific steps in the query execution process.
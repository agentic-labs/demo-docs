---
title: "conftest.py"
---

Here's a comprehensive documentation for the target file `tests/integration_tests/flows/conftest.py`:

## High-level description
This file contains pytest fixtures and utility functions for integration testing of MindsDB. It sets up the test environment, manages Docker containers for various databases, and provides helper functions for interacting with the MindsDB API and databases.

## Code Structure
The file defines several utility functions, pytest fixtures, and a base class `BaseStuff` that contains common methods used across tests. The fixtures are designed to set up and tear down test environments, including MindsDB application instances and various database containers.

## Symbols

### `remove_container`
#### Description
Stops and removes a Docker container by its name.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| container_name | str | Name of the container to remove |

### `make_test_csv`
#### Description
Creates a CSV file from given data and returns the file path.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | str | Name of the CSV file |
| data | dict | Data to be written to the CSV file |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| path | str | Path to the created CSV file |

### `docker_inet_ip`
#### Description
Gets the IP address of the docker0 interface.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ip | str | IP address of the docker0 interface |

### `temp_dir` (fixture)
#### Description
Creates a temporary directory for storing MindsDB data during tests.

### `config` (fixture)
#### Description
Creates a configuration for the MindsDB app used in tests.

### `override_recursive`
#### Description
Recursively overrides elements in one dictionary with elements from another.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| a | dict | Base dictionary to be updated |
| b | dict | Dictionary with override values |

### `mindsdb_app` (fixture)
#### Description
Starts the MindsDB application before tests and stops it after.

### `waitReadiness`
#### Description
Waits for a Docker container to be ready by checking its logs.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| container | docker.Container | Docker container object |
| match_msg | str | Message to match in logs |
| match_number | int | Number of times the message should appear |
| timeout | int | Timeout in seconds |

### `postgres_db`, `mysql_db`, `maria_db` (fixtures)
#### Description
Set up and tear down Docker containers for PostgreSQL, MySQL, and MariaDB respectively.

### `redis` (fixture)
#### Description
Starts a Redis Docker container for testing.

## Dependencies
- docker
- pytest
- psutil
- requests
- netifaces
- pandas
- walrus

## Configuration
The file uses environment variables and a JSON configuration file to set up the test environment. Key configuration options include:
- `USE_PERSISTENT_STORAGE`: Determines if persistent storage should be used for tests.
- `TEST_CONFIG`: Path to the test configuration JSON file.
- `TEMP_DIR`: Directory for temporary test files.

## Error Handling
The code includes basic error handling, primarily using try-except blocks to catch and handle exceptions during Docker container operations and database connections.

## Logging
The file uses the `log` module from `mindsdb.utilities` for logging.

## TODOs
- None explicitly mentioned in the code.

This documentation provides an overview of the main components and functionality of the `conftest.py` file, which is crucial for setting up the test environment for MindsDB integration tests.
---
title: "test_ts_predictions.py"
---

## High-level description
This file contains integration tests for time series predictions in MindsDB. It tests the creation of a time series model and various prediction scenarios using SQL queries via HTTP requests.

## Code Structure
The main class `TestHTTP` inherits from `HTTPHelperMixin` and contains several test methods. Each test method sets up a scenario, executes SQL queries, and verifies the results.

## Symbols

### `to_dicts`
#### Description
Converts the input data into a list of dictionaries with 'date', 'group', and 'value' keys.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | list | List of tuples containing date, group, and value information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | list | List of dictionaries with 'date', 'group', and 'value' keys |

#### Internal Logic
1. Converts each tuple in the input data to a dictionary.
2. Parses the date string to a datetime.date object.
3. Sorts the resulting list by date.

### `TestHTTP`
#### Description
A test class containing methods for testing time series predictions via HTTP requests.

#### Internal Logic
- Uses the `mindsdb_app` fixture for setup.
- Inherits from `HTTPHelperMixin` for HTTP-related helper methods.
- Contains several test methods, each focusing on a specific scenario.

### `TestHTTP.test_create_model`
#### Description
Tests the creation of a time series model using SQL queries.

#### Internal Logic
1. Creates a database connection.
2. Generates sample data for the model.
3. Creates a view with the sample data.
4. Creates a time series model.
5. Verifies the model creation status.
6. Waits for the model to be ready.

### `TestHTTP.test_gt_latest_date`
#### Description
Tests predictions for dates greater than the latest date in the training data.

#### Internal Logic
1. Executes a SQL query to get predictions for dates after the latest date.
2. Verifies the number of predictions and their properties.

### `TestHTTP.test_gt_latest_date_empty_join`
#### Description
Tests the scenario where no predictions are returned due to a non-existent group.

#### Internal Logic
1. Executes a SQL query with a condition that results in no matches.
2. Verifies that no predictions are returned.

### `TestHTTP.test_eq_latest_date`
#### Description
Tests predictions for the latest date in the training data.

#### Internal Logic
1. Executes a SQL query to get predictions for the latest date.
2. Verifies the number of predictions and their properties.

### `TestHTTP.test_gt_particular_date`
#### Description
Tests predictions for dates greater than a specific date.

#### Internal Logic
1. Sets a specific date.
2. Executes a SQL query to get predictions after that date.
3. Verifies the number of predictions and their properties.

### `TestHTTP.test_eq_particular_date`
#### Description
Tests predictions for a specific date.

#### Internal Logic
1. Sets a specific date.
2. Executes a SQL query to get predictions for that date.
3. Verifies the number of predictions and their properties.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pytest | Testing framework |
| mindsdb.api.executor.data_types.response_type | For RESPONSE_TYPE enum |
| tests.utils.http_test_helpers | For HTTPHelperMixin |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| API_LIST | list | ['http'] | List of APIs to be tested |
| HTTP_API_ROOT | str | 'http://127.0.0.1:47334/api' | Root URL for HTTP API requests |

## Error Handling
The tests use assertions to verify expected outcomes. If an assertion fails, the test will fail and provide information about the mismatch between expected and actual results.

## Logging
No explicit logging mechanisms are implemented in this code. Test results and any failures will be reported by the pytest framework.
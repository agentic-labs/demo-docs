---
title: "test_huggingface_api.py"
---

Here's a detailed documentation of the target file:

## High-level description
This file contains unit tests for the HuggingFace API integration in MindsDB. It tests the text classification functionality using a mock Postgres handler and the HuggingFace API engine.

## Code Structure
The main class `TestHuggingFaceAPI` inherits from `BaseExecutorTest`. It uses the `run_sql` method to execute SQL commands and the `set_handler` method to mock the Postgres handler.

## Symbols

### TestHuggingFaceAPI
#### Description
A test class for the HuggingFace API integration, focusing on text classification.

#### Internal Logic
The class sets up a mock environment and tests the creation and usage of a text classification model using the HuggingFace API.

### run_sql
#### Description
Executes SQL commands and returns the result as a DataFrame.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| sql | str | SQL command to execute |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | pd.DataFrame | Result of the SQL command |

#### Internal Logic
1. Parses the SQL command
2. Executes the command using the command executor
3. Asserts that there's no error
4. Returns the result as a DataFrame if data is present

### test_text_classification
#### Description
Tests the creation and usage of a text classification model using the HuggingFace API.

#### Internal Logic
1. Creates a mock database "proj"
2. Sets up a mock Postgres handler with sample text data
3. Creates a text classification model using SQL
4. Queries the model with a sample text
5. Asserts that the result is as expected (positive sentiment)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest.mock | For mocking the Postgres handler |
| pandas | For data manipulation |
| mindsdb_sql | For SQL parsing |
| BaseExecutorTest | Base class for executor tests |

## Error Handling
The test method uses assertions to check for expected results and error conditions.

## Notes
- The test uses a mock API key ('&lt;YOUR_API_KEY&gt;') for demonstration purposes.
- The actual API call is not made in this test; instead, it relies on the mocked handler to simulate the behavior.
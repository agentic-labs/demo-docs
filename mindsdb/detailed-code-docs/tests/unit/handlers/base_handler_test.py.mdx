---
title: "base_handler_test.py"
---

## High-level description
This file contains base classes and utility classes for testing database handlers in the MindsDB project. It provides a structured approach to testing various aspects of database handlers, including connection management, query execution, and specific database operations.

## Code Structure
The file defines several classes that work together to provide a comprehensive testing framework:
1. `MockCursorContextManager`: A mock class for simulating database cursors.
2. `BaseHandlerTestSetup`: An abstract base class for setting up handler tests.
3. `BaseHandlerTest`: Extends `BaseHandlerTestSetup` and provides basic connection testing methods.
4. `BaseDatabaseHandlerTest`: Extends `BaseHandlerTest` and adds database-specific testing methods.

## Symbols

### `MockCursorContextManager`
#### Description
A mock class that simulates a cursor context manager for database clients.

#### Internal Logic
- Implements `__enter__` and `__exit__` methods to simulate context management.
- Provides a `fetchall` method that returns a predefined result.

### `BaseHandlerTestSetup`
#### Description
An abstract base class that provides setup and teardown methods for handler tests.

#### Internal Logic
- Defines abstract methods `dummy_connection_data`, `create_patcher`, and `create_handler`.
- Implements `setUp` and `tearDown` methods to manage the test environment.

### `BaseHandlerTest`
#### Description
Extends `BaseHandlerTestSetup` and provides methods to test the `connect` and `check_connection` methods of a handler.

#### Internal Logic
- Defines abstract property `err_to_raise_on_connect_failure`.
- Implements test methods for successful and failed connections.

### `BaseDatabaseHandlerTest`
#### Description
Extends `BaseHandlerTest` and provides methods to test database-specific operations like `native_query`, `get_tables`, and `get_columns`.

#### Internal Logic
- Defines abstract properties for database-specific queries.
- Implements test methods for executing queries and retrieving database metadata.

## Dependencies
- `unittest`: Python's built-in testing framework
- `unittest.mock`: Mocking library for unit tests
- `abc`: Abstract Base Classes module
- `mindsdb.integrations.libs.response`: Custom response classes for handlers

## Error Handling
The code implements specific tests to check error handling in connection failures and query execution failures.

## API/Interface Reference
This file doesn't expose an API but defines a testing interface for database handlers. The main methods that should be implemented by subclasses are:
- `create_handler()`
- `create_patcher()`
- `dummy_connection_data`
- `err_to_raise_on_connect_failure`
- `get_tables_query`
- `get_columns_query`

These methods and properties should be overridden in specific handler test classes to provide handler-specific implementations.
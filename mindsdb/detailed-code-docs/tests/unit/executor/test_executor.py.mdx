---
title: "test_executor.py"
---

Here's a high-level description and documentation of the provided code:

## High-level description

This code defines a set of unit test classes for testing the MindsDB executor. It includes base classes for setting up test environments, mocking database handlers, and testing various aspects of the MindsDB system, including ML model creation, prediction, and SQL query execution.

## Code Structure

The code is organized into several test classes that inherit from each other:

1. `BaseUnitTest`: Sets up a basic MindsDB environment with a temporary database and configuration.
2. `BaseExecutorTest`: Extends `BaseUnitTest` to set up an executor with mocked data handlers.
3. `BaseExecutorDummyML`: Extends `BaseExecutorTest` to include a dummy ML handler.
4. `BaseExecutorDummyLLM`: Extends `BaseExecutorTest` to include a dummy LLM handler.
5. `BaseExecutorMockPredictor`: Extends `BaseExecutorTest` to mock both data and Lightwood handlers.

These classes provide various utility methods for setting up test environments, executing SQL queries, and mocking predictor behavior.

## Symbols

### BaseUnitTest

#### Description
This class sets up a basic MindsDB test environment with a temporary database and configuration.

#### Internal Logic
- Sets up a temporary database file and configuration
- Initializes the MindsDB database
- Provides methods for clearing the database and resetting Prometheus collectors

### BaseExecutorTest

#### Description
Extends `BaseUnitTest` to set up an executor with mocked data handlers.

#### Internal Logic
- Sets up the executor with optional mocking of Lightwood and model controller
- Provides methods for setting up database handlers and file controllers

### BaseExecutorMockPredictor

#### Description
Extends `BaseExecutorTest` to mock both data and Lightwood handlers.

#### Internal Logic
- Sets up a mocked predictor with specified behavior
- Provides methods for executing SQL queries and retrieving predictor data

## Dependencies
- unittest.mock
- pandas
- duckdb
- mindsdb_sql
- prometheus_client

## Configuration
The test classes use temporary files for database and configuration storage.

## Error Handling
The classes include various assertions and error checks to ensure proper test execution and to catch issues in the MindsDB system being tested.

## Logging
The code uses the MindsDB logging utility for logging messages during test execution.

This code provides a comprehensive framework for testing various aspects of the MindsDB system, including database operations, ML model creation and prediction, and SQL query execution. It allows for flexible mocking of different components to isolate and test specific functionalities.
---
title: "test_storage_handler.py"
---

## High-level description
This file contains unit tests for the RedisStorageHandler and SqliteStorageHandler classes, which are part of the storage handling functionality in the MindsDB project. The tests verify the basic set and get operations for both Redis and SQLite storage backends.

## Code Structure
The code defines a single test class `StorageHandlerTest` with two test methods, one for Redis storage and one for SQLite storage. Each test method creates a storage handler instance, sets a value, retrieves it, and checks for expected behavior.

## References
This code references the following external symbols:
- `Config` from `mindsdb.utilities.config`
- `RedisStorageHandler` and `SqliteStorageHandler` from `mindsdb.integrations.libs.storage_handler`

## Symbols

### StorageHandlerTest
#### Description
A unittest.TestCase subclass that contains test methods for Redis and SQLite storage handlers.

#### Internal Logic
The class defines two test methods:

1. `test_1_redis_storage`: Tests the RedisStorageHandler
2. `test_2_sqlite_storage`: Tests the SqliteStorageHandler

### test_1_redis_storage
#### Description
Tests the basic functionality of the RedisStorageHandler.

#### Internal Logic
1. Creates a RedisStorageHandler instance with a test context and configuration.
2. Sets a test key-value pair.
3. Retrieves the value and asserts it matches the set value.
4. Attempts to retrieve a non-existent key and asserts that it raises an exception.

### test_2_sqlite_storage
#### Description
Tests the basic functionality of the SqliteStorageHandler.

#### Internal Logic
1. Creates a Config instance to get the root path.
2. Creates a SqliteStorageHandler instance with a test name and configuration.
3. Sets a test key-value pair.
4. Retrieves the value and asserts it matches the set value.
5. Attempts to retrieve a non-existent key and asserts that it raises an exception.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.utilities.config | Imports the Config class |
| mindsdb.integrations.libs.storage_handler | Imports RedisStorageHandler and SqliteStorageHandler classes |

## Error Handling
The tests use `self.assertRaises(Exception, ...)` to verify that attempting to get a non-existent key raises an exception for both Redis and SQLite storage handlers.

## Performance Considerations
These tests are designed to verify basic functionality and are not focused on performance. However, it's worth noting that Redis operations are typically faster than SQLite operations, especially for large datasets or high-concurrency scenarios.

## TODOs
There are no explicit TODOs in the code. However, potential improvements could include:
1. Testing more complex data types (e.g., nested dictionaries, lists).
2. Adding tests for concurrent access scenarios.
3. Including cleanup code to remove test data after each test run.
4. Adding more edge cases and error scenarios to improve test coverage.
---
title: "test_paypal_handler.py"
---

## High-level description
This file contains unit tests for the PayPalHandler class, which is part of the MindsDB integration with PayPal. The tests verify the functionality of various methods in the PayPalHandler, including connection checking, retrieving tables, and executing queries on different PayPal data entities.

## Code Structure
The code defines a single test class `PayPalHandlerTest` that inherits from `unittest.TestCase`. It contains a `setUpClass` method to initialize the handler and several test methods to check different functionalities.

## Symbols

### PayPalHandlerTest
#### Description
A test class that contains unit tests for the PayPalHandler. It sets up the PayPal handler with environment variables and tests various methods of the handler.

#### Internal Logic
1. `setUpClass`: Sets up the PayPalHandler with connection data from environment variables.
2. Test methods: Each test method checks a specific functionality of the PayPalHandler.

### test_0_check_connection
#### Description
Tests the `check_connection` method of the PayPalHandler.

#### Internal Logic
Asserts that the `check_connection` method returns True.

### test_1_get_tables
#### Description
Tests the `get_tables` method of the PayPalHandler.

#### Internal Logic
Calls `get_tables` and asserts that the response type is not an error.

### test_2_select_payments_query
#### Description
Tests the `native_query` method for selecting payments data.

#### Internal Logic
Executes a SELECT query on the payments table and asserts that the response type is TABLE.

### test_3_select_invoices_query
#### Description
Tests the `native_query` method for selecting invoices data.

#### Internal Logic
Executes a SELECT query on the invoices table and asserts that the response type is TABLE.

### test_4_select_subscriptions_query
#### Description
Tests the `native_query` method for selecting subscriptions data.

#### Internal Logic
Executes a SELECT query on the subscriptions table and asserts that the response type is TABLE.

### test_5_select_orders_query
#### Description
Tests the `native_query` method for selecting orders data with a specific condition.

#### Internal Logic
Executes a SELECT query on the orders table with a WHERE clause and asserts that the response type is TABLE.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| os | To access environment variables |
| unittest | To create and run unit tests |
| mindsdb.integrations.handlers.paypal_handler.paypal_handler | To import PayPalHandler |
| mindsdb.api.executor.data_types.response_type | To import RESPONSE_TYPE for assertion checks |

## Configuration
The test class uses environment variables for configuration:
| Option | Type | Description |
|:-------|:-----|:------------|
| MODE | string | The mode for PayPal API (sandbox or live) |
| CLIENT_ID | string | The client ID for PayPal API authentication |
| CLIENT_SECRET | string | The client secret for PayPal API authentication |

## Error Handling
The tests use assertions to check for expected outcomes. If any assertion fails, the test will raise an AssertionError.

## Notes
1. The tests are numbered (0 to 5) to ensure they run in a specific order.
2. The `check_connection` test is run first to ensure the handler is properly connected before running other tests.
3. The `get_tables` test checks if the handler can retrieve tables without errors.
4. The remaining tests check if the handler can execute queries on different PayPal entities (payments, invoices, subscriptions, and orders).
5. The orders query includes a WHERE clause with an empty string for the 'ids' column, which might be intended to test handling of empty input.
---
title: "test_rag_pipelines.py"
---

## High-level description
This file contains unit tests for the RAG (Retrieval-Augmented Generation) pipeline functionality in the MindsDB project. It tests the creation and invocation of RAG pipelines using various configurations loaded from YAML files.

## Code Structure
The code defines a test fixture that loads different RAG pipeline configurations and creates a test environment. It then uses this fixture to test the creation and basic functionality of the RAG pipeline.

## Symbols

### `create_test_documents()`
#### Description
Creates a list of sample Document objects for testing purposes.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| return value | List[Document] | A list of three Document objects with test content and metadata |

### `config` (pytest fixture)
#### Description
A pytest fixture that loads RAG pipeline configurations from YAML files and prepares them for testing.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| return value | RAGPipelineModel | A configured RAGPipelineModel object for testing |

#### Internal Logic
1. Reads a YAML configuration file
2. Adds test documents to the configuration
3. Sets default LLM and embedding models
4. Returns a RAGPipelineModel object

### `test_rag_pipeline_creation(config)`
#### Description
Tests the creation and basic functionality of a RAG pipeline using the provided configuration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| config | RAGPipelineModel | The RAG pipeline configuration to test |

#### Internal Logic
1. Creates a RAG object with the given configuration
2. Invokes the pipeline with a test question
3. Asserts that the result is not None, is a dictionary, and contains expected keys

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| pytest | Testing framework |
| yaml | YAML file parsing |
| langchain_core.documents | Document class for test data |
| langchain_openai | OpenAI language and embedding models |
| mindsdb.integrations.utilities.rag.rag_pipeline_builder | RAG pipeline implementation |
| mindsdb.integrations.utilities.rag.settings | RAG pipeline settings and defaults |

## Configuration
The test uses configuration files stored in the `tests/handler_tests/data/rag_pipelines/` directory. Each YAML file in this directory represents a different RAG pipeline configuration to be tested.

## Notes
- The test uses default OpenAI models for language modeling and embeddings.
- The test creates a simple set of documents for testing the RAG pipeline.
- The test checks if the RAG pipeline can be created and invoked successfully, but does not verify the quality or correctness of the generated answers.
---
title: "test_hubspot_handler.py"
---

## High-level description
This file contains unit tests for the HubspotHandler class, which is part of the MindsDB integration with HubSpot. The tests verify the functionality of connecting to HubSpot, retrieving tables, and executing queries for companies, contacts, and deals.

## Code Structure
The code defines a single test class `HubSpotHandlerTest` that inherits from `unittest.TestCase`. It contains a `setUpClass` method to initialize the handler and five test methods to check various functionalities.

## References
- `mindsdb.integrations.handlers.hubspot_handler.hubspot_handler.HubspotHandler`
- `mindsdb.api.executor.data_types.response_type.RESPONSE_TYPE`

## Symbols

### HubSpotHandlerTest
#### Description
A test class for the HubspotHandler, containing methods to test various functionalities of the handler.

#### Internal Logic
1. Sets up the HubspotHandler with an access token from environment variables.
2. Tests connection, table retrieval, and queries for companies, contacts, and deals.

### setUpClass
#### Description
Class method to set up the test environment by creating a HubspotHandler instance.

#### Inputs
None (class method)

#### Internal Logic
1. Retrieves the ACCESS_TOKEN from environment variables.
2. Creates a HubspotHandler instance with the token.

### test_0_check_connection
#### Description
Tests the connection to HubSpot using the handler's check_connection method.

#### Internal Logic
Asserts that the check_connection method returns True.

### test_1_get_tables
#### Description
Tests the retrieval of tables from HubSpot.

#### Internal Logic
1. Calls the get_tables method of the handler.
2. Asserts that the response type is not an error.

### test_2_select_companies_query
#### Description
Tests querying the companies table from HubSpot.

#### Internal Logic
1. Executes a SELECT query on the companies table.
2. Asserts that the response type is TABLE.

### test_3_select_contacts_query
#### Description
Tests querying the contacts table from HubSpot.

#### Internal Logic
1. Executes a SELECT query on the contacts table.
2. Asserts that the response type is TABLE.

### test_4_select_deals_query
#### Description
Tests querying the deals table from HubSpot.

#### Internal Logic
1. Executes a SELECT query on the deals table.
2. Asserts that the response type is TABLE.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| os | To access environment variables |
| unittest | For creating and running unit tests |
| mindsdb.integrations.handlers.hubspot_handler.hubspot_handler.HubspotHandler | The main class being tested |
| mindsdb.api.executor.data_types.response_type.RESPONSE_TYPE | For comparing response types |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| ACCESS_TOKEN | str | None | HubSpot access token retrieved from environment variables |

## Error Handling
The tests use assertions to check for expected outcomes. If any assertion fails, the test will raise an AssertionError.
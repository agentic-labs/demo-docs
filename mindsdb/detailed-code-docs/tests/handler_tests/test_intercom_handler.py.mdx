---
title: "test_intercom_handler.py"
---

## High-level description
This file contains unit tests for the IntercomHandler class, which is responsible for handling interactions with the Intercom API. The tests cover various functionalities such as connecting to the API, retrieving data, and performing CRUD operations on articles.

## Code Structure
The code defines a single test class `InstatusHandlerTest` that inherits from `unittest.TestCase`. It contains multiple test methods that check different aspects of the IntercomHandler's functionality.

## Symbols

### InstatusHandlerTest
#### Description
This class contains unit tests for the IntercomHandler. It sets up the handler instance and tests various methods and operations.

#### Internal Logic
1. Sets up the IntercomHandler instance in the `setUpClass` method.
2. Tests connection, API calls, data retrieval, and CRUD operations on articles.

### test_0_check_connection
#### Description
Tests the `check_connection` method of the IntercomHandler.

#### Internal Logic
Asserts that the `check_connection` method returns True.

### test_1_connect
#### Description
Tests the `connect` method of the IntercomHandler.

#### Internal Logic
Asserts that the `connect` method returns True.

### test_2_call_instatus_api
#### Description
Tests the `call_intercom_api` method of the IntercomHandler.

#### Internal Logic
Calls the API with the '/articles' endpoint and asserts that the result is an instance of pandas DataFrame.

### test_3_get_tables
#### Description
Tests the `get_tables` method of the IntercomHandler.

#### Internal Logic
Calls `get_tables` and asserts that the result is not of type `RESPONSE_TYPE.ERROR`.

### test_4_get_columns
#### Description
Tests the `get_columns` method of the IntercomHandler for the 'articles' table.

#### Internal Logic
Calls `get_columns` with 'articles' as the table name and asserts that the result is not of type `RESPONSE_TYPE.ERROR`.

### test_5_select_articles
#### Description
Tests the `native_query` method of the IntercomHandler for selecting all articles.

#### Internal Logic
Executes a SELECT query and asserts that the result is True.

### test_6_select_articles_by_condition
#### Description
Tests the `native_query` method of the IntercomHandler for selecting articles with a specific condition.

#### Internal Logic
Executes a SELECT query with a WHERE clause and asserts that the result is True.

### test_7_insert_article
#### Description
Tests the `native_query` method of the IntercomHandler for inserting a new article.

#### Internal Logic
Executes an INSERT query and asserts that the result is True.

### test_8_update_article
#### Description
Tests the `native_query` method of the IntercomHandler for updating an existing article.

#### Internal Logic
1. Retrieves the first article from the API.
2. Extracts the article ID.
3. Executes an UPDATE query using the retrieved ID.
4. Asserts that the result is True.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| unittest | Provides the testing framework |
| mindsdb.integrations.handlers.intercom_handler.intercom_handler | Contains the IntercomHandler class being tested |
| mindsdb.api.executor.data_types.response_type | Provides the RESPONSE_TYPE enum |
| pandas | Used for data manipulation and testing |
| os | Used to access environment variables |

## Configuration
The test class uses an environment variable for configuration:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| INTERCOM_ACCESS_TOKEN | str | None | Access token for the Intercom API |

## Error Handling
The tests use assertions to check for expected outcomes. If any assertion fails, the test will raise an AssertionError.

## API/Interface Reference
The tests interact with the following IntercomHandler methods:
| Method | Description |
|:-------|:------------|
| check_connection | Checks the connection to the Intercom API |
| connect | Establishes a connection to the Intercom API |
| call_intercom_api | Makes a direct call to the Intercom API |
| get_tables | Retrieves available tables |
| get_columns | Retrieves columns for a specific table |
| native_query | Executes a native SQL query |
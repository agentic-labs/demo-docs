---
title: "20220816120137_update_properties_on_percentage_charges.rb"
---

## High-level description
This migration file, `UpdatePropertiesOnPercentageCharges`, is designed to load tasks from the LagoApi application. It's a Rails migration that doesn't directly modify the database schema but instead executes application-specific tasks.

## Code Structure
The migration consists of a single class `UpdatePropertiesOnPercentageCharges` that inherits from `ActiveRecord::Migration[7.0]`. It contains one method, `change`, which loads tasks from the LagoApi application.

## Symbols

### UpdatePropertiesOnPercentageCharges
#### Description
This class is a Rails migration that loads tasks from the LagoApi application. It doesn't perform any direct database schema changes.

#### Internal Logic
The `change` method calls `LagoApi::Application.load_tasks`, which loads all Rake tasks defined in the application. This is an unusual operation for a migration, as migrations typically focus on database schema changes.

## Side Effects
Loading tasks in a migration can have side effects depending on what those tasks do. This approach is atypical and could potentially lead to unexpected behavior during database migrations.

## Dependencies
This migration indirectly depends on the LagoApi application and its task definitions.

## Configuration
The migration uses Rails 7.0, as indicated by `ActiveRecord::Migration[7.0]`.

## Performance Considerations
Loading tasks in a migration could potentially impact the performance of the migration process, especially if there are many tasks or if any of the tasks perform time-consuming operations.

## TODOs
While there are no explicit TODOs in this migration file, the unusual nature of loading tasks in a migration suggests that this might be a temporary solution or part of a larger refactoring process.

## Additional Notes
1. The purpose of loading tasks in a migration is unclear and potentially problematic. Migrations are typically used for database schema changes, not for running application tasks.
2. The migration's name, `UpdatePropertiesOnPercentageCharges`, doesn't seem to match its content, as it doesn't directly update any properties or interact with percentage charges.
3. This approach could lead to issues with migration reversibility and repeatability, as task loading might have different effects each time it's run.
4. It's possible that this migration is intended to trigger some task that updates properties on percentage charges, but if so, it's not explicitly clear from the code provided.
5. The related `application.rb` file shows that the LagoApi application has various configurations, including autoloading paths, API-only mode, and internationalization settings. However, it doesn't provide direct insight into what tasks might be loaded by this migration.

Given the unusual nature of this migration, it would be advisable to review its purpose and consider whether the task loading could be moved to a more appropriate part of the application lifecycle.
---
title: "20220729055309_add_properties_to_fees.rb"
---

## High-level description
This migration adds a new `properties` column to the `fees` table in the database. The column is of type `jsonb`, which allows for storing JSON-formatted data, and is set to be non-nullable with a default empty JSON object.

## Symbols

### `AddPropertiesToFees`
#### Description
This class is an ActiveRecord migration that extends `ActiveRecord::Migration[7.0]`. It defines a change to be applied to the database schema, specifically adding a new column to the `fees` table.

#### Internal Logic
The migration uses the `change` method to define a reversible database change. It calls the `add_column` method to add the new `properties` column to the `fees` table.

### `change`
#### Description
This method defines the changes to be applied to the database schema. It adds a new column named `properties` to the `fees` table.

#### Internal Logic
The method uses the `add_column` method with the following parameters:
- `:fees`: The name of the table to modify
- `:properties`: The name of the new column
- `:jsonb`: The data type of the new column (JSON binary)
- `null: false`: Specifies that the column cannot contain null values
- `default: {}`: Sets the default value for the column to an empty JSON object

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework and database interaction capabilities |

## Notes
1. The use of `jsonb` type allows for efficient storage and querying of JSON data in PostgreSQL databases.
2. Setting `null: false` ensures that every row in the `fees` table will have a value for the `properties` column.
3. The `default: {}` ensures that if no value is provided when creating a new fee, an empty JSON object will be used instead of null.
4. This migration is reversible by default, meaning Rails can automatically generate the code to undo this change if needed.
---
title: "20240808080611_remove_amount_currency_from_usage_tresholds.rb"
---

## High-level description
This migration removes the `amount_currency` column from the `usage_thresholds` table in the database. It provides both `up` and `down` methods to allow for reversible migration, ensuring the ability to roll back changes if needed.

## Symbols

### `RemoveAmountCurrencyFromUsageTresholds`
#### Description
This class is an ActiveRecord migration that removes the `amount_currency` column from the `usage_thresholds` table. It inherits from `ActiveRecord::Migration[7.1]`, indicating it's compatible with Rails 7.1 migration framework.

#### Internal Logic

##### `up` method
- Uses `safety_assured` block, likely a custom method to bypass certain safety checks.
- Utilizes `change_table` with `bulk: true` option for performance optimization when making multiple changes to a table.
- Removes the `amount_currency` column from the `usage_thresholds` table.

##### `down` method
- Also uses `change_table` with `bulk: true` option.
- Adds back the `amount_currency` column to the `usage_thresholds` table as a non-nullable string column.

## Side Effects
- Removes `amount_currency` column from `usage_thresholds` table when migrating up.
- Adds `amount_currency` column to `usage_thresholds` table when rolling back (migrating down).

## Performance Considerations
The use of `bulk: true` in `change_table` operations is an optimization technique. It allows multiple alterations to be performed in a single statement, which can significantly improve performance, especially for large tables.

## Error Handling
No explicit error handling is implemented in this migration. It relies on the default error handling provided by ActiveRecord migrations.

## TODOs
There are no explicit TODOs in this migration file.
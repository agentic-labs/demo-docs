---
title: "20230905081225_add_weighted_interval_to_billable_metric.rb"
---

## High-level description
This migration adds a new enum column `weighted_interval` to the `billable_metrics` table. It creates a custom enum type `billable_metric_weighted_interval` with a single value 'seconds', which is then used for the new column.

## Symbols

### `AddWeightedIntervalToBillableMetric`
#### Description
This class is a Rails migration that extends the `billable_metrics` table with a new enum column `weighted_interval`. It creates a custom enum type and adds the column in a single transaction.

#### Internal Logic
1. Creates a new enum type `billable_metric_weighted_interval` with a single value 'seconds'.
2. Uses `safety_assured` block to bypass Strong Migrations checks.
3. Alters the `billable_metrics` table to add the `weighted_interval` column of the newly created enum type.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord::Migration | Provides the framework for database migrations in Rails |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| weighted_interval | enum | null | New column added to billable_metrics table, can be 'seconds' or null |

## Error Handling
This migration does not implement any specific error handling. It relies on the default behavior of Rails migrations.

## Notes
1. The migration uses `safety_assured` which bypasses Strong Migrations checks. This should be used cautiously and only when the developer is certain that the migration is safe to run.
2. The new enum type `billable_metric_weighted_interval` is created with only one value ('seconds'). If more values are needed in the future, a new migration would be required to add them.
3. The `weighted_interval` column is nullable, allowing existing records to have no value for this new field.
---
title: "20230328161507_create_password_resets.rb"
---

## High-level description
This migration file creates a `password_resets` table in the database. It's designed to store information related to password reset requests, including the associated user, a unique token, and an expiration time for each reset request.

## Symbols

### CreatePasswordResets
#### Description
This class is an ActiveRecord migration that defines the structure for the `password_resets` table. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0.

#### Internal Logic
The migration uses the `change` method to define the table structure:

1. Creates a new table named `password_resets` with UUID as the primary key.
2. Adds a reference to the `users` table.
3. Adds a unique token column.
4. Adds an expiration datetime column.
5. Adds timestamps for created_at and updated_at.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework for database schema modifications |

## Code Structure

### Table Structure
The `password_resets` table is created with the following columns:

1. `id`: UUID, primary key
2. `user_id`: UUID, foreign key referencing the `users` table
3. `token`: string, unique index
4. `expire_at`: datetime
5. `created_at`: datetime
6. `updated_at`: datetime

### Key Features
- Uses UUID for the primary key instead of integer IDs.
- Establishes a foreign key relationship with the `users` table.
- Ensures the `token` column has a unique index for quick lookups.
- Includes an `expire_at` column to manage the validity period of password reset requests.
- Utilizes Rails' `timestamps` macro to add `created_at` and `updated_at` columns automatically.

This structure allows for efficient storage and retrieval of password reset information, with built-in support for expiration and unique tokens per reset request.
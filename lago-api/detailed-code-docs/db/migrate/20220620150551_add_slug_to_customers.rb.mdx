---
title: "20220620150551_add_slug_to_customers.rb"
---

## High-level description
This migration file adds a `slug` and `sequential_id` column to the `customers` table in a Rails application. It also invokes a Rake task to generate slugs for existing customers after the migration is complete.

## Code Structure
The code defines a single class `AddSlugToCustomers` that inherits from `ActiveRecord::Migration[7.0]`. This class contains a `change` method that performs the migration operations.

## Symbols

### `AddSlugToCustomers`
#### Description
This class represents a database migration that adds new columns to the `customers` table and generates slugs for existing customers.

#### Internal Logic
1. Uses `safety_assured` to bypass Strong Migrations checks.
2. Adds `slug` (string) and `sequential_id` (bigint) columns to the `customers` table.
3. Loads Rails application tasks.
4. Invokes the `customers:generate_slug` Rake task.

## Side Effects
- Modifies the database schema by adding new columns to the `customers` table.
- Generates slugs for existing customers by invoking a Rake task.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord::Migration | Provides the framework for database migrations |
| Rake | Used to invoke the slug generation task |

## Performance Considerations
The migration uses `bulk: true` when changing the table, which can improve performance for adding multiple columns in a single operation.

## TODOs
There are no TODOs in this specific file, but the related `config/application.rb` file contains two TODOs:
1. "Should be turned to false" for `config.add_autoload_paths_to_load_path`
2. "turn this value to 7.1 after upgrading to Rails 7.1" for `config.active_support.cache_format_version`
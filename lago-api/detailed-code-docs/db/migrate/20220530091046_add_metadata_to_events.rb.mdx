---
title: "20220530091046_add_metadata_to_events.rb"
---

## High-level description
This migration adds a new `metadata` column to the `events` table in the database. The column is of type `jsonb` (JSON Binary), allowing for the storage of structured JSON data. It is set to be non-nullable with a default empty JSON object.

## Symbols

### `AddMetadataToEvents`
#### Description
This class is an ActiveRecord migration that defines a change to be applied to the database schema. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0 migration framework.

#### Internal Logic
The migration uses the `change` method to define a reversible database change. It adds a new column named `metadata` to the `events` table using the `add_column` method.

1. Table name: `:events`
2. Column name: `:metadata`
3. Data type: `:jsonb`
4. Constraints:
   - `null: false`: The column cannot contain NULL values
   - `default: {}`: If no value is provided, an empty JSON object will be used as the default value

## Dependencies
This migration relies on the ActiveRecord framework, which is part of Ruby on Rails.

## Performance Considerations
Using `jsonb` type for the `metadata` column allows for efficient storage and querying of JSON data in PostgreSQL databases. This can be beneficial for performance when working with complex, semi-structured data that doesn't fit well into a traditional relational schema.

## Error Handling
The migration framework handles most error scenarios automatically. If the migration fails, it will be rolled back to maintain database integrity.

## TODOs
There are no explicit TODOs in this migration file.
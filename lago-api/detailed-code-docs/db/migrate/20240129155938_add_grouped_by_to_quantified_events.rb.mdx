---
title: "20240129155938_add_grouped_by_to_quantified_events.rb"
---

## High-level description
This migration adds a new column called `grouped_by` to the `quantified_events` table in the database. The column is of type `jsonb`, which allows for storing JSON data, and is set to be non-nullable with a default empty JSON object.

## Symbols

### `AddGroupedByToQuantifiedEvents`
#### Description
This class is an ActiveRecord migration that defines a change to be applied to the database schema. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0 migration framework.

#### Internal Logic
The migration uses the `change` method to define a reversible database change. It adds a new column to the `quantified_events` table with the following specifications:
- Column name: `grouped_by`
- Data type: `jsonb` (JSON Binary)
- Constraints: `null: false` (not nullable)
- Default value: `{}` (empty JSON object)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework for database schema changes |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| grouped_by | jsonb | {} | Stores JSON data for grouping quantified events |

## Notes
1. The migration is marked as `# frozen_string_literal: true`, which is a Ruby optimization that prevents the file from modifying string literals.
2. The use of `jsonb` type suggests that this column is intended to store structured data for grouping quantified events, which can be queried and indexed efficiently in PostgreSQL databases.
3. Setting `null: false` ensures that this column will always have a value, even if it's an empty JSON object.
4. The default value of `{}` means that if no specific value is provided when creating a new record, an empty JSON object will be used.

This migration allows for flexible grouping of quantified events using JSON data, which can be particularly useful for complex categorization or metadata storage without needing to create multiple separate columns.
---
title: "20240808085506_add_metadata_to_recurring_transaction_rules.rb"
---

## High-level description
This migration adds a new column called `transaction_metadata` to the `recurring_transaction_rules` table. The column is of type `jsonb` and has a default value of an empty JSON object.

## Symbols

### AddMetadataToRecurringTransactionRules
#### Description
This class is an ActiveRecord migration that extends the `ActiveRecord::Migration` class. It defines a change to be applied to the database schema, specifically adding a new column to the `recurring_transaction_rules` table.

#### Internal Logic
The migration uses the `change` method to define the modification to the database schema. Inside this method, it calls `add_column` to add the new `transaction_metadata` column to the `recurring_transaction_rules` table.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework for database schema modifications |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| transaction_metadata | jsonb | {} | Stores metadata related to recurring transaction rules in JSON format |

## Notes
1. The migration is using Rails 7.1, as indicated by `ActiveRecord::Migration[7.1]`.
2. The `jsonb` data type is used, which is a PostgreSQL-specific type for storing JSON data in a binary format. This allows for efficient storage and querying of JSON data.
3. The default value for the new column is set to an empty JSON object (`{}`), ensuring that existing rows will have a valid default value.
4. The migration file is frozen with the `# frozen_string_literal: true` pragma, which can help improve performance by preventing the creation of new string objects.

This migration allows for storing additional, flexible metadata for recurring transaction rules without needing to add multiple specific columns. The use of `jsonb` provides performance benefits and advanced querying capabilities for JSON data in PostgreSQL databases.
---
title: "20230524130637_rename_fees_vat_fields.rb"
---

## High-level description
This migration renames and removes columns related to VAT (Value Added Tax) in the `fees` table, changing the terminology to "taxes" and removing the currency column for the tax amount.

## Symbols

### `RenameFeesVatFields`
#### Description
This class is an ActiveRecord migration that modifies the structure of the `fees` table. It renames two columns and removes one column, all related to VAT (Value Added Tax) fields.

#### Internal Logic
The migration uses the `change` method to define the modifications to the database schema. The changes are wrapped in a `safety_assured` block, which is likely a custom method to bypass certain safety checks during the migration process.

1. Renames the `vat_rate` column to `taxes_rate`
2. Renames the `vat_amount_cents` column to `taxes_amount_cents`
3. Removes the `vat_amount_currency` column

## Side Effects
This migration will modify the structure of the `fees` table in the database. It will:
1. Change the name of two existing columns
2. Remove one column

These changes may affect any existing queries, models, or code that rely on the old column names or the removed column.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework |

## Error Handling
The migration uses `safety_assured`, which suggests that there might be some safety checks in place for migrations. By using this method, the migration bypasses these checks, potentially to allow for operations that might otherwise be considered unsafe.

## TODOs
There are no explicit TODOs in this code.

Note: This migration changes the terminology from "VAT" to "taxes", which might indicate a broader change in how the application handles tax-related data. It's important to ensure that all related code (models, controllers, views, etc.) is updated to reflect these new column names.
---
title: "20220713171816_change_active_storage_attachments_id_type.rb"
---

## High-level description
This migration changes the `record_id` column type in the `active_storage_attachments` table from its current type to UUID. It removes the existing `record_id` column and adds a new one with the UUID type.

## Symbols

### `ChangeActiveStorageAttachmentsIdType`
#### Description
This class is an ActiveRecord migration that modifies the `active_storage_attachments` table by changing the `record_id` column type to UUID.

#### Internal Logic
1. The migration is wrapped in a `safety_assured` block, which is likely a method from a database migration safety gem (such as strong_migrations).
2. It uses `change_table` with the `bulk: true` option for performance optimization when making multiple changes to the table.
3. The existing `record_id` column is removed using `t.remove :record_id`.
4. A new `record_id` column of type UUID is added using `t.uuid :record_id`.

## Side Effects
- The `record_id` column in the `active_storage_attachments` table is replaced with a new column of UUID type.
- Any existing data in the `record_id` column will be lost due to the column removal.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord::Migration | Provides the migration framework for database schema changes |

## Error Handling
The migration uses `safety_assured` which suggests that there might be some safety checks in place, possibly from a gem like strong_migrations. This helps to ensure that the migration is executed safely.

## TODOs
The code includes a `rubocop:disable Rails/ReversibleMigration` comment, indicating that this migration is not reversible. In a production environment, it would be advisable to create a reversible migration or provide a `down` method to revert the changes if needed.
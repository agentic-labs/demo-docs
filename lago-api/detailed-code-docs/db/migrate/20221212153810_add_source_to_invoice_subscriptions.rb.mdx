---
title: "20221212153810_add_source_to_invoice_subscriptions.rb"
---

## High-level description
This migration adds a new `source` column to the `invoice_subscriptions` table, sets a default value for existing records, and makes the column non-nullable. It's designed to be reversible and uses safety measures to ensure data integrity during the migration process.

## Symbols

### `AddSourceToInvoiceSubscriptions`
#### Description
This class is an ActiveRecord migration that adds a new `source` column to the `invoice_subscriptions` table and sets its default value. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0.

#### Internal Logic
1. Adds a new integer column named `source` to the `invoice_subscriptions` table.
2. Uses `safety_assured` block to bypass Strong Migrations checks.
3. Implements a reversible migration with an `up` direction.
4. Executes SQL to set the default value of 0 for the `source` column on existing records.
5. Makes the `source` column non-nullable.

## Side Effects
- Modifies the schema of the `invoice_subscriptions` table by adding a new column.
- Updates existing records in the `invoice_subscriptions` table by setting a default value for the new `source` column.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework and database interaction capabilities |

## Error Handling
The migration uses `safety_assured` to bypass Strong Migrations checks, indicating that the developer has manually verified the safety of this migration.

## TODOs
There are no explicit TODOs in the code.
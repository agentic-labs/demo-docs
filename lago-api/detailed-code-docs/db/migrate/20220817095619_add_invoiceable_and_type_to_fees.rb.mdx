---
title: "20220817095619_add_invoiceable_and_type_to_fees.rb"
---

## High-level description
This migration adds two new columns to the `fees` table: `fee_type` and `invoiceable`. The `fee_type` is an integer column, while `invoiceable` is a polymorphic reference column of UUID type. This migration enhances the `fees` table to support different fee types and associate fees with various invoiceable entities.

## Symbols

### `AddInvoiceableAndTypeToFees`
#### Description
This class is an ActiveRecord migration that adds new columns to the `fees` table. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0.

#### Internal Logic
The migration performs two main actions:
1. Adds an integer column named `fee_type` to the `fees` table.
2. Adds a polymorphic reference column named `invoiceable` to the `fees` table, with a UUID type.

The `change` method is used, which allows Rails to automatically figure out how to reverse this migration if needed.

#### Performance Considerations
The `safety_assured` block is used when adding the `invoiceable` reference. This suggests that the migration might be using the `strong_migrations` gem or a similar safety mechanism. The `safety_assured` block indicates that the developer has considered the potential performance implications of adding this reference and has deemed it safe to proceed.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework |

## Notes
1. The `fee_type` column is added as an integer, suggesting it might be used with an enum in the `Fee` model to represent different types of fees.
2. The `invoiceable` reference is polymorphic, allowing fees to be associated with different types of models that can be invoiced.
3. The use of UUID for the `invoiceable` reference suggests that the application is using UUIDs as primary keys for at least some of its models.
4. The `safety_assured` block implies that there might be additional migration safety checks in place, possibly through a gem like `strong_migrations`.

This migration enhances the flexibility of the fee system by allowing fees to be categorized and associated with various invoiceable entities across the application.
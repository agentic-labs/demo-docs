---
title: "20220906130714_add_invites.rb"
---

## High-level description
This migration file creates a new table called `invites` in the database. The table is designed to store information about invitations within an organization, including details such as the associated organization, membership, email, token, status, and timestamps for various events.

## Code Structure
The code defines a single class `AddInvites` that inherits from `ActiveRecord::Migration[7.0]`. This class contains a `change` method that creates the `invites` table with specific columns and constraints.

## Symbols

### AddInvites
#### Description
This class is an ActiveRecord migration that defines the structure for the `invites` table in the database.

#### Internal Logic
The `change` method uses the `create_table` method to define the `invites` table with the following columns and constraints:

1. `id`: A UUID primary key
2. `organization`: A reference to the organizations table (foreign key)
3. `membership`: An optional reference to the memberships table (foreign key)
4. `email`: A required string column
5. `token`: A required string column with a unique index
6. `status`: An integer column with a default value of 0
7. `accepted_at`: A datetime column
8. `revoked_at`: A datetime column
9. `created_at` and `updated_at`: Timestamp columns (automatically added by `timestamps`)

## Dependencies
This migration relies on the ActiveRecord framework, which is part of Ruby on Rails.

## Configuration
The migration is configured to use UUID as the primary key type for the `invites` table.

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| id | :uuid | N/A | Sets the primary key type to UUID |

## Side Effects
When this migration is run, it will create a new table called `invites` in the database with the specified structure. This will affect the database schema and may impact any existing code that interacts with the database.

## Performance Considerations
Using UUID as the primary key type can have performance implications compared to traditional auto-incrementing integer keys. However, it provides benefits such as global uniqueness and improved distribution in certain database systems.

The addition of indexes on the `organization`, `membership`, and `token` columns can improve query performance when searching or joining on these fields.
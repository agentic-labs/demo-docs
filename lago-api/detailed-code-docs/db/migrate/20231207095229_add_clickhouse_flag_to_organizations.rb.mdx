---
title: "20231207095229_add_clickhouse_flag_to_organizations.rb"
---

## High-level description
This migration adds a boolean column named `clickhouse_aggregation` to the `organizations` table in the database. The column is set to have a default value of `false` and is not nullable.

## Symbols

### `AddClickhouseFlagToOrganizations`
#### Description
This class is an ActiveRecord migration that defines a change to be applied to the database schema. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0 migration framework.

#### Internal Logic
The migration uses the `change` method to define the modification to the database schema. Inside this method, it calls `add_column` to add a new column to the `organizations` table.

The `add_column` method is used with the following parameters:
1. `:organizations` - the name of the table to modify
2. `:clickhouse_aggregation` - the name of the new column
3. `:boolean` - the data type of the new column
4. `default: false` - sets the default value of the column to `false`
5. `null: false` - specifies that the column cannot contain null values

This migration will add a boolean flag to each organization record, presumably to indicate whether Clickhouse aggregation is enabled or not for that organization.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework and database abstraction |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| clickhouse_aggregation | boolean | false | Indicates whether Clickhouse aggregation is enabled for an organization |

Note: This migration adds a configuration option to the `organizations` table, but the actual usage of this flag would be implemented in other parts of the application.
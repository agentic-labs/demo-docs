---
title: "20240118140703_add_grouped_by_to_cached_aggregations.rb"
---

## High-level description
This migration adds a new column called `grouped_by` to the `cached_aggregations` table. The column is designed to store an array of strings, is set to not allow null values, and has a default value of an empty array.

## Symbols

### `AddGroupedByToCachedAggregations`
#### Description
This class is an ActiveRecord migration that defines a change to be applied to the database schema. It inherits from `ActiveRecord::Migration[7.0]`, indicating it's compatible with Rails 7.0 migration framework.

#### Internal Logic
The migration uses the `change` method to define a reversible database change. It adds a new column to the `cached_aggregations` table using the `add_column` method.

### `change`
#### Description
This method specifies the changes to be made to the database schema. In this case, it adds a new column to the `cached_aggregations` table.

#### Internal Logic
The method calls `add_column` with the following parameters:
- Table name: `:cached_aggregations`
- Column name: `:grouped_by`
- Column type: `:string`
- Options: 
  - `array: true`: Specifies that this column will store an array of strings
  - `null: false`: Disallows null values in this column
  - `default: []`: Sets the default value to an empty array

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the migration framework and database abstraction |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| array | boolean | true | Specifies that the column will store an array of values |
| null | boolean | false | Disallows null values in the column |
| default | array | [] | Sets the default value to an empty array |

Note: This migration will automatically be reversible due to the use of `add_column` in the `change` method. Rails can automatically generate the reverse operation (dropping the column) if the migration needs to be rolled back.
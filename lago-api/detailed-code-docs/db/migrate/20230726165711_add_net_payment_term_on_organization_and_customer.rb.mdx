---
title: "20230726165711_add_net_payment_term_on_organization_and_customer.rb"
---

## High-level description
This migration adds a `net_payment_term` column to both the `organizations` and `customers` tables. It also adds check constraints to ensure that the `net_payment_term` values are non-negative in both tables.

## Symbols

### AddNetPaymentTermOnOrganizationAndCustomer
#### Description
This is a Rails migration class that inherits from `ActiveRecord::Migration[7.0]`. It defines the changes to be applied to the database schema.

#### Internal Logic
The migration performs the following steps:
1. Adds a `net_payment_term` column to the `organizations` table.
2. Adds a `net_payment_term` column to the `customers` table.
3. Adds check constraints to both tables to ensure `net_payment_term` is non-negative.

### change
#### Description
This method defines the changes to be applied to the database schema when the migration is run.

#### Internal Logic
1. Adds `net_payment_term` column to `organizations` table:
   - Type: integer
   - Default: 0
   - Not null
2. Adds `net_payment_term` column to `customers` table:
   - Type: integer
   - Default: nil
   - Nullable
3. Uses `safety_assured` block to bypass Strong Migrations checks.
4. Uses `reversible` block to define both up and down migrations.
5. In the `up` direction:
   - Executes SQL to add check constraints on both tables.
6. In the `down` direction:
   - Executes SQL to remove the check constraints from both tables.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord::Migration | Provides the framework for defining database schema changes |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| net_payment_term (organizations) | integer | 0 | Default value for organizations' net payment term |
| net_payment_term (customers) | integer | nil | Default value for customers' net payment term |

## Error Handling
The migration uses `safety_assured` to bypass Strong Migrations checks, indicating that the migration has been manually reviewed for safety.

## API/Interface Reference
| Method | Description |
|:-------|:------------|
| change | Defines the changes to be applied to the database schema |

This migration adds a new column and constraints to existing tables, which may affect any code that interacts with the `organizations` and `customers` tables in the application.
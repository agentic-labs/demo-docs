---
title: "gocardless_create_job.rb"
---

## High-level description
This code defines a background job class `GocardlessCreateJob` within the `Invoices::Payments` module. The job is responsible for creating a GoCardless payment for a given invoice using the `GocardlessService`.

## Code Structure
The `GocardlessCreateJob` class inherits from `ApplicationJob` and is configured to use the 'providers' queue. It utilizes the `unique` method to ensure the job is only executed once until it's completed.

## Symbols

### `GocardlessCreateJob`
#### Description
This class represents a background job for creating GoCardless payments for invoices.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| invoice | Invoice | The invoice object for which the payment needs to be created |

#### Internal Logic
1. The job calls the `create` method of `Invoices::Payments::GocardlessService` with the provided invoice.
2. It then calls `raise_if_error!` on the result to ensure any errors are raised and handled appropriately.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ApplicationJob | Base job class that this job inherits from |
| Invoices::Payments::GocardlessService | Service class used to create the GoCardless payment |

## Error Handling
The job uses `raise_if_error!` to handle any errors that might occur during the payment creation process. If an error occurs, it will be raised and can be caught by the job execution system for proper handling and potential retries.

## Performance Considerations
The job uses the `unique` method to ensure it's only executed once until completed. This prevents duplicate payment creation attempts for the same invoice, which could lead to errors or inconsistencies.

This job is part of a larger system for handling invoice payments, specifically for the GoCardless payment provider. It works in conjunction with other services and jobs to manage the payment process for invoices in the application.
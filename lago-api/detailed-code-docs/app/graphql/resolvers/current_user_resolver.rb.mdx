---
title: "current_user_resolver.rb"
---

## High-level description
This code defines a GraphQL resolver called `CurrentUserResolver` within the `Resolvers` module. Its primary purpose is to retrieve and return the currently authenticated user in a GraphQL query.

## Code Structure
The `CurrentUserResolver` class inherits from `Resolvers::BaseResolver` and includes the `AuthenticableApiUser` module. It defines a GraphQL field that returns a `UserType` object representing the current user.

## References
- `Types::UserType`: The GraphQL type definition for a user object.
- `AuthenticableApiUser`: A module that provides authentication-related functionality.

## Symbols

### `CurrentUserResolver`
#### Description
This resolver is responsible for fetching the current user from the GraphQL context.

#### Inputs
This resolver doesn't take any explicit inputs.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| current_user | Types::UserType | The currently authenticated user |

#### Internal Logic
The resolver simply returns the `current_user` object from the GraphQL context. This object is likely set during the authentication process before the GraphQL query execution.

## Side Effects
This resolver doesn't have any side effects. It only reads from the context without modifying any state.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| AuthenticableApiUser | Provides authentication-related functionality |

## Error Handling
The `AuthenticableApiUser` module, which is included in this resolver, implements error handling for unauthorized access. If there's no current user in the context, it raises an `unauthorized_error`.

## API/Interface Reference
This resolver is used as part of the GraphQL API. It's referenced in the `QueryType` as the resolver for the `current_user` field:

| Field | Resolver | Description |
|:------|:---------|:------------|
| current_user | Resolvers::CurrentUserResolver | Retrieves the currently connected user |

## Additional Notes
1. The resolver is marked as non-nullable (`null: false`), indicating that it always returns a user object when called successfully.
2. The `UserType` returned by this resolver includes fields such as `id`, `email`, `premium`, `memberships`, and `organizations`.
3. The `premium` field in `UserType` is determined by calling `License.premium?`, suggesting there's a licensing system in place.
4. The `organizations` field in `UserType` is marked as deprecated and is kept for backward compatibility with the frontend.

This resolver plays a crucial role in providing user information for authenticated GraphQL queries, serving as the entry point for user-specific data in the API.
---
title: "anrok.rb"
---

## High-level description
The code defines the `Types::Integrations::Anrok` GraphQL type, representing an Anrok integration within the application. It defines the structure and fields for querying and interacting with Anrok integration data.

## Code Structure
The `Types::Integrations::Anrok` class inherits from `Types::BaseObject` and defines several fields representing attributes of an Anrok integration. It also includes methods to format and derive values for certain fields like `api_key`, `has_mappings_configured`, `external_account_id`, and `failed_invoices_count`.

## References
- `Types::BaseObject`: Parent class providing basic GraphQL object functionality.
- `IntegrationCollectionMappings::AnrokCollectionMapping`: Used to check for configured mappings.

## Symbols

### `Types::Integrations::Anrok`
#### Description
A GraphQL type representing an Anrok integration. It defines the fields and their types that can be queried for an Anrok integration.

#### Inputs
This is a GraphQL type definition, not a function, so it doesn't have explicit inputs.

#### Outputs
This is a GraphQL type definition, not a function, so it doesn't have explicit outputs. However, it defines the following fields that can be queried:

| Name | Type | Description |
|:-----|:-----|:------------|
| api_key | String | The obfuscated API key of the Anrok integration. |
| code | String | The code associated with the Anrok integration. |
| external_account_id | String | The external account ID extracted from the API key, if available. |
| failed_invoices_count | Integer | The number of failed invoices associated with the Anrok integration. |
| has_mappings_configured | Boolean | Indicates whether the Anrok integration has mappings configured. |
| id | ID | The unique identifier of the Anrok integration. |
| name | String | The name of the Anrok integration. |

#### Internal Logic
The type defines several methods:

- `api_key`: Obfuscates the actual API key for security reasons, showing only the last three digits.
- `has_mappings_configured`: Checks if any Anrok collection mappings exist for the integration.
- `external_account_id`: Extracts the external account ID from the API key if it follows a specific format.
- `failed_invoices_count`: Retrieves the count of failed invoices associated with the integration.

## Dependencies
- `graphql`: Provides the GraphQL implementation and types.

## Error Handling
The code does not implement specific error handling beyond potential exceptions raised during data retrieval or processing.

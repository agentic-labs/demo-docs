---
title: "update.rb"
---

## High-level description
This code defines a GraphQL mutation for updating an existing invoice in a Ruby on Rails application. It is part of the Mutations module and specifically handles the update operation for invoices, including authentication and permission checks.

## Code Structure
The `Update` class inherits from `BaseMutation` and includes the `AuthenticableApiUser` concern. It defines the input object, return type, and resolve method for the update operation.

## References
- `Types::Invoices::UpdateInvoiceInput`
- `Types::Invoices::Object`
- `::Invoices::UpdateService`

## Symbols

### `Mutations::Invoices::Update`
#### Description
This class represents a GraphQL mutation for updating an existing invoice. It includes authentication checks and uses a service object to perform the actual update operation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args | Hash | Arguments passed to the mutation, including invoice ID and update parameters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| invoice | Types::Invoices::Object | The updated invoice object if successful |
| errors | [String] | Array of error messages if the update fails |

#### Internal Logic
1. Finds the invoice by ID within the current organization's visible invoices.
2. Calls the `::Invoices::UpdateService` to perform the update operation.
3. Returns the updated invoice if successful, or error information if the update fails.

## Side Effects
- Updates an existing invoice in the database.
- May trigger webhook notifications (handled by the UpdateService).

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| AuthenticableApiUser | Provides authentication checks for the API user |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| REQUIRED_PERMISSION | String | 'invoices:update' | The permission required to perform this mutation |

## Error Handling
The mutation uses the `result_error` method (likely defined in a parent class) to handle and format errors returned by the UpdateService.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
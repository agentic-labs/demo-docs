---
title: "Overview"
---

## High-level description

This directory contains GraphQL mutations for authentication processes within a Ruby on Rails application. It includes two subdirectories, each handling authentication through different providers: Google OAuth and Okta OAuth. These mutations serve as the interface between the client-side application and the server-side authentication logic, providing a structured way to handle user authentication, registration, and invite acceptance.

## What does it do?

The code in this directory facilitates several authentication workflows:

1. User Registration: Allows new users to create accounts using either Google or Okta authentication.

2. User Login: Enables existing users to log in to the application using their Google or Okta credentials.

3. Invite Acceptance: Provides a mechanism for users to accept membership invites using their Google or Okta accounts.

4. Authorization Initiation: Specifically for Okta, it includes functionality to start the authorization process, generating a URL for user redirection.

Each of these workflows is implemented as a separate GraphQL mutation, providing a clear and structured way for client applications to interact with the authentication systems. The mutations handle the server-side portion of the authentication flow, processing OAuth codes, creating or updating user accounts, and generating session tokens.

## Key Files

1. Google Authentication (`app/graphql/mutations/auth/google/`):
   - `accept_invite.rb`: Handles accepting invites using Google OAuth.
   - `login_user.rb`: Manages user login with Google credentials.
   - `register_user.rb`: Facilitates new user registration via Google OAuth.

2. Okta Authentication (`app/graphql/mutations/auth/okta/`):
   - `accept_invite.rb`: Processes invite acceptance using Okta OAuth.
   - `authorize.rb`: Initiates the Okta authorization process.
   - `login.rb`: Handles user login through Okta.

Each file defines a specific GraphQL mutation that interacts with the respective authentication service (Google or Okta) and performs the necessary operations within the application.

## Dependencies

The mutations rely on several internal and external dependencies:

1. Internal Services:
   - `::Auth::GoogleService`: Handles Google OAuth interactions.
   - `::Auth::Okta::AcceptInviteService`, `::Auth::Okta::AuthorizeService`, `::Auth::Okta::LoginService`: Manage Okta-related operations.

2. GraphQL Types:
   - Various custom types (e.g., `Types::Payloads::RegisterUserType`, `Types::Payloads::LoginUserType`, `Types::Auth::Okta::AcceptInviteInput`) that define the structure of mutation inputs and payloads.

3. External Libraries:
   - While not explicitly mentioned, these mutations likely depend on OAuth libraries for Ruby/Rails to handle the OAuth flows.

## Configuration

Although not directly visible in the code snippets, these authentication integrations require configuration, typically stored in environment variables or configuration files:

1. Google OAuth:
   - Google API credentials (Client ID, Client Secret)
   - Authorized redirect URIs

2. Okta OAuth:
   - Okta application credentials (Client ID, Client Secret)
   - Okta authorization server URL
   - Redirect URIs for the OAuth flow

The mutations are designed to be flexible, taking necessary OAuth codes as inputs rather than handling the OAuth flow directly. This suggests that the OAuth process is initiated client-side, with these mutations handling the server-side portion of the authentication flow.

In summary, this directory provides a comprehensive set of GraphQL mutations for handling user authentication, registration, and invite acceptance using both Google and Okta OAuth within the application. These mutations serve as the interface between the client-side OAuth process and the server-side user management system, providing a seamless integration of third-party authentication into the application's user management workflows.
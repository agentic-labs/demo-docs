---
title: "Overview"
---

## High-level description
This directory contains GraphQL mutations related to Stripe payment provider operations within a Ruby on Rails application. It includes base functionality for Stripe-related mutations and specific mutations for creating and updating Stripe payment providers.

## What does it do?
This code allows users to interact with Stripe payment provider settings through a GraphQL API. It provides functionality to:

1. Create a new Stripe payment provider for an organization, including setting up API keys and configuration.
2. Update an existing Stripe payment provider's details.

These operations are secured with authentication and permission checks, ensuring that only authorized users can perform these actions. The code interacts with a Stripe service to handle the actual creation and updating of payment providers, which may involve tasks such as registering webhooks and managing customer data.

## Key Files

1. `base.rb`: This file defines the `Mutations::PaymentProviders::Stripe::Base` class, which serves as a foundation for Stripe-related mutations. It handles authentication, organization validation, and interaction with the Stripe service.

2. `create.rb`: This file contains the `Mutations::PaymentProviders::Stripe::Create` class, which defines the GraphQL mutation for adding a new Stripe payment provider to an organization.

3. `update.rb`: This file defines the `Mutations::PaymentProviders::Stripe::Update` class, which implements the GraphQL mutation for updating an existing Stripe payment provider's details.

## Dependencies
The code relies on several external dependencies and internal modules:

1. GraphQL: The entire structure is built using the GraphQL framework for Ruby.
2. AuthenticableApiUser: A module that provides user authentication functionality.
3. RequiredOrganization: A module that ensures the user belongs to a valid organization.
4. PaymentProviders::StripeService: An internal service that handles the creation and updating of Stripe payment providers.

## Configuration
The mutations use configuration settings to define permissions and input/output types:

1. Create mutation:
   - Required permission: 'organization:integrations:create'
   - Input type: Types::PaymentProviders::StripeInput
   - Return type: Types::PaymentProviders::Stripe

2. Update mutation:
   - Required permission: 'organization:integrations:update'
   - Input type: Types::PaymentProviders::UpdateInput
   - Return type: Types::PaymentProviders::Stripe

These configurations ensure that the mutations are properly integrated into the GraphQL schema and respect the application's permission system.

Here's an example of how the Create mutation might be used in a GraphQL query:

```graphql
mutation {
  addStripePaymentProvider(input: {
    code: "stripe_provider"
    name: "Stripe Payment"
    secretKey: "sk_test_1234567890"
    successRedirectUrl: "https://example.com/success"
  }) {
    id
    code
    name
    successRedirectUrl
  }
}
```

And similarly, for the Update mutation:

```graphql
mutation {
  updateStripePaymentProvider(input: {
    id: "123"
    name: "Updated Stripe Payment"
    successRedirectUrl: "https://example.com/new-success"
  }) {
    id
    code
    name
    successRedirectUrl
  }
}
```

These mutations would be processed by the respective classes, which would then interact with the StripeService to perform the actual operations on the payment provider data.
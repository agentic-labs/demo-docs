---
title: "sync_invoice.rb"
---

## High-level description
This code defines a GraphQL mutation called `SyncInvoice` within the `Mutations::Integrations` module. It's designed to synchronize an invoice with an external integration system, specifically for organizations that have integration capabilities.

## Code Structure
The `SyncInvoice` class inherits from `BaseMutation` and includes two modules: `AuthenticableApiUser` and `RequiredOrganization`. It defines the mutation's name, description, input object class, and output field. The main logic is implemented in the `resolve` method.

## References
- `Types::Integrations::SyncInvoiceInput`
- `::Integrations::Aggregator::Invoices::CreateService`

## Symbols

### `SyncInvoice`
#### Description
This class represents a GraphQL mutation for synchronizing an invoice with an external integration system.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args | Hash | Contains the `invoice_id` |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| invoice_id | ID | The ID of the synchronized invoice |

#### Internal Logic
1. Finds the invoice in the current organization using the provided `invoice_id`.
2. Calls the `::Integrations::Aggregator::Invoices::CreateService` asynchronously with the found invoice.
3. Returns the `invoice_id` if successful, otherwise returns an error.

## Side Effects
- Initiates an asynchronous job to sync the invoice with an external system.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| AuthenticableApiUser | Ensures the user is authenticated |
| RequiredOrganization | Ensures the user has access to the organization |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| REQUIRED_PERMISSION | String | 'organization:integrations:update' | The permission required to perform this mutation |

## Error Handling
The mutation relies on the error handling mechanisms provided by the included modules (`AuthenticableApiUser` and `RequiredOrganization`) and the `result_error` method (not shown in the provided code).

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| SyncIntegrationInvoice | Mutation | SyncIntegrationInvoiceInput | invoice_id | Syncs an integration invoice |

This mutation is part of the GraphQL API and is likely accessed through a GraphQL endpoint.
---
title: "destroy.rb"
---

## High-level description
This code defines a GraphQL mutation for deleting a tax within an organization. It's part of a larger GraphQL API and handles the process of finding and destroying a tax record, while also updating related draft invoices.

## Code Structure
The `Destroy` class is defined within the `Mutations::Taxes` module and inherits from `BaseMutation`. It includes two modules: `AuthenticableApiUser` and `RequiredOrganization`, which provide authentication and organization-related functionality.

## References
- `::Taxes::DestroyService`: A service class that handles the actual deletion of the tax.
- `current_organization`: Provided by the `RequiredOrganization` module.

## Symbols

### `Mutations::Taxes::Destroy`
#### Description
This class defines a GraphQL mutation for deleting a tax. It authenticates the user, ensures they have access to the organization, finds the tax by ID, and uses a service to delete it.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| id | ID | The ID of the tax to be deleted |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| id | ID | The ID of the deleted tax (if successful) |

#### Internal Logic
1. Finds the tax within the current organization using the provided ID.
2. Calls the `::Taxes::DestroyService` to delete the tax.
3. Returns the deleted tax if successful, or an error if the operation fails.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| AuthenticableApiUser | Provides user authentication functionality |
| RequiredOrganization | Ensures the user has access to the organization |

## Error Handling
The mutation uses the `result_error` method (likely defined in a parent class) to handle and return errors from the `DestroyService`.

## TODOs
There is a commented-out line suggesting that permissions might need to be implemented:
```ruby
# Permissions ??
# REQUIRED_PERMISSION = 'taxes:create'
```
This indicates that the developers may want to add permission checks for this mutation in the future.
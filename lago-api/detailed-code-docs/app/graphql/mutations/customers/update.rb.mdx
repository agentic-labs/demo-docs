---
title: "update.rb"
---

## High-level description
This code defines a GraphQL mutation for updating an existing customer in a Ruby on Rails application. It includes authentication, permission checks, and uses a service object to handle the update logic.

## Code Structure
The main class `Update` is defined within the `Mutations::Customers` module. It inherits from `BaseMutation` and includes the `AuthenticableApiUser` concern. The class defines the GraphQL mutation's name, description, input object, and return type. The core functionality is implemented in the `resolve` method.

## Symbols

### `Mutations::Customers::Update`
#### Description
This class defines a GraphQL mutation for updating an existing customer. It handles authentication, permission checks, and delegates the update logic to a service object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| args | Hash | A hash containing the update parameters for the customer |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| customer | Types::Customers::Object | The updated customer object if successful |
| error | GraphQL::ExecutionError | An error object if the update fails |

#### Internal Logic
1. The mutation requires specific permissions defined in `REQUIRED_PERMISSION`.
2. It uses `Types::Customers::UpdateCustomerInput` as the input object class.
3. The `resolve` method calls the `::Customers::UpdateService` to perform the update.
4. If successful, it returns the updated customer; otherwise, it returns an error.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| AuthenticableApiUser | Provides authentication functionality |
| Types::Customers::UpdateCustomerInput | Defines the input structure for the mutation |
| Types::Customers::Object | Defines the return type for the mutation |
| ::Customers::UpdateService | Handles the actual customer update logic |

## Error Handling
The mutation uses the `result_error` method to handle and return errors from the update service.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| updateCustomer | POST | UpdateCustomerInput | Customer object or error | Updates an existing customer |

This mutation is part of the larger GraphQL API and can be accessed through the standard GraphQL endpoint of the application.
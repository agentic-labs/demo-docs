---
title: "Overview"
---

## High-level description
The `app/services/taxes` directory contains service classes responsible for managing tax-related operations within the application. These services handle various aspects of tax management, including automatic generation of tax records, creation, updating, and deletion of individual tax entries. The services are designed to work with an organization's tax structure, particularly focusing on EU VAT rates and general tax management.

## What does it do?
This directory provides a set of services that:

1. Automatically generate tax records for an organization based on EU VAT rates, creating standard rates for each EU country and additional exception rates where applicable.
2. Create new tax records for an organization, handling the creation process and any validation errors.
3. Update existing tax records, modifying their attributes and managing related draft invoices.
4. Delete tax records and update affected draft invoices accordingly.

These services ensure that organizations have up-to-date tax information for billing purposes, especially for those operating within the EU. They also provide a consistent interface for tax management across different parts of the application, including both API and GraphQL contexts.

## Key Files

1. `auto_generate_service.rb`: This file contains the `AutoGenerateService` class, which is responsible for automatically generating tax records for an organization based on EU VAT rates. It creates standard tax rates for each EU country and additional exception rates where applicable.

2. `create_service.rb`: This file defines the `CreateService` class, which handles the creation of new tax records for an organization. It sets up the required attributes and performs the main logic of creating a tax record.

3. `update_service.rb`: This file contains the `UpdateService` class, which is responsible for updating existing tax records. It handles the modification of tax attributes, updates related draft invoices, and manages error cases.

4. `destroy_service.rb`: This file defines the `DestroyService` class, which handles the deletion of tax records and updates related draft invoices.

## Dependencies
The services in this directory rely on the following dependencies:

1. `BaseService`: A parent class providing common functionality for service objects.
2. `ActiveRecord`: Used for database operations and error handling.
3. `LagoEuVat::Rate`: Provides EU VAT rates and country information (used in `AutoGenerateService`).

## Configuration
While there are no explicit configuration files mentioned, the services use various models and classes that may have their own configurations:

1. `Organization`: Represents the organization for which taxes are being managed.
2. `Tax`: Represents individual tax records.
3. `Invoice`: Used to update draft invoices affected by tax changes.

The services also use parameters passed during initialization to configure their behavior, such as the organization and specific attributes for tax creation or updates.

In summary, the `app/services/taxes` directory provides a comprehensive set of services for managing taxes within the application, focusing on EU VAT rates and general tax record management. These services handle the creation, updating, deletion, and automatic generation of tax records, ensuring that organizations have accurate and up-to-date tax information for billing purposes.
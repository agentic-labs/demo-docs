---
title: "void_service.rb"
---

## High-level description
This code defines a `VoidService` class within the `CreditNotes` module, responsible for voiding a credit note. It checks if the credit note is voidable and marks it as voided if the conditions are met.

## Code Structure
The `VoidService` class inherits from `BaseService` and contains a single public method `call` that performs the voiding operation. It uses a `result` object to manage the operation's outcome.

## Symbols

### `VoidService`
#### Description
A service class that handles the voiding of a credit note.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| credit_note | CreditNote | The credit note to be voided |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Result | An object containing the operation's outcome |

#### Internal Logic
1. Check if the credit note exists and is not in draft status.
2. Verify if the credit note is voidable.
3. Mark the credit note as voided if conditions are met.

### `initialize`
#### Description
Initializes the service with a credit note.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| credit_note | CreditNote | The credit note to be voided |

### `call`
#### Description
Executes the voiding process for the credit note.

#### Internal Logic
1. Return a not_found_failure if the credit note is nil or in draft status.
2. Set the credit_note in the result object.
3. Return a not_allowed_failure if the credit note is not voidable.
4. Mark the credit note as voided using the `mark_as_voided!` method.
5. Return the result object.

## Error Handling
The service uses the `result` object to handle and communicate errors:
- `not_found_failure!` when the credit note is not found or in draft status.
- `not_allowed_failure!` when the credit note is not voidable.

## Dependencies
This service likely depends on a `CreditNote` model and a `BaseService` class, which are not shown in the provided code.

## Related Code Context
1. The `void` action in the `CreditNotesController` uses this service to void a credit note via API.
2. The `Void` GraphQL mutation also utilizes this service for voiding credit notes through GraphQL API.

These related components demonstrate how the `VoidService` is integrated into the application's API layer, providing functionality for voiding credit notes through different interfaces.
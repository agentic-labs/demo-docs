---
title: "depleted_ongoing_balance_service.rb"
---

## High-level description
This code defines a service class `DepletedOngoingBalanceService` within the `Webhooks::Wallets` module. It is responsible for handling webhook notifications when a wallet's ongoing balance is depleted. The class extends the `Webhooks::BaseService` and provides specific implementations for webhook-related methods.

## Code Structure
The `DepletedOngoingBalanceService` class inherits from `Webhooks::BaseService` and overrides several private methods to customize the webhook behavior for the wallet depleted ongoing balance event.

## References
This code references the following:
- `Webhooks::BaseService`
- `::V1::WalletSerializer`

## Symbols

### `Webhooks::Wallets::DepletedOngoingBalanceService`
#### Description
This class is responsible for handling the webhook notification when a wallet's ongoing balance is depleted. It provides specific implementations for the webhook type, object type, and serialization of the wallet object.

#### Internal Logic
The class overrides four private methods from the base class:

1. `current_organization`: Retrieves the organization associated with the wallet object.
2. `object_serializer`: Uses the `V1::WalletSerializer` to serialize the wallet object.
3. `webhook_type`: Defines the specific webhook type for this event as 'wallet.depleted_ongoing_balance'.
4. `object_type`: Specifies the object type as 'wallet'.

These methods are used by the base class to construct and send the webhook payload.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| `Webhooks::BaseService` | Parent class providing the main webhook functionality |
| `::V1::WalletSerializer` | Serializes the wallet object for the webhook payload |

## API/Interface Reference
While this class doesn't directly expose an API, it is part of the webhook system. When triggered, it will send a webhook with the following characteristics:

| Webhook Type | Object Type | Payload |
|:-------------|:------------|:--------|
| wallet.depleted_ongoing_balance | wallet | Serialized wallet data |

The exact structure of the serialized wallet data can be found in the `V1::WalletSerializer` class, which includes details such as the wallet's ID, customer information, balance, and status.
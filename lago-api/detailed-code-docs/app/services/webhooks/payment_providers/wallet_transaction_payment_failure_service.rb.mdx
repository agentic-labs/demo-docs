---
title: "wallet_transaction_payment_failure_service.rb"
---

## High-level description
This code defines a service class `WalletTransactionPaymentFailureService` within the `Webhooks::PaymentProviders` module. It is responsible for handling webhook events related to wallet transaction payment failures, preparing the necessary data for webhook notifications.

## Code Structure
The `WalletTransactionPaymentFailureService` class inherits from `Webhooks::BaseService` and defines private methods to provide specific functionality for wallet transaction payment failure webhooks.

## References
This code references:
- `Webhooks::BaseService` (parent class)
- `::V1::PaymentProviders::WalletTransactionPaymentErrorSerializer`

## Symbols

### `WalletTransactionPaymentFailureService`
#### Description
This service class handles the preparation of data for webhook notifications when a wallet transaction payment fails.

#### Inputs
This class doesn't explicitly define inputs, but it likely receives an `object` (wallet transaction) and `options` from its parent class.

#### Internal Logic
The class overrides several private methods to customize the behavior for wallet transaction payment failures:

1. `current_organization`: Retrieves the organization associated with the wallet of the transaction.
2. `object_serializer`: Creates a serializer for the wallet transaction payment error, including additional error information.
3. `webhook_type`: Defines the type of webhook as 'wallet_transaction.payment_failure'.
4. `object_type`: Specifies the object type as 'payment_provider_wallet_transaction_payment_error'.

### `current_organization`
#### Description
Retrieves the organization associated with the wallet of the transaction.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| @current_organization | Organization | The organization associated with the wallet |

#### Internal Logic
Memoizes the organization by accessing it through the wallet associated with the object (likely a wallet transaction).

### `object_serializer`
#### Description
Creates a serializer for the wallet transaction payment error.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| serializer | WalletTransactionPaymentErrorSerializer | Serializer instance for the wallet transaction payment error |

#### Internal Logic
Instantiates a `::V1::PaymentProviders::WalletTransactionPaymentErrorSerializer` with the object, specifying the root name and including additional error information from the options.

### `webhook_type`
#### Description
Defines the type of webhook for wallet transaction payment failures.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| webhook_type | String | The type of webhook |

### `object_type`
#### Description
Specifies the object type for wallet transaction payment errors.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| object_type | String | The type of object for serialization |

## Dependencies
This code depends on the `::V1::PaymentProviders::WalletTransactionPaymentErrorSerializer` for serializing the wallet transaction payment error data.
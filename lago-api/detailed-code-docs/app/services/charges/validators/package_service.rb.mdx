---
title: "package_service.rb"
---

## High-level description
This code defines a `PackageService` class within the `Charges::Validators` module. It is responsible for validating the properties of a package charge, specifically the amount, free units, and package size.

## Code Structure
The `PackageService` class inherits from `Charges::Validators::BaseService` and overrides the `valid?` method to perform specific validations for package charges.

## Symbols

### `PackageService`
#### Description
This class is responsible for validating the properties of a package charge.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| properties | Hash | A hash containing the charge properties to be validated |

#### Internal Logic
1. Overrides the `valid?` method to perform three validations:
   - Validates the amount
   - Validates the free units
   - Validates the package size
2. Calls `super` to perform any additional validations defined in the parent class

### `valid?`
#### Description
This method performs the package charge validations and returns the result of the parent class's `valid?` method.

#### Internal Logic
1. Calls `validate_amount`
2. Calls `validate_free_units`
3. Calls `validate_package_size`
4. Returns the result of `super`

### `amount`
#### Description
A private method that retrieves the 'amount' value from the properties hash.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| amount | String | The amount value from the properties hash |

### `validate_amount`
#### Description
Validates the amount using the `Validators::DecimalAmountService`.

#### Internal Logic
1. Checks if the amount is valid using `Validators::DecimalAmountService`
2. If invalid, adds an error with the field `:amount` and error code 'invalid_amount'

### `package_size`
#### Description
A private method that retrieves the 'package_size' value from the properties hash.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| package_size | Integer | The package size value from the properties hash |

### `validate_package_size`
#### Description
Validates that the package size is present, an integer, and positive.

#### Internal Logic
1. Checks if `package_size` is present, an integer, and positive
2. If invalid, adds an error with the field `:package_size` and error code 'invalid_package_size'

### `free_units`
#### Description
A private method that retrieves the 'free_units' value from the properties hash.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| free_units | Integer | The free units value from the properties hash |

### `validate_free_units`
#### Description
Validates that the free units value is present, an integer, and non-negative.

#### Internal Logic
1. Checks if `free_units` is present, an integer, and greater than or equal to 0
2. If invalid, adds an error with the field `:free_units` and error code 'invalid_free_units'

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| Validators::DecimalAmountService | Used to validate the amount property |

## Error Handling
The class uses the `add_error` method (likely defined in the parent class) to add validation errors. Each validation method adds a specific error if the validation fails.
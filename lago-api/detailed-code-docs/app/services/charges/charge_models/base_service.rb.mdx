---
title: "base_service.rb"
---

## High-level description
This code defines a base service class `BaseService` within the `Charges::ChargeModels` module. It provides a foundation for various charge models, implementing common functionality and defining an interface for specific charge model implementations to follow.

## Code Structure
The `BaseService` class serves as a parent class for different charge model services. It defines a common structure and interface that child classes should implement, including methods for applying charges and computing amounts.

## Symbols

### `Charges::ChargeModels::BaseService`
#### Description
This class is the base service for charge models. It provides a common structure and interface for applying charges based on aggregation results and properties.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| charge | Object | The charge object |
| aggregation_result | Object | The result of aggregation |
| properties | Hash | Properties for the charge model |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Object | An object containing charge calculation results |

#### Internal Logic
1. Initializes the service with charge, aggregation_result, and properties.
2. Defines an `apply` method that sets various attributes on the result object.
3. Calls `compute_amount`, `unit_amount`, and `amount_details` methods, which are to be implemented by child classes.
4. Sets `total_aggregated_units` if available in the aggregation result.

### `self.apply`
#### Description
A class method that creates a new instance of the service and calls its `apply` method.

### `apply`
#### Description
Applies the charge model calculations and populates the result object.

### `compute_amount`
#### Description
A method to be implemented by child classes for computing the total charge amount.

### `unit_amount`
#### Description
A method to be implemented by child classes for computing the amount per unit.

### `amount_details`
#### Description
A method that can be overridden by child classes to provide additional details about the charge calculation.

## Dependencies
This class inherits from `::BaseService`, which is not shown in the provided code snippets.

## References
The `BaseService` class is referenced and extended by several other charge model services in the related code snippets, including:
- `GroupedStandardService`
- `GraduatedService`
- `GraduatedPercentageService`
- `PackageService`
- `CustomService`

Each of these services implements specific logic for different charge models while utilizing the common structure provided by `BaseService`.
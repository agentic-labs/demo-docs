---
title: "Overview"
---

## High-level description
The `app/services/validators` directory contains a set of validator services that are crucial for ensuring data integrity and consistency across the application. These validators focus on decimal amount validation, metadata validation, and range bounds validation for pricing structures.

## What does it do?
This directory houses three main validator services:

1. DecimalAmountService: Validates decimal amounts, ensuring they are valid, positive, and properly formatted. This is crucial for handling financial transactions and monetary values throughout the application.

2. MetadataValidator: Validates metadata associated with wallet transactions or recurring transaction rules. It ensures that metadata adheres to specific constraints such as the number of keys, key length, value length, and structure.

3. RangeBoundsValidator: Validates the bounds of ranges in pricing structures, ensuring that ranges are contiguous and properly ordered. This is essential for graduated, volume, and graduated percentage pricing models.

These validators work together to maintain data quality and prevent errors in critical areas of the application, such as financial calculations, transaction processing, and pricing model implementations.

## Key Files

1. `decimal_amount_service.rb`:
   This file contains the `DecimalAmountService` class, which provides methods for validating decimal amounts. It ensures that input amounts are valid, positive decimals, and handles various edge cases and potential errors in the parsing process. This service is used extensively throughout the application for validating various types of decimal amounts, including charges, credits, and wallet transactions.

2. `metadata_validator.rb`:
   This file defines the `MetadataValidator` class, which is responsible for validating metadata associated with wallet transactions or recurring transaction rules. It ensures that the metadata adheres to specific constraints such as the number of keys, key length, value length, and structure. The validator is configurable and collects detailed error information for invalid metadata.

3. `range_bounds_validator.rb`:
   This file contains the `RangeBoundsValidator` module, which provides a method to validate the bounds of ranges in a pricing structure. It ensures that the ranges are contiguous and properly ordered, which is crucial for graduated, volume, and graduated percentage pricing models. This module is included in various validator services for different pricing models.

## Dependencies
The validators in this directory primarily rely on Ruby's standard library and ActiveSupport. The `DecimalAmountService` specifically uses the `BigDecimal` class for precise decimal arithmetic and parsing.

## Configuration
The `MetadataValidator` class uses a default configuration that can be overridden:

```ruby
DEFAULT_CONFIG = {
  max_keys: 5,
  max_key_length: 20,
  max_value_length: 40
}.freeze
```

This configuration allows for customization of the metadata validation rules, such as the maximum number of keys, maximum key length, and maximum value length.

The other validators do not have specific configuration options but may be customized through inheritance or module inclusion in other parts of the application.

These validator services play a critical role in maintaining data integrity and consistency across the application, particularly in areas dealing with financial calculations, transaction processing, and pricing models. They provide a robust foundation for ensuring that data entering the system meets the required standards and constraints.
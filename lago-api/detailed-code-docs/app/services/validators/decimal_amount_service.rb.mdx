---
title: "decimal_amount_service.rb"
---

## High-level description
The `DecimalAmountService` is a Ruby module that provides validation methods for decimal amounts. It ensures that input amounts are valid, positive decimals, and handles various edge cases and potential errors in the parsing process.

## Code Structure
The `DecimalAmountService` class contains class methods and instance methods for validating decimal amounts. The class methods delegate to instance methods, allowing for both class-level and instance-level usage.

## Symbols

### `DecimalAmountService`
#### Description
This class provides methods to validate decimal amounts, ensuring they are valid, positive, and properly formatted.

#### Class Methods

### `valid_amount?(amount)`
#### Description
Checks if the given amount is a valid decimal amount (zero or positive).

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| amount | String | The amount to be validated |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | True if the amount is valid, false otherwise |

### `valid_positive_amount?(amount)`
#### Description
Checks if the given amount is a valid positive decimal amount.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| amount | String | The amount to be validated |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | True if the amount is valid and positive, false otherwise |

#### Instance Methods

### `initialize(amount)`
#### Description
Initializes a new instance of the DecimalAmountService with the given amount.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| amount | String | The amount to be validated |

### `valid_amount?`
#### Description
Checks if the initialized amount is a valid decimal amount (zero or positive).

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | True if the amount is valid, false otherwise |

### `valid_positive_amount?`
#### Description
Checks if the initialized amount is a valid positive decimal amount.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | True if the amount is valid and positive, false otherwise |

### `valid_decimal?`
#### Description
Checks if the initialized amount is a valid decimal string that can be parsed into a BigDecimal.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Boolean | True if the amount is a valid decimal string, false otherwise |

#### Internal Logic
1. Checks if the amount is a String (required for precise decimal handling).
2. Attempts to parse the amount into a BigDecimal.
3. Verifies that the parsed decimal is present and finite.
4. Handles ArgumentError and TypeError exceptions that may occur during parsing.

## Side Effects
The class memoizes the parsed BigDecimal value in the `@decimal_amount` instance variable.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| BigDecimal | Used for precise decimal arithmetic and parsing |

## Error Handling
The `valid_decimal?` method catches and handles `ArgumentError` and `TypeError` exceptions that may occur during BigDecimal parsing, returning false in these cases.

## Performance Considerations
The class uses BigDecimal for precise decimal handling, which may have performance implications for large-scale operations compared to floating-point arithmetic. However, it provides better accuracy for financial calculations.

This service is used extensively throughout the application for validating various types of decimal amounts, including charges, credits, and wallet transactions. It ensures consistency and accuracy in handling decimal values across the system.
---
title: "Overview"
---

## High-level description
The `app/services/payment_provider_customers` directory contains a set of services that handle operations related to payment provider customers. These services are responsible for creating, updating, and managing customer information for various payment providers, including Stripe, GoCardless, and Adyen. The directory includes a factory pattern for instantiating the appropriate service based on the payment provider, as well as specific services for each supported provider.

## What does it do?
This directory provides a set of services that manage the interaction between the application and various payment providers. The main functionalities include:

1. Creating and updating customer records in the application and on the payment provider's side.
2. Generating checkout URLs for customers to complete payments.
3. Managing payment methods, including updating and deleting them.
4. Handling preauthorization events for certain providers (e.g., Adyen).
5. Providing a unified interface for working with different payment providers through a factory pattern.

These services abstract the complexities of working with different payment providers, allowing the rest of the application to interact with payment providers in a consistent manner.

## Entry points
The main entry points for this directory are:

1. `create_service.rb`: Handles the creation and updating of payment provider customer records.
2. `update_service.rb`: Provides a unified interface for updating customer information across different payment providers.
3. `factory.rb`: Acts as a factory for instantiating the appropriate service based on the payment provider.

The specific provider services (`adyen_service.rb`, `gocardless_service.rb`, and `stripe_service.rb`) are typically accessed through the factory or other entry points rather than being used directly.

## Key Files
1. `adyen_service.rb`: Handles operations specific to Adyen payment provider customers.
2. `gocardless_service.rb`: Manages operations for GoCardless payment provider customers.
3. `stripe_service.rb`: Handles Stripe-specific customer operations.
4. `create_service.rb`: Provides a unified interface for creating and updating payment provider customer records.
5. `update_service.rb`: Offers a consistent way to update customer information across different payment providers.
6. `factory.rb`: Implements a factory pattern to instantiate the appropriate service based on the payment provider.

## Dependencies
The services in this directory rely on several external libraries and frameworks:

1. Stripe: Used for interacting with the Stripe API in `stripe_service.rb`.
2. GoCardlessPro: Utilized in `gocardless_service.rb` for GoCardless API interactions.
3. Adyen: Employed in `adyen_service.rb` for Adyen API operations.
4. ActiveJob: Used for background job processing across various services.
5. Rails: The underlying framework for the entire application, providing features like ActiveRecord for database operations.

## Configuration
While there are no specific configuration files in this directory, the services likely rely on environment variables or application-wide configurations for API keys and other sensitive information required to interact with the payment providers. These configurations would typically be set up in the main application environment or through a secrets management system.

The services in this directory play a crucial role in managing payment provider customers, providing a flexible and extensible system for handling various payment providers. They abstract the complexities of working with different APIs and offer a consistent interface for the rest of the application to interact with payment provider customers.
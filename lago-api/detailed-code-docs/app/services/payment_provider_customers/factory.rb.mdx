---
title: "factory.rb"
---

## High-level description
This code defines a Factory class within the PaymentProviderCustomers module. Its purpose is to create and return instances of specific payment provider services based on the type of provider customer provided. It supports Stripe, GoCardless, and Adyen payment providers.

## Code Structure
The Factory class contains two class methods: `new_instance` and `service_class`. The `new_instance` method uses `service_class` to determine which service to instantiate based on the provider customer type.

## Symbols

### `Factory.new_instance`
#### Description
Creates and returns a new instance of the appropriate payment provider service based on the given provider customer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| provider_customer | Object | An instance of a payment provider customer (Stripe, GoCardless, or Adyen) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| service | Object | An instance of the corresponding payment provider service |

#### Internal Logic
1. Calls `service_class` to determine the appropriate service class based on the provider customer type.
2. Instantiates and returns a new instance of the determined service class, passing the provider customer as an argument.

### `Factory.service_class`
#### Description
Determines the appropriate service class based on the type of provider customer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| provider_customer | Object | An instance of a payment provider customer (Stripe, GoCardless, or Adyen) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| service_class | Class | The class of the corresponding payment provider service |

#### Internal Logic
Uses a case statement to match the provider customer's class name to the appropriate service class:
- For StripeCustomer, returns StripeService
- For GocardlessCustomer, returns GocardlessService
- For AdyenCustomer, returns AdyenService
- If no match is found, raises a NotImplementedError

## Error Handling
The `service_class` method raises a `NotImplementedError` if an unsupported provider customer type is provided.

## Dependencies
This code relies on the existence of the following classes:
- PaymentProviderCustomers::StripeService
- PaymentProviderCustomers::GocardlessService
- PaymentProviderCustomers::AdyenService
- PaymentProviderCustomers::StripeCustomer
- PaymentProviderCustomers::GocardlessCustomer
- PaymentProviderCustomers::AdyenCustomer

These classes are not defined in the provided code but are referenced and expected to exist in the broader application context.
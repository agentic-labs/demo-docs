---
title: "payment_provider_finder.rb"
---

## High-level description
This code defines a module `Customers::PaymentProviderFinder` that provides functionality to find a payment provider for a customer. It is designed to be included in other classes to add the ability to retrieve payment provider information.

## Code Structure
The module contains a single method `payment_provider` that takes a customer as an argument. It uses the `PaymentProviders::FindService` to locate the appropriate payment provider based on the customer's organization and payment provider details.

## Symbols

### `payment_provider`
#### Description
This method retrieves the payment provider for a given customer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| customer | Customer | The customer object for which to find the payment provider |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| payment_provider | PaymentProvider | The found payment provider or nil if not found |

#### Internal Logic
1. Calls `PaymentProviders::FindService` with the customer's organization ID, payment provider code, and payment provider type.
2. If the service returns an error with code 'payment_provider_not_found', it returns nil.
3. Otherwise, it raises any errors from the service.
4. If successful, it returns the payment provider from the service result.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ActiveSupport::Concern | Provides a way to create modules that can be easily included in classes |
| PaymentProviders::FindService | Used to find the payment provider based on customer information |

## Error Handling
The method handles the case where a payment provider is not found by returning nil. For any other errors, it raises an exception using `raise_if_error!`.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
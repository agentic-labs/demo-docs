---
title: "subsidiaries_service.rb"
---

## High-level description
The `SubsidiariesService` class, part of the `Integrations::Aggregator` module, is responsible for fetching and processing subsidiary data from an external API. It makes a GET request to a specific endpoint, handles the response, and transforms the subsidiary data into a standardized format.

## Code Structure
The `SubsidiariesService` class inherits from `BaseService` and defines methods for making API requests, handling responses, and processing subsidiary data.

## References
This code references the `BaseService` class, which provides common functionality for service objects in the application.

## Symbols

### `SubsidiariesService`
#### Description
This class is responsible for fetching and processing subsidiary data from an external API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| integration | Object | An object containing integration details (implicitly used) |
| provider | String | The provider name (implicitly used) |
| secret_key | String | The secret key for API authentication (implicitly used) |
| provider_key | String | The provider configuration key (implicitly used) |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Result | An instance of `BaseService::Result` containing processed subsidiaries |

#### Internal Logic
1. Defines the API endpoint path
2. Makes a GET request to the API with appropriate headers
3. Processes the response and transforms subsidiary data
4. Returns the result object with processed subsidiaries

### `action_path`
#### Description
Defines the API endpoint path for fetching subsidiaries.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| path | String | The API endpoint path |

### `call`
#### Description
Makes the API request, processes the response, and sets the result.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Result | An instance of `BaseService::Result` containing processed subsidiaries |

### `headers`
#### Description
Prepares the headers for the API request.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| headers | Hash | A hash containing the required headers for the API request |

### `handle_subsidiaries`
#### Description
Processes the subsidiary data from the API response.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| subsidiaries | Array | An array of subsidiary data from the API response |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| processed_subsidiaries | Array | An array of OpenStruct objects with standardized subsidiary data |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| OpenStruct | Used to create objects with arbitrary attributes for processed subsidiary data |

## Error Handling
The code doesn't implement explicit error handling. It relies on the error handling mechanisms provided by the `BaseService` class, which includes various failure types and a `Result` object for managing service outcomes.
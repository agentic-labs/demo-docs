---
title: "line_break_helper.rb"
---

## High-level description
The `LineBreakHelper` class provides a utility method to convert newline characters in a given text into HTML line breaks (`&lt;br/&gt;` tags). It also handles HTML escaping of the input text and removes blank lines.

## Symbols

### `LineBreakHelper`
#### Description
This class contains a single class method `break_lines` that processes text by converting newlines to HTML line breaks.

### `LineBreakHelper.break_lines`
#### Description
This class method takes a text input, escapes HTML entities, splits the text by newlines, removes blank lines, and joins the remaining lines with HTML line break tags.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| text | String or object responding to `to_s` | The input text to be processed |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | ActiveSupport::SafeBuffer | The processed text with HTML line breaks |

#### Internal Logic
1. Convert the input `text` to a string using `to_s`.
2. Escape HTML entities in the text using `ERB::Util.html_escape`.
3. Split the escaped text by newline characters.
4. Remove blank lines using `reject(&:blank?)`.
5. Join the remaining lines with `&lt;br/&gt;` tags.
6. Mark the result as HTML safe using `html_safe`.

## Side Effects
The method uses `html_safe` to mark the output as safe HTML, which bypasses Rails' automatic HTML escaping. This is generally safe in this context because the input has already been HTML escaped, but it's worth noting as a potential security consideration.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ERB::Util | Used for HTML escaping |
| ActiveSupport | Implied by the use of `blank?` and `html_safe` |

## Error Handling
This method does not implement any specific error handling. If the input cannot be converted to a string or doesn't respond to `to_s`, a `NoMethodError` might be raised.

## TODOs
The code includes a Rubocop disable comment for the `Rails/OutputSafety` cop. This suggests that the use of `html_safe` has been intentionally left in place, possibly after consideration of the security implications.

```ruby
# rubocop:disable Rails/OutputSafety
```

This disable comment indicates that the code intentionally bypasses Rails' automatic HTML escaping mechanism. While this is necessary for the functionality of the method, it's important to ensure that the input is properly sanitized to prevent potential security vulnerabilities.
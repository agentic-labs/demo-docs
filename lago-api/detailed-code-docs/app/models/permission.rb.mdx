---
title: "permission.rb"
---

## High-level description
The `Permission` class defines several permission levels used throughout the application by defining different permission hashes. It provides methods to load permissions from YAML files and defines several pre-defined permission hashes for different roles.

## Code Structure
The `Permission` class uses the `yaml_to_hash` method to load permissions from YAML files. The loaded hashes are then used to define several constants representing different permission levels: `EMPTY_PERMISSIONS_HASH`, `DEFAULT_PERMISSIONS_HASH`, `ADMIN_PERMISSIONS_HASH`, `MANAGER_PERMISSIONS_HASH`, and `FINANCE_PERMISSIONS_HASH`.

## References
- `Rails.root`: Used to construct the path to the YAML configuration files.
- `YAML.parse_file`: Used to parse the YAML files.
- `DottedHash`: Used to convert the parsed YAML data into a hash with dotted keys.

## Symbols
### `Permission`
#### Description
The `Permission` class is a utility class that handles loading and defining permission levels used throughout the application.

#### Inputs
This class doesn't have any instance methods and therefore doesn't accept any inputs.

#### Outputs
This class doesn't have any instance methods and therefore doesn't return any outputs.

#### Internal Logic
The class defines several constants representing different permission levels:
- `EMPTY_PERMISSIONS_HASH`: An empty hash representing no permissions.
- `DEFAULT_PERMISSIONS_HASH`: Loaded from `definition.yml`, representing default permissions.
- `ADMIN_PERMISSIONS_HASH`: All permissions set to `true`, representing administrator permissions.
- `MANAGER_PERMISSIONS_HASH`: Merges default permissions with permissions from `role-manager.yml`.
- `FINANCE_PERMISSIONS_HASH`: Merges default permissions with permissions from `role-finance.yml`.

The `yaml_to_hash` method loads a YAML file from the `app/config/permissions` directory and converts it into a hash with boolean values indicating whether a permission is granted or not.

## Side Effects
This class doesn't have any side effects.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails | Provides access to the Rails application environment and utilities. |
| yaml | Used for parsing YAML files. |
| dotted_hash | Used for converting nested hashes to dotted hashes. |

## Configuration
The permission definitions are loaded from YAML files located in the `app/config/permissions` directory.

- `definition.yml`: Defines the default permissions.
- `role-manager.yml`: Defines additional permissions for the Manager role.
- `role-finance.yml`: Defines additional permissions for the Finance role.

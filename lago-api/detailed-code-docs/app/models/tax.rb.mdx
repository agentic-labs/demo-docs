---
title: "tax.rb"
---

## High-level description
The `Tax` model represents a tax rate that can be applied to various financial entities within an organization. It manages associations with these entities and provides methods for retrieving and calculating tax information.

## Code Structure
The `Tax` model has many-to-many relationships with several other models, including `Customer`, `Fee`, `Invoice`, `CreditNote`, `AddOn`, `Plan`, `Charge`, and `Commitment`, through intermediary join tables. It also belongs to an `Organization`.

## References
This code references the following models:
- `Customer`
- `Fee`
- `Invoice`
- `CreditNote`
- `AddOn`
- `Plan`
- `Charge`
- `Commitment`
- `Organization`
- `Customer::AppliedTax`
- `Fee::AppliedTax`
- `Invoice::AppliedTax`
- `CreditNote::AppliedTax`
- `AddOn::AppliedTax`
- `Plan::AppliedTax`
- `Charge::AppliedTax`
- `Commitment::AppliedTax`

## Symbols

### `Tax`
#### Description
This class represents a tax rate and its application to various financial entities.

#### Inputs
This class doesn't have any explicitly defined input parameters.

#### Outputs
This class doesn't have any explicitly defined output values.

#### Internal Logic
The class defines several scopes and methods:
- `applied_to_organization`: Returns taxes that are applied to the entire organization.
- `ransackable_attributes`: Defines attributes that can be used for searching.
- `customers_count`: Returns the number of customers the tax is applied to.
- `applicable_customers`: Returns a list of customers the tax applies to, considering both direct application and organization-level application.

## Side Effects
This class doesn't have any significant side effects.

## Dependencies
This class depends on the following libraries:
| Dependency | Purpose |
|:-----------|:--------|
| ActiveRecord | Provides the ORM framework for interacting with the database. |
| PaperTrailTraceable | Includes the `PaperTrail` gem for tracking changes to the model. |

### Configuration
This class doesn't define any specific configuration options.

## Error Handling
This class uses ActiveRecord validations to ensure data integrity.

## Logging
This class doesn't implement any specific logging mechanisms.

## API/Interface Reference
This class doesn't expose any API endpoints.

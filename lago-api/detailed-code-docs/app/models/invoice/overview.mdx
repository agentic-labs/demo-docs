---
title: "Overview"
---

## High-level description
The `Invoice::AppliedTax` model represents a tax that has been applied to a specific invoice. It stores information about the tax, such as the tax code, name, rate, and amount.

## Code Structure
The `Invoice::AppliedTax` model is a nested class within the `Invoice` model. It inherits from `ApplicationRecord` and includes the `PaperTrailTraceable` module for tracking changes. It has a many-to-one relationship with both the `Invoice` and `Tax` models.

## References
- `Invoice` model
- `Tax` model

## Symbols
### `Invoice::AppliedTax`
#### Description
This class represents a tax applied to an invoice.

#### Inputs
This class does not define any specific inputs.

#### Outputs
This class does not define any specific outputs.

#### Internal Logic
- It uses the `monetize` gem to handle monetary values for `amount_cents` and `fees_amount_cents`, using the `amount_currency` attribute for currency.
- It validates that `amount_cents` is greater than or equal to 0.
- It defines a constant `TAX_CODES_APPLICABLE_ON_WHOLE_INVOICE` which lists tax codes that apply to the whole invoice.
- The `applied_on_whole_invoice?` method checks if the tax code is included in the `TAX_CODES_APPLICABLE_ON_WHOLE_INVOICE` list.

## Side Effects
This class does not have any notable side effects.

## Dependencies
- `activerecord`
- `paper_trail`
- `money-rails`

## Error Handling
This class relies on ActiveRecord validations for error handling.

---
title: "applied_usage_threshold.rb"
---

## High-level description
The `AppliedUsageThreshold` model represents a usage threshold that has been applied to a specific invoice. It records the lifetime usage amount at the time the threshold was applied.

## Code Structure
The `AppliedUsageThreshold` model has a `belongs_to` association with both the `UsageThreshold` and `Invoice` models. It also uses the `monetize` gem to handle the `lifetime_usage_amount_cents` attribute, ensuring it's treated as a monetary value in the invoice's currency.

## References
- `UsageThreshold`: Represents a predefined usage limit for a plan.
- `Invoice`: Represents a billing document issued to a customer.

## Symbols

### `AppliedUsageThreshold`
#### Description
This model represents an instance of a usage threshold being applied to an invoice. It stores the lifetime usage amount at the point of application.

#### Inputs
N/A - This is a database model, it doesn't have explicit inputs.

#### Outputs
N/A - This is a database model, it doesn't have explicit outputs.

#### Internal Logic
The model uses:
- `belongs_to`: Defines associations with `UsageThreshold` and `Invoice` models.
- `validates`: Ensures uniqueness of `usage_threshold_id` within the scope of an invoice.
- `monetize`: Handles the `lifetime_usage_amount_cents` attribute as a monetary value.

## Side Effects
N/A

#### Performance Considerations
N/A

## Dependencies
- `rails`: Provides the base framework for the model.
- `monetize`: Handles monetary values.

## Configuration
N/A

## Error Handling
N/A

## Logging
N/A

## API/Interface Reference
N/A

---
title: "organization.rb"
---

Based on the provided code for the `Organization` model, here's a comprehensive documentation:

## High-level description
The `Organization` model represents an organization within the application. It manages various aspects of an organization, including its settings, associated entities, and integrations with external services.

## Code Structure
The `Organization` model includes several modules and defines numerous associations with other models. It also includes validations, callbacks, and custom methods for managing organization-specific functionality.

## Symbols

### `Organization`
#### Description
This is the main class representing an organization in the system. It includes various settings and associations with other models.

#### Inputs
N/A (This is a model class, not a method)

#### Outputs
N/A (This is a model class, not a method)

#### Internal Logic
- Includes several modules: `PaperTrailTraceable`, `OrganizationTimezone`, `Currencies`
- Defines constants for email settings and document numbering
- Sets up numerous associations with other models (e.g., users, billable metrics, plans, customers)
- Defines validations for various attributes
- Implements callbacks for API key generation and document number prefix generation
- Provides methods for logo handling, VAT eligibility checking, and payment provider retrieval

### `logo_url`
#### Description
Returns the URL of the organization's logo.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| url | String | The URL of the organization's logo |

### `base64_logo`
#### Description
Returns the organization's logo encoded in base64 format.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| encoded_logo | String | The base64 encoded logo |

### `eu_vat_eligible?`
#### Description
Checks if the organization is eligible for EU VAT.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| eligible | Boolean | Whether the organization is EU VAT eligible |

### `payment_provider`
#### Description
Retrieves the payment provider for the given provider type.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| provider | String | The type of payment provider |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| provider | Object | The payment provider object |

## Side Effects
- The model interacts with the database to store and retrieve organization data.
- It manages file attachments for the organization's logo.

## Dependencies
- Rails ActiveRecord
- PaperTrail
- Various custom modules and concerns

## Configuration
The model defines several configuration options:
- `EMAIL_SETTINGS`: An array of allowed email setting values
- `DOCUMENT_NUMBERINGS`: An array of allowed document numbering types
- `INTEGRATIONS`: An array of allowed integration types

## Error Handling
The model includes various validations to ensure data integrity:
- Validates country code
- Validates default currency
- Validates document locale
- Validates email format
- Validates invoice footer length
- Validates document number prefix length
- Validates invoice grace period and net payment term
- Validates logo file type and size
- Validates name presence
- Validates timezone
- Validates webhook URL format

## Logging
No specific logging mechanisms are implemented in this model.

This documentation provides a comprehensive overview of the `Organization` model, its functionality, and its relationships with other parts of the application.
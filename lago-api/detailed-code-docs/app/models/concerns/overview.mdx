---
title: "Overview"
---

## High-level description
The `app/models/concerns` directory contains a collection of Ruby modules that provide reusable functionality for ActiveRecord models in a Ruby on Rails application. These modules, known as concerns, encapsulate common behaviors and attributes that can be shared across multiple models.

## What does it do?
This directory contains modules that add various capabilities to models:

1. Currency handling: Defines accepted currencies and provides methods to list them.
2. Timezone conversion: Allows for automatic conversion of time-aware values to customer or organization timezones.
3. Integration mapping: Provides a common interface for models that can be mapped to external integrations like Netsuite and Xero.
4. Version tracking: Integrates with the `paper_trail` gem to track changes made to model instances.
5. UUID searching: Enhances Ransack search capabilities for UUID fields.
6. Secure data storage: Provides methods for storing and retrieving encrypted sensitive data.
7. Sequential ID generation: Implements a mechanism for assigning unique, sequential IDs within a defined scope.
8. Settings storage: Offers a convenient way to store and retrieve key-value settings for models.

These concerns can be included in various models throughout the application to add their functionality where needed.

## Key Files

1. `currencies.rb`: Defines accepted currencies and methods to list them.
2. `customer_timezone.rb`: Provides automatic timezone conversion for customer-related time values.
3. `integration_mappable.rb`: Adds capabilities for mapping models to external integrations.
4. `organization_timezone.rb`: Similar to `customer_timezone.rb`, but for organization-related time values.
5. `paper_trail_traceable.rb`: Integrates version tracking using the `paper_trail` gem.
6. `ransack_uuid_search.rb`: Enhances Ransack search capabilities for UUID fields.
7. `secrets_storable.rb`: Implements secure storage and retrieval of sensitive data.
8. `sequenced.rb`: Provides a mechanism for generating unique, sequential IDs within a defined scope.
9. `settings_storable.rb`: Offers methods for storing and retrieving key-value settings.

## Dependencies
These concerns rely on several external libraries and frameworks:

1. Ruby on Rails: The underlying web application framework.
2. ActiveSupport::Concern: Used to define and include concerns in models.
3. paper_trail gem: Used for version tracking in `paper_trail_traceable.rb`.
4. Ransack gem: Enhanced in `ransack_uuid_search.rb` for UUID searching.
5. attr_encrypted gem: Implicitly used in `secrets_storable.rb` for encrypting sensitive data.

## Configuration
While the concerns themselves don't have extensive configuration options, they often provide class methods that allow for some customization when included in models. For example:

- `Currencies`: Defines `ACCEPTED_CURRENCIES` which can be modified to change the list of supported currencies.
- `IntegrationMappable`: Allows configuration of different types of integration mappings.
- `PaperTrailTraceable`: Configures metadata to be stored with each version, including the current user and Lago version.
- `Sequenced`: Provides options for configuring the scope and lock key for sequential ID generation.

These concerns are designed to be flexible and can be adapted to the specific needs of the models that include them.
---
title: "gross_revenues_controller.rb"
---

## High-level description
This code defines the `GrossRevenuesController` within the `Api::V1::Analytics` module. It handles requests for gross revenue analytics data, utilizing a service object to fetch and process the data based on provided filters.

## Code Structure
The `GrossRevenuesController` inherits from `BaseController` and defines an `index` action that uses the `GrossRevenuesService` to retrieve data. It also defines a private `filters` method to process request parameters.

## References
- `::Analytics::GrossRevenuesService`
- `BaseController`

## Symbols

### `GrossRevenuesController`
#### Description
This controller handles requests for gross revenue analytics data. It uses the `GrossRevenuesService` to fetch and process the data based on the current organization and applied filters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| params | Hash | Request parameters including filters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| @result | Object | The result of the `GrossRevenuesService` call |

#### Internal Logic
1. The `index` action initializes a `GrossRevenuesService` with the current organization and filters.
2. It calls the service and stores the result in `@result`.
3. It then calls `super`, likely rendering the result as JSON (based on common API practices).

### `filters`
#### Description
A private method that processes request parameters to create a hash of filters for the `GrossRevenuesService`.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| filters | Hash | Processed filters from request parameters |

#### Internal Logic
1. Extracts `external_customer_id` from params.
2. Extracts `currency` from params and converts it to uppercase.
3. Extracts `months` from params.
4. Returns a hash with these three filters.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| BaseController | Parent controller providing common functionality |
| ::Analytics::GrossRevenuesService | Service object for fetching and processing gross revenue data |

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /api/v1/analytics/gross_revenues | GET | Query parameters: external_customer_id, currency, months | JSON response with gross revenue data | Retrieves gross revenue analytics data based on provided filters |

Note: The exact response format is not specified in this code, but it's likely to be a JSON representation of the `@result` object returned by the `GrossRevenuesService`.
---
title: "Overview"
---

## High-level description
The `app/controllers` directory contains the core controllers for a SaaS application, including API controllers, admin controllers, and specialized controllers for handling webhooks and GraphQL requests. It provides a comprehensive set of endpoints for managing customers, subscriptions, invoices, analytics, and various other aspects of a subscription-based business.

## What does it do?
This directory implements the backend logic for a wide range of functionalities:

1. API Management: Handles various API endpoints for customer management, subscription handling, invoicing, analytics, plan management, event tracking, and webhook management.

2. Admin Interface: Provides controllers for administrative tasks such as managing invoices, memberships, and organizations.

3. Authentication: Implements different authentication mechanisms for API users, admin users, and customer portal users.

4. Webhook Processing: Handles incoming webhooks from payment providers like Stripe, GoCardless, and Adyen.

5. GraphQL Support: Processes GraphQL queries and mutations.

6. Error Handling: Implements standardized error responses across different controllers.

7. Pagination: Provides pagination functionality for collections of records.

8. Request Tracking: Sets tracing information for requests based on user and organization context.

The controllers work together to create a robust and secure backend for managing all aspects of a SaaS or subscription-based business, providing interfaces for both internal administration and external API consumers.

## Entry points
The main entry points for this codebase are:

1. `application_controller.rb`: The base controller that sets up common behavior for all controllers.

2. `api/base_controller.rb`: The foundation for all API controllers, implementing authentication and common API functionality.

3. `admin/base_controller.rb`: The base controller for admin-specific actions, handling admin authentication and context.

4. `graphql_controller.rb`: Handles all GraphQL requests, processing queries and mutations.

5. `webhooks_controller.rb`: Manages incoming webhooks from various payment providers.

The typical flow of control starts with the `application_controller.rb`, which sets up basic error handling and health checks. Depending on the type of request, control then flows to the appropriate specialized controller (API, admin, GraphQL, or webhooks).

## Key Files

1. `application_controller.rb`: Sets up common behavior, error handling, and includes a health check endpoint.

2. `api/base_controller.rb`: Implements core functionality for all API controllers, including authentication and error handling.

3. `admin/base_controller.rb`: Handles authentication and sets up the context for admin actions.

4. `graphql_controller.rb`: Processes and executes GraphQL queries.

5. `webhooks_controller.rb`: Handles incoming webhooks from different payment providers.

6. `concerns/` directory: Contains modules that provide reusable functionality for controllers, such as error handling, authentication, and pagination.

Each of these files and directories plays a crucial role in the overall functionality of the application, handling specific domains and providing the necessary infrastructure for processing requests, interacting with the database, and formatting responses.

## Dependencies
The controllers rely on several external dependencies and internal services:

1. Ruby on Rails framework
2. JWT for token-based authentication
3. GraphQL for query processing
4. Various service objects for business logic
5. Serializers for formatting API responses
6. OpenTelemetry for tracing

## Configuration
While there are no explicit configuration files in this directory, the controllers use several configuration-like elements:

1. API versioning: The API controllers are namespaced under `Api::V1`.
2. Authentication: Different authentication mechanisms are implemented for API, admin, and customer portal users.
3. Pagination: Many controllers use `page` and `per_page` parameters for pagination.
4. Error handling: Standardized error responses are implemented across controllers.
5. Environment variables: Used for various configurations, such as secret keys for JWT decoding.

In conclusion, the `app/controllers` directory contains a comprehensive set of controllers that form the backbone of a SaaS application. The controllers are well-structured, following RESTful principles and leveraging various design patterns to maintain clean, modular code. They provide extensive functionality for managing all aspects of a subscription-based business, from customer and subscription management to analytics and billing, with a focus on security, scalability, and maintainability.
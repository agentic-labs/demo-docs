---
title: "invoice_serializer.rb"
---

## High-level description
The `InvoiceSerializer` class is responsible for serializing `Invoice` objects into a JSON-compatible hash structure. It provides a detailed representation of an invoice, including its attributes, associated customer, subscriptions, fees, credits, metadata, applied taxes, and error details.

## Code Structure
The `InvoiceSerializer` class inherits from `ModelSerializer` and overrides the `serialize` method. It utilizes several private helper methods (`customer`, `subscriptions`, `fees`, `credits`, `metadata`, `applied_taxes`, `error_details`) to serialize associated objects. It also uses the `CollectionSerializer` to serialize collections of objects.

## References
- `ModelSerializer`: Parent class providing basic serialization functionality.
- `CustomerSerializer`: Used to serialize the associated customer object.
- `SubscriptionSerializer`: Used to serialize the associated subscription objects.
- `FeeSerializer`: Used to serialize the associated fee objects.
- `CreditSerializer`: Used to serialize the associated credit objects.
- `Invoices::MetadataSerializer`: Used to serialize the associated metadata objects.
- `Invoices::AppliedTaxSerializer`: Used to serialize the associated applied tax objects.
- `Invoices::ErrorDetailSerializer`: Used to serialize the associated error detail objects.
- `CollectionSerializer`: Used to serialize collections of objects.

## Symbols

### `InvoiceSerializer`
#### Description
Serializes an `Invoice` object into a JSON-compatible hash.

#### Inputs
The `serialize` method does not take any explicit inputs. It operates on the `model` attribute, which is an instance of the `Invoice` class.

#### Outputs
Returns a hash representing the serialized invoice data.

#### Internal Logic
The `serialize` method constructs a hash `payload` with the invoice attributes. It then conditionally merges additional hashes for associated objects based on the `include?` method, which checks if the serializer was initialized with specific includes. Finally, it returns the assembled `payload` hash.

## Side Effects
The code has no direct side effects. It does not modify any global state or external resources.

## Dependencies
- `active_model_serializers`: Provides the `ModelSerializer` and `CollectionSerializer` classes.

### Configuration
This code does not define any configuration options.

---
title: "invoice_payment_error_serializer.rb"
---

## High-level description
The `InvoicePaymentErrorSerializer` class is a custom serializer responsible for formatting data related to invoice payment errors into a specific JSON structure. This structure is intended for consumption by an external system, likely a payment provider, and includes details about the invoice, customer, payment provider, and the error itself.

## Code Structure
The `InvoicePaymentErrorSerializer` class inherits from `ModelSerializer` and overrides the `serialize` method. The `serialize` method constructs a hash containing relevant data from the `invoice` object and options passed to the serializer.

## References
- `ModelSerializer`: This class is assumed to be a parent class or module providing serialization functionality.
- `invoice`: This refers to an instance of a model representing an invoice, likely accessible through the inherited `model` method.
- `customer`: This refers to an association on the `invoice` object, representing the customer associated with the invoice.

## Symbols

### `InvoicePaymentErrorSerializer`
#### Description
This class serializes invoice payment error data into a specific JSON format.

#### Inputs
The serializer itself doesn't have explicit input parameters. However, it relies on:
- `model`: An instance of an invoice object, accessible via `alias_method :invoice, :model`.
- `options`: A hash containing additional data passed to the serializer, specifically `:provider_error` and `:provider_customer_id`.

#### Outputs
Returns a hash containing serialized data about the invoice payment error.

#### Internal Logic
The `serialize` method constructs a hash containing the following key-value pairs:
- `lago_invoice_id`: The ID of the invoice.
- `lago_customer_id`: The ID of the customer associated with the invoice.
- `external_customer_id`: The external ID of the customer.
- `provider_customer_id`: The customer ID specific to the payment provider.
- `payment_provider`: The name of the payment provider.
- `payment_provider_code`: The code of the payment provider.
- `provider_error`: The error message or code received from the payment provider.

## Side Effects
This class doesn't have any direct side effects as it focuses solely on data transformation for serialization.

## Dependencies
- `ModelSerializer`: This dependency suggests the code relies on a serialization framework or library.

## Error Handling
The code doesn't include specific error handling mechanisms. It assumes that the necessary data is available and valid.

## Logging
The code doesn't implement any logging mechanisms.

## API/Interface Reference
This class doesn't expose an API. It's used internally for data serialization.

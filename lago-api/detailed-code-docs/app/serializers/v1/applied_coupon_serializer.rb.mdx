---
title: "applied_coupon_serializer.rb"
---

## High-level description
The `V1::AppliedCouponSerializer` class is responsible for serializing an `AppliedCoupon` model instance into a JSON-compatible hash structure for API responses. It includes details about the applied coupon, such as its code, name, customer information, status, amount, frequency, and associated credits.

## Code Structure
The `V1::AppliedCouponSerializer` inherits from `ModelSerializer` and overrides the `serialize` method. It uses helper methods like `amount_cents_remaining` and `credits` to format specific attributes. It also leverages the `CollectionSerializer` to serialize associated credits if requested.

## References
- `ModelSerializer`: Parent class providing basic serialization functionality.
- `CollectionSerializer`: Used to serialize the collection of associated credits.
- `V1::CreditSerializer`: Used to serialize individual credit objects.

## Symbols

### `V1::AppliedCouponSerializer`
#### Description
This class serializes an `AppliedCoupon` object into a hash representation suitable for JSON output. It includes details about the applied coupon and optionally its associated credits.

#### Inputs
The `V1::AppliedCouponSerializer` class itself doesn't have explicit input parameters for its methods. However, it implicitly receives the following:

- `model`: An instance of the `AppliedCoupon` model to be serialized. This is passed during the initialization of the serializer.
- `options`: A hash of options to customize the serialization process. This is also passed during initialization and can include options like `:includes` to specify which associations to include.

#### Outputs
- `serialize`: Returns a hash representing the serialized `AppliedCoupon` object.

#### Internal Logic
The `serialize` method constructs a hash containing various attributes of the `AppliedCoupon` object. It formats dates as ISO8601 strings and conditionally includes the `credits` key based on the `:includes` option. The `amount_cents_remaining` method calculates the remaining amount for non-recurring, fixed-amount coupons. The `credits` method uses the `CollectionSerializer` to serialize the associated credits using the `V1::CreditSerializer`.

## Dependencies
- `ModelSerializer`: Provides basic serialization functionality.
- `CollectionSerializer`: Used for serializing collections of objects.
- `V1::CreditSerializer`: Used for serializing individual `Credit` objects.

## Error Handling
This code does not implement specific error handling beyond what is inherited from parent classes.

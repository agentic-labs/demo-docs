---
title: "Overview"
---

## High-level description
This directory contains RSpec test files for two jobs related to integration customers: `IntegrationCustomers::CreateJob` and `IntegrationCustomers::UpdateJob`. These tests ensure that the jobs correctly interact with their respective services to create and update integration customers.

## What does it do?
The tests in this directory verify the behavior of two important jobs in the system:

1. The Create Job: This job is responsible for creating new integration customers. When it runs, it should call a service that handles the actual creation process.

2. The Update Job: This job is tasked with updating existing integration customers. Similar to the Create Job, it should call a service that manages the update process.

The tests ensure that these jobs are working correctly by checking if they call the appropriate services with the right parameters. This is crucial for maintaining the integrity of the customer integration process, especially when dealing with external systems or providers (like NetSuite, as suggested by the factory names).

## Key Files

1. `create_job_spec.rb`:
   This file tests the `IntegrationCustomers::CreateJob`. It verifies that the job correctly calls the `IntegrationCustomers::CreateService` to create a new integration customer. The test mocks the service and checks if it's called with the right parameters, including customer data and synchronization flags.

2. `update_job_spec.rb`:
   This file tests the `IntegrationCustomers::UpdateJob`. It ensures that the job properly calls the `IntegrationCustomers::UpdateService` to update an existing integration customer. Similar to the create job test, it mocks the service and verifies the correct method calls and parameters.

Both files follow a similar structure:
- They set up test doubles for the respective services.
- They create mock data using FactoryBot (for integrations and customers).
- They stub the service initialization and call methods.
- They run the job and assert that the correct service methods were called with the expected parameters.

## Dependencies
The tests rely on the following dependencies:

1. RSpec: The testing framework used for writing and running the tests.
2. FactoryBot: Used for creating test data (factories) for integrations and customers.
3. Rails: The tests are written in the context of a Rails application, as evidenced by the use of `rails_helper`.

## Configuration
While there are no explicit configuration files in this directory, the tests use several important configurations and patterns:

1. RSpec configuration: The tests use RSpec's `describe`, `let`, `before`, and `it` blocks to structure the test cases.

2. Test doubles: Both test files use `instance_double` to create mock objects for the services, allowing for isolated testing of the job classes.

3. FactoryBot factories: The tests use factories named `:netsuite_integration`, `:customer`, and `:netsuite_customer`, suggesting that the application integrates with NetSuite for customer management.

4. Service result objects: Both tests expect the services to return a `BaseService::Result` object, indicating a standardized way of handling service responses in the application.

5. Job parameters: The tests pass parameters like `sync_with_provider: true` to the jobs, suggesting that the integration process can be configured to synchronize data with external providers.

These tests play a crucial role in ensuring the reliability of the customer integration process, particularly when creating or updating customer records that need to be synchronized with external systems. By verifying that the jobs correctly delegate to their respective services, the tests help maintain the separation of concerns in the application's architecture and ensure that the integration process works as expected.
---
title: "invoice_applied_taxes.rb"
---

## High-level description
This file defines a factory for creating `Invoice::AppliedTax` objects using FactoryBot, a popular Ruby gem for creating test data. The factory sets up default attributes for an applied tax on an invoice, including tax details and monetary values.

## Symbols

### `:invoice_applied_tax`
#### Description
This factory defines the attributes for creating an `Invoice::AppliedTax` object, which represents a tax applied to an invoice. It sets up default values for various attributes of the applied tax.

#### Inputs
The factory doesn't have explicit inputs, but it uses FactoryBot's DSL to define default attributes.

#### Outputs
When used, this factory will create and return an `Invoice::AppliedTax` object with the specified attributes.

#### Internal Logic
The factory sets the following attributes for the `Invoice::AppliedTax` object:
- `invoice`: Associates the applied tax with an invoice (likely using another factory)
- `tax`: Associates the applied tax with a tax object (likely using another factory)
- `tax_code`: Generates a unique tax code using "vat-" prefix and a UUID
- `tax_description`: Sets a default description for the tax
- `tax_name`: Sets a default name for the tax
- `tax_rate`: Sets a default tax rate of 20.0%
- `amount_cents`: Sets a default tax amount of 200 cents
- `amount_currency`: Sets the currency to 'EUR' (Euro)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Used to define and create test data factories |
| SecureRandom | Used to generate a UUID for the tax code |

## Notes
1. This factory is likely used in test suites to create sample `Invoice::AppliedTax` objects for testing purposes.
2. The use of `SecureRandom.uuid` ensures that each created `Invoice::AppliedTax` object has a unique `tax_code`.
3. The factory assumes the existence of `invoice` and `tax` factories, which are likely defined elsewhere in the project.
4. The monetary values are defined using the Money gem convention (separate fields for cents and currency).
5. The tax rate is set as a float value (20.0), representing a 20% tax rate.

This factory provides a convenient way to create `Invoice::AppliedTax` objects with predefined attributes, which can be overridden as needed in specific test scenarios.
---
title: "clickhouse_events.rb"
---

## High-level description
This file defines a factory for creating test instances of the `Clickhouse::EventsRaw` model using FactoryBot. It sets up default attributes and associations for generating sample data related to clickhouse events in a testing environment.

## Symbols

### `factory :clickhouse_events_raw`
#### Description
This factory defines how to create instances of the `Clickhouse::EventsRaw` class for testing purposes. It sets up default values and associations for various attributes of the model.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| organization | Association | Transient attribute to create or reference an organization |
| billable_metric | Association | Transient attribute to create or reference a billable metric |
| subscription | Association | Transient attribute to create or reference a subscription |

#### Internal Logic
1. Uses transient attributes to create associations without persisting them directly on the model.
2. Sets `organization_id` based on the associated organization.
3. Generates a random UUID for `transaction_id`.
4. Sets `external_subscription_id` from the associated subscription's external_id.
5. Sets `timestamp` to the current time.
6. Sets `code` from the associated billable metric's code.
7. Initializes `properties` as an empty hash.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Defines factories for creating test data |
| SecureRandom | Generates UUIDs for transaction_id |

## Notes
- This factory is likely used in test suites to generate sample data for Clickhouse events.
- The use of transient attributes allows for flexible creation of associated models without directly persisting them.
- The factory assumes the existence of other factories like `:organization`, `:billable_metric`, and `:subscription`.
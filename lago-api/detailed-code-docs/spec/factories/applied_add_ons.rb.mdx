---
title: "applied_add_ons.rb"
---

## High-level description
This code defines a factory for creating `AppliedAddOn` objects using FactoryBot, a popular Ruby gem for creating test data. The factory sets up default attributes for an `AppliedAddOn`, including associations with a customer and an add-on, as well as a default amount in euros.

## Symbols

### `FactoryBot.define`
#### Description
This method is used to define a new factory for the `AppliedAddOn` model. It encapsulates the factory definition and allows for the creation of `AppliedAddOn` instances with predefined attributes.

### `:applied_add_on`
#### Description
This symbol represents the name of the factory being defined. It corresponds to the `AppliedAddOn` model.

#### Internal Logic
The factory sets up the following attributes:
1. Associates the `AppliedAddOn` with a `customer` (likely using another factory).
2. Associates the `AppliedAddOn` with an `add_on` (likely using another factory).
3. Sets the `amount_cents` to 200.
4. Sets the `amount_currency` to 'EUR' (Euro).

## References
The factory references the following models:
- `Customer` (through the `customer` association)
- `AddOn` (through the `add_on` association)

## Dependencies
This code depends on the FactoryBot gem for defining and creating test data.

## Related Information
Based on the related `AppliedAddOn` model definition:

1. The `AppliedAddOn` model includes `PaperTrailTraceable` and `Currencies` modules.
2. It has `belongs_to` associations with both `add_on` and `customer`.
3. The `amount_cents` field is monetized.
4. There are validations for `amount_cents` (must be greater than 0) and `amount_currency` (must be included in a predefined currency list).
5. The database table `applied_add_ons` has fields for `id`, `amount_cents`, `amount_currency`, `created_at`, `updated_at`, `add_on_id`, and `customer_id`.

This factory provides a convenient way to create valid `AppliedAddOn` instances for testing purposes, ensuring that the basic associations and monetary values are set up correctly.
---
title: "integration_customers.rb"
---

## High-level description
This code defines FactoryBot factories for creating test instances of different types of integration customers: NetSuite, Anrok, and Xero. These factories are used to generate sample data for testing purposes, simulating the integration of customers with various external systems.

## Code Structure
The code defines three main factories: `netsuite_customer`, `anrok_customer`, and `xero_customer`. Each factory corresponds to a specific integration customer type and sets up the necessary attributes and associations.

## Symbols

### `netsuite_customer` factory
#### Description
Creates a test instance of a NetSuite customer integration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| integration | association | Associated NetSuite integration |
| customer | association | Associated customer |
| type | string | Class name of the integration customer |
| external_customer_id | string | Unique identifier for the external customer |
| settings | hash | Configuration settings for the integration |

#### Internal Logic
- Associates with a NetSuite integration
- Sets the type to 'IntegrationCustomers::NetsuiteCustomer'
- Generates a random UUID for the external_customer_id
- Defines settings with sync_with_provider set to true and a random subsidiary_id

### `anrok_customer` factory
#### Description
Creates a test instance of an Anrok customer integration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| integration | association | Associated Anrok integration |
| customer | association | Associated customer |
| type | string | Class name of the integration customer |
| external_customer_id | string | Unique identifier for the external customer |
| settings | hash | Configuration settings for the integration |

#### Internal Logic
- Associates with an Anrok integration
- Sets the type to 'IntegrationCustomers::AnrokCustomer'
- Generates a random UUID for the external_customer_id
- Defines settings with sync_with_provider set to true

### `xero_customer` factory
#### Description
Creates a test instance of a Xero customer integration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| integration | association | Associated Xero integration |
| customer | association | Associated customer |
| type | string | Class name of the integration customer |
| external_customer_id | string | Unique identifier for the external customer |
| settings | hash | Configuration settings for the integration |

#### Internal Logic
- Associates with a Xero integration
- Sets the type to 'IntegrationCustomers::XeroCustomer'
- Generates a random UUID for the external_customer_id
- Defines settings with sync_with_provider set to true

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Defines factories for creating test data |
| SecureRandom | Generates random UUIDs for external_customer_id |
| Faker | Generates random numbers for subsidiary_id in NetSuite customer |

## References
The factories reference the following models:
- IntegrationCustomers::NetsuiteCustomer
- IntegrationCustomers::AnrokCustomer
- IntegrationCustomers::XeroCustomer

These models are defined in the related code snippets and inherit from a BaseCustomer class. They all share the same database schema, which includes fields for settings, type, customer_id, external_customer_id, and integration_id.

The NetsuiteCustomer model has an additional `settings_accessors :subsidiary_id` declaration, which likely provides getter and setter methods for the subsidiary_id within the settings hash.
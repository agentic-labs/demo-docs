---
title: "refund_responses.rb"
---

## High-level description
This file defines a factory for creating mock Adyen refund responses using FactoryBot. It generates a sequence of structured data that simulates the response from Adyen's payment service provider (PSP) for refund operations.

## Symbols

### `FactoryBot.define`
#### Description
This method is used to define a new factory within the FactoryBot framework. In this case, it's defining a sequence for Adyen refund responses.

### `:adyen_refunds_response` sequence
#### Description
This sequence generates a new OpenStruct object each time it's called, simulating an Adyen refund response with randomized data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| OpenStruct | Object | An OpenStruct containing a simulated Adyen refund response |

#### Internal Logic
1. Creates a new OpenStruct object.
2. Sets a `response` key with a hash containing simulated refund response data:
   - `merchantAccount`: A randomly generated UUID
   - `pspReference`: A randomly generated UUID
   - `paymentPspReference`: A randomly generated UUID
   - `status`: Set to 'received'
   - `amount`: A hash with `currency` set to 'CHF' and `value` set to 134

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Provides a framework for setting up test data |
| OpenStruct | Used to create a flexible structure for the response data |
| SecureRandom | Used to generate random UUIDs for various fields |

## Notes
- This factory is likely used in test scenarios to simulate Adyen refund responses without making actual API calls.
- The use of `OpenStruct` allows for flexible access to the response data in tests.
- The currency is hardcoded to 'CHF' (Swiss Franc) and the amount to 134, which may not be suitable for all test cases and might need to be parameterized for more flexible testing.
- The `status` is always set to 'received', which may not cover all possible response statuses from Adyen.
---
title: "applied_usage_thresholds.rb"
---

## High-level description
This code defines a factory for creating `AppliedUsageThreshold` objects using FactoryBot, a popular Ruby gem for creating test data. The factory sets up default attributes for an `AppliedUsageThreshold`, including associations with `usage_threshold` and `invoice`, and a default `lifetime_usage_amount_cents` value.

## Symbols

### `FactoryBot.define`
#### Description
This method is used to define factories for FactoryBot. It encapsulates all factory definitions within its block.

### `:applied_usage_threshold`
#### Description
This symbol defines the factory for creating `AppliedUsageThreshold` objects. It sets up the default attributes and associations for these objects.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| usage_threshold | association | Associates the created object with a `usage_threshold` |
| invoice | association | Associates the created object with an `invoice` |
| lifetime_usage_amount_cents | integer | Sets the default value for `lifetime_usage_amount_cents` |

#### Internal Logic
The factory sets up the following:
1. Associates the `AppliedUsageThreshold` with a `usage_threshold` (likely using another factory or creating a new `UsageThreshold` object).
2. Associates the `AppliedUsageThreshold` with an `invoice` (likely using another factory or creating a new `Invoice` object).
3. Sets the `lifetime_usage_amount_cents` to 100 by default.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Used for defining and creating test data factories |

## References
This factory references the `AppliedUsageThreshold` model, which is defined in the related code snippet `app/models/applied_usage_threshold.rb`. The model provides context for the associations and attributes used in the factory:

- It belongs to `usage_threshold` and `invoice`.
- It has a `lifetime_usage_amount_cents` attribute, which is monetized.
- The `invoice` association is used to determine the currency for the monetized `lifetime_usage_amount_cents` attribute.

This factory can be used in tests to create `AppliedUsageThreshold` objects with default values, making it easier to set up test scenarios involving applied usage thresholds, invoices, and usage thresholds.
---
title: "events_sum_aggs.rb"
---

## High-level description
This code defines a factory for creating `Clickhouse::EventsSumAgg` objects using FactoryBot. It sets up default attributes and associations for testing purposes, allowing developers to easily create test data for the `Clickhouse::EventsSumAgg` model.

## Symbols

### `FactoryBot.define`
#### Description
This method is used to define a new factory for the `Clickhouse::EventsSumAgg` model.

### `:clickhouse_events_sum_agg`
#### Description
This is the name of the factory being defined. It can be used to create instances of `Clickhouse::EventsSumAgg` in tests.

#### Internal Logic
The factory sets up transient attributes and default values for various fields of the `Clickhouse::EventsSumAgg` model. It creates associated objects (subscription, customer, organization, billable_metric, plan, and charge) and uses their attributes to populate the `Clickhouse::EventsSumAgg` instance.

### Transient Attributes
#### Description
Transient attributes are used to create associated objects but are not directly assigned to the `Clickhouse::EventsSumAgg` instance.

| Name | Type | Description |
|:-----|:-----|:------------|
| subscription | Subscription | Created using the customer |
| customer | Customer | Created using FactoryBot |
| organization | Organization | Derived from the customer |
| billable_metric | BillableMetric | Created with the organization |
| plan | Plan | Created with the organization |
| charge | Charge | Created with the billable_metric and plan |

### Model Attributes
#### Description
These are the attributes directly assigned to the `Clickhouse::EventsSumAgg` instance.

| Name | Type | Description |
|:-----|:-----|:------------|
| organization_id | String | ID of the associated organization |
| external_subscription_id | String | External ID of the associated subscription |
| code | String | Code of the associated billable metric |
| timestamp | DateTime | Current time at the beginning of the hour |
| value | Float | Default value set to 12.0 |
| charge_id | String | ID of the associated charge |
| filters | Hash | Empty hash by default |
| grouped_by | Hash | Empty hash by default |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Used to define and create test data factories |

## References
This factory references several other models and factories:
- Subscription
- Customer
- Organization
- BillableMetric
- Plan
- Charge

These references are used to create associated objects and populate the `Clickhouse::EventsSumAgg` instance with realistic data for testing purposes.
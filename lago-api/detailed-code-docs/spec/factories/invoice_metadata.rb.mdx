---
title: "invoice_metadata.rb"
---

## High-level description
This code defines a factory for creating `InvoiceMetadata` objects using FactoryBot, a popular Ruby gem for creating test data. The factory is designed to generate sample metadata for invoices, which can be used in testing scenarios.

## Symbols

### `factory :invoice_metadata`
#### Description
This factory definition creates instances of the `Metadata::InvoiceMetadata` class with predefined attributes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| invoice | association | Associated invoice object |
| key | string | Metadata key |
| value | string | Metadata value |

#### Internal Logic
1. Associates the metadata with an invoice using the `invoice` association.
2. Sets a default key of 'lead_name'.
3. Sets a default value of 'John Doe'.

## References
- `Metadata::InvoiceMetadata`: The class for which this factory is defined.
- `invoice`: An association, likely referencing another factory or model for creating invoice objects.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| FactoryBot | Used to define and create test data factories |

## Additional Notes
1. The factory is defined within the `FactoryBot.define` block, which is the standard way to define factories using FactoryBot.
2. The `class:` option in the factory definition specifies the exact class to be instantiated, which is `Metadata::InvoiceMetadata` in this case.
3. The factory provides default values for `key` and `value`, but these can be overridden when creating instances if needed.
4. The associated `invoice` is not given a default value in this factory, so it would need to be provided or associated with another factory when creating `InvoiceMetadata` instances.

Based on the related code snippet provided, we can infer some additional information about the `InvoiceMetadata` model:

1. It belongs to an `invoice`.
2. It has validations for `key` and `value`:
   - `key` must be present, unique within the scope of an invoice, and have a maximum length of 20 characters.
   - `value` must be present.
3. There's a constant `COUNT_PER_INVOICE` set to 5, which might indicate a limit on the number of metadata entries per invoice.

This factory provides a convenient way to create test data for `InvoiceMetadata` objects, which can be useful in various testing scenarios, such as unit tests, integration tests, or when setting up test environments.
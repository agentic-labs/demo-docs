---
title: "terminated_service_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Webhooks::Subscriptions::TerminatedService` class. It verifies that the service correctly creates a webhook when a subscription is terminated.

## Symbols

### `RSpec.describe Webhooks::Subscriptions::TerminatedService`
#### Description
This is the main describe block for the test suite, focusing on the `Webhooks::Subscriptions::TerminatedService` class.

### `subject(:webhook_service)`
#### Description
Defines the subject of the test, which is an instance of the `Webhooks::Subscriptions::TerminatedService` class, initialized with a terminated subscription.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| object | Subscription | A terminated subscription object |

### `let(:subscription)`
#### Description
Creates a test subscription with a terminated status using FactoryBot.

### `let(:organization)`
#### Description
Retrieves the organization associated with the test subscription.

### `describe '.call'`
#### Description
Describes the test for the `call` method of the `Webhooks::Subscriptions::TerminatedService` class.

#### Internal Logic
The test uses a shared example `'creates webhook'` to verify that the service creates a webhook with the event type 'subscription.terminated' and the resource type 'subscription'.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| FactoryBot | Used for creating test objects (subscription in this case) |

## References
- The test relies on a shared example `'creates webhook'`, which is likely defined in a support file.
- FactoryBot is used to create a subscription object, implying the existence of a subscription factory.

## Notes
1. The test is focused on verifying that the `TerminatedService` correctly creates a webhook when called.
2. The use of shared examples suggests that similar webhook creation behavior is tested across multiple services.
3. The test doesn't explicitly call the service's methods, relying instead on the shared example to perform the actual test.

This test suite is part of a larger application that deals with subscriptions and uses webhooks to notify about subscription status changes, specifically when a subscription is terminated.
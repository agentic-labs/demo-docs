---
title: "created_service_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Webhooks::PaymentRequests::CreatedService` class. It verifies that the service correctly creates a webhook for a payment request creation event, including the expected payload structure.

## Symbols

### `RSpec.describe Webhooks::PaymentRequests::CreatedService`
#### Description
This is the main describe block for the test suite, focusing on the `Webhooks::PaymentRequests::CreatedService` class.

### `subject(:webhook_service)`
#### Description
Defines the subject of the test, which is an instance of the `Webhooks::PaymentRequests::CreatedService` class, initialized with a payment request object.

### `let(:organization)`
#### Description
Creates a test organization using FactoryBot.

### `let(:customer)`
#### Description
Creates a test customer associated with the organization using FactoryBot.

### `let(:payment_request)`
#### Description
Creates a test payment request associated with the customer and organization using FactoryBot.

### `describe ".call"`
#### Description
Describes the test for the `.call` method of the `Webhooks::PaymentRequests::CreatedService` class.

### `it_behaves_like "creates webhook"`
#### Description
Uses a shared example to test that the service creates a webhook with the specified parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| "payment_request.created" | String | The event name for the webhook |
| "payment_request" | String | The type of object associated with the webhook |
| {"customer" =&gt; Hash, "invoices" =&gt; Array} | Hash | The expected structure of the webhook payload |

#### Internal Logic
This shared example likely verifies that:
1. A webhook is created with the correct event name ("payment_request.created").
2. The webhook is associated with a payment request object.
3. The webhook payload includes a customer hash and an invoices array.

## Dependencies
The test file depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| FactoryBot | Used for creating test data (organization, customer, payment_request) |

## References
The test file references:
- `Webhooks::PaymentRequests::CreatedService`: The class being tested
- FactoryBot factories for :organization, :customer, and :payment_request
- A shared example for "creates webhook"

Note: The actual implementation of the `CreatedService` class and the shared example are not provided in the given code snippets, so their details are not included in this documentation.
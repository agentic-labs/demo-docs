---
title: "one_off_created_service_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Webhooks::Invoices::OneOffCreatedService` class. It verifies that the service correctly creates a webhook for a one-off invoice creation event.

## Symbols

### `RSpec.describe Webhooks::Invoices::OneOffCreatedService`
#### Description
This is the main describe block that groups all tests related to the `Webhooks::Invoices::OneOffCreatedService` class.

### `subject(:webhook_service)`
#### Description
Defines the subject of the test, which is an instance of `Webhooks::Invoices::OneOffCreatedService` initialized with an invoice object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| object | Invoice | An invoice instance to be used in the webhook service |

### `let(:organization)`
#### Description
Creates a factory-generated organization for use in the tests.

### `let(:customer)`
#### Description
Creates a factory-generated customer associated with the organization.

### `let(:invoice)`
#### Description
Creates a factory-generated invoice associated with the customer and organization.

### `describe '.call'`
#### Description
Describes the test for the `call` method of the `Webhooks::Invoices::OneOffCreatedService` class.

### `it_behaves_like 'creates webhook'`
#### Description
Uses a shared example to test if the service creates a webhook with the correct event type and resource.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| event_type | String | The expected event type for the webhook ('invoice.one_off_created') |
| resource_type | String | The expected resource type for the webhook ('invoice') |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| FactoryBot | Used for creating test data (organization, customer, invoice) |

## Notes
1. The test uses FactoryBot to create test data, which allows for easy setup of complex object relationships.
2. The `it_behaves_like` method suggests that there's a shared example defined elsewhere in the test suite, which is reused here to test webhook creation.
3. The test focuses on verifying that the service creates a webhook with the correct event type ('invoice.one_off_created') and resource type ('invoice') when called.
4. The actual implementation of the `Webhooks::Invoices::OneOffCreatedService` is not shown in this file, as this is purely a test specification.

This test ensures that when a one-off invoice is created, the appropriate webhook is triggered with the correct parameters, which is crucial for maintaining the integrity of the webhook system in the application.
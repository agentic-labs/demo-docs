---
title: "error_service_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Webhooks::Events::ErrorService` class. It tests the behavior of the service when handling error events in a webhook context, specifically for the 'event.error' scenario.

## Symbols

### `RSpec.describe Webhooks::Events::ErrorService`
#### Description
This is the main describe block for the test suite, focusing on the `Webhooks::Events::ErrorService` class.

### `subject(:webhook_service)`
#### Description
Defines the subject of the test, which is an instance of `Webhooks::Events::ErrorService` initialized with an event object and options.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| object | ReceivedEvent | The event being processed |
| options | Hash | Contains error information |

### `let(:organization)`
#### Description
Creates a test organization using FactoryBot.

### `let(:event)`
#### Description
Creates a test received event associated with the organization.

### `let(:options)`
#### Description
Defines the options hash with error information to be passed to the service.

### `describe '.call'`
#### Description
Describes the test for the `call` method of the `Webhooks::Events::ErrorService`.

#### Internal Logic
This test uses a shared example 'creates webhook' to verify that the service creates a webhook with the following parameters:
- Event name: 'event.error'
- Webhook type: 'event_error'
- Expected payload structure: {'error' =&gt; String, 'event' =&gt; Hash}

## References
- The test relies on the `rails_helper`, which sets up the testing environment.
- It uses FactoryBot to create test objects (`:organization` and `:received_event`).
- It uses a shared example `'creates webhook'`, which is likely defined in a support file.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Sets up the Rails testing environment |
| FactoryBot | Creates test objects |
| RSpec | Testing framework |

## Notes
- The test is focused on verifying that the `ErrorService` correctly creates a webhook with the appropriate event name, type, and payload structure when handling an error event.
- The actual implementation of the `Webhooks::Events::ErrorService` is not provided in this file, as this is a test specification.
- The test uses shared examples, which suggests that similar webhook creation behavior is tested across multiple services.
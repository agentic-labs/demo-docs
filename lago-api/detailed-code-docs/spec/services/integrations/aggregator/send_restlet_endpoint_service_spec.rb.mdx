---
title: "send_restlet_endpoint_service_spec.rb"
---

## High-level description
This RSpec test file describes the behavior of the `Integrations::Aggregator::SendRestletEndpointService` class. It verifies that the service correctly sends a restlet endpoint URL to a specified API endpoint using the LagoHttpClient.

## Symbols

### `RSpec.describe Integrations::Aggregator::SendRestletEndpointService`
#### Description
This is the main describe block for the `SendRestletEndpointService` class, which sets up the context for all the tests within it.

### `subject(:send_restlet_endpoint_service)`
#### Description
Defines the subject of the test, which is an instance of the `SendRestletEndpointService` class, initialized with an integration object.

### `let(:integration)`
#### Description
Creates a test double for a NetSuite integration using FactoryBot.

### `describe '.call'`
#### Description
This describe block focuses on testing the `call` method of the `SendRestletEndpointService` class.

#### Internal Logic
1. Sets up a mock LagoHttpClient.
2. Defines the expected API endpoint URL.
3. Configures the integration with a script endpoint URL.
4. Calls the service and verifies that the correct HTTP client is created and the correct payload is sent.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| LagoHttpClient::Client | HTTP client used to make API requests |

## References
- `LagoHttpClient::Client`: Used to send HTTP requests to the API endpoint.
- `FactoryBot`: Used to create test data (NetSuite integration).

## Error Handling
This test file doesn't explicitly test error handling scenarios. It focuses on the happy path where the service successfully sends the restlet endpoint.

## Performance Considerations
The test uses doubles and stubs to avoid making actual HTTP requests, which helps keep the test suite fast and isolated.
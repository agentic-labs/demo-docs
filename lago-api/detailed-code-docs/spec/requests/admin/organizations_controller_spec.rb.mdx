---
title: "organizations_controller_spec.rb"
---

## High-level description
This code is an RSpec test suite for the `Admin::OrganizationsController`, specifically testing the update functionality for organizations. It verifies that an admin can successfully update an organization's name through a PUT request.

## Symbols

### `RSpec.describe Admin::OrganizationsController, type: [:request, :admin]`
#### Description
This is the main describe block for the test suite, focusing on the `Admin::OrganizationsController`. It sets the type of the test to `:request` and `:admin`, indicating that these are request specs for admin functionality.

### `let(:organization)`
#### Description
This is a let block that creates a factory-generated organization for use in the tests.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| organization | Organization | A factory-created organization instance |

### `describe 'PUT /admin/organizations/:id'`
#### Description
This describe block focuses on testing the PUT request to update an organization.

### `let(:update_params)`
#### Description
This let block defines the parameters to be used for updating the organization.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| update_params | Hash | A hash containing the new name for the organization |

### `it 'updates an organization'`
#### Description
This is the actual test case that verifies the organization update functionality.

#### Internal Logic
1. Sends a PUT request to update the organization using `admin_put` helper method.
2. Checks if the response has a success status.
3. Verifies that the returned JSON contains the updated organization name.
4. Confirms that the organization in the database has been updated with the new name.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| FactoryBot | Used for creating test data (organization) |

## References
- The test relies on the `admin_put` helper method, which is likely defined in a support file (possibly in `spec/support/admin_helper.rb`).
- The test uses the `json` method to parse the response body, which is likely defined in a support file as well.

## Notes
1. The test uses `aggregate_failures` to group multiple expectations together, allowing all expectations to be evaluated even if one fails.
2. The test assumes the existence of an `Organization` model and a corresponding factory.
3. The `admin_put` helper method is used instead of the standard RSpec `put` method, suggesting some custom authentication or setup for admin requests.

This test ensures that the admin functionality for updating organizations works correctly, verifying both the API response and the actual database update.
---
title: "webhook_endpoints_controller_spec.rb"
---

## High-level description
This file contains RSpec tests for the Api::V1::WebhookEndpointsController, focusing on CRUD operations for webhook endpoints. It tests the creation, retrieval, updating, and deletion of webhook endpoints through API requests.

## Code Structure
The test suite is organized into describe blocks for each API endpoint, with context blocks for different scenarios. Each test uses factory-generated data and makes HTTP requests to the API endpoints, asserting the expected responses.

## Symbols

### RSpec.describe Api::V1::WebhookEndpointsController
#### Description
This is the main describe block for the WebhookEndpointsController tests. It groups all the tests related to this controller.

### describe 'create'
#### Description
Tests the creation of a new webhook endpoint.

#### Internal Logic
1. Creates a test organization
2. Defines create parameters
3. Sends a POST request to create a webhook endpoint
4. Asserts the response status and the created webhook endpoint's attributes

### describe 'GET /webhook_endpoints'
#### Description
Tests the retrieval of all webhook endpoints for an organization.

#### Internal Logic
1. Creates a test organization
2. Creates two webhook endpoints for the organization
3. Sends a GET request to retrieve all webhook endpoints
4. Asserts the response status and the total count of webhook endpoints

### describe 'GET /webhook_endpoints/:id'
#### Description
Tests the retrieval of a specific webhook endpoint.

#### Internal Logic
1. Creates a test webhook endpoint and organization
2. Tests two contexts: existing ID and non-existing ID
3. Sends GET requests to retrieve the webhook endpoint
4. Asserts the response status and webhook endpoint details for existing ID
5. Asserts not found status for non-existing ID

### describe 'DELETE /webhook_endpoints/:id'
#### Description
Tests the deletion of a webhook endpoint.

#### Internal Logic
1. Creates a test webhook endpoint and organization
2. Tests two contexts: existing webhook endpoint and non-existing webhook endpoint
3. Sends DELETE requests to remove the webhook endpoint
4. Asserts the change in WebhookEndpoint count and response details for existing endpoint
5. Asserts not found status for non-existing endpoint

### describe 'PUT /webhook_endpoints/:id'
#### Description
Tests the updating of a webhook endpoint.

#### Internal Logic
1. Creates a test webhook endpoint and organization
2. Defines update parameters
3. Tests two contexts: existing webhook endpoint and non-existing webhook endpoint
4. Sends PUT requests to update the webhook endpoint
5. Asserts the response status and updated webhook endpoint details for existing endpoint
6. Asserts not found status for non-existing endpoint

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads Rails testing environment and configuration |
| FactoryBot | Used for creating test data |
| Faker | Generates fake data for testing |

## Error Handling
The tests check for appropriate error responses, such as 404 Not Found for non-existing resources.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /api/v1/webhook_endpoints | POST | webhook_endpoint params | Created webhook_endpoint | Create a new webhook endpoint |
| /api/v1/webhook_endpoints | GET | None | List of webhook_endpoints | Retrieve all webhook endpoints |
| /api/v1/webhook_endpoints/:id | GET | None | webhook_endpoint details | Retrieve a specific webhook endpoint |
| /api/v1/webhook_endpoints/:id | DELETE | None | Deleted webhook_endpoint | Delete a webhook endpoint |
| /api/v1/webhook_endpoints/:id | PUT | webhook_endpoint params | Updated webhook_endpoint | Update a webhook endpoint |

Note: The tests use custom helper methods like `post_with_token`, `get_with_token`, `delete_with_token`, and `put_with_token`, which are likely defined in a support file to handle authentication and make API requests.
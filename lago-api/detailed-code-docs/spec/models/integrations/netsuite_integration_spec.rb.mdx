---
title: "netsuite_integration_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Integrations::NetsuiteIntegration` model. It tests various validations, attribute assignments, and retrievals for the NetSuite integration in a Rails application.

## Symbols

### `RSpec.describe Integrations::NetsuiteIntegration, type: :model`
#### Description
This is the main describe block for the NetSuite integration model tests.

#### Internal Logic
The tests are organized into several describe and context blocks, each focusing on different aspects of the model.

### `subject(:netsuite_integration)`
#### Description
Defines the subject of the tests as a new instance of the NetSuite integration model.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| None | N/A | Uses FactoryBot to build a new instance |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| netsuite_integration | Integrations::NetsuiteIntegration | An instance of the NetSuite integration model |

### Validation Tests
#### Description
Tests for presence and uniqueness validations on the model.

#### Internal Logic
- Checks for the presence of the `name` attribute
- Validates the uniqueness of the `code` attribute scoped to `organization_id`

### Attribute Tests
#### Description
Tests for various attribute assignments and retrievals.

#### Internal Logic
For each attribute (`connection_id`, `client_secret`, `account_id`, `client_id`, `script_endpoint_url`, `sync_credit_notes`, `sync_invoices`, `sync_payments`, `sync_sales_orders`, `legacy_script`):
- Assigns a value to the attribute
- Verifies that the assigned value can be retrieved correctly

#### Special Cases
- For `account_id`, there's an additional test to check if the value is formatted correctly (converted to lowercase and spaces replaced with hyphens)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| FactoryBot | Used for creating test instances of the model |

## Error Handling
The tests implicitly handle errors by expecting certain behaviors. If any expectation fails, the test will fail, indicating an error in the implementation.

## TODOs
There are no explicit TODOs in the code.

This test suite provides comprehensive coverage for the `Integrations::NetsuiteIntegration` model, ensuring that all its attributes and validations work as expected. It's particularly useful for maintaining the integrity of the NetSuite integration functionality in the application.
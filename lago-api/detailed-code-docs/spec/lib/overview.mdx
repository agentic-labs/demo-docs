---
title: "Overview"
---

## High-level description
This directory contains RSpec test files for various utility modules and classes used in the Lago application. The tests cover functionality related to Adyen integration parameters, EU VAT rate handling, HTTP client operations, license verification, and a Ruby code sandbox.

## What does it do?
The test suite in this directory verifies several key functionalities:

1. Adyen Integration: It tests the generation of parameter hashes for Adyen integration, ensuring correct default values and parameter merging.

2. EU VAT Rates: It verifies the retrieval of EU country codes and specific country VAT rates, which is crucial for accurate tax calculations in a European context.

3. HTTP Client: It tests a custom HTTP client, focusing on POST requests, response handling, and error management.

4. License Verification: It checks the application's ability to handle different license scenarios, including valid licenses, invalid licenses, and cases where no license is present.

5. Ruby Code Sandbox: It tests a utility that allows safe execution of Ruby code in a controlled environment, preventing potentially dangerous operations while allowing basic code execution.

These tests ensure that various utility functions and integrations in the Lago application work correctly, securely, and reliably.

## Key Files

1. `lago/adyen_params_spec.rb`:
   Tests the `Lago::Adyen::Params` class, verifying the correct generation of parameter hashes for Adyen integration.

2. `lago_eu_vat/rate_spec.rb`:
   Tests the `LagoEuVat::Rate` class, checking the retrieval of EU country codes and specific country VAT rates.

3. `lago_http_client/client_spec.rb`:
   Tests the `LagoHttpClient::Client` class, focusing on the `post` method and its handling of various response scenarios.

4. `lago_utils/license_spec.rb`:
   Tests the `LagoUtils::License` class, verifying license verification functionality under different scenarios.

5. `lago_utils/ruby_sandbox_spec.rb`:
   Tests the `LagoUtils::RubySandbox` class, ensuring safe execution of Ruby code in a controlled environment.

## Dependencies
The test files rely on the following main dependencies:

1. RSpec: The testing framework used for writing and running the tests.
2. Rails: The test files are part of a Rails application, as evidenced by the inclusion of `rails_helper`.
3. WebMock: Used in some tests for stubbing HTTP requests.

## Configuration
The test suite uses various configurations, including:

1. Environment variables: Such as `LAGO_LICENSE` for license testing.
2. Stubbed HTTP responses: Used in HTTP client and license verification tests.
3. Predefined test data: Such as VAT rates and country codes for EU VAT tests.

All test files make use of the `rails_helper`, which likely includes additional configuration for the Rails testing environment, RSpec, and other testing tools.

These tests play a crucial role in ensuring the reliability, security, and accuracy of various utility functions and integrations in the Lago application, covering areas from payment processing to tax calculation and custom code execution.
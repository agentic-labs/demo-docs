---
title: "taxes_query_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `TaxesQuery` class. It tests various scenarios of querying taxes, including pagination, searching, filtering, and ordering. The tests ensure that the `TaxesQuery` class correctly handles different input parameters and returns the expected results.

## Code Structure
The test suite is organized around a single `describe` block for the `TaxesQuery` class. Within this block, there are multiple contexts and examples testing different aspects of the query functionality.

## Symbols

### `RSpec.describe TaxesQuery`
#### Description
This is the main describe block for the `TaxesQuery` class tests. It sets up the test environment and defines various test cases.

#### Internal Logic
1. Sets up test data using FactoryBot to create taxes with different attributes.
2. Defines a subject `result` that calls the `TaxesQuery.call` method with various parameters.
3. Tests different scenarios by manipulating the input parameters and checking the output.

### `subject(:result)`
#### Description
Defines the subject of the test, which is the result of calling `TaxesQuery.call` with specified parameters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| organization | Organization | The organization associated with the taxes |
| pagination | Hash | Pagination parameters (optional) |
| search_term | String | Search term for filtering taxes (optional) |
| filters | Hash | Filters for querying taxes (optional) |
| order | String | Ordering parameter for the query result (optional) |

### Test Cases
#### Default Behavior
Tests that all taxes are returned ordered by name in ascending order.

#### Pagination
Tests the pagination functionality by setting `pagination` parameter and checking the result properties.

#### Search Functionality
Tests the search functionality by setting a `search_term` and verifying the returned taxes.

#### Filtering
Tests filtering functionality for `applied_to_organization` and `auto_generated` attributes.

#### Ordering
Tests the ordering functionality by setting the `order` parameter to 'rate'.

## Dependencies
The test file depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment |
| FactoryBot | Used for creating test data |

## Configuration
The test suite uses RSpec's `let` statements to define test data and parameters:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| pagination | Hash | nil | Pagination parameters |
| search_term | String | nil | Search term for filtering |
| filters | Hash | nil | Filters for querying |
| order | String | nil | Ordering parameter |

## Error Handling
The test suite doesn't explicitly test error handling. It focuses on testing the successful execution of the `TaxesQuery` under various conditions.

## TODOs
There are no explicit TODOs in the code.
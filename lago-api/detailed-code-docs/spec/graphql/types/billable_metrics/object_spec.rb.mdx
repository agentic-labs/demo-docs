---
title: "object_spec.rb"
---

## High-level description
This code defines a set of RSpec tests for the `Types::BillableMetrics::Object` GraphQL type. It verifies that the type has the expected fields with their corresponding types, ensuring that the GraphQL schema for billable metrics is correctly defined.

## Symbols

### `RSpec.describe Types::BillableMetrics::Object`
#### Description
This is the main RSpec test suite for the `Types::BillableMetrics::Object` GraphQL type. It uses the `have_field` matcher to check if each expected field is present in the type definition with the correct type.

#### Internal Logic
The test suite uses a series of expectations to verify the presence and type of each field in the `Types::BillableMetrics::Object` GraphQL type. Each expectation follows the pattern:

```ruby
it { is_expected.to have_field(:field_name).of_type('FieldType') }
```

This checks that the described class (Types::BillableMetrics::Object) has a field with the given name and type.

## Fields Tested
The test suite verifies the following fields:

1. `id`: ID! (non-nullable ID)
2. `organization`: Organization
3. `code`: String! (non-nullable String)
4. `name`: String! (non-nullable String)
5. `description`: String
6. `aggregation_type`: AggregationTypeEnum! (non-nullable enum)
7. `field_name`: String
8. `weighted_interval`: WeightedIntervalEnum
9. `filters`: [BillableMetricFilter!] (array of non-nullable BillableMetricFilter)
10. `active_subscriptions_count`: Int! (non-nullable Integer)
11. `draft_invoices_count`: Int! (non-nullable Integer)
12. `plans_count`: Int! (non-nullable Integer)
13. `recurring`: Boolean! (non-nullable Boolean)
14. `subscriptions_count`: Int! (non-nullable Integer)
15. `created_at`: ISO8601DateTime! (non-nullable ISO8601 formatted date-time)
16. `deleted_at`: ISO8601DateTime
17. `updated_at`: ISO8601DateTime! (non-nullable ISO8601 formatted date-time)
18. `integration_mappings`: [Mapping!] (array of non-nullable Mapping)

## Dependencies
The test file depends on the following:

1. `rails_helper`: This is a common RSpec configuration file for Rails projects, which sets up the testing environment.
2. RSpec: The testing framework used to write and run the tests.
3. GraphQL-related testing utilities: The `have_field` matcher is likely provided by a GraphQL testing library, possibly `graphql-ruby`.

## Notes
1. The use of `frozen_string_literal: true` at the beginning of the file indicates that string literals in this file are frozen, which can provide performance benefits and prevent unintended string mutations.
2. The tests are written using RSpec's one-liner syntax, which is concise and readable for simple expectations.
3. The test file doesn't include any setup or complex test scenarios, focusing solely on the structure of the GraphQL type.
4. Some fields are marked as non-nullable (with `!`), indicating that they must always have a value in the GraphQL schema.
5. Custom enum types are used for `aggregation_type` and `weighted_interval`, suggesting that these fields have a predefined set of possible values.
6. The presence of `deleted_at` suggests that soft deletion might be implemented for billable metrics.
7. The `integration_mappings` field suggests that billable metrics can be mapped to external integrations.

This test file ensures that the `Types::BillableMetrics::Object` GraphQL type is correctly defined with all the necessary fields and types, providing a solid foundation for the billable metrics feature in the application's GraphQL API.
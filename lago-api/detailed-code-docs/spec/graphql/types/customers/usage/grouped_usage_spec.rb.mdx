---
title: "grouped_usage_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Types::Customers::Usage::GroupedUsage` GraphQL type. It verifies that the type has specific fields with the correct data types, ensuring the GraphQL schema is correctly defined for grouped usage data.

## Symbols

### `RSpec.describe Types::Customers::Usage::GroupedUsage`
#### Description
This is the main RSpec test suite for the `Types::Customers::Usage::GroupedUsage` GraphQL type. It uses the `subject` method to set the described class as the subject of the tests.

#### Internal Logic
The test suite uses RSpec's `have_field` matcher to verify the presence and type of specific fields in the GraphQL type. Each test checks a different field:

1. `amount_cents`: Ensures it's of type `'BigInt!'` (non-nullable big integer)
2. `events_count`: Ensures it's of type `'Int!'` (non-nullable integer)
3. `units`: Ensures it's of type `'Float!'` (non-nullable float)
4. `filters`: Ensures it's of type `'[ChargeFilterUsage!]'` (non-nullable array of `ChargeFilterUsage` objects)
5. `grouped_by`: Ensures it's of type `'JSON'` (JSON object)

Each test uses the `is_expected.to` syntax, which is equivalent to `expect(subject).to`, making the tests more readable.

## Dependencies
The test file depends on the following:

| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |
| RSpec | Testing framework used for writing and running the tests |
| GraphQL | The GraphQL implementation for Ruby, which defines the types being tested |

## References
The code references the following external symbols:

1. `Types::Customers::Usage::GroupedUsage`: The GraphQL type being tested
2. `ChargeFilterUsage`: Another GraphQL type referenced in the `filters` field

## Notes
1. The use of `frozen_string_literal: true` at the beginning of the file indicates that string literals in this file are frozen, which can improve performance and memory usage.
2. The tests are focused on the structure of the GraphQL type and do not test any behavior or data manipulation.
3. The `BigInt!` type for `amount_cents` suggests that this field is used for storing large integer values, likely representing monetary amounts in cents.
4. The presence of a `JSON` type for the `grouped_by` field indicates that this type can handle flexible, nested data structures for grouping usage data.

This test suite ensures that the `GroupedUsage` GraphQL type maintains its expected structure, which is crucial for maintaining a consistent API for clients consuming this data.
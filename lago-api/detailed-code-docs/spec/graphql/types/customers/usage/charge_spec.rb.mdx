---
title: "charge_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Types::Customers::Usage::Charge` GraphQL type. It verifies that the type has specific fields with the correct types, ensuring the GraphQL schema is correctly defined for customer usage charges.

## Symbols

### `RSpec.describe Types::Customers::Usage::Charge`
#### Description
This is the main RSpec test suite for the `Types::Customers::Usage::Charge` GraphQL type. It uses the `subject` method to set the described class as the subject of the tests.

#### Internal Logic
The test suite uses a series of expectations to verify the presence and types of fields in the GraphQL type. Each expectation checks for a specific field and its corresponding GraphQL type.

### Field Expectations
#### Description
Each line starting with `it { is_expected.to have_field(...) }` is an individual test case checking for the presence and type of a specific field in the GraphQL type.

#### Internal Logic
- `have_field(:field_name)`: Checks if the field exists in the GraphQL type
- `.of_type('Type!')`: Specifies the expected GraphQL type for the field

Here's a breakdown of the fields being tested:

1. `amount_cents`: Expected to be of type `BigInt!`
2. `events_count`: Expected to be of type `Int!`
3. `units`: Expected to be of type `Float!`
4. `billable_metric`: Expected to be of type `BillableMetric!`
5. `charge`: Expected to be of type `Charge!`
6. `grouped_usage`: Expected to be of type `[GroupedChargeUsage!]!`
7. `filters`: Expected to be of type `[ChargeFilterUsage!]`

The `!` at the end of most types indicates that these fields are non-nullable in the GraphQL schema.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |

## References
This test file references the following GraphQL types:
- `Types::Customers::Usage::Charge`
- `BillableMetric`
- `Charge`
- `GroupedChargeUsage`
- `ChargeFilterUsage`

These types are likely defined in other files within the GraphQL schema of the application.

Note: The related `spec/rails_helper.rb` file provides the testing setup for the entire Rails application, including RSpec configuration, database cleaner setup, and various helper inclusions. However, it doesn't directly impact the understanding of this specific test file beyond providing the necessary testing environment.
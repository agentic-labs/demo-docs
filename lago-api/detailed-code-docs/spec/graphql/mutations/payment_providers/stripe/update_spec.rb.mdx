---
title: "update_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Mutations::PaymentProviders::Stripe::Update` GraphQL mutation. It verifies the behavior of updating a Stripe payment provider, including permission checks and handling of the `successRedirectUrl` field.

## Code Structure
The test suite is organized into several contexts and examples, testing different aspects of the mutation. It uses shared examples for common checks and defines a GraphQL mutation query for testing.

## References
- `rails_helper`: The test file requires the Rails helper, which sets up the testing environment.
- `Mutations::PaymentProviders::Stripe::Update`: The GraphQL mutation being tested.
- `FactoryBot`: Used for creating test data.

## Symbols

### RSpec.describe Mutations::PaymentProviders::Stripe::Update
#### Description
This is the main describe block for the test suite, focusing on the Stripe Update mutation.

#### Internal Logic
- Sets up necessary test data using `let` statements.
- Defines the GraphQL mutation query.
- Includes shared examples for common checks.
- Contains individual test cases for different scenarios.

### it 'updates an stripe provider'
#### Description
This test case verifies that the mutation successfully updates a Stripe provider's `successRedirectUrl`.

#### Internal Logic
1. Executes the GraphQL mutation with necessary permissions and input data.
2. Verifies that the returned `successRedirectUrl` matches the provided value.

### context 'when success redirect url is nil'
#### Description
This context tests the behavior when the `successRedirectUrl` is set to nil.

#### Internal Logic
1. Executes the GraphQL mutation with a nil `successRedirectUrl`.
2. Verifies that the returned `successRedirectUrl` is nil, indicating it was removed from the provider.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Sets up the Rails testing environment |
| FactoryBot | Creates test data |
| Faker | Generates fake data for testing |

## Error Handling
The test suite implicitly checks for error handling by expecting successful responses. Any unexpected errors would cause the tests to fail.

## API/Interface Reference
| Mutation | Input | Output | Description |
|:---------|:------|:-------|:------------|
| updateStripePaymentProvider | UpdateStripePaymentProviderInput | id, successRedirectUrl | Updates a Stripe payment provider |

Note: The actual API is defined elsewhere; this test suite verifies its behavior.
---
title: "Overview"
---

## High-level description
This directory contains RSpec test files for GraphQL mutations related to Adyen payment providers. The tests focus on the creation and update operations for Adyen providers within the application's GraphQL API.

## What does it do?
These tests ensure that the GraphQL mutations for Adyen payment providers function correctly. They verify that:

1. Creating an Adyen provider works as expected, including proper handling of sensitive data like API keys and HMAC keys.
2. Updating an Adyen provider, particularly its success redirect URL, functions correctly.
3. The system properly enforces permissions for these operations.
4. The mutations handle various scenarios, such as setting the success redirect URL to nil.

The tests simulate real-world usage of the GraphQL API for managing Adyen payment providers, ensuring that the system behaves correctly and securely when integrating with this payment service.

## Key Files

1. `create_spec.rb`:
   - Tests the `Mutations::PaymentProviders::Adyen::Create` mutation.
   - Verifies the creation of Adyen providers with correct data handling and permission checks.
   - Ensures sensitive data (API key, HMAC key) is properly masked in responses.

2. `update_spec.rb`:
   - Tests the `Mutations::PaymentProviders::Adyen::Update` mutation.
   - Focuses on updating the success redirect URL of existing Adyen providers.
   - Verifies the mutation's behavior when setting the URL to a new value or removing it (setting to nil).

Both files use shared examples for common checks like user authentication, organization context, and permission requirements.

## Dependencies
The test files rely on the following key dependencies:

1. RSpec (version not specified): The primary testing framework used for writing and organizing the tests.
2. FactoryBot (version not specified): Used for creating test data, such as memberships and Adyen providers.
3. Faker (version not specified): Employed for generating random data, particularly URLs for testing.
4. Rails (version not specified): The underlying framework, with `rails_helper` being required in both spec files.

These dependencies were likely chosen for their widespread use in the Ruby on Rails ecosystem and their ability to simplify test data creation and management.

## Configuration
While there's no explicit configuration file mentioned, the tests use several important configurations:

1. RSpec configuration:
   - The tests are marked as `:graphql` type, indicating they are specific to GraphQL functionality.

2. Test data configuration:
   - Both spec files use `let` statements to set up test data, including:
     - `required_permission`: The permission needed to perform the mutation.
     - `membership`: A factory-created membership object.
     - Various Adyen-specific fields like `api_key`, `hmac_key`, `code`, `name`, etc.

3. GraphQL mutation configuration:
   - Each spec file defines a `mutation` variable containing the GraphQL query string for the respective operation (create or update).

These configurations ensure that the tests have the necessary data and context to properly evaluate the behavior of the Adyen-related GraphQL mutations.
---
title: "update_spec.rb"
---

## High-level description
This RSpec test file describes the behavior of the `Mutations::PaymentProviders::Adyen::Update` GraphQL mutation. It verifies that the mutation correctly updates an Adyen payment provider's success redirect URL, handles permissions correctly, and manages cases where the success redirect URL is set to nil.

## Code Structure
The test file defines a set of RSpec examples that test various aspects of the `updateAdyenPaymentProvider` mutation. It uses shared examples for common behaviors and defines specific tests for updating the success redirect URL.

## Symbols

### RSpec.describe Mutations::PaymentProviders::Adyen::Update
#### Description
This is the main describe block for the test suite, focusing on the Update mutation for Adyen payment providers.

#### Internal Logic
The test suite sets up necessary test data, defines the GraphQL mutation, and includes shared examples for common behaviors. It then tests specific scenarios for updating the Adyen provider.

### let blocks
#### Description
These blocks define variables used throughout the test suite, such as `required_permission`, `membership`, `adyen_provider`, and `success_redirect_url`.

### mutation
#### Description
This block defines the GraphQL mutation used in the tests, which updates an Adyen payment provider.

### Shared examples
#### Description
The test suite includes shared examples for common behaviors:
- `requires current user`
- `requires current organization`
- `requires permission`

These shared examples likely test that the mutation behaves correctly when these requirements are not met.

### "updates an adyen provider" example
#### Description
This test verifies that the mutation successfully updates the success redirect URL of an Adyen provider.

#### Internal Logic
1. Executes the GraphQL mutation with necessary permissions and input data.
2. Checks if the returned data contains the updated success redirect URL.

### "removes success redirect url from the provider" example
#### Description
This test verifies that the mutation correctly handles setting the success redirect URL to nil, effectively removing it from the provider.

#### Internal Logic
1. Executes the GraphQL mutation with the success redirect URL set to nil.
2. Checks if the returned data shows the success redirect URL as nil.

## Dependencies
The test file depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads Rails testing environment and configurations |
| RSpec | Testing framework |
| FactoryBot | Used for creating test data (implied by the use of `create` method) |
| Faker | Generates fake data for testing (used for `success_redirect_url`) |

## Configuration
The test uses the following configuration:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| type: :graphql | Symbol | N/A | Specifies that this is a GraphQL-related test |

## Error Handling
The test implicitly checks for error handling through the shared examples, which likely verify that the mutation responds correctly to missing permissions or invalid inputs.
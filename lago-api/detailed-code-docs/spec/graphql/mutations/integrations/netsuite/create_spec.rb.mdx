---
title: "create_spec.rb"
---

## High-level description
This code defines a RSpec test suite for the `Mutations::Integrations::Netsuite::Create` GraphQL mutation. It verifies the functionality of creating a Netsuite integration within the context of a premium organization.

## Code Structure
The test suite is organized as a single RSpec describe block, containing several test cases and shared examples. It sets up the necessary context, defines the GraphQL mutation, and tests the creation of a Netsuite integration.

## Symbols

### `RSpec.describe Mutations::Integrations::Netsuite::Create, type: :graphql`
#### Description
This is the main describe block for the test suite, focusing on the Netsuite integration creation mutation.

#### Internal Logic
1. Sets up test data and variables
2. Defines the GraphQL mutation
3. Configures the test environment
4. Includes shared examples for common checks
5. Tests the creation of a Netsuite integration

### `let` blocks
#### Description
These blocks define variables and test data used throughout the test suite.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| required_permission | String | The permission required to create an integration |
| membership | Membership | A factory-created membership object |
| code | String | The code for the Netsuite integration |
| name | String | The name of the Netsuite integration |
| script_endpoint_url | String | A randomly generated URL for the script endpoint |

### `mutation` block
#### Description
Defines the GraphQL mutation for creating a Netsuite integration.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | String | The GraphQL mutation query |

### `around` block
#### Description
Sets up the premium feature flag for the duration of the test.

### `before` block
#### Description
Updates the organization to include Netsuite in its premium integrations.

### Shared examples
#### Description
Includes shared examples for common checks:
- `requires current user`
- `requires current organization`
- `requires permission`

### Main test case
#### Description
Tests the creation of a Netsuite integration using the defined GraphQL mutation.

#### Internal Logic
1. Executes the GraphQL mutation with test data
2. Verifies the response data
3. Checks various attributes of the created integration

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads Rails testing environment and configurations |
| RSpec | Testing framework |
| FactoryBot | Used for creating test data |
| Faker | Generates random data for testing |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| type | Symbol | :graphql | Specifies the type of test (GraphQL) |

## Error Handling
The test case implicitly checks for successful execution of the mutation. Any errors would cause the test to fail.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| createNetsuiteIntegration | Mutation | CreateNetsuiteIntegrationInput | Netsuite Integration attributes | Creates a new Netsuite integration |

This test suite ensures that the Netsuite integration creation mutation works correctly, verifying the required permissions, input handling, and output format of the GraphQL API.
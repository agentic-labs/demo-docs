---
title: "update_spec.rb"
---

## High-level description
This file contains RSpec tests for the `Mutations::Integrations::Xero::Update` GraphQL mutation. It verifies the behavior of updating a Xero integration, including permission checks and the correct updating of integration attributes.

## Code Structure
The test suite is organized as an RSpec describe block for the `Mutations::Integrations::Xero::Update` mutation. It includes several let statements for setting up test data, a GraphQL mutation string, and test cases to verify the mutation's behavior.

## Symbols

### RSpec.describe Mutations::Integrations::Xero::Update
#### Description
This is the main describe block that groups all the tests for the Xero integration update mutation.

### let statements
#### Description
These statements set up the test data and variables used across the test cases.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| required_permission | String | The permission required to update integrations |
| integration | XeroIntegration | A factory-created Xero integration instance |
| organization | Organization | The organization associated with the membership |
| membership | Membership | A factory-created membership instance |
| code | String | The new code for the Xero integration |
| name | String | The new name for the Xero integration |

### mutation
#### Description
This is a GraphQL mutation string that defines the structure of the updateXeroIntegration mutation.

### around block
#### Description
This block wraps the tests in a lago_premium! context, likely enabling premium features for the duration of the tests.

### before block
#### Description
This block sets up the test environment by creating an integration and updating the organization's premium integrations.

### it_behaves_like shared examples
#### Description
These shared examples verify common behaviors such as requiring a current user, current organization, and specific permissions.

### 'updates a xero integration' test
#### Description
This test case verifies that the mutation correctly updates a Xero integration with new name and code values.

#### Internal Logic
1. Executes the GraphQL mutation with the necessary inputs and context.
2. Retrieves the result data from the mutation response.
3. Uses RSpec's aggregate_failures to group multiple expectations.
4. Checks if the returned name and code match the input values.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment |
| RSpec | Testing framework used for writing and running the tests |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| type: :graphql | Symbol | N/A | Specifies that this is a GraphQL-related test |

Note: This test file relies on several custom helpers and shared examples that are not directly visible in the provided code, such as `execute_graphql`, `lago_premium!`, and the shared examples for permission checks.
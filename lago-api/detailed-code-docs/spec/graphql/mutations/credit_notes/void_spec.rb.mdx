---
title: "void_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Mutations::CreditNotes::Void` GraphQL mutation. It verifies the functionality of voiding a credit note, including permission checks and error handling for non-existent credit notes.

## Code Structure
The test suite defines a set of let variables to set up the test environment, a GraphQL mutation query, and several test cases to verify the behavior of the mutation.

## Symbols

### RSpec.describe Mutations::CreditNotes::Void
#### Description
This is the main describe block for the test suite, focusing on the `Mutations::CreditNotes::Void` GraphQL mutation.

### let variables
#### Description
These variables set up the test environment by creating necessary objects such as membership, organization, customer, invoice, and credit note.

### mutation
#### Description
This variable contains the GraphQL mutation query string for voiding a credit note.

### it_behaves_like 'requires current user'
#### Description
This shared example ensures that the mutation requires a current user to be present.

### it_behaves_like 'requires permission', 'credit_notes:void'
#### Description
This shared example verifies that the mutation requires the 'credit_notes:void' permission.

### it 'voids the credit note'
#### Description
This test case verifies that the mutation successfully voids a credit note.

#### Internal Logic
1. Executes the GraphQL mutation with valid input.
2. Checks the result data for the correct credit note ID and credit status.

### context 'when credit note is not found'
#### Description
This context block tests the error handling when an invalid credit note ID is provided.

#### Internal Logic
1. Executes the GraphQL mutation with an invalid credit note ID.
2. Expects a "not found" error to be returned.

## Dependencies
The test suite depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Provides the necessary setup for Rails-specific testing |
| RSpec | Testing framework |
| FactoryBot | Used for creating test objects |
| GraphQL | The query language being tested |

## Error Handling
The test suite includes a specific test case for handling the scenario when a credit note is not found, expecting a "not found" error to be returned.
---
title: "create_spec.rb"
---

## High-level description
This code defines a RSpec test for the `Mutations::Taxes::Create` GraphQL mutation. It verifies that the mutation correctly creates a tax with the provided input and returns the expected tax details.

## Symbols

### `RSpec.describe Mutations::Taxes::Create, type: :graphql`
#### Description
This is the main test suite for the `Mutations::Taxes::Create` GraphQL mutation. It sets up the test environment and defines the test cases for creating a tax.

### `let(:membership)`
#### Description
Creates a test membership using FactoryBot.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| membership | Membership | A test membership object |

### `let(:input)`
#### Description
Defines the input data for creating a tax.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| input | Hash | A hash containing tax creation input data |

### `let(:mutation)`
#### Description
Defines the GraphQL mutation query string for creating a tax.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | String | GraphQL mutation query for creating a tax |

### `it 'creates a tax'`
#### Description
This test case verifies that the `createTax` mutation successfully creates a tax with the provided input.

#### Internal Logic
1. Executes the GraphQL mutation using the `execute_graphql` helper method.
2. Passes the current user, organization, query, and input variables to the mutation.
3. Asserts that the returned data matches the expected tax details.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads Rails testing environment and configuration |
| FactoryBot | Used for creating test data (membership) |
| GraphQL | The mutation being tested is a GraphQL mutation |

## References
- The test relies on the `execute_graphql` helper method, which is likely defined in a support file (possibly in `spec/support/graphql_helper.rb`).
- The test uses FactoryBot to create a test membership, indicating that there's a factory defined for the Membership model.

## Notes
- The test is tagged with `type: :graphql`, which may be used for filtering or applying specific configurations for GraphQL tests.
- The test checks for the presence of `id`, `name`, `code`, `description`, and `rate` in the mutation response, but also includes `addOnsCount`, `plansCount`, `chargesCount`, and `customersCount` in the query, which are not asserted in this test case.
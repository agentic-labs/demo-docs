---
title: "update_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Mutations::IntegrationMappings::Update` GraphQL mutation. It verifies that the mutation correctly updates an integration mapping with the provided input, including permission checks and data validation.

## Code Structure
The test suite is organized as a single RSpec describe block for the `Mutations::IntegrationMappings::Update` mutation. It includes several let statements for setting up test data and a main test case for updating an integration mapping.

## References
- `rails_helper`: This file is required at the beginning of the spec, which sets up the testing environment.
- `FactoryBot`: Used for creating test data (e.g., `create(:netsuite_mapping)`, `create(:membership)`).
- `Faker`: Used for generating random test data.

## Symbols

### RSpec.describe Mutations::IntegrationMappings::Update
#### Description
This is the main describe block for the test suite, focusing on the Update mutation for IntegrationMappings.

#### Internal Logic
1. Sets up necessary test data using `let` statements.
2. Defines the GraphQL mutation query.
3. Includes shared examples for permission and authentication checks.
4. Contains a test case for updating an integration mapping.

### let statements
#### Description
These statements set up the test data and variables used throughout the test suite.

#### Inputs
N/A (These are variable definitions)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| required_permission | String | The permission required to perform the mutation |
| integration_mapping | IntegrationMapping | The integration mapping to be updated |
| integration | Integration | The associated integration |
| mappable | AddOn | The mappable object (in this case, an AddOn) |
| organization | Organization | The organization associated with the membership |
| membership | Membership | A user's membership in the organization |
| external_account_code | String | A random barcode for testing |
| external_id | String | A random UUID for testing |
| external_name | String | A random department name for testing |

### mutation
#### Description
Defines the GraphQL mutation query used in the test.

#### Inputs
N/A

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | String | The GraphQL mutation query |

### it 'updates an integration'
#### Description
This is the main test case that verifies the functionality of the Update mutation.

#### Internal Logic
1. Arrange: Sets up the test data and mutation input.
2. Act: Executes the GraphQL mutation with the given input.
3. Assert: Verifies that the returned data matches the expected values.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Sets up the Rails testing environment |
| RSpec | Testing framework |
| FactoryBot | Creates test data |
| Faker | Generates random test data |

## Error Handling
The test case uses `aggregate_failures` to group multiple expectations together, allowing all expectations to be evaluated even if one fails.
---
title: "wallet_resolver_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Resolvers::WalletResolver` GraphQL resolver. It tests the functionality of querying a wallet, including successful retrieval, error handling for missing organization, and error handling for non-existent wallets.

## Code Structure
The test suite is organized into a main describe block for `Resolvers::WalletResolver`, with several nested contexts and examples. It uses let blocks to set up test data and shared variables.

## Symbols

### RSpec.describe Resolvers::WalletResolver
#### Description
This is the main describe block that groups all tests related to the WalletResolver.

### let(:query)
#### Description
Defines the GraphQL query used in the tests to fetch wallet data.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | String | GraphQL query for fetching wallet data |

### let(:membership), let(:organization), let(:customer), let(:wallet)
#### Description
These let blocks set up the test data required for the specs, including a membership, organization, customer, and wallet.

### it 'returns a wallet'
#### Description
Tests the successful retrieval of a wallet using the GraphQL query.

#### Internal Logic
1. Executes the GraphQL query with the necessary context and variables.
2. Verifies that the returned wallet data matches the expected values.

### context 'without current organization'
#### Description
Tests the error handling when the current organization is not provided.

#### Internal Logic
1. Executes the GraphQL query without a current organization.
2. Verifies that an error message about missing organization id is returned.

### context 'when wallet is not found'
#### Description
Tests the error handling when trying to fetch a non-existent wallet.

#### Internal Logic
1. Executes the GraphQL query with an invalid wallet ID.
2. Verifies that an error message about resource not found is returned.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads Rails testing environment and configuration |
| FactoryBot | Used for creating test data |
| GraphQLHelper | Provides helper methods for GraphQL testing |

## Error Handling
The test suite covers two main error scenarios:
1. Missing current organization
2. Non-existent wallet

Both scenarios are expected to return appropriate GraphQL errors.
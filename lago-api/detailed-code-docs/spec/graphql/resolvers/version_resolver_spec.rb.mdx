---
title: "version_resolver_spec.rb"
---

## High-level description
This code is a RSpec test file for the `Resolvers::VersionResolver` GraphQL resolver. It tests the functionality of the `currentVersion` query, which is expected to return the current version number and GitHub URL of the Lago API.

## Symbols

### `RSpec.describe Resolvers::VersionResolver, type: :graphql`
#### Description
This is the main RSpec describe block that groups the tests for the `Resolvers::VersionResolver`.

### `let(:query)`
#### Description
This is a let block that defines the GraphQL query to be tested. It requests the `currentVersion` with its `number` and `githubUrl` fields.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | String | A GraphQL query string for requesting the current version information |

### `it 'returns the currentVersion'`
#### Description
This is the main test case that verifies the behavior of the `currentVersion` query.

#### Internal Logic
1. Executes the GraphQL query using the `execute_graphql` helper method.
2. Extracts the `currentVersion` response from the result.
3. Uses `aggregate_failures` to group multiple expectations.
4. Checks if the `number` field is present in the response.
5. Verifies that the `githubUrl` field starts with the expected GitHub URL.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads the Rails testing environment and configuration |

## References
The test file references the following:
- `Resolvers::VersionResolver`: The GraphQL resolver being tested.
- `execute_graphql`: A helper method for executing GraphQL queries (likely defined in a support file).

## Notes
1. The test is using the `:graphql` type, which may have specific configurations or helpers defined in the `rails_helper.rb` file.
2. The `execute_graphql` method is not defined in this file, suggesting it's a custom helper method, possibly defined in a support file or included through the `GraphQLHelper` module.
3. The test expects the `currentVersion` to have both a `number` and a `githubUrl` field, with specific expectations for each.
4. The GitHub URL is expected to start with 'https://github.com/getlago/lago-api', indicating this is likely testing the Lago API project.

This test ensures that the `VersionResolver` correctly provides the current version information for the Lago API, including both the version number and the link to the GitHub repository.
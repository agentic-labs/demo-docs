---
title: "webhook_endpoints_resolver_spec.rb"
---

## High-level description
This code is a RSpec test suite for the `Resolvers::WebhookEndpointsResolver` GraphQL resolver. It verifies that the resolver correctly handles authentication, authorization, and returns the expected webhook endpoints data.

## Code Structure
The test suite is organized as a single RSpec describe block for the `Resolvers::WebhookEndpointsResolver`. It includes shared examples for common authentication and authorization checks, and a specific test for the resolver's functionality.

## References
- `Resolvers::WebhookEndpointsResolver`: The GraphQL resolver being tested.
- `rails_helper`: Required at the beginning of the file, likely containing common test setup and configurations.

## Symbols

### RSpec.describe Resolvers::WebhookEndpointsResolver
#### Description
This is the main describe block for the test suite, focusing on the WebhookEndpointsResolver.

### let(:required_permission)
#### Description
Defines the required permission for accessing webhook endpoints.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| required_permission | String | The permission required to access webhook endpoints |

### let(:query)
#### Description
Defines the GraphQL query used in the test.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | String | The GraphQL query for fetching webhook endpoints |

### let(:membership)
#### Description
Creates a membership object using FactoryBot.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| membership | Membership | A membership object for testing |

### let(:organization)
#### Description
Retrieves the organization associated with the membership.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| organization | Organization | The organization associated with the membership |

### it_behaves_like 'requires current user'
#### Description
Includes shared examples to test if the resolver requires a current user.

### it_behaves_like 'requires current organization'
#### Description
Includes shared examples to test if the resolver requires a current organization.

### it_behaves_like 'requires permission', 'developers:manage'
#### Description
Includes shared examples to test if the resolver requires the 'developers:manage' permission.

### it 'returns a list of webhook endpoints'
#### Description
Tests the main functionality of the resolver, verifying that it returns the correct webhook endpoints data.

#### Internal Logic
1. Executes the GraphQL query with the necessary context (current user, organization, and permissions).
2. Retrieves the webhook endpoints response from the result.
3. Uses `aggregate_failures` to group multiple expectations.
4. Checks if the first webhook endpoint in the collection matches the expected data.
5. Verifies the metadata of the response (current page and total count).

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| rails_helper | Loads common test configurations and helpers |
| rspec | Testing framework used for writing and running the tests |
| FactoryBot | Used for creating test data (membership) |

## Error Handling
This test suite doesn't explicitly test error handling. It focuses on the happy path where the user has the required permissions and the query executes successfully.
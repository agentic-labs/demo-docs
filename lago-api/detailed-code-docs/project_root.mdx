---
title: "Overview"
---

## High-level description
This repository contains the source code for the Lago API, which is part of an open-source Stripe Billing alternative. The API is built using Ruby on Rails and provides comprehensive functionality for managing complex billing logic, including usage-based billing, subscription-based billing, and various pricing models.

## What does it do?
The Lago API serves as the backend for a sophisticated billing system, offering the following key functionalities:

1. Customer Management: Handling customer data, relationships, and metadata.
2. Subscription Management: Creating, updating, and terminating subscriptions.
3. Usage-Based Billing: Processing and aggregating usage data for billing purposes.
4. Invoice Generation: Creating and managing invoices based on subscriptions and usage.
5. Payment Processing: Integrating with payment providers and handling transactions.
6. Tax Calculation: Supporting various tax regimes, including EU VAT.
7. Webhook Management: Sending notifications about billing events to external systems.
8. Analytics and Reporting: Providing insights into billing and revenue data.
9. Multi-tenancy: Supporting multiple organizations with isolated data.
10. API and GraphQL Interfaces: Offering flexible ways to interact with the system.

## Entry points
The main entry points for the application are:

1. `config/routes.rb`: Defines the API endpoints and GraphQL interface.
2. `app/controllers/api/v1/base_controller.rb`: The base controller for API v1 endpoints.
3. `app/graphql/lago_api_schema.rb`: The main GraphQL schema definition.
4. `app/models/application_record.rb`: The base model for all ActiveRecord models.
5. `app/jobs/application_job.rb`: The base job for background processing.

## Key Files
1. `app/models/customer.rb`: Defines the core Customer model and its associations.
2. `app/services/invoices/create_service.rb`: Manages the complex process of invoice creation.
3. `app/graphql/types/query_type.rb`: Defines the available GraphQL queries.
4. `app/jobs/bill_subscription_job.rb`: Handles the asynchronous billing process for subscriptions.
5. `config/database.yml`: Configures database connections for PostgreSQL and ClickHouse.
6. `lib/lago_http_client/client.rb`: Implements a custom HTTP client for external integrations.
7. `spec/rails_helper.rb`: Sets up the testing environment for RSpec.

## Dependencies
The application relies on several key dependencies:

1. Ruby on Rails: The web application framework
2. PostgreSQL and ClickHouse: For primary and analytics databases
3. GraphQL: For implementing the GraphQL API
4. Sidekiq: For background job processing
5. Kafka: For event streaming and processing
6. AWS SDK and Google Cloud Storage: For file storage options
7. Sentry: For error tracking and monitoring
8. OpenTelemetry: For distributed tracing

## Configuration
The application uses various configuration techniques:

1. Environment variables: For sensitive information and deployment-specific settings.
2. `config/application.rb` and environment-specific files: For Rails and application settings.
3. `config/database.yml`: For database connections.
4. `config/initializers/`: For setting up various gems and services.
5. `.rubocop.yml`: For code style and linting rules.

The Lago API provides a robust and flexible backend for complex billing scenarios, supporting various pricing models and integrations. It's designed with scalability and multi-tenancy in mind, making it suitable for SaaS applications and other subscription-based services.
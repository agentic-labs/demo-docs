---
title: "3_alter_add_entity_id.up.sql"
---

## High-level description
This SQL script alters the `flipt_counter_analytics` table in ClickHouse by adding a new nullable column named `entity_id` of type String. The new column is positioned after the `evaluation_value` column in the table structure.

## Symbols

### ALTER TABLE flipt_counter_analytics
#### Description
This SQL command modifies the structure of the existing `flipt_counter_analytics` table in the ClickHouse database.

#### Internal Logic
1. Targets the `flipt_counter_analytics` table for modification.
2. Adds a new column named `entity_id`.
3. Sets the data type of `entity_id` to `Nullable(String)`, allowing it to contain either string values or NULL.
4. Positions the new column immediately after the `evaluation_value` column using the `AFTER` clause.

## Side Effects
- The `flipt_counter_analytics` table structure is permanently modified.
- Existing rows in the table will have NULL values in the new `entity_id` column.
- Any queries or applications interacting with this table may need to be updated to account for the new column.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| ClickHouse | The database system where this SQL script is intended to be executed |

## Configuration
This script is part of a database migration process, as indicated by its filename (`3_alter_add_entity_id.up.sql`). It's likely managed by a migration tool or process that applies database schema changes in a controlled manner.

## TODOs
There are no explicit TODOs in this script. However, it's important to note that this is an "up" migration script (as indicated by the `.up.sql` in the filename). In a proper migration setup, there should be a corresponding "down" migration script to revert this change if needed.
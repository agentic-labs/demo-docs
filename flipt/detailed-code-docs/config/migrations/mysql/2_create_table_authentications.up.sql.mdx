---
title: "2_create_table_authentications.up.sql"
---

## High-level description
This SQL script creates a table named `authentications` in a MySQL database. The table is designed to store authentication-related information, including unique identifiers, hashed client tokens, authentication methods, metadata, and timestamps for expiration and record management.

## Code Structure
The script consists of two main SQL statements: one to create the `authentications` table and another to create a unique index on the `hashed_client_token` column.

## Symbols

### CREATE TABLE authentications
#### Description
This SQL statement creates the `authentications` table if it doesn't already exist. The table is designed to store various authentication-related data points.

#### Internal Logic
The table is created with the following columns:
1. `id`: A unique identifier for each authentication record.
2. `hashed_client_token`: A hashed version of the client token, also unique.
3. `method`: An integer representing the authentication method, defaulting to 0.
4. `metadata`: A text field for storing additional information.
5. `expires_at`: A timestamp for the expiration of the authentication.
6. `created_at`: A timestamp for when the record was created, automatically set to the current time.
7. `updated_at`: A timestamp for when the record was last updated, automatically set to the current time.

The `id` column is set as the primary key of the table.

### CREATE UNIQUE INDEX
#### Description
This SQL statement creates a unique index on the `hashed_client_token` column of the `authentications` table.

#### Internal Logic
The index is named `hashed_client_token_authentications_index` and ensures that each `hashed_client_token` value in the table is unique, allowing for faster lookups and enforcing uniqueness at the database level.

## Performance Considerations
1. The use of `VARCHAR(255)` for `id` and `hashed_client_token` allows for efficient storage of variable-length strings up to 255 characters.
2. The unique index on `hashed_client_token` improves query performance for lookups based on this column but may slightly impact insert and update operations.
3. The use of `TIMESTAMP(6)` for date-related columns provides microsecond precision, which may be important for accurate timing in authentication scenarios.

## Dependencies
This script is designed for MySQL databases, as evidenced by the MySQL-specific syntax such as the use of backticks for column names and the `TIMESTAMP(6)` data type.

## Error Handling
The `IF NOT EXISTS` clause in the `CREATE TABLE` statement prevents errors if the table already exists, allowing for idempotent execution of the script.

## TODOs
There are no explicit TODOs or notes left in the code.
---
title: "Overview"
---

## High-level description
This directory contains MySQL database migration scripts for a feature flag management system. The scripts create and modify tables to support various features such as namespaces, rollouts, authentication, and metadata management. The migrations are numbered sequentially, indicating the order in which they should be applied to maintain database consistency.

## What does it do?
These migration scripts collectively set up and evolve the database schema for a feature flag management system. They create tables for storing feature flags, user segments, variants, constraints, rules, and distributions. The scripts also add support for namespaces, allowing for organization of flags and related entities. Additionally, they introduce tables for managing authentication, operation locks, and rollouts. Over time, the migrations add new columns and modify existing tables to support new features and improve the system's functionality.

## Entry points
The migration files are numbered sequentially from 0 to 14, with each file containing SQL statements to be executed in order. The main entry points are:

1. `0_initial.up.sql`: Creates the initial database schema with core tables.
2. Subsequent numbered files (1 through 14): Add new features, modify existing tables, or refine the schema.

Each file is designed to be run in sequence to gradually build and modify the database structure.

## Key Files
1. `0_initial.up.sql`: Sets up the core tables for flags, segments, variants, constraints, rules, and distributions.
2. `2_create_table_authentications.up.sql`: Adds authentication support.
3. `4_create_namespaces.up.sql`: Introduces the concept of namespaces.
4. `5_namespaces_relationships.up.sql`: Establishes relationships between namespaces and other entities.
5. `8_rollouts.up.sql`: Adds support for feature rollouts.
6. `14_flag_metadata.up.sql`: Introduces metadata support for flags.

## Dependencies
These migration scripts are specifically designed for MySQL databases. They use MySQL-specific syntax and features, such as:

- `JSON` data type
- `TIMESTAMP(6)` for microsecond precision
- MySQL-specific index and foreign key syntax

## Configuration
The migration scripts don't contain explicit configuration options. However, they do set up various default values and constraints:

1. Default namespace: 'default'
2. Timestamp columns often use `DEFAULT CURRENT_TIMESTAMP(6)` for automatic timestamping
3. Some columns have default values (e.g., `enabled BOOLEAN DEFAULT FALSE` in the flags table)

When implementing these migrations, ensure that:
1. The MySQL server version supports all used features (e.g., JSON data type).
2. The database user has sufficient privileges to create tables, modify schemas, and add constraints.
3. The migrations are run in the correct order, as indicated by their numerical prefixes.

These migration scripts provide a solid foundation for a feature flag management system, allowing for complex targeting, rollout strategies, and organization through namespaces. The incremental nature of the migrations allows for easy updates and maintenance of the database schema over time.
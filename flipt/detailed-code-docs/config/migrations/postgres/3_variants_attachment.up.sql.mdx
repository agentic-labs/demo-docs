---
title: "3_variants_attachment.up.sql"
---

## High-level description
This SQL migration script alters the `variants` table in a PostgreSQL database by adding a new column named `attachment` of type `JSONB`. This change allows for storing JSON-formatted data in the `variants` table, providing flexibility for storing complex, structured information related to variants.

## Symbols

### ALTER TABLE variants ADD attachment JSONB;
#### Description
This SQL statement modifies the structure of the `variants` table by adding a new column called `attachment`.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| variants | Table | The existing table to be altered |

#### Outputs
The `variants` table is modified with a new column added.

#### Internal Logic
1. The `ALTER TABLE` command is used to modify the structure of the `variants` table.
2. The `ADD` clause specifies that a new column is being added to the table.
3. The new column is named `attachment`.
4. The data type of the new column is set to `JSONB`.

## Side Effects
- This migration will modify the schema of the `variants` table in the database.
- Existing rows in the `variants` table will have a `NULL` value in the new `attachment` column unless a default value is specified (which is not the case in this migration).
- Applications or queries that interact with the `variants` table may need to be updated to account for the new column.

## Performance Considerations
- Adding a `JSONB` column allows for efficient storage and querying of JSON data in PostgreSQL.
- The `JSONB` type is generally more efficient than the `JSON` type for most operations, as it stores data in a decomposed binary format.
- Indexes can be created on `JSONB` columns or specific JSON paths within the column for improved query performance if needed.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| PostgreSQL | This migration is specific to PostgreSQL databases and relies on PostgreSQL's support for the `JSONB` data type. |

Note: This migration script is part of a series of migrations, as indicated by the filename prefix "3_". It's important to ensure that this migration is run in the correct order relative to other migrations in the same directory.
---
title: "14_default_variant.up.sql"
---

## High-level description
This SQL migration script adds a new column `default_variant_id` to the `flags` table in a PostgreSQL database. The column is designed to reference the `id` column in the `variants` table, establishing a foreign key relationship between the two tables.

## Symbols

### ALTER TABLE flags
#### Description
This SQL command modifies the structure of the `flags` table by adding a new column.

#### Internal Logic
1. Adds a new column named `default_variant_id` to the `flags` table.
2. Sets the data type of the new column to `VARCHAR(255)`.
3. Establishes a foreign key relationship with the `variants` table, referencing its `id` column.
4. Specifies the `ON DELETE SET NULL` behavior for the foreign key constraint.

## Side Effects
- The `flags` table structure is modified, which may affect existing queries or applications interacting with this table.
- A new foreign key relationship is established between the `flags` and `variants` tables.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| PostgreSQL | This SQL script is specifically designed for PostgreSQL databases |

## Error Handling
If the `variants` table or its `id` column does not exist, the migration will fail due to the foreign key constraint.

## Performance Considerations
Adding a new column to an existing table with a foreign key constraint may have performance implications, especially for large tables. The operation might require a table rewrite, which could be time-consuming for tables with a large number of rows.

This migration script is part of a series of database schema changes, as indicated by the filename prefix "14_". It's important to run this script in the correct order with respect to other migration scripts to ensure proper database schema evolution.
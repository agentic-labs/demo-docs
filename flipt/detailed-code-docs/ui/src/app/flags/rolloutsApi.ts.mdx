---
title: "rolloutsApi.ts"
---

## High-level description
This code defines a Redux Toolkit Query API for managing rollouts in a feature flag system. It provides endpoints for listing, creating, updating, deleting, and reordering rollouts, as well as utility functions for generating cache tags and hooks for using the API in React components.

## Code Structure
The main symbol in this code is the `rolloutsApi`, which is created using Redux Toolkit's `createApi` function. It defines several endpoints for interacting with rollouts. The code also exports a `rolloutTag` function for generating cache tags and several hooks for using the API in React components.

## Symbols

### `rolloutTag`
#### Description
A function that generates a cache tag for a rollout based on its namespace and flag key.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| arg | { namespaceKey: string; flagKey: string } | An object containing the namespace key and flag key |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| tag | TagDescription&lt;'Rollout'&gt; | A cache tag for the rollout |

### `rolloutsApi`
#### Description
The main API slice for managing rollouts, created using Redux Toolkit's `createApi` function.

#### Endpoints
1. `listRollouts`: Fetches a list of rollouts for a given namespace and flag.
2. `deleteRollout`: Deletes a specific rollout.
3. `createRollout`: Creates a new rollout.
4. `updateRollout`: Updates an existing rollout.
5. `orderRollouts`: Reorders the rollouts for a flag.

#### Internal Logic
Each endpoint defines its query function, which specifies the API request details. The `orderRollouts` endpoint includes additional logic for optimistic updates to the cache.

## Side Effects
The `orderRollouts` endpoint performs an optimistic update to the cache, modifying the order of rollouts before the server response is received.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @reduxjs/toolkit | Provides utilities for creating the API slice |
| ~/types/Rollout | Defines TypeScript interfaces for rollout-related data |
| ~/utils/redux-rtk | Provides the `baseQuery` function for API requests |

## Exported Hooks
The code exports several hooks for use in React components:
- `useListRolloutsQuery`
- `useCreateRolloutMutation`
- `useUpdateRolloutMutation`
- `useDeleteRolloutMutation`
- `useOrderRolloutsMutation`

These hooks allow components to easily interact with the rollouts API and manage related state.
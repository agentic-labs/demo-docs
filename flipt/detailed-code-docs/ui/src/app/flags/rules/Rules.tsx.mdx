---
title: "Rules.tsx"
---

## High-level description
This code defines a React component called `Rules` that manages and displays rules for a feature flag. It allows users to create, edit, reorder, and delete rules, as well as set a default variant for the flag. The component uses drag-and-drop functionality for reordering rules and includes forms for creating and editing rules.

## Code Structure
The main `Rules` component contains several sub-components and hooks:
- `DefaultVariant`: Handles the default variant for the flag
- `RuleForm`: Used for creating new rules
- `SortableRule`: Wrapper for individual rules that enables drag-and-drop functionality
- Various Redux hooks for managing state and API calls

## Symbols

### Rules
#### Description
The main component that renders the list of rules and the default variant for a feature flag.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| flag | IFlag | The feature flag object |

#### Internal Logic
1. Fetches the list of rules and segments for the current flag
2. Manages state for rule creation, deletion, and reordering
3. Renders the list of rules using drag-and-drop functionality
4. Handles rule creation, deletion, and reordering

### DefaultVariant
#### Description
A sub-component that manages the default variant for the feature flag.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| flag | IFlag | The feature flag object |

#### Internal Logic
1. Manages the selected default variant
2. Handles updating the default variant
3. Renders a form for selecting and updating the default variant

## Dependencies
- @dnd-kit/core and @dnd-kit/sortable: For drag-and-drop functionality
- @heroicons/react: For icons
- formik: For form management
- react-redux and @reduxjs/toolkit: For state management
- Various custom hooks and components

## Error Handling
The component uses custom `useError` and `useSuccess` hooks to handle and display errors and success messages.

## Performance Considerations
- Uses `useMemo` to memoize computed values and prevent unnecessary re-renders
- Implements optimistic updates for rule reordering to improve perceived performance

This component is a complex and feature-rich implementation for managing rules in a feature flag system. It provides a user-friendly interface for creating, editing, and reordering rules, as well as setting a default variant for the flag.
---
title: "store.ts"
---

## High-level description
This code defines the Redux store configuration for a React application using Redux Toolkit. It sets up the store with various slices, APIs, and middleware, including listener middleware for handling specific actions. The store manages state for authentication, namespaces, flags, segments, preferences, and other application features.

## Code Structure
The code imports various slices and APIs from different parts of the application. It then configures the Redux store using these imported modules. The store is set up with preloaded state, reducers, and middleware. The code also defines listener middleware for specific actions to handle side effects like saving data to local storage or resetting API states.

## Symbols

### `listenerMiddleware`
#### Description
Creates and configures a listener middleware to handle specific actions.

#### Internal Logic
- Listens for onboarding completion and banner dismissal actions to save user state to local storage.
- Listens for theme and timezone changes to save preferences to local storage.
- Listens for namespace changes to save the current namespace to local storage.
- Listens for reference changes to save the current reference and reset various API states.
- Listens for namespace list updates to propagate changes to the namespaces slice.
- Listens for namespace deletion to invalidate related segment cache.
- Listens for flag deletion to invalidate related rollout and rule caches.

### `store`
#### Description
Configures and creates the Redux store for the application.

#### Internal Logic
- Preloads state from local storage for user events, preferences, and namespaces.
- Combines reducers from various slices and APIs.
- Configures middleware, including the custom listener middleware and API middleware.

### `RootState`
#### Description
Type definition for the root state of the Redux store.

### `AppDispatch`
#### Description
Type definition for the dispatch function of the Redux store.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @reduxjs/toolkit | Provides utilities for efficient Redux development |
| Various local imports | Import slices and APIs for different features |

## Side Effects
- The listener middleware performs side effects like saving data to local storage and resetting API states based on specific actions.

## Performance Considerations
- The use of RTK Query APIs helps in efficient data fetching and caching.
- The listener middleware might impact performance if not carefully managed, especially for frequently dispatched actions.

This code sets up a comprehensive Redux store for managing the application's state, integrating various features and handling side effects through listener middleware. It provides a centralized state management solution for the React application.
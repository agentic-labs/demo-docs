---
title: "SegmentsPicker.tsx"
---

## High-level description
The `SegmentsPicker` component is a reusable form element for selecting and managing segments in Flipt, a feature flag management system. It allows users to add, remove, and replace segments, with support for multiple segment selection and different segment operators.

## Code Structure
The main `SegmentsPicker` component uses several utility functions and components, including `Combobox` for segment selection, and various icons from Heroicons. It manages the state of selected segments and provides functionality to add, remove, and replace segments.

## Symbols

### SegmentsPicker
#### Description
A React component that renders a UI for selecting and managing segments.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| readonly | boolean | Determines if the picker is in read-only mode |
| segments | ISegment[] | Array of available segments |
| selectedSegments | FilterableSegment[] | Array of currently selected segments |
| segmentAdd | function | Callback to add a segment |
| segmentReplace | function | Callback to replace a segment |
| segmentRemove | function | Callback to remove a segment |

#### Internal Logic
1. Manages the state of editing mode and selected segments
2. Renders a list of selected segments with options to add or remove
3. Uses `Combobox` component for segment selection
4. Handles adding, removing, and replacing segments
5. Supports read-only mode

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @heroicons/react | Provides icons for UI elements |
| react | Core React library |
| ~/components/forms/Combobox | Custom Combobox component for segment selection |
| ~/types/Segment | Type definitions for segments |
| ~/utils/helpers | Utility functions |

## Error Handling
The component doesn't implement explicit error handling but uses conditional rendering to manage UI states based on user interactions and prop values.

## Performance Considerations
The component uses `useRef` to maintain a set of selected segment keys, which helps in efficient filtering of available segments. It also uses `useEffect` to update the editing state when the parent segments change.

This component is crucial for managing segments in various parts of the Flipt UI, including rule creation and editing forms. It provides a flexible and reusable interface for segment selection across different contexts in the application.
---
title: "ConstraintForm.tsx"
---

## High-level description
This code defines a `ConstraintForm` component in React, which is used to create or edit constraints for segments in a feature flagging system. It provides a form interface for users to input various properties of a constraint, such as type, operator, and value, with different input fields based on the selected constraint type.

## Code Structure
The main `ConstraintForm` component uses several sub-components and utility functions to render different parts of the form. It leverages Formik for form management and validation, and uses Redux for state management and API calls.

## Symbols

### `ConstraintForm`
#### Description
The main component that renders the constraint form. It handles the creation and editing of constraints for segments.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| setOpen | function | Function to control the visibility of the form |
| segmentKey | string | Key of the segment the constraint belongs to |
| constraint | IConstraint (optional) | Existing constraint data for editing |
| onSuccess | function | Callback function to be called on successful submission |

#### Internal Logic
1. Initializes form state and validation schema
2. Renders form fields based on constraint type and operator
3. Handles form submission, including API calls for creating or updating constraints
4. Manages error and success states

### `ConstraintOperatorSelect`
#### Description
A select input component for choosing the constraint operator.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| onChange | function | Function to handle changes in the select input |
| type | string | The type of constraint |

### `ConstraintValueInput`
#### Description
An input component for the constraint value.

### `ConstraintValueArrayInput`
#### Description
An input component for array-type constraint values.

### `ConstraintValueDateTimeInput`
#### Description
A specialized input component for datetime constraint values.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @headlessui/react | UI components |
| @heroicons/react | Icon components |
| date-fns | Date manipulation and formatting |
| formik | Form management |
| react-redux | Redux state management |
| yup | Form validation |

## Error Handling
The component uses the `useError` and `useSuccess` hooks to manage and display error and success messages.

## API/Interface Reference
| Endpoint | Method | Description |
|:---------|:-------|:------------|
| /namespaces/{namespaceKey}/segments/{segmentKey}/constraints | POST | Create a new constraint |
| /namespaces/{namespaceKey}/segments/{segmentKey}/constraints/{constraintId} | PUT | Update an existing constraint |

Note: The actual API calls are handled by the `useCreateConstraintMutation` and `useUpdateConstraintMutation` hooks from the `segmentsApi`.
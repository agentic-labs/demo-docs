---
title: "evaluation_store_mock.go"
---

## High-level description
The `evaluation_store_mock.go` file defines a mock implementation of the `Storer` interface, which is used for testing purposes in the evaluation package. This mock allows for simulating interactions with the underlying storage layer for evaluation-related data without relying on a real storage backend.

## Code Structure
The `evaluationStoreMock` struct implements the `Storer` interface by mocking all its methods. Each method uses the `mock.Called` function to record the call with its arguments and returns predefined values or errors specified in the test using the `Return` method of the `mock.Mock` object.

## Symbols

### `evaluationStoreMock`
#### Description
The `evaluationStoreMock` is a mock implementation of the `Storer` interface, used for testing purposes. It utilizes the `github.com/stretchr/testify/mock` package to simulate interactions with a storage backend.

#### Inputs
This struct doesn't have any explicit inputs.

#### Outputs
This struct doesn't have any explicit outputs.

#### Internal Logic
The `evaluationStoreMock` struct embeds `mock.Mock` and uses its methods to simulate method calls and return predefined values or errors. Each method follows this pattern:
1. Call `e.Called(ctx, ...)` to record the method call with its arguments.
2. Use `args.Get(index)` to retrieve the predefined return values set in the test.
3. Cast the retrieved values to their appropriate types.
4. Return the values and an error (if any) as specified in the test using the `Return` method of the `mock.Mock` object.

#### Example
```go
func (e *evaluationStoreMock) GetFlag(ctx context.Context, flag storage.ResourceRequest) (*flipt.Flag, error) {
	args := e.Called(ctx, flag)
	return args.Get(0).(*flipt.Flag), args.Error(1)
}
```

In this example, `GetFlag` is expected to return a `*flipt.Flag` and an `error`. The test using this mock will define what these values should be using the `Return` method.

### `String()`
#### Description
`String()` is a method of the `evaluationStoreMock` struct. It returns a string identifying the mock as "mock".

#### Inputs
This method doesn't take any inputs.

#### Outputs
| Name | Type   | Description |
|:-----|:-------|:------------|
|      | string | The string "mock" |

#### Internal Logic
This method simply returns the string "mock".

### `GetFlag()`
#### Description
`GetFlag()` is a mock method that simulates retrieving a flag from the store.

#### Inputs
| Name | Type                        | Description                                  |
|:-----|:----------------------------|:----------------------------------------------|
| ctx  | context.Context              | The context for the request.                 |
| flag | storage.ResourceRequest     | The resource request containing flag details. |

#### Outputs
| Name | Type        | Description                                  |
|:-----|:------------|:----------------------------------------------|
|      | *flipt.Flag | The retrieved flag or a mock value.         |
|      | error       | An error, if any, as defined in the test.    |

### `GetEvaluationRules()`
#### Description
`GetEvaluationRules()` is a mock method that simulates retrieving evaluation rules for a flag from the store.

#### Inputs
| Name | Type                        | Description                                  |
|:-----|:----------------------------|:----------------------------------------------|
| ctx  | context.Context              | The context for the request.                 |
| flag | storage.ResourceRequest     | The resource request containing flag details. |

#### Outputs
| Name | Type                                | Description                                          |
|:-----|:------------------------------------|------------------------------------------------------|
|      | []*storage.EvaluationRule          | A slice of evaluation rules or a mock value.       |
|      | error                               | An error, if any, as defined in the test.            |

### `GetEvaluationDistributions()`
#### Description
`GetEvaluationDistributions()` is a mock method that simulates retrieving evaluation distributions for a rule from the store.

#### Inputs
| Name   | Type                    | Description                                      |
|:-------|:-------------------------|:--------------------------------------------------|
| ctx    | context.Context          | The context for the request.                     |
| ruleID | storage.IDRequest        | The ID request containing the evaluation rule ID. |

#### Outputs
| Name | Type                                    | Description                                              |
|:-----|:----------------------------------------|:------------------------------------------------------------------|
|      | []*storage.EvaluationDistribution     | A slice of evaluation distributions or a mock value.           |
|      | error                                   | An error, if any, as defined in the test.                |

### `GetEvaluationRollouts()`
#### Description
`GetEvaluationRollouts()` is a mock method that simulates retrieving evaluation rollouts for a flag from the store.

#### Inputs
| Name | Type                        | Description                                  |
|:-----|:----------------------------|:----------------------------------------------|
| ctx  | context.Context              | The context for the request.                 |
| flag | storage.ResourceRequest     | The resource request containing flag details. |

#### Outputs
| Name | Type                                  | Description                                            |
|:-----|:----------------------------------------|:----------------------------------------------------------------|
|      | []*storage.EvaluationRollout         | A slice of evaluation rollouts or a mock value.             |
|      | error                                   | An error, if any, as defined in the test.                |

## Dependencies
| Dependency | Purpose                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | Dependency | Purpose |
|:-----------|:--------|
| github.com/stretchr/testify/mock | Provides mocking functionality for testing |
| go.flipt.io/flipt/internal/storage | Defines storage-related types and interfaces |
| go.flipt.io/flipt/rpc/flipt | Contains RPC-related types for Flipt |

## Error Handling
The mock implementation doesn't handle errors directly. Instead, it allows the test to define the error responses for each method call using the `Return` method of the `mock.Mock` object.

## Logging
This mock implementation doesn't include any logging functionality. Logging, if needed, should be handled in the actual implementation or in the test code using this mock.

## API/Interface Reference
The `evaluationStoreMock` implements the `Storer` interface, which includes the following methods:

| Method | Description |
|:-------|:------------|
| String() | Returns a string representation of the store |
| GetFlag() | Retrieves a flag from the store |
| GetEvaluationRules() | Retrieves evaluation rules for a flag |
| GetEvaluationDistributions() | Retrieves evaluation distributions for a rule |
| GetEvaluationRollouts() | Retrieves evaluation rollouts for a flag |

## Performance Considerations
As this is a mock implementation used for testing, performance is not a primary concern. However, the use of the `testify/mock` package ensures efficient recording and verification of method calls during testing.

## TODOs
There are no TODOs or notes left in the code.

This mock implementation provides a flexible way to simulate the behavior of the `Storer` interface in unit tests, allowing developers to easily control the responses of storage-related operations without relying on an actual storage backend. This facilitates isolated testing of components that depend on the `Storer` interface.
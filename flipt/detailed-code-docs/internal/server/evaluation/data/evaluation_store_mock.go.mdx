---
title: "evaluation_store_mock.go"
---

## High-level description
The `evaluationStoreMock` struct is a mock implementation of the `EvaluationStore` interface. It is used in tests to simulate the behavior of a real evaluation store, allowing for controlled testing of components that depend on the `EvaluationStore` interface. 

This mock utilizes the `stretchr/testify/mock` library to provide functionality for setting up expectations on method calls and asserting that these expectations are met during the test execution.

## Code Structure
The `evaluationStoreMock` struct is the main symbol in this code. It embeds `mock.Mock` to inherit mocking capabilities. All other symbols are methods of this struct. Each method corresponds to a method in the `EvaluationStore` interface and is responsible for mocking its behavior.

## References
This code references the following symbols from other parts of the codebase:
- `storage.NamespaceRequest`: Represents a request for a namespace.
- `storage.ListRequest`: Represents a request to list resources.
- `storage.ResourceRequest`: Represents a request for a specific resource.
- `storage.IDRequest`: Represents a request for a resource by its ID.
- `flipt.Flag`: Represents a feature flag.
- `storage.EvaluationRule`: Represents an evaluation rule for a flag.
- `storage.EvaluationDistribution`: Represents an evaluation distribution for a rule.
- `storage.EvaluationRollout`: Represents an evaluation rollout for a flag.

## Symbols

### `evaluationStoreMock`
#### Description
A mock implementation of the `EvaluationStore` interface for testing purposes.

#### Inputs
This struct doesn't have any explicit inputs.

#### Outputs
This struct doesn't have any explicit outputs.

#### Internal Logic
This struct uses the `mock.Mock` object to provide mocking functionality. Each method of the struct defines a mock behavior for the corresponding method in the `EvaluationStore` interface.

### `String()`
#### Description
Returns a string identifying this store as "mock".

#### Inputs
_This method takes no inputs._

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value) | string | Always returns "mock". |

### `GetVersion()`
#### Description
Mocks the `GetVersion` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| ns | storage.NamespaceRequest | The namespace request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | string | The mocked version string. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, ns)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

### `ListFlags()`
#### Description
Mocks the `ListFlags` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| req | *storage.ListRequest[storage.NamespaceRequest] | The list request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | storage.ResultSet[*flipt.Flag] | The mocked result set of flags. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, req)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

### `GetFlag()`
#### Description
Mocks the `GetFlag` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| flag | storage.ResourceRequest | The flag request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | *flipt.Flag | The mocked flag. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, flag)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

### `GetEvaluationRules()`
#### Description
Mocks the `GetEvaluationRules` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| flag | storage.ResourceRequest | The flag request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | []*storage.EvaluationRule | The mocked evaluation rules. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, flag)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

### `GetEvaluationDistributions()`
#### Description
Mocks the `GetEvaluationDistributions` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| ruleID | storage.IDRequest | The rule ID request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | []*storage.EvaluationDistribution | The mocked evaluation distributions. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, ruleID)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

### `GetEvaluationRollouts()`
#### Description
Mocks the `GetEvaluationRollouts` method of the `EvaluationStore` interface.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ctx | context.Context | The context for the request. |
| flag | storage.ResourceRequest | The flag request. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (return value 1) | []*storage.EvaluationRollout | The mocked evaluation rollouts. |
| (return value 2) | error | The mocked error, if any. |

#### Internal Logic
This method uses `e.Called(ctx, flag)` to record the call and return predefined values set up by the test using `On` method of the `mock.Mock`.

## Dependencies
This code depends on the `github.com/stretchr/testify/mock` library for its mocking functionality.

This code also depends on the `go.flipt.io/flipt/internal/storage` and `go.flipt.io/flipt/rpc/flipt` packages for data types and interfaces.

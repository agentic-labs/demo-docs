---
title: "checker_test.go"
---

## High-level description
The `checker_test.go` file contains unit tests for the `NewChecker` function in the `audit` package. The `NewChecker` function is responsible for creating a new `Checker` instance that is used to determine if an event pair (e.g., "flag:created") is present in a given list of allowed event pairs.

## Code Structure
The code defines a single test function `TestChecker` which iterates over a set of test cases, each testing different input scenarios for the `NewChecker` function. Each test case asserts whether the created `Checker` correctly identifies the presence or absence of specific event pairs.

## Symbols
### `TestChecker`
#### Description
This function is a test function that tests the functionality of the `NewChecker` function. It defines several test cases, each with a different set of event pairs, and checks if the `NewChecker` function correctly creates a `Checker` that can validate those pairs.

#### Inputs
This function takes a pointer to a `testing.T` object as input, which is used for reporting test failures.

#### Outputs
This function does not return any values.

#### Internal Logic
The function defines a slice of test cases, each containing:
* `name`: The name of the test case.
* `eventPairs`: A slice of strings representing the allowed event pairs.
* `expectedError`: An error that is expected to be returned by `NewChecker`, or nil if no error is expected.
* `pairs`: A map of strings to booleans, where the key is an event pair and the value indicates whether the pair is expected to be allowed by the `Checker`.

The function iterates over the test cases and performs the following steps for each case:
1. **Arrange:** It calls `NewChecker` with the `eventPairs` from the test case.
2. **Act:** It checks if `NewChecker` returned an error and compares it to the `expectedError`. If an error is expected, it asserts that the error matches.
3. **Assert:** If no error is expected, it iterates over the `pairs` map and calls the `Check` method of the created `Checker` for each event pair. It then asserts that the return value of `Check` matches the expected boolean value in the map.

## Dependencies
* `testing`: This package is used for running tests and making assertions.
* `github.com/stretchr/testify/assert`: This package provides assertion functions for testing.

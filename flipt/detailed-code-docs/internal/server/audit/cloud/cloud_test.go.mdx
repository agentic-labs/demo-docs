---
title: "cloud_test.go"
---

## High-level description
This code defines unit tests for the `Sink` struct in the `cloud` package, which is responsible for sending audit events to a cloud-based audit log. The tests ensure that the `Sink` correctly implements the `audit.Sink` interface and can successfully send audit events.

## Symbols

### `TestSink`
#### Description
This function is a unit test for the `Sink` struct. It creates a new `Sink` instance with a dummy executer and tests its functionality.

#### Inputs
This function takes a pointer to `testing.T` as input, which is used for reporting test results and errors.

#### Outputs
This function does not return any values.

#### Internal Logic
1. **Arrange:**
    - Creates a new `Sink` instance with a `zap.NewNop()` logger (which discards all logs) and a `dummyExecuter`.
    - Asserts that the `String()` method of the `Sink` returns "cloud".
2. **Act:**
    - Calls the `SendAudits` method of the `Sink` with a context and a slice of two dummy audit events.
3. **Assert:**
    - Asserts that the `SendAudits` method returns no error.
    - Asserts that the `Close` method of the `Sink` returns no error.

## References
- `audit.Sink`: This interface defines the methods that a sink must implement to send audit events.
- `flipt.SubjectFlag`: This constant represents the "flag" subject type for audit events.
- `flipt.SubjectConstraint`: This constant represents the "constraint" subject type for audit events.
- `flipt.ActionCreate`: This constant represents the "create" action type for audit events.
- `flipt.ActionUpdate`: This constant represents the "update" action type for audit events.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| "context" | Used for managing the lifecycle of goroutines and API calls. |
| "testing" | Used for writing and running unit tests. |
| "github.com/stretchr/testify/require" | Used for making assertions in tests. |
| "go.flipt.io/flipt/internal/server/audit" | Provides the `audit.Sink` interface and related types. |
| "go.flipt.io/flipt/rpc/flipt" | Provides constants for audit event types and actions. |
| "go.uber.org/zap" | Used for structured logging. |

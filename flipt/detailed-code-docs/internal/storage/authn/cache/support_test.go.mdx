---
title: "support_test.go"
---

## High-level description
The code defines mock implementations of a cache and an authentication store, primarily for testing purposes. These mocks allow for controlled behavior and error injection during tests.

## Code Structure
The `cacheSpy` struct implements the `cache.Cacher` interface, while the `storeMock` struct implements the `authn.Store` interface. Both mocks use a map to simulate data storage and provide methods to simulate success, failure, and data retrieval.

## Symbols

### `cacheSpy`
#### Description
`cacheSpy` is a mock implementation of the `cache.Cacher` interface. It is used in tests to simulate a cache and control its behavior. It stores data in a map and allows setting errors for its methods.

#### Inputs
This symbol is a struct and does not have explicit input parameters.

#### Outputs
This symbol is a struct and does not have explicit output values.

#### Internal Logic
The `cacheSpy` struct uses a `map[string][]byte` to store cached data. It provides methods to get, set, and delete data from this map. Each method can be configured to return a specific error, allowing for simulating different cache behaviors in tests.

### `storeMock`
#### Description
`storeMock` is a mock implementation of the `authn.Store` interface. It simulates an authentication store for testing purposes. It uses a `common.StoreMock` to handle basic store operations and provides specific methods for authentication-related actions.

#### Inputs
This symbol is a struct and does not have explicit input parameters.

#### Outputs
This symbol is a struct and does not have explicit output values.

#### Internal Logic
The `storeMock` struct embeds a `common.StoreMock` to handle generic store operations. It implements methods like `CreateAuthentication`, `GetAuthenticationByClientToken`, `ListAuthentications`, etc., to simulate interactions with an authentication store. Each method uses the embedded `StoreMock` to simulate data access and error handling.

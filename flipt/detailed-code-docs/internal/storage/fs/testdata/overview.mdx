---
title: "Overview"
---

## High-level description
This directory contains test data for the Flipt feature flag evaluation system, specifically focusing on both valid and invalid configuration scenarios. It includes two main subdirectories: `invalid` and `valid`, each serving different testing purposes for the Flipt system's configuration parsing, validation, and error handling capabilities.

## What does it do?
The testdata directory simulates various real-world scenarios that the Flipt system might encounter when managing feature flags across different environments and file structures. It serves two primary purposes:

1. Testing invalid configurations:
   - Simulates various types of configuration errors, such as invalid data types, unknown segments, and incorrect variant distributions.
   - Allows developers to test the system's error handling and validation processes when encountering these configuration errors.

2. Testing valid configurations:
   - Demonstrates different aspects of Flipt's configuration capabilities, including file inclusion/exclusion, explicit and implicit indexing, and YAML stream formatting.
   - Simulates real-world scenarios for managing feature flags across different environments (production, sandbox, staging).
   - Covers various feature flag types (boolean, string, number) with different targeting rules and rollout strategies.

This comprehensive test suite enables developers to verify that the Flipt system correctly handles different configuration structures, properly applies include/exclude rules, accurately parses and interprets feature flag and segment definitions, and gracefully handles and reports configuration errors.

## Key Files

1. Invalid configurations:
   - `invalid/boolean_flag_segment`: YAML file with an invalid boolean flag segment configuration.
   - `invalid/extension/.flipt.yml`: YAML configuration including a file with an unknown extension.
   - `invalid/namespace/.flipt.yml` and `invalid/namespace/features.json`: YAML and JSON files with an invalid namespace definition.
   - `invalid/variant_flag_distribution`: YAML file with an invalid variant flag distribution.
   - `invalid/variant_flag_segment`: YAML file with an invalid variant flag segment configuration.

2. Valid configurations:
   - `valid/exclude_index/.flipt.yml`: Demonstrates file inclusion/exclusion capabilities.
   - `valid/explicit_index/.flipt.yml`: Shows explicit indexing of feature flag files.
   - `valid/explicit_index/prod/prod.features.yml`: Production environment feature flag configurations.
   - `valid/explicit_index/sandbox/sandbox.features.yaml`: Sandbox environment feature flag configurations.
   - `valid/implicit_index/prod/features.yml` and `valid/implicit_index/staging/features.yml`: Demonstrate implicit indexing and environment-specific configurations.
   - `valid/yaml_stream/flags.yaml`: Showcases YAML stream format for multiple configurations in a single file.

## Configuration
The configuration files in this directory use YAML and JSON formats, with the following key elements:

1. Global Configuration (in `.flipt.yml` files):
   - `version`: Specifies the configuration file format version.
   - `include`: Glob patterns for files to include.
   - `exclude`: Glob patterns for files to exclude.

2. Feature Flag Configuration:
   - `namespace`: Specifies the environment (e.g., "prod", "sandbox", "staging").
   - `flags`: Defines feature flags with properties such as name, type, description, enabled status, variants, rules, and rollout strategies.
   - `segments`: Defines user groups with criteria for segment membership.

Example of a valid feature flag configuration:

```yaml
flags:
  new-onboarding:
    type: boolean
    defaultVariant: "false"
    variants:
      "true": true
      "false": false
    rules:
      - name: Enable for internal users
        variants:
          "true": 100
        constraints:
          - attribute: email
            operator: ends_with
            value: "@company.com"
```

Example of an invalid configuration (namespace defined as an integer):

```json
{
  "namespace": 123,
  "flags": {
    "foo": {
      "key": "foo",
      "name": "foo",
      "description": "foo",
      "enabled": true,
      "variants": [
        {
          "key": "on",
          "name": "on"
        },
        {
          "key": "off",
          "name": "off"
        }
      ]
    }
  }
}
```

These configurations allow for testing of Flipt's ability to handle various scenarios, from simple boolean flags to complex multi-variant flags with gradual rollout strategies and user segmentation, as well as its robustness in identifying and reporting configuration errors.
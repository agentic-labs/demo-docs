---
title: "metrics.go"
---

## High-level description
This code defines the configuration structure for metrics in the Flipt application. It provides options for enabling metrics, selecting the exporter type, and configuring OTLP (OpenTelemetry Protocol) metrics.

## Code Structure
The code defines several types: `MetricsExporter`, `MetricsConfig`, and `OTLPMetricsConfig`. The `MetricsConfig` struct implements the `defaulter` interface, allowing it to set default values for the metrics configuration.

## Symbols

### `MetricsExporter`
#### Description
An enumeration type for supported metrics exporters.

#### Inputs
N/A (It's a type definition)

#### Outputs
N/A (It's a type definition)

### `MetricsConfig`
#### Description
Struct that holds the configuration for metrics.

#### Inputs
N/A (It's a struct definition)

#### Outputs
N/A (It's a struct definition)

#### Internal Logic
- `Enabled`: Boolean flag to enable/disable metrics
- `Exporter`: Type of metrics exporter to use
- `OTLP`: Configuration for OTLP metrics

### `OTLPMetricsConfig`
#### Description
Struct that holds the configuration for OTLP metrics.

#### Inputs
N/A (It's a struct definition)

#### Outputs
N/A (It's a struct definition)

#### Internal Logic
- `Endpoint`: String for the OTLP endpoint
- `Headers`: Map of string key-value pairs for headers

### `setDefaults`
#### Description
Method of `MetricsConfig` that sets default values for the metrics configuration.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| v | *viper.Viper | Viper instance for configuration management |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| error | error | Any error encountered during the process |

#### Internal Logic
Sets default values for the metrics configuration:
- Enables metrics by default
- Sets the default exporter to Prometheus

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| github.com/spf13/viper | Configuration management |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| metrics.enabled | bool | true | Enables or disables metrics |
| metrics.exporter | string | "prometheus" | Sets the metrics exporter type |

Note: The OTLP configuration options are not set by default and would need to be explicitly configured if the OTLP exporter is chosen.
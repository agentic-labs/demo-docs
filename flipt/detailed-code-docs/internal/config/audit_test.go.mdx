---
title: "audit_test.go"
---

## High-level description
This file contains unit tests for the `AuditConfig` struct's `Enabled()` method in the `config` package. The tests verify that the `Enabled()` method correctly determines whether auditing is enabled based on the configuration of various audit sinks.

## Symbols

### TestAuditEnabled
#### Description
This function is a unit test that checks the behavior of the `Enabled()` method of the `AuditConfig` struct for different audit sink configurations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| t | *testing.T | The testing object provided by Go's testing framework |

#### Internal Logic
1. Define a slice of test cases, each containing:
   - A sink name (string)
   - A function that returns an `AuditConfig` with specific settings
   - The expected result (boolean) of calling `Enabled()` on that config
2. Iterate through each test case:
   - Run a subtest for each sink
   - Create the `AuditConfig` using the provided function
   - Assert that the `Enabled()` method returns the expected result

The test cases cover the following scenarios:
1. No sinks enabled (expected: false)
2. Log sink enabled (expected: true)
3. Webhook sink enabled (expected: true)
4. Cloud sink enabled (expected: true)
5. Kafka sink enabled (expected: true)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| testing | Go's built-in testing framework |
| github.com/stretchr/testify/assert | Provides additional assertion functions for testing |

## References
The test file references the following symbols from other parts of the codebase:
- `AuditConfig`: A struct that likely contains the configuration for audit sinks
- `AuditConfig.Enabled()`: A method that determines if auditing is enabled based on the configuration
- `AuditConfig.Sinks`: A field of `AuditConfig` that contains configurations for different audit sinks (Log, Webhook, Cloud, Kafka)

These symbols are not defined in this file but are assumed to exist in the `config` package.
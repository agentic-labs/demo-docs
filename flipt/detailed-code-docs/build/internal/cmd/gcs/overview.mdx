---
title: "Overview"
---

## High-level description
This code implements a Google Cloud Storage (GCS) client for syncing data from a local directory to a GCS bucket. It uses the Google Cloud Storage Go client library to interact with GCS and provides functionality to upload files from a specified local directory to a designated GCS bucket.

## Code Structure
The main function sets up command-line flags, initializes the GCS client, creates a bucket if it doesn't exist, and then walks through the local directory to upload files to the GCS bucket.

## Symbols

### `main`
#### Description
The main function is the entry point of the program. It sets up command-line flags, initializes the GCS client, creates a bucket, and uploads files to GCS.

#### Internal Logic
1. Parse command-line flags for testdata directory and bucket name.
2. Set up a helper function `fatalOnError` to handle errors.
3. Check for the required `STORAGE_EMULATOR_HOST` environment variable.
4. Initialize the GCS client.
5. Create the specified bucket if it doesn't exist.
6. Walk through the local directory and upload files to GCS.

### `fatalOnError`
#### Description
A helper function that logs a fatal error if the provided error is not nil.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| err | error | The error to check |

#### Internal Logic
If the error is not nil, it calls `log.Fatal(err)` to log the error and exit the program.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| context | For managing request contexts |
| flag | For parsing command-line flags |
| fmt | For formatted I/O |
| io | For I/O operations |
| io/fs | For filesystem operations |
| log | For logging |
| os | For operating system functionality |
| cloud.google.com/go/storage | Google Cloud Storage client library |

## Error Handling
The program uses the `fatalOnError` function to handle errors. If any error occurs during execution, the program will log the error and exit.

## Logging
The program uses the standard `log` package for logging errors and the `fmt` package to print informational messages to stderr.

Your response should not exceed 3000 words or 4000 tokens. Focus on providing clear, concise information that can be directly inferred from the code. Include optional sections only when they provide significant value for understanding the code.
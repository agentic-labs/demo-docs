---
title: "Overview"
---

## High-level description

This directory contains integration tests and configuration files for the Flipt feature flag system. It includes a Go test file (`readonly_test.go`) that implements comprehensive integration tests, and a `testdata` directory with YAML configuration files for different environments and setups.

## What does it do?

The code in this directory serves two main purposes:

1. Integration Testing: The `readonly_test.go` file implements a series of tests that verify the functionality of the Flipt server across various API operations. These tests cover namespace management, flag evaluation, batch operations, and more. The tests are designed to work with different storage backends and authentication methods.

2. Feature Flag Configuration: The `testdata` directory provides YAML configuration files that define feature flags, user segments, and distribution rules. These configurations allow developers to control feature rollouts, perform A/B testing, and target specific user segments with different feature variants.

The combination of these components allows for thorough testing of the Flipt system and provides example configurations for real-world usage scenarios.

## Key Files

1. `readonly_test.go`:
   This file contains the main integration test suite for the Flipt server. It uses a test harness to set up the environment and run a series of test cases. The tests cover various API operations such as:
   - Namespace management
   - Flag and segment operations
   - Rule and rollout management
   - Evaluation operations for variant and boolean flags
   - Pagination checks for listing operations

2. `testdata/alternate/.flipt.yml`, `testdata/alternate/default.yaml`, `testdata/alternate/production.yaml`:
   These files provide a simplified configuration setup, focusing on basic feature flag definitions for default and production environments.

3. `testdata/main/.flipt.yml`, `testdata/main/default.yaml`, `testdata/main/production.yaml`:
   These files offer a more comprehensive configuration, including detailed feature flags, segments, and distribution rules for both default and production environments.

## Dependencies

The integration tests rely on several external packages:
- `github.com/stretchr/testify/assert` and `github.com/stretchr/testify/require` for test assertions
- `go.flipt.io/flipt/rpc/flipt` for Flipt's RPC definitions
- `go.flipt.io/flipt/rpc/flipt/evaluation` for evaluation-specific RPC definitions
- Various standard Go packages such as `context`, `fmt`, `testing`

The configuration files are designed to work with the Flipt feature flag management system.

## Configuration

The `testdata` directory contains YAML configuration files that define the feature flag system:

1. Alternate Configuration (simplified):
   ```yaml
   version: "1.2"
   flags:
     - key: flag_variant
       name: Alternate Flag Type Variant
       type: VARIANT_FLAG_TYPE
       description: Variant Flag Description
       enabled: false
     - key: flag_boolean
       name: Alternate Flag Type Boolean
       type: BOOLEAN_FLAG_TYPE
       description: Boolean Flag Description
       enabled: true
   ```

2. Main Configuration (comprehensive):
   ```yaml
   namespace:
     key: default
     name: Default
     description: Default namespace

   flags:
     - key: flag_001
       name: Flag 1
       type: VARIANT_FLAG_TYPE
       description: Description for Flag 1
       enabled: true
       variants:
         - key: on
           name: On
         - key: off
           name: Off
       rules:
         - segment:
             key: segment_001
           distributions:
             - variant:
                 key: on
               percentage: 50
             - variant:
                 key: off
               percentage: 50

   segments:
     - key: segment_001
       name: Segment 1
       description: Description for Segment 1
       constraints:
         - property: in_segment
           operator: eq
           value: "true"
       match_type: ALL_MATCH_TYPE
   ```

These configurations allow for fine-grained management of feature releases, enabling developers to test features in a default environment before rolling them out to production, and to target specific user segments with different feature variants.

The integration tests in `readonly_test.go` use these configurations to verify the correct behavior of the Flipt server under various scenarios and API operations.
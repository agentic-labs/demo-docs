---
title: "readonly_test.go"
---

Here's a high-level description and documentation of the provided code:

## High-level description

This code implements integration tests for the Flipt feature flag system. It sets up a test harness that can run various test cases against different configurations of the Flipt server, including different storage backends and authentication methods. The tests cover various API operations such as namespace management, flag evaluation, and batch operations.

## Code Structure

The main test suite is defined in the `TestReadOnly` function. It uses a test harness to set up the environment and run a series of test cases. The test cases cover various API operations provided by the Flipt server, including namespace, flag, segment, rule, and rollout management, as well as evaluation operations.

## Symbols

### TestReadOnly
#### Description
This is the main test function that sets up the test environment and runs a series of test cases to verify the functionality of the Flipt server.

#### Internal Logic
1. Sets up the test environment using the `integration.Harness` function.
2. Runs a series of test cases for different namespaces.
3. Each test case checks various API operations such as getting and listing namespaces, flags, segments, rules, and rollouts.
4. It also tests evaluation operations for both variant and boolean flags.

### integration.Harness
#### Description
This function sets up the test harness with the provided configuration options.

### TestOpts
#### Description
This struct contains configuration options for the test environment, including the server URL, whether references are supported, and the authentication token.

### ClientOpts
#### Description
This struct contains options for creating a client, including the namespace and role.

## Dependencies
The code relies on several external packages:
- `github.com/stretchr/testify/assert` and `github.com/stretchr/testify/require` for test assertions
- `go.flipt.io/flipt/rpc/flipt` for Flipt's RPC definitions
- `go.flipt.io/flipt/rpc/flipt/evaluation` for evaluation-specific RPC definitions
- Various standard Go packages such as `context`, `fmt`, `testing`

## Error Handling
The code uses `require.NoError` and `assert.Error` to handle and check for errors in the test cases. It also checks for specific error messages in some cases.

## Performance Considerations
The tests include pagination checks for listing operations, ensuring that the server can handle large datasets efficiently.

## TODOs
There are no explicit TODOs in the provided code.

This integration test suite provides comprehensive coverage of the Flipt server's API functionality, ensuring that all major operations work as expected across different namespaces and configurations.
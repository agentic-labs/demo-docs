---
title: "Overview"
---

## High-level description
This code defines a Next.js API route that uses the Flipt SDK to dynamically determine the language for a greeting message. It evaluates a feature flag named "language" in the "default" namespace to decide whether to display the greeting in Spanish or English.

## References
- `FliptApiClient` from `@flipt-io/flipt`
- `uuidv4` from `uuid`

## Symbols
### `handler`
#### Description
This is an asynchronous function that handles requests to the `/api/hello` API route. It uses the Flipt client to evaluate a feature flag and determine the appropriate language for a greeting message.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| _req | NextApiRequest | The incoming request object (unused in this example). |
| res | NextApiResponse&lt;Data&gt; | The response object used to send the response back to the client. |

#### Outputs
The function sends a JSON response with a status code of 200. The response body contains a greeting message in either English or Spanish based on the evaluation of the "language" feature flag.

#### Internal Logic
1. **Initialize language:** Sets a default language of "english".
2. **Evaluate feature flag:**
   - Uses `client.evaluation.variant` to evaluate the "language" feature flag in the "default" namespace.
   - The `entityId` is set to a random UUID generated by `uuidv4()`.
   - The `context` is empty in this example.
   - If the evaluation is successful, the `language` variable is updated with the returned `variantKey`.
3. **Handle errors:**
   - If an error occurs during feature flag evaluation, it is logged to the console.
4. **Construct response:**
   - Creates a response object with a greeting message.
   - The message is chosen based on the value of the `language` variable.
5. **Send response:**
   - Sends the constructed response with a status code of 200 using `res.status(200).json(response)`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @flipt-io/flipt | Provides the FliptApiClient for interacting with the Flipt server. |
| uuid | Used for generating UUIDs for entity IDs. |

## Error Handling
The code includes basic error handling by catching potential errors during feature flag evaluation and logging them to the console. This prevents the API route from crashing and provides some level of error reporting.

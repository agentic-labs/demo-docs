---
title: "docker-compose.yml"
---

## High-level description
This `docker-compose.yml` file defines a multi-container Docker application for running a Next.js application that integrates with Flipt feature flags. It sets up three services: `next` for the Next.js app, `flipt` for the Flipt server, and `init` for initializing Flipt with data.

## Code Structure
The `docker-compose.yml` file uses a YAML configuration to define three services: `next`, `init`, and `flipt`. The `next` service depends on the `flipt` service, and the `flipt` service depends on the `init` service. This ensures that Flipt is initialized with data before it starts and that the Next.js application can connect to Flipt. The services communicate with each other through a shared network called `flipt_network`.

## Symbols
### `version`
#### Description
Specifies the Docker Compose file format version.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `services`
#### Description
Defines the services that make up the application.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `next`
#### Description
Defines the Next.js application service.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
- Builds the Next.js application from the current directory.
- Runs the `npm run dev` command to start the development server.
- Exposes port 3000 for accessing the application.
- Sets environment variables for the Flipt server address.
- Depends on the `flipt` service to ensure it starts after Flipt is running.
- Connects to the `flipt_network` network.

### `init`
#### Description
Defines the Flipt initialization service.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
- Uses the `flipt/flipt:latest` Docker image.
- Runs the `./flipt import flipt.yml` command to import feature flag data from `flipt.yml`.
- Sets environment variables for logging and telemetry.
- Mounts the `flipt.yml` file from the host machine to the container.
- Mounts the `flipt_data` volume to persist Flipt data.

### `flipt`
#### Description
Defines the Flipt server service.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
- Uses the `flipt/flipt:latest` Docker image.
- Runs the `./flipt --force-migrate` command to start the Flipt server and force database migrations.
- Depends on the `init` service to ensure Flipt is initialized before starting.
- Exposes port 8080 for accessing the Flipt API.
- Sets environment variables for logging, telemetry, and CORS.
- Mounts the `flipt_data` volume to persist Flipt data.
- Connects to the `flipt_network` network.

### `volumes`
#### Description
Defines named volumes for data persistence.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `flipt_data`
#### Description
A named volume for persisting Flipt data.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `networks`
#### Description
Defines networks for service communication.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `flipt_network`
#### Description
A user-defined bridge network for communication between services.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

---
title: "Overview"
---

## High-level description
This directory contains test files for an RPC (Remote Procedure Call) system implemented using a custom framework called fRPC (Frisbee RPC). The code includes unit tests, server implementations for testing, and generated code for the RPC service. The main components are test implementations of an Echo service with various RPC patterns, including synchronous requests, bi-directional streaming, server streaming, and client streaming.

## What does it do?
The code in this directory serves several purposes:

1. It provides a comprehensive test suite for the RPC system, covering different communication patterns:
   - Synchronous request-response
   - Bi-directional streaming
   - Server streaming
   - Client streaming

2. It implements a test server (svc struct) that handles these various RPC methods, allowing the system to verify the correctness of both client and server-side operations.

3. It includes generated code (test.frpc.go) that defines the structure and methods for the RPC service, including message types, serialization/deserialization, and client/server implementations.

The workflow typically involves setting up a client-server pair, initiating various types of RPC calls, and verifying that the messages are correctly sent, received, and processed on both ends. This ensures that the RPC system can handle different communication patterns reliably and efficiently.

## Key Files

1. generator_test.go:
   - Contains the main test function `TestRPC` and sub-tests for different RPC patterns.
   - Sets up the client-server environment for testing.
   - Implements test cases for synchronous, bi-directional, server streaming, and client streaming RPC calls.

2. server.go:
   - Defines the `svc` struct, which implements the server-side logic for the RPC methods being tested.
   - Includes implementations for `Echo`, `EchoStream`, `Search`, and `Upload` methods.
   - Contains assertions to verify the correctness of incoming requests and outgoing responses.

3. test.frpc.go:
   - Generated code for the fRPC implementation.
   - Defines message types (Request, Response, Data, etc.) and their serialization/deserialization methods.
   - Implements server and client structures for the EchoService.
   - Provides functions for creating new server and client instances.

These files work together to create a comprehensive testing environment for the RPC system. The generated code in test.frpc.go provides the underlying structure and communication mechanisms, while server.go implements the actual logic for handling RPC calls. Finally, generator_test.go uses these components to run a series of tests that verify the correct functioning of the entire system.

## Dependencies
The code relies on several external libraries and frameworks:

1. github.com/loopholelabs/testing/conn/pair: Used for creating client-server connection pairs in tests.
2. github.com/stretchr/testify/assert: Provides test assertion functions for more readable and informative test cases.
3. github.com/loopholelabs/polyglot/v2: Used for serialization and deserialization of messages.
4. github.com/loopholelabs/frisbee-go: The underlying network communication framework for the RPC system.
5. github.com/rs/zerolog: Used for logging purposes in the generated code.
6. go.uber.org/atomic: Provides atomic operations for handling concurrency in the RPC implementation.

These dependencies were chosen to provide robust testing capabilities, efficient network communication, and reliable message serialization for the RPC system.

The code uses Go's standard library packages such as `context`, `io`, and `testing` for core functionality related to context management, I/O operations, and testing infrastructure.
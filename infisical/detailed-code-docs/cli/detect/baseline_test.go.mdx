---
title: "baseline_test.go"
---

## High-level description
This file contains unit tests for the baseline functionality in the detect package. It tests various aspects of baseline detection, including identifying new findings, loading baseline files, and ignoring issues that are already in the baseline.

## Symbols

### `TestIsNew`
#### Description
This function tests the `IsNew` function, which determines whether a finding is new compared to a baseline.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| t | *testing.T | Testing object for running tests and making assertions |

#### Internal Logic
1. Defines a slice of test cases, each containing a finding, a baseline, and an expected result.
2. Iterates through the test cases.
3. For each case, calls `IsNew` with the finding and baseline, and asserts that the result matches the expected value.

### `TestFileLoadBaseline`
#### Description
This function tests the `LoadBaseline` function, focusing on error handling for unsupported file formats and non-existent files.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| t | *testing.T | Testing object for running tests and making assertions |

#### Internal Logic
1. Defines a slice of test cases, each containing a filename and an expected error.
2. Iterates through the test cases.
3. For each case, calls `LoadBaseline` with the filename and asserts that the returned error matches the expected error.

### `TestIgnoreIssuesInBaseline`
#### Description
This function tests the behavior of ignoring issues that are already present in the baseline.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| t | *testing.T | Testing object for running tests and making assertions |

#### Internal Logic
1. Defines a slice of test cases, each containing a list of findings, a baseline, and an expected count of remaining findings.
2. Iterates through the test cases.
3. For each case:
   - Creates a new detector with default configuration.
   - Sets the baseline for the detector.
   - Adds each finding to the detector.
   - Asserts that the number of findings in the detector matches the expected count.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| testing | Provides testing functionality |
| errors | Used for creating error objects |
| github.com/stretchr/testify/assert | Provides assertion functions for tests |
| github.com/Infisical/infisical-merge/report | Imports the `Finding` type used in the tests |

## References
The tests reference the following functions from the `detect` package:
- `IsNew`
- `LoadBaseline`
- `NewDetectorDefaultConfig`

These functions are not defined in this file but are assumed to be implemented in other files within the `detect` package.

Note: The actual implementation of these functions is not provided in this file, as it focuses on testing their behavior.
---
title: "location.go"
---

## High-level description
This code defines a `Location` struct and a `location` function in the `detect` package. The purpose is to represent and calculate the precise location of a matched fragment within a file, including start and end lines and columns.

## Symbols

### `Location`
#### Description
`Location` is a struct that represents a specific location in a file. It contains fields for start and end lines, columns, and line indices.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| startLine | int | The starting line number |
| endLine | int | The ending line number |
| startColumn | int | The starting column number |
| endColumn | int | The ending column number |
| startLineIndex | int | The byte index of the start of the line |
| endLineIndex | int | The byte index of the end of the line |

### `location`
#### Description
The `location` function calculates the precise location of a matched fragment within a file.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fragment | Fragment | The fragment of text being analyzed |
| matchIndex | []int | The start and end indices of the match within the fragment |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| location | Location | The calculated location of the match |

#### Internal Logic
1. Initialize variables and set default values.
2. Handle the case where the fragment has no newlines by creating a default newline index.
3. Iterate through newline indices in the fragment:
   - Determine the start line and column when the start index is found.
   - Determine the end line and column when the end index is found.
4. Handle the case where the match is on the last line without a newline.
5. Return the calculated location.

## Side Effects
This function does not have any side effects. It purely calculates and returns a `Location` based on the input fragment and match indices.

## Performance Considerations
The function iterates through the newline indices of the fragment, which could be potentially slow for very large fragments with many lines. However, for typical use cases, this should not be a significant performance concern.

## Error Handling
The code does not implement explicit error handling. It assumes that the input fragment and match indices are valid.

## TODOs
There is a comment referencing a GitHub issue that was fixed:
```
// Fixes: https://github.com/zricethezav/gitleaks/issues/1037
```
This comment indicates that the code addresses a specific issue related to fragments without newlines.
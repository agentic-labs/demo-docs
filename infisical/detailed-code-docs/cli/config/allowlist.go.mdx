---
title: "allowlist.go"
---

## High-level description
This file defines an `Allowlist` struct and associated methods for managing exceptions in a security or content filtering system. It provides functionality to check if certain commits, paths, or content matches are allowed to be ignored based on predefined rules.

## Code Structure
The code defines the `Allowlist` struct and four methods that operate on it: `CommitAllowed`, `PathAllowed`, `RegexAllowed`, and `ContainsStopWord`. These methods check different aspects of the allowlist against input values.

## Symbols

### `Allowlist`
#### Description
A struct that represents a set of rules for allowing certain content, paths, or commits to be ignored in a security or filtering context.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Description | string | A short human-readable description of the allowlist |
| Regexes | []*regexp.Regexp | Slice of content regular expressions that are allowed to be ignored |
| RegexTarget | string | Target for the regular expressions (purpose not clear from the code) |
| Paths | []*regexp.Regexp | Slice of path regular expressions that are allowed to be ignored |
| Commits | []string | Slice of commit SHAs that are allowed to be ignored |
| StopWords | []string | Slice of stop words that are allowed to be ignored (targets the secret, not the content) |

### `CommitAllowed`
#### Description
Checks if a given commit SHA is in the list of allowed commits.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| c | string | The commit SHA to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (unnamed) | bool | True if the commit is allowed, false otherwise |

#### Internal Logic
1. If the input commit is empty, return false.
2. Iterate through the list of allowed commits.
3. If a match is found, return true.
4. If no match is found, return false.

### `PathAllowed`
#### Description
Checks if a given path matches any of the allowed path regular expressions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| path | string | The path to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (unnamed) | bool | True if the path is allowed, false otherwise |

#### Internal Logic
Calls the `anyRegexMatch` function (not defined in this file) with the path and the list of allowed path regexes.

### `RegexAllowed`
#### Description
Checks if a given string matches any of the allowed content regular expressions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| s | string | The string to check |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (unnamed) | bool | True if the string matches an allowed regex, false otherwise |

#### Internal Logic
Calls the `anyRegexMatch` function (not defined in this file) with the input string and the list of allowed content regexes.

### `ContainsStopWord`
#### Description
Checks if a given string contains any of the defined stop words.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| s | string | The string to check for stop words |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (unnamed) | bool | True if the string contains a stop word, false otherwise |

#### Internal Logic
1. Convert the input string to lowercase.
2. Iterate through the list of stop words.
3. Convert each stop word to lowercase and check if it's contained in the input string.
4. If a match is found, return true.
5. If no match is found, return false.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| regexp | Used for working with regular expressions |
| strings | Used for string manipulation and comparison |

## Notes
1. The `anyRegexMatch` function is used in `PathAllowed` and `RegexAllowed` methods but is not defined in this file. It's likely defined elsewhere in the package.
2. The purpose of the `RegexTarget` field in the `Allowlist` struct is not clear from the code and is not used in any of the methods.
3. The code uses case-insensitive comparison for stop words by converting both the input string and stop words to lowercase before checking.
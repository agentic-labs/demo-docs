---
title: "Overview"
---

## High-level description
The `cli/testdata` directory contains various test data and configuration files used for testing and validating the functionality of Gitleaks, a tool designed to detect and prevent secrets in code repositories. This directory includes baseline data for secret detection tests, configuration files for Gitleaks, expected output files for secret scanning reports, and sample repositories with intentional security risks for testing purposes.

## What does it do?
The contents of this directory serve multiple purposes in the context of testing and configuring Gitleaks:

1. Provide baseline data for secret detection tests, including examples of detected PyPI upload tokens.
2. Define various configuration scenarios for Gitleaks, including rules for detecting different types of secrets, allowlists, and entropy-based filtering.
3. Offer expected output templates for secret scanning reports, both for scenarios where no secrets are detected and when a single secret is found.
4. Include sample Go repositories with intentional security risks to test Gitleaks' detection capabilities in different scenarios.

These components collectively enable comprehensive testing of Gitleaks' functionality, from configuration and detection rules to output formatting and handling of various secret types and edge cases.

## Key Files

1. `baseline/baseline.json`: Contains baseline data for secret detection tests, specifically PyPI upload tokens.

2. `config/*.toml`: Various TOML configuration files for Gitleaks, defining rules, allowlists, and settings for secret detection across different platforms and services.

3. `expected/*.json`: JSON files representing expected outputs for secret scanning reports, including an empty report and a simple report with a single detected secret.

4. `repos/`: Directory containing small Go projects used as test repositories for Gitleaks, including intentional security risks for testing purposes.

## Configuration
The configuration files in the `config/` directory use the TOML format and typically include the following key elements:

1. `title`: Description of the configuration's purpose.
2. `rules`: Array of rule definitions for detecting specific types of secrets.
3. `allowlist`: Definitions for patterns or files to be excluded from secret detection.
4. `extend`: Used to include additional configuration files.

These configurations allow fine-tuning of Gitleaks' behavior, balancing comprehensive secret detection with minimizing false positives.

## Dependencies
While not explicitly stated, the test data and configurations in this directory are designed to work with Gitleaks, a secret scanning tool. The exact version of Gitleaks is not specified in the provided information.

In summary, the `cli/testdata` directory plays a crucial role in testing, configuring, and validating the Gitleaks tool. It provides a comprehensive set of test cases, configurations, and sample data to ensure the tool's effectiveness in detecting secrets across various scenarios and project structures.
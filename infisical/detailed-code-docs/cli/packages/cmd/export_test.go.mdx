---
title: "export_test.go"
---

## High-level description
This file contains unit tests for the `formatAsYaml` function, which is responsible for converting a slice of environment variables into a YAML-formatted string. The tests cover various scenarios, including empty input, single and multiple variables, duplicate keys, and special characters in values.

## Symbols

### `TestFormatAsYaml`
#### Description
This function is a test suite for the `formatAsYaml` function. It uses table-driven tests to verify the correct formatting of environment variables into YAML.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| t | *testing.T | The testing object provided by Go's testing framework |

#### Internal Logic
1. Defines a slice of test cases, each containing a name, input (slice of `SingleEnvironmentVariable`), and expected output (YAML string).
2. Iterates through each test case:
   a. Calls `formatAsYaml` with the input.
   b. Asserts that no error occurred.
   c. Compares the result with the expected output.
   d. Parses the result back into a map to ensure it's valid YAML.
   e. Creates an expected map from the input for comparison.
   f. Compares the parsed result map with the expected map.

The test cases cover:
- Empty input
- Single environment variable
- Multiple environment variables
- Overwriting duplicate keys
- Special characters in values (spaces, colons, newlines)

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| testing | Go's built-in testing framework |
| github.com/Infisical/infisical-merge/packages/models | Provides the `SingleEnvironmentVariable` model |
| github.com/stretchr/testify/assert | Assertion library for more expressive tests |
| gopkg.in/yaml.v2 | YAML parsing and encoding library |

## Error Handling
The test function uses `assert.NoError` to check if any errors occur during the execution of `formatAsYaml` or when unmarshaling the result back into a map.
---
title: "vault.go"
---

## High-level description
This code defines the `vault` command for the Infisical CLI, which manages where the user's Infisical login token is stored on their machine. It provides functionality to list available vault backends and set a specific vault backend type.

## Code Structure
The code defines two main commands: `vaultCmd` and `vaultSetCmd`. These commands are part of a larger CLI structure, likely using the Cobra library for command-line interface creation. The `vaultCmd` displays available vault backends, while `vaultSetCmd` allows users to change the current vault backend.

## Symbols

### `VaultBackendType`
#### Description
A struct that represents a vault backend type with a name and description.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Name | string | The name of the vault backend type |
| Description | string | A brief description of the vault backend type |

### `AvailableVaults`
#### Description
A slice of `VaultBackendType` that defines the available vault backend types.

### `vaultSetCmd`
#### Description
A Cobra command that allows users to set the vault backend type.

#### Internal Logic
1. Retrieves the current vault backend
2. Checks if the requested vault type is already in use
3. If the requested type is valid, updates the configuration file with the new vault type
4. Generates a new random passphrase for the vault backend
5. Logs telemetry data about the vault change

### `vaultCmd`
#### Description
A Cobra command that displays information about available vault backends and the currently used backend.

#### Internal Logic
Calls `printAvailableVaultBackends()` to display information about available vault backends and the current backend in use.

### `printAvailableVaultBackends()`
#### Description
A function that prints information about available vault backends and the currently used backend.

#### Internal Logic
1. Prints a list of available vault backends with their names and descriptions
2. Retrieves and displays the current vault backend in use
3. Logs telemetry data about the vault command execution

### `init()`
#### Description
Initializes the command structure by adding `vaultSetCmd` as a subcommand of `vaultCmd`, and adding `vaultCmd` to the root command.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| github.com/Infisical/infisical-merge/packages/util | Provides utility functions for configuration and vault operations |
| github.com/posthog/posthog-go | Used for telemetry and event tracking |
| github.com/rs/zerolog/log | Logging library |
| github.com/spf13/cobra | Command-line interface framework |

## Error Handling
The code uses the zerolog library for error logging. Errors are logged with appropriate error messages and the operation is typically aborted when an error occurs.

## Logging
The code uses the zerolog library for logging. Error messages are logged using `log.Error().Msgf()`.

## Telemetry
The code uses the PostHog library for telemetry. Events are captured for the `vault` and `vault set` commands, including information about the current and requested vault types, and the CLI version.
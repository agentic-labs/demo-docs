---
title: "util.go"
---

## High-level description
This file contains utility functions for the Secure Remote Password (SRP) protocol implementation in Go. It provides helper functions for padding, hashing, and converting between different data types (bytes, integers, and hexadecimal strings) commonly used in cryptographic operations.

## Symbols

### `padTo`
#### Description
Pads a byte slice to a specified length by adding leading zero bytes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| bytes | []byte | The input byte slice to be padded |
| length | int | The desired total length of the padded slice |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| paddedBytes | []byte | The padded byte slice |

#### Internal Logic
1. Calculate the required padding length
2. Create a new byte slice with the required padding
3. Append the original bytes to the padding and return the result

### `padToN`
#### Description
Pads a big integer to the length of the SRP parameter N in bytes.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| number | *big.Int | The big integer to be padded |
| params | *SRPParams | The SRP parameters containing NLengthBits |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| paddedBytes | []byte | The padded byte representation of the number |

#### Internal Logic
Calls `padTo` with the byte representation of the number and the calculated byte length of N.

### `hashToBytes`
#### Description
Converts a hash.Hash to a byte slice.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| h | hash.Hash | The hash object to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| bytes | []byte | The byte slice representation of the hash |

### `hashToInt`
#### Description
Converts a hash.Hash to a big integer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| h | hash.Hash | The hash object to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| U | *big.Int | The big integer representation of the hash |

#### Internal Logic
1. Convert the hash to bytes using `hashToBytes`
2. Create a new big integer and set its value from the bytes

### `intFromBytes`
#### Description
Converts a byte slice to a big integer.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| bytes | []byte | The byte slice to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| i | *big.Int | The big integer representation of the bytes |

### `intToBytes`
#### Description
Converts a big integer to a byte slice.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| i | *big.Int | The big integer to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| bytes | []byte | The byte slice representation of the big integer |

### `bytesFromHexString`
#### Description
Converts a hexadecimal string to a byte slice, removing any non-hexadecimal characters.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| s | string | The hexadecimal string to convert |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| b | []byte | The byte slice representation of the hexadecimal string |

#### Internal Logic
1. Use a regular expression to remove non-hexadecimal characters
2. Decode the cleaned hexadecimal string to bytes

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| encoding/hex | For decoding hexadecimal strings |
| hash | For working with hash functions |
| math/big | For big integer operations |
| regexp | For regular expression matching |

These utility functions are essential for the SRP protocol implementation, providing necessary conversions and manipulations of cryptographic data. They handle padding, hashing, and various data type conversions commonly used in cryptographic operations.
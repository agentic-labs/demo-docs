---
title: "model.go"
---

## High-level description
This Go file defines various data structures used for API requests and responses in a secure authentication and secret management system. It includes structures for login processes, secret retrieval, workspace management, and service token operations.

## Code Structure
The file contains multiple struct definitions, each representing a specific request or response type for different API endpoints. These structs are organized based on their functionality, such as login, secret management, workspace operations, and service token handling.

## Symbols

### LoginOneRequest
#### Description
Represents the request structure for the first step of a login process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Email | string | User's email address |
| ClientPublicKey | string | Client's public key for secure communication |

### LoginOneResponse
#### Description
Represents the response structure for the first step of a login process.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ServerPublicKey | string | Server's public key for secure communication |
| ServerSalt | string | Salt used for password hashing |

### LoginTwoRequest
#### Description
Represents the request structure for the second step of a login process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Email | string | User's email address |
| ClientProof | string | Proof of client's identity |

### LoginTwoResponse
#### Description
Represents the response structure for the second step of a login process.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| JTWToken | string | JSON Web Token for authentication |
| RefreshToken | string | Token used to refresh the JWT |
| PublicKey | string | User's public key |
| EncryptedPrivateKey | string | User's encrypted private key |
| IV | string | Initialization vector for encryption |
| Tag | string | Authentication tag for encryption |

### PullSecretsRequest
#### Description
Represents the request structure for retrieving secrets.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Environment | string | The environment for which secrets are requested |

### PullSecretsResponse
#### Description
Represents the response structure for retrieving secrets, including encrypted secret data and workspace key information.

### Secret
#### Description
Represents the structure of an encrypted secret.

### RawSecret
#### Description
Represents the structure of a decrypted (raw) secret.

### GetEncryptedWorkspaceKeyRequest
#### Description
Represents the request structure for retrieving an encrypted workspace key.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| WorkspaceId | string | ID of the workspace |

### GetEncryptedWorkspaceKeyResponse
#### Description
Represents the response structure for retrieving an encrypted workspace key, including sender information and encryption details.

### CreateServiceTokenRequest
#### Description
Represents the request structure for creating a service token.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Name | string | Name of the service token |
| WorkspaceId | string | ID of the workspace |
| Scopes | []ScopePermission | Permissions scopes for the token |
| ExpiresIn | int | Token expiration time |
| EncryptedKey | string | Encrypted key for the token |
| Iv | string | Initialization vector |
| Tag | string | Authentication tag |
| RandomBytes | string | Random bytes for additional security |
| Permissions | []string | List of permissions |

### CreateServiceTokenResponse
#### Description
Represents the response structure for creating a service token, including the token itself and associated data.

## Dependencies
This file does not explicitly import external libraries, but it uses the `time` package from the Go standard library for handling timestamps.

## Error Handling
This file primarily defines data structures and does not implement error handling directly. Error handling would typically be implemented in the functions that use these structures.

## API/Interface Reference
This file defines the structure for various API requests and responses, but does not implement the API endpoints themselves. The structures defined here would be used by the actual API implementation to ensure type safety and consistent data formatting.
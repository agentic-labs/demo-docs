---
title: "knex.d.ts"
---

## High-level description
This file, `knex.d.ts`, is a TypeScript declaration file that extends the Knex.js library's type definitions. It defines custom table types for a database schema, including various entities such as users, organizations, projects, secrets, and more. This file ensures type safety when working with database operations using Knex.js in the application.

## Code Structure
The file imports types from various schema files and extends the Knex namespace to include these custom table types. It also adds custom methods to the QueryInterface.

## Symbols

### `declare module "knex"`
#### Description
This module declaration extends the Knex namespace to add custom methods to the QueryInterface.

#### Internal Logic
It adds two methods:
- `primaryNode()`: Returns a KnexOriginal instance for primary node operations.
- `replicaNode()`: Returns a KnexOriginal instance for replica node operations.

### `declare module "knex/types/tables"`
#### Description
This module declaration extends the Tables interface in Knex to include custom table types for the application's database schema.

#### Internal Logic
It defines a large number of table types, each corresponding to a specific entity in the database. These types use the `KnexOriginal.CompositeTableType` to define the structure of each table, including insert and update types.

## Dependencies
The file imports types from numerous local schema files, such as:
- `@app/db/schemas`
- `@app/db/schemas/secret-v2-tag-junction`
- `@app/db/schemas/secret-versions-v2`
- `@app/db/schemas/secrets-v2`

## Configuration
This file doesn't define configuration options directly, but it sets up the type system for database operations, which indirectly affects how the application interacts with the database.

## Notes
1. This file is crucial for maintaining type safety when working with database operations in the application.
2. It covers a wide range of entities, suggesting a complex database schema with many interconnected tables.
3. The use of `CompositeTableType` allows for different types for insert and update operations, which can be useful for enforcing certain constraints or defaults.
4. The file includes both v1 and v2 versions of some tables (e.g., secrets), indicating that there might be ongoing schema migrations or updates in the application.
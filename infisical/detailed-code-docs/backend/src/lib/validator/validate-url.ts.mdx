---
title: "validate-url.ts"
---

## High-level description
This code defines a function `validateLocalIps` that checks if a given URL is a local IP address or localhost. It throws a `BadRequestError` if the URL is local, considering cloud environment restrictions.

## References
- `getConfig`: This function is imported from `../config/env` and is used to retrieve the application configuration.
- `BadRequestError`: This class is imported from `../errors` and is used to throw an error if the URL is invalid.

## Symbols

### `validateLocalIps`
#### Description
This function validates if a given URL is a local IP address or localhost. It throws a `BadRequestError` if the URL is local, considering cloud environment restrictions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| url | string | The URL to validate. |

#### Outputs
This function does not return any value.

#### Internal Logic
1. Creates a new `URL` object from the input `url`.
2. Retrieves the application configuration using `getConfig()`.
3. Checks if the application is running in a cloud environment (`appCfg.isCloud`).
4. If in a cloud environment, checks if the URL host is:
    - "host.docker.internal"
    - Matches the regular expression for a private IP address in the 10.0.0.0 - 10.255.255.255 range.
    - Matches the regular expression for a private IP address in the 192.168.0.0 - 192.168.255.255 range.
5. If any of the above conditions are true, throws a `BadRequestError` with the message "Local IPs not allowed as URL".
6. Checks if the URL host is "localhost" or "127.0.0.1".
7. If true, throws a `BadRequestError` with the message "Localhost not allowed".

## Error Handling
This function throws a `BadRequestError` if the provided URL is a local IP address or localhost.

## Dependencies
This code depends on the following:
| Dependency | Purpose |
|:-----------|:--------|
| getConfig | Retrieves the application configuration. |
| BadRequestError | Throws an error if the URL is invalid. |

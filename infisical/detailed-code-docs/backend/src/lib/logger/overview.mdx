---
title: "Overview"
---

## High-level description
This directory contains the implementation of a logging system for the backend of the application. It utilizes the Pino logging library to create a configurable, singleton logger instance that can output logs to the console and optionally to AWS CloudWatch Logs. The logger is designed to be easily initialized and used throughout the application, with built-in features for redacting sensitive information from log messages.

## What does it do?
The logging system in this directory provides a centralized way to record and manage log messages across the application. It allows developers to:

1. Initialize a logger with custom configurations, including log level and output destinations.
2. Log messages at various levels (e.g., debug, info, error) using a consistent interface.
3. Automatically format log messages to include additional context such as process ID and hostname.
4. Redact sensitive information from log messages to enhance security.
5. Optionally send logs to AWS CloudWatch Logs for centralized log management and analysis.

This logging system helps developers track application behavior, diagnose issues, and monitor performance in both development and production environments.

## Entry points
The main entry point for this logging system is the `index.ts` file, which exports two key functions:

1. `initLogger`: This function is used to initialize the logger with the desired configuration.
2. `logger`: This is the main logging function used throughout the application to record log messages.

The actual implementation of these functions is contained in the `logger.ts` file. The `index.ts` file serves as a convenient interface for other parts of the application to access the logging functionality without needing to know the details of the implementation.

## Key Files
1. `logger.ts`: This is the core file of the logging system. It contains the implementation of the `initLogger` function and the creation of the `logger` instance. Key features of this file include:
   - Configuration of the Pino logger with custom formatters and redaction rules.
   - Integration with AWS CloudWatch Logs when appropriate environment variables are set.
   - Definition of a schema for parsing and validating environment variables used for logger configuration.

2. `index.ts`: This file acts as the public interface for the logging system, exporting the `initLogger` and `logger` functions from `logger.ts`.

## Dependencies
The logging system relies on the following external libraries:

1. Pino (version not specified): A very low overhead Node.js logger. It was likely chosen for its performance and flexibility.

2. Zod (version not specified): A TypeScript-first schema declaration and validation library. It's used here to parse and validate environment variables, ensuring type safety and proper configuration.

3. @serdnam/pino-cloudwatch-transport (version not specified): A Pino transport for sending logs to AWS CloudWatch Logs. This allows for easy integration with AWS services for centralized log management.

## Configuration
The logger can be configured using the following environment variables:

- `AWS_CLOUDWATCH_LOG_GROUP_NAME`: The name of the CloudWatch log group (default: `infisical-log-stream`).
- `AWS_CLOUDWATCH_LOG_REGION`: The AWS region for CloudWatch logs (default: `us-east-1`).
- `AWS_CLOUDWATCH_LOG_ACCESS_KEY_ID`: The AWS access key ID for CloudWatch logs (optional).
- `AWS_CLOUDWATCH_LOG_ACCESS_KEY_SECRET`: The AWS secret access key for CloudWatch logs (optional).
- `AWS_CLOUDWATCH_LOG_INTERVAL`: The interval in milliseconds for sending logs to CloudWatch (default: `1000`).
- `NODE_ENV`: The environment for the application (default: `production`).
- `PINO_LOG_LEVEL`: The minimum log level to output (default: `info`).

The logger also includes a list of redacted keys to ensure sensitive information is not logged:

```typescript
const redactedKeys = [
  "password",
  "token",
  "refreshToken",
  "authorization",
  "cookie",
  "jwt",
  "key",
  "accessKey",
  "secretKey",
  "secret",
  "x-api-key",
];
```

These keys will be automatically redacted from any log messages to enhance security.

The `initLogger` function sets up the logger with these configurations, creating a powerful and flexible logging system that can be easily used throughout the application.
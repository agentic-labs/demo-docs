---
title: "Overview"
---

## High-level description
This directory contains a comprehensive set of cryptographic functions and utilities for secure data handling, encryption, decryption, and authentication. It implements various encryption algorithms, including symmetric (AES-256-GCM) and asymmetric (TweetNaCl) encryption, as well as the Secure Remote Password (SRP) protocol for user authentication.

## What does it do?
The crypto library provides a range of security-related functionalities:

1. Symmetric Encryption: It offers functions to encrypt and decrypt data using AES-256-GCM, which is suitable for securing sensitive information like secrets and configuration data.

2. Asymmetric Encryption: The library implements asymmetric encryption using TweetNaCl, allowing secure communication between parties without sharing a common secret key.

3. Hashing: It provides functions for generating cryptographic hashes, useful for data integrity checks and password hashing.

4. Digital Signatures: The library includes functionality to verify digital signatures, which is crucial for ensuring the authenticity of data or licenses.

5. Secure Remote Password (SRP) Protocol: It implements the SRP protocol, providing a secure way for user authentication without transmitting passwords over the network.

6. Key Management: The library offers functions for generating, encrypting, and managing various types of cryptographic keys, including symmetric keys, asymmetric key pairs, and user-specific project keys.

7. Secret Management: It provides specialized functions for encrypting and decrypting various types of secrets, including individual secrets, secret versions, and secret approvals.

8. Blind Indexing: The library implements a blind indexing mechanism for secrets, allowing secure searchable encryption.

These functionalities work together to provide a robust security layer for the application, ensuring that sensitive data is protected both at rest and in transit.

## Entry points
The main entry point for this crypto library is the `index.ts` file, which re-exports functions from various specialized modules:

1. `encryption.ts`: Contains general-purpose encryption and decryption functions.
2. `secret-encryption.ts`: Provides functions specifically for encrypting and decrypting secrets and related data.
3. `signing.ts`: Contains functions for verifying digital signatures.
4. `srp.ts`: Implements functions for the Secure Remote Password (SRP) protocol.

Developers should start by importing the required functions from the `index.ts` file. For more specific or advanced use cases, they may need to directly use the specialized modules.

## Key Files

1. `cipher/cipher.ts`: Implements a symmetric cipher service using the Node.js `crypto` module, providing a flexible interface for encryption and decryption operations.

2. `encryption.ts`: Contains a wide range of encryption-related functions, including symmetric and asymmetric encryption, key generation, and hashing.

3. `secret-encryption.ts`: Focuses on encrypting and decrypting various types of secrets, including individual secrets, secret versions, and secret approvals.

4. `signing.ts`: Provides functionality for verifying digital signatures, including a specialized function for verifying offline licenses.

5. `srp.ts`: Implements the Secure Remote Password (SRP) protocol, offering functions for user authentication and key management.

## Dependencies
The crypto library relies on several external libraries and Node.js built-in modules:

1. `node:crypto`: The built-in Node.js cryptographic module, used for various cryptographic operations.
2. `argon2`: Used for password hashing and key derivation.
3. `tweetnacl` and `tweetnacl-util`: Provide implementations for asymmetric encryption and utility functions.
4. `jsrp`: Implements the Secure Remote Password (SRP) protocol.
5. `zod`: Used for data validation in secret decryption processes.

These dependencies were chosen to provide a balance of security, performance, and ease of use. The use of well-established libraries like `argon2` and `tweetnacl` ensures that the cryptographic operations are implemented according to best practices and current security standards.

## Configuration
The crypto library does not use external configuration files. However, it does rely on environment variables for some operations:

- `ROOT_ENCRYPTION_KEY`: Used as the primary encryption key for symmetric encryption operations.
- `ENCRYPTION_KEY`: Used as a fallback encryption key when `ROOT_ENCRYPTION_KEY` is not available.

These environment variables should be securely set and managed in the application's deployment environment.

The library is designed to be flexible, allowing the choice of encryption algorithms and key sizes at runtime in many cases. This flexibility enables the application to adapt to different security requirements or regulatory standards as needed.
---
title: "org-permission.ts"
---

## High-level description
This code defines enums for organization permission actions, admin console actions, and subjects. It also defines permission sets for different organization roles (admin, member, no access) using the CASL (Control Access Based on Roles) library. These permission sets are used to determine what actions a user can perform on different organization resources.

## Code Structure
The code defines several enums for actions, admin console actions, and subjects related to organization permissions. It then defines a type `OrgPermissionSet` which is a union of tuples representing different permission combinations. Finally, it defines three constants `orgAdminPermissions`, `orgMemberPermissions`, and `orgNoAccessPermissions` which are instances of `MongoAbility` initialized with different permission sets.

## Symbols

### `OrgPermissionActions`
#### Description
Enum defining actions that can be performed on organization resources.

#### Inputs
N/A - This is an enum, not a function.

#### Outputs
N/A - This is an enum, not a function.

#### Internal Logic
N/A - This is an enum, not a function.

### `OrgPermissionAdminConsoleAction`
#### Description
Enum defining actions specific to the organization admin console.

#### Inputs
N/A - This is an enum, not a function.

#### Outputs
N/A - This is an enum, not a function.

#### Internal Logic
N/A - This is an enum, not a function.

### `OrgPermissionSubjects`
#### Description
Enum defining the resources (subjects) within an organization that permissions can be applied to.

#### Inputs
N/A - This is an enum, not a function.

#### Outputs
N/A - This is an enum, not a function.

#### Internal Logic
N/A - This is an enum, not a function.

### `OrgPermissionSet`
#### Description
A type alias representing a set of permissions. It's a union of tuples where each tuple represents a specific permission: `[action, subject]`.

#### Inputs
N/A - This is a type alias, not a function.

#### Outputs
N/A - This is a type alias, not a function.

#### Internal Logic
N/A - This is a type alias, not a function.

### `buildAdminPermission`
#### Description
Function to build the permission set for an organization admin.

#### Inputs
N/A

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (anonymous) | MongoAbility\&lt;OrgPermissionSet\&gt; | An instance of `MongoAbility` configured with admin permissions. |

#### Internal Logic
1. Creates a new `AbilityBuilder` instance with `createMongoAbility`.
2. Defines permissions for various organization resources (workspace, role, member, settings, incident account, SSO, SCIM, LDAP, groups, secret scanning, billing, identity, KMS, admin console) using `can` method.
3. Builds and returns the `MongoAbility` instance with the defined permissions and `conditionsMatcher`.

### `orgAdminPermissions`
#### Description
A constant holding the pre-built `MongoAbility` instance with admin permissions.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `buildMemberPermission`
#### Description
Function to build the permission set for a regular organization member.

#### Inputs
N/A

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (anonymous) | MongoAbility\&lt;OrgPermissionSet\&gt; | An instance of `MongoAbility` configured with member permissions. |

#### Internal Logic
1. Creates a new `AbilityBuilder` instance with `createMongoAbility`.
2. Defines read and limited create/edit/delete permissions for various organization resources using `can` method.
3. Builds and returns the `MongoAbility` instance with the defined permissions and `conditionsMatcher`.

### `orgMemberPermissions`
#### Description
A constant holding the pre-built `MongoAbility` instance with member permissions.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

### `buildNoAccessPermission`
#### Description
Function to build an empty permission set, representing no access to organization resources.

#### Inputs
N/A

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (anonymous) | MongoAbility\&lt;OrgPermissionSet\&gt; | An instance of `MongoAbility` with no permissions defined. |

#### Internal Logic
1. Creates a new `AbilityBuilder` instance with `createMongoAbility`.
2. Builds and returns the `MongoAbility` instance with no permissions defined and `conditionsMatcher`.

### `orgNoAccessPermissions`
#### Description
A constant holding the pre-built `MongoAbility` instance with no permissions defined.

#### Inputs
N/A

#### Outputs
N/A

#### Internal Logic
N/A

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @casl/ability | Provides the core functionality for defining and checking permissions using the CASL library. |
| @app/lib/casl | Likely contains custom conditions matchers used by the CASL library for more complex permission checks. |


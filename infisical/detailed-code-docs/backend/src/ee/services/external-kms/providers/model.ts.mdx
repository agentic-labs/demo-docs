---
title: "model.ts"
---

## High-level description
This TypeScript file defines data models and schemas for external Key Management Service (KMS) providers, specifically focusing on AWS. It uses the Zod library for schema validation and type inference, providing a structured way to handle KMS-related configurations and operations.

## Code Structure
The code defines enums, schemas, and types related to KMS providers and AWS credentials. It also includes a generic type for KMS provider functions. The main components are interconnected through the use of Zod schemas and TypeScript type inference.

## Symbols

### `KmsProviders`
#### Description
An enum that defines the available KMS providers. Currently, it only includes AWS.

### `KmsAwsCredentialType`
#### Description
An enum that defines the types of AWS credentials: AssumeRole and AccessKey.

### `ExternalKmsAwsSchema`
#### Description
A Zod schema that defines the structure for AWS KMS configuration.

#### Internal Logic
The schema includes:
1. A discriminated union for credential types (AccessKey or AssumeRole)
2. AWS region
3. Optional KMS key ID

### `TExternalKmsAwsSchema`
#### Description
A TypeScript type inferred from the `ExternalKmsAwsSchema`.

### `ExternalKmsInputSchema`
#### Description
A Zod schema that defines the root structure for KMS input, using a discriminated union based on the KMS provider type.

### `TExternalKmsInputSchema`
#### Description
A TypeScript type inferred from the `ExternalKmsInputSchema`.

### `ExternalKmsInputUpdateSchema`
#### Description
A Zod schema similar to `ExternalKmsInputSchema`, but with partial inputs for update operations.

### `TExternalKmsInputUpdateSchema`
#### Description
A TypeScript type inferred from the `ExternalKmsInputUpdateSchema`.

### `TExternalKmsProviderFns`
#### Description
A TypeScript type that defines the structure of functions shared by all KMS providers.

#### Internal Logic
Includes three functions:
1. `validateConnection`: Validates the connection to the KMS provider
2. `encrypt`: Encrypts data using the KMS provider
3. `decrypt`: Decrypts data using the KMS provider

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| zod | Used for schema validation and type inference |

## Notes
- The code is well-structured and uses TypeScript and Zod effectively to ensure type safety and validation.
- It provides a flexible structure for handling different KMS providers, although currently only AWS is implemented.
- The use of discriminated unions allows for type-safe handling of different credential types and KMS providers.
- The schemas include descriptions for each field, which is helpful for documentation and potentially for generating user interfaces.
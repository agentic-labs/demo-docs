---
title: "identity-kubernetes-auth-fns.ts"
---

## High-level description
This code defines a single function `extractK8sUsername` that parses a Kubernetes username string and extracts the service account name and namespace. It assumes a specific username format (`system:serviceaccount:&lt;namespace&gt;:&lt;name&gt;`).

## Symbols

### `extractK8sUsername`
#### Description
This function takes a Kubernetes username string as input, validates its format, and extracts the service account namespace and name.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| username | string | The Kubernetes username string in the format `system:serviceaccount:&lt;namespace&gt;:&lt;name&gt;`. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| return value | object | An object containing the `namespace` and `name` of the service account extracted from the username. |

#### Internal Logic
1. Splits the input `username` string using ":" as the delimiter.
2. Checks if the resulting array has exactly four elements and if the first two elements are "system" and "serviceaccount" respectively. This ensures the username follows the expected format.
3. If the format is valid, it extracts the third element as the `namespace` and the fourth element as the `name` of the service account.
4. Returns an object containing the extracted `namespace` and `name`.
5. If the format validation fails, it throws an error indicating an "Invalid username format".

## Error Handling
The function throws an error if the input username does not adhere to the expected format (`system:serviceaccount:&lt;namespace&gt;:&lt;name&gt;`). 

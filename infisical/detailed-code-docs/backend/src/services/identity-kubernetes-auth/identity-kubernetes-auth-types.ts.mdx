---
title: "identity-kubernetes-auth-types.ts"
---

## High-level description
This file defines TypeScript types related to Kubernetes authentication for user identities. It includes types for data transfer objects (DTOs) used in API requests and responses, as well as types for interacting with the Kubernetes TokenReview API. 

## Code Structure
The code defines several types related to Kubernetes authentication. Some types, like `TAttachKubernetesAuthDTO` and `TUpdateKubernetesAuthDTO`, share common fields related to Kubernetes configuration and project permissions.  The `TCreateTokenReviewResponse` type utilizes  `TCreateTokenReviewSuccessResponse` and `TCreateTokenReviewErrorResponse` to represent the possible outcomes of a token review request.

## References
- `TProjectPermission` from "@app/lib/types"

## Symbols
### `TLoginKubernetesAuthDTO`
#### Description
Represents the data required for a user to log in using Kubernetes authentication.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the user identity. |
| jwt | string | The JSON Web Token (JWT) obtained from Kubernetes. |

#### Outputs
None

### `TAttachKubernetesAuthDTO`
#### Description
Represents the data required to attach Kubernetes authentication to a user identity.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the user identity. |
| kubernetesHost | string | The hostname or IP address of the Kubernetes API server. |
| caCert | string | The base64-encoded CA certificate for verifying the Kubernetes API server's TLS certificate. |
| tokenReviewerJwt | string | The JWT used to authenticate with the Kubernetes TokenReview API. |
| allowedNamespaces | string | A comma-separated list of allowed Kubernetes namespaces. |
| allowedNames | string | A comma-separated list of allowed Kubernetes service account names. |
| allowedAudience | string | A comma-separated list of allowed Kubernetes audiences. |
| accessTokenTTL | number | The time-to-live (TTL) for access tokens in seconds. |
| accessTokenMaxTTL | number | The maximum TTL for access tokens in seconds. |
| accessTokenNumUsesLimit | number | The maximum number of times an access token can be used. |
| accessTokenTrustedIps | { ipAddress: string }[] | A list of trusted IP addresses that can bypass access token limits. |
| ...TProjectPermission (excluding projectId) |  | Includes fields from `TProjectPermission` (actor, actorId, actorAuthMethod, actorOrgId) to manage project-level permissions. |

#### Outputs
None

### `TUpdateKubernetesAuthDTO`
#### Description
Represents the data that can be updated for Kubernetes authentication attached to a user identity.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the user identity. |
| kubernetesHost | string | (Optional) The updated hostname or IP address of the Kubernetes API server. |
| caCert | string | (Optional) The updated base64-encoded CA certificate. |
| tokenReviewerJwt | string | (Optional) The updated JWT for the TokenReview API. |
| allowedNamespaces | string | (Optional) The updated list of allowed namespaces. |
| allowedNames | string | (Optional) The updated list of allowed service account names. |
| allowedAudience | string | (Optional) The updated list of allowed audiences. |
| accessTokenTTL | number | (Optional) The updated TTL for access tokens. |
| accessTokenMaxTTL | number | (Optional) The updated maximum TTL for access tokens. |
| accessTokenNumUsesLimit | number | (Optional) The updated maximum number of uses for access tokens. |
| accessTokenTrustedIps | { ipAddress: string }[] | (Optional) The updated list of trusted IP addresses. |
| ...TProjectPermission (excluding projectId) |  | Includes fields from `TProjectPermission` (actor, actorId, actorAuthMethod, actorOrgId) to manage project-level permissions. |

#### Outputs
None

### `TGetKubernetesAuthDTO`
#### Description
Represents the data required to retrieve Kubernetes authentication details for a user identity.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the user identity. |
| ...TProjectPermission (excluding projectId) |  | Includes fields from `TProjectPermission` (actor, actorId, actorAuthMethod, actorOrgId) to manage project-level permissions. |

#### Outputs
None

### `TCreateTokenReviewSuccessResponse`
#### Description
Represents a successful response from the Kubernetes TokenReview API.

#### Inputs
None

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authenticated | boolean | Indicates whether the token was successfully authenticated. |
| user | { username: string; uid: string; groups: string[] } | Information about the authenticated user. |
| audiences | string[] | The audiences associated with the token. |

### `TCreateTokenReviewErrorResponse`
#### Description
Represents an error response from the Kubernetes TokenReview API.

#### Inputs
None

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| error | string | The error message returned by the API. |

### `TCreateTokenReviewResponse`
#### Description
Represents the complete response from the Kubernetes TokenReview API, which can be either a success or an error.

#### Inputs
None

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| apiVersion | string | The API version used for the request. |
| kind | string | The kind of resource returned in the response. |
| spec | { token: string } | The specification of the token review request. |
| status | TCreateTokenReviewSuccessResponse \| TCreateTokenReviewErrorResponse | The status of the token review request, which can be either a success or an error. |

### `TRevokeKubernetesAuthDTO`
#### Description
Represents the data required to revoke Kubernetes authentication from a user identity.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the user identity. |
| ...TProjectPermission (excluding projectId) |  | Includes fields from `TProjectPermission` (actor, actorId, actorAuthMethod, actorOrgId) to manage project-level permissions. |

#### Outputs
None

## Dependencies
- "@app/lib/types" for `TProjectPermission` type. 

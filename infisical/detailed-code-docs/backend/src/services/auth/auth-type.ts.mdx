---
title: "auth-type.ts"
---

## High-level description
This file defines various authentication-related enums and types used throughout the backend of the application. It includes definitions for authentication methods, token types, actor types, and payload structures for different authentication scenarios.

## Code Structure
The file consists of several enum definitions and type declarations that are related to authentication and authorization. These types and enums are likely used across different parts of the application to ensure consistent handling of authentication-related data.

## Symbols

### `AuthMethod`
#### Description
An enum that defines the various authentication methods supported by the application.

#### Inputs
None (enum definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| EMAIL | string | Email-based authentication |
| GOOGLE | string | Google authentication |
| GITHUB | string | GitHub authentication |
| GITLAB | string | GitLab authentication |
| OKTA_SAML | string | Okta SAML authentication |
| AZURE_SAML | string | Azure SAML authentication |
| JUMPCLOUD_SAML | string | JumpCloud SAML authentication |
| GOOGLE_SAML | string | Google SAML authentication |
| KEYCLOAK_SAML | string | Keycloak SAML authentication |
| LDAP | string | LDAP authentication |
| OIDC | string | OpenID Connect authentication |

### `AuthTokenType`
#### Description
An enum that defines the various types of authentication tokens used in the system.

#### Inputs
None (enum definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ACCESS_TOKEN | string | Standard access token |
| REFRESH_TOKEN | string | Token used for refreshing access tokens |
| SIGNUP_TOKEN | string | Token used during signup process (marked for removal) |
| MFA_TOKEN | string | Token used for multi-factor authentication (marked for removal) |
| PROVIDER_TOKEN | string | Token used for authentication providers (marked for removal) |
| API_KEY | string | API key for authentication |
| SERVICE_ACCESS_TOKEN | string | Access token for service accounts |
| SERVICE_REFRESH_TOKEN | string | Refresh token for service accounts |
| IDENTITY_ACCESS_TOKEN | string | Access token for identity-based authentication |
| SCIM_TOKEN | string | Token used for SCIM (System for Cross-domain Identity Management) |

### `AuthMode`
#### Description
An enum that defines the different authentication modes supported by the application.

#### Inputs
None (enum definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| JWT | string | JSON Web Token authentication |
| SERVICE_TOKEN | string | Service token authentication |
| API_KEY | string | API key authentication |
| IDENTITY_ACCESS_TOKEN | string | Identity access token authentication |
| SCIM_TOKEN | string | SCIM token authentication |

### `ActorType`
#### Description
An enum that defines the types of actors that can perform actions in the system.

#### Inputs
None (enum definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| USER | string | Regular user |
| SERVICE | string | Service account |
| IDENTITY | string | Identity-based actor |
| Machine | string | Machine actor |
| SCIM_CLIENT | string | SCIM client |

### `ActorAuthMethod`
#### Description
A type alias for the authentication method used by an actor.

#### Inputs
None (type alias)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| ActorAuthMethod | AuthMethod \| null | The authentication method used by an actor, or null if not applicable |

### `AuthModeJwtTokenPayload`
#### Description
A type that defines the structure of a JWT token payload for standard authentication.

#### Inputs
None (type definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authTokenType | AuthTokenType.ACCESS_TOKEN | The type of token |
| authMethod | AuthMethod | The authentication method used |
| userId | string | The ID of the user |
| tokenVersionId | string | The version ID of the token |
| accessVersion | number | The version of the access token |
| organizationId | string \| undefined | The ID of the organization (optional) |

### `AuthModeMfaJwtTokenPayload`
#### Description
A type that defines the structure of a JWT token payload for multi-factor authentication.

#### Inputs
None (type definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authTokenType | AuthTokenType.MFA_TOKEN | The type of token |
| authMethod | AuthMethod | The authentication method used |
| userId | string | The ID of the user |
| organizationId | string \| undefined | The ID of the organization (optional) |

### `AuthModeRefreshJwtTokenPayload`
#### Description
A type that defines the structure of a JWT token payload for refresh tokens.

#### Inputs
None (type definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authTokenType | AuthTokenType.REFRESH_TOKEN | The type of token |
| authMethod | AuthMethod | The authentication method used |
| userId | string | The ID of the user |
| tokenVersionId | string | The version ID of the token |
| refreshVersion | number | The version of the refresh token |
| organizationId | string \| undefined | The ID of the organization (optional) |

### `AuthModeProviderJwtTokenPayload`
#### Description
A type that defines the structure of a JWT token payload for authentication providers.

#### Inputs
None (type definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authTokenType | AuthTokenType.PROVIDER_TOKEN | The type of token |
| username | string | The username of the user |
| authMethod | AuthMethod | The authentication method used |
| email | string | The email of the user |
| organizationId | string \| undefined | The ID of the organization (optional) |

### `AuthModeProviderSignUpTokenPayload`
#### Description
A type that defines the structure of a JWT token payload for provider sign-up tokens.

#### Inputs
None (type definition)

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| authTokenType | AuthTokenType.SIGNUP_TOKEN | The type of token |
| userId | string | The ID of the user |

## TODOs
- Remove `SIGNUP_TOKEN` in favor of claim
- Remove `MFA_TOKEN` in favor of claim
- Remove `PROVIDER_TOKEN` in favor of claim
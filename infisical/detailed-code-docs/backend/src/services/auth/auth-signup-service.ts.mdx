---
title: "auth-signup-service.ts"
---

## High-level description
This file defines the `authSignupServiceFactory`, which creates a service for handling user signup processes in the application. It includes functions for initiating email signup, verifying email, completing account signup, and handling invitations to join organizations.

## Code Structure
The `authSignupServiceFactory` takes various dependencies (DALs and services) and returns an object with four main functions: `beginEmailSignupProcess`, `verifyEmailSignup`, `completeEmailAccountSignup`, and `completeAccountInvite`. These functions work together to manage different stages of the signup process.

## Symbols

### `authSignupServiceFactory`
#### Description
This factory function creates and returns an object with methods for handling the signup process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dependencies | TAuthSignupDep | An object containing various data access layers (DALs) and services required for signup operations |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| signupService | Object | An object containing methods for handling signup processes |

#### Internal Logic
1. Creates and returns an object with four main methods for handling signup processes.
2. Each method uses the provided dependencies to perform its operations.

### `beginEmailSignupProcess`
#### Description
Initiates the email signup process by creating a user (if not exists) and sending a verification email.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| email | string | The email address of the user signing up |

#### Internal Logic
1. Checks if the email is disposable.
2. Finds or creates a user with the given email.
3. Creates a token for email confirmation.
4. Sends a verification email to the user.

### `verifyEmailSignup`
#### Description
Verifies the email signup process using the provided code and generates a JWT token for further signup steps.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| email | string | The email address of the user |
| code | string | The verification code sent to the user's email |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Object | Contains the user object and a JWT token |

#### Internal Logic
1. Finds the user by email.
2. Validates the provided token.
3. Updates the user's email verification status.
4. Generates and returns a JWT token for the next signup step.

### `completeEmailAccountSignup`
#### Description
Completes the email account signup process by updating user information and creating necessary cryptographic keys.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| signupData | TCompleteAccountSignupDTO | Object containing various user and cryptographic information |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Object | Contains the updated user object, access token, refresh token, and organization ID |

#### Internal Logic
1. Validates the user and authorization.
2. Creates or updates user information and encryption keys.
3. Handles organization membership and group memberships.
4. Generates and returns access and refresh tokens.

### `completeAccountInvite`
#### Description
Completes the account signup process for users invited to join an organization.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| inviteData | TCompleteAccountInviteDTO | Object containing user information and invitation details |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Object | Contains the updated user object, access token, and refresh token |

#### Internal Logic
1. Validates the user and invitation.
2. Updates user information and creates encryption keys.
3. Handles organization membership and project memberships (if applicable).
4. Generates and returns access and refresh tokens.

## Dependencies
The service relies on various data access layers (DALs) and services, including user management, organization management, project management, token services, and email services.
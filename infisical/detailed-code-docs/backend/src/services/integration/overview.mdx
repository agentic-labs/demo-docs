---
title: "Overview"
---

## High-level description
This directory contains the core services and data structures for managing integrations in the backend of the application. It includes data access layer (DAL) operations, schema definitions, service logic, and type definitions for integrations. The code is designed to handle various aspects of integration management, including creation, updating, deletion, listing, and synchronization of integrations within projects.

## What does it do?
The integration service provides a set of functionalities to manage integrations within the application:

1. Create new integrations: Users can set up new integrations by specifying details such as secret paths, authentication, environments, and metadata.

2. Update existing integrations: The service allows modifications to integration properties, including activation status, target environments, and metadata.

3. Delete integrations: Users can remove integrations, with an option to also delete associated secrets.

4. List integrations: The service can retrieve all integrations associated with a specific project.

5. Sync integrations: There's functionality to trigger synchronization of integration data.

6. Manage integration metadata: The service handles complex metadata structures, including settings for secret management and cloud provider-specific configurations.

7. Enforce permissions: All operations are subject to permission checks to ensure users have the necessary access rights.

8. Handle integration secrets: The service interacts with secret management systems, allowing for secure storage and retrieval of integration-related secrets.

## Key Files

1. `integration-dal.ts`: Defines the data access layer for integrations, providing methods to interact with the database for CRUD operations on integration records.

2. `integration-schema.ts`: Contains the Zod schema definition for integration metadata, specifying the structure and validation rules for various configuration options.

3. `integration-service.ts`: Implements the core business logic for managing integrations, including creation, updating, deletion, listing, and synchronization of integrations.

4. `integration-types.ts`: Defines TypeScript types and interfaces used throughout the integration service, including data transfer objects (DTOs) for various operations.

## Dependencies
The integration service relies on several external libraries and internal modules:

1. Zod: Used for schema definition and validation in `integration-schema.ts`.
2. Knex: Utilized for database operations in `integration-dal.ts`.
3. CASL: Employed for permission handling in `integration-service.ts`.
4. Internal modules:
   - `@app/db`: Provides database-related types and schemas.
   - `@app/lib/errors`: Offers custom error classes for error handling.
   - `@app/lib/knex`: Supplies utility functions for database operations.
   - `@app/lib/api-docs`: Provides descriptions for schema fields.
   - Various DAL and service factories from other parts of the application.

## Configuration
The integration service uses a complex configuration structure defined in the `IntegrationMetadataSchema`. Key configurable options include:

1. Secret management:
   - `secretPrefix` and `secretSuffix`: For naming conventions of secrets.
   - `shouldMaskSecrets` and `shouldProtectSecrets`: Flags for secret handling behavior.

2. Synchronization behavior:
   - `initialSyncBehavior`: Defines the behavior for initial synchronization.
   - `mappingBehavior`: Specifies how integrations should be mapped.

3. Cloud provider settings:
   - `secretGCPLabel`: For Google Cloud Platform label configurations.
   - `secretAWSTag`: For Amazon Web Services tag configurations.
   - `kmsKeyId`: For specifying a KMS key ID.

4. Operational flags:
   - `shouldAutoRedeploy`: Determines if auto redeployment should occur.
   - `shouldDisableDelete` and `shouldEnableDelete`: Control deletion behavior.

These configuration options allow for flexible and detailed control over how integrations are managed and how they interact with various cloud services and secret management systems.

I hope this summary provides a comprehensive overview of the integration service directory. Let me know if you need any clarification or have additional questions!
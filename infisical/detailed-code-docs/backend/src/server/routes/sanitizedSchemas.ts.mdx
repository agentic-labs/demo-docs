---
title: "sanitizedSchemas.ts"
---

## High-level description
This file defines a set of Zod schemas used for sanitizing sensitive data before returning it to the client. These schemas ensure that only specific fields are included in the response, protecting sensitive information like secret values and encryption keys.

## Code Structure
This file defines a series of Zod schemas, each representing a sanitized version of a corresponding schema from the database. These schemas are used to pick specific fields from the original data, ensuring that only safe and necessary information is exposed.

## Symbols
### `integrationAuthPubSchema`
#### Description
This schema defines the sanitized structure of an integration authentication object, omitting sensitive fields like API keys or tokens.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  id: string,
  projectId: string,
  integration: string,
  teamId: string,
  url: string,
  namespace: string,
  accountId: string,
  metadata: any,
  createdAt: Date,
  updatedAt: Date
}
```

### `sapPubSchema`
#### Description
This schema defines the sanitized structure of a Secret Approval Policy object, including information about the environment and project.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  id: string,
  name: string,
  projectId: string,
  environment: string,
  secretPath: string,
  approvers: string[],
  approvals: number,
  enforcementLevel: EnforcementLevel,
  createdAt: Date,
  updatedAt: Date,
  environment: {
    id: string,
    name: string,
    slug: string
  },
  projectId: string
}
```

### `sanitizedServiceTokenUserSchema`
#### Description
This schema defines the sanitized structure of a user object associated with a service token, omitting sensitive fields like passwords or MFA details.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  authMethods: string[],
  id: string,
  createdAt: Date,
  updatedAt: Date,
  devices: any[],
  email: string,
  firstName: string,
  lastName: string,
  mfaMethods: string[],
  __v: number,
  _id: string
}
```

### `secretRawSchema`
#### Description
This schema defines the structure of a raw secret object, including all fields. This schema is not sanitized and should be used with caution.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  id: string,
  _id: string,
  workspace: string,
  environment: string,
  version: number,
  type: string,
  secretKey: string,
  secretValue: string,
  secretComment: string,
  secretReminderNote: string | null,
  secretReminderRepeatDays: number | null,
  skipMultilineEncoding: boolean,
  metadata: any,
  createdAt: Date,
  updatedAt: Date
}
```

### `ProjectPermissionSchema`
#### Description
This schema defines the structure of a project permission object, specifying the allowed actions, subject, and optional conditions.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  action: ProjectPermissionActions,
  subject: ProjectPermissionSub,
  conditions?: {
    environment?: string,
    secretPath?: {
      $glob: string
    }
  }
}
```

### `ProjectSpecificPrivilegePermissionSchema`
#### Description
This schema defines the structure of a project-specific privilege permission, specifying allowed actions, subject, and conditions.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  actions: ProjectPermissionActions[],
  subject: 'secrets',
  conditions: {
    environment: string,
    secretPath?: {
      $glob: string
    }
  }
}
```

### `SanitizedIdentityPrivilegeSchema`
#### Description
This schema defines the sanitized structure of an identity privilege, extending the `IdentityProjectAdditionalPrivilegeSchema` with an array of unpacked permissions.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object extending the `IdentityProjectAdditionalPrivilegeSchema` with an additional field:
```typescript
{
  // ... fields from IdentityProjectAdditionalPrivilegeSchema
  permissions: UnpackedPermissionSchema[]
}
```

### `SanitizedRoleSchema`
#### Description
This schema defines the sanitized structure of a project role, extending the `ProjectRolesSchema` with an array of unpacked permissions.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object extending the `ProjectRolesSchema` with an additional field:
```typescript
{
  // ... fields from ProjectRolesSchema
  permissions: UnpackedPermissionSchema[]
}
```

### `SanitizedDynamicSecretSchema`
#### Description
This schema defines the sanitized structure of a dynamic secret, omitting sensitive fields like encryption details.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure, omitting sensitive fields from `DynamicSecretsSchema`:
```typescript
{
  // ... fields from DynamicSecretsSchema except inputIV, inputTag, inputCiphertext, keyEncoding, algorithm
}
```

### `SanitizedAuditLogStreamSchema`
#### Description
This schema defines the sanitized structure of an audit log stream object.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure:
```typescript
{
  id: string,
  url: string,
  createdAt: Date,
  updatedAt: Date
}
```

### `SanitizedProjectSchema`
#### Description
This schema defines the sanitized structure of a project object, omitting sensitive fields.

#### Inputs
This schema doesn't take any direct inputs. It's used to define the structure of an object.

#### Outputs
This schema represents an object with the following structure, picking specific fields from `ProjectsSchema`:
```typescript
{
  id: true,
  name: true,
  slug: true,
  autoCapitalization: true,
  orgId: true,
  createdAt: true,
  updatedAt: true,
  version: true,
  upgradeStatus: true,
  pitVersionLimit: true,
  kmsCertificateKeyId: true,
  auditLogsRetentionDays: true
}
```

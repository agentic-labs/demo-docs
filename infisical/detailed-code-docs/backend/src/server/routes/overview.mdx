---
title: "Overview"
---

## High-level description
This directory contains the implementation of API routes for the backend server, covering multiple versions (v1, v2, and v3) of the API. It includes various routers handling different aspects of the application, such as authentication, user management, organization management, project management, secrets management, and more. The code is structured using Fastify as the web framework and Zod for request/response validation.

## What does it do?
The code in this directory defines and implements the API endpoints for the backend server, handling a wide range of functionalities:

1. User authentication and authorization (including Multi-Factor Authentication)
2. User management (signup, login, profile updates, email verification)
3. Organization management (creating, updating, deleting organizations and memberships)
4. Project/workspace management (creating, updating, deleting projects and memberships)
5. Secrets management (CRUD operations, batch actions, blind indexes)
6. Service token and API key management
7. Identity management for organizations and projects
8. Integration with various authentication providers (AWS IAM, Azure, GCP, Kubernetes, OIDC)
9. Certificate management (PKI)
10. Webhook management
11. Admin operations

The API is versioned, with v1, v2, and v3 routes available, each potentially offering different features or implementations.

## Entry points
The main entry point for this directory is the `index.ts` file in the root, which likely registers all routes for all versions with the Fastify server. Each version (v1, v2, v3) has its own `index.ts` file that registers the specific routes for that version.

The flow of control typically goes from the main `index.ts` file to version-specific `index.ts` files, and then to individual router files (e.g., `user-router.ts`, `organization-router.ts`, etc.), where specific routes are defined and handlers are implemented.

## Key Files
1. `index.ts`: Registers all routes for all versions.
2. `v1/index.ts`, `v2/index.ts`, `v3/index.ts`: Register routes for specific API versions.
3. Various router files (e.g., `user-router.ts`, `organization-router.ts`, `secret-router.ts`): Define and implement specific routes for different functionalities.
4. `sanitizedSchemas.ts`: Defines Zod schemas for sanitizing sensitive data before returning it to the client.

## Dependencies
The code relies on several key dependencies:

1. Fastify: Used as the web framework for defining and handling routes.
2. Zod: Employed for request and response schema validation.
3. JWT: Used for token-based authentication.
4. Various internal modules for configuration, database access, error handling, and business logic implementation.

## Configuration
The routers use configuration from various sources:

1. Rate limiting configurations
2. Authentication modes and types
3. Environment variables for sensitive information

Each router typically applies rate limiting and authentication middleware to its routes. The specific configuration can vary between routes based on their requirements.

The code structure allows for easy extension and modification of the API, with each router handling a specific domain of functionality. This modular approach enhances maintainability and allows for independent scaling of different parts of the API.
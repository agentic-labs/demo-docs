---
title: "swagger.ts"
---

## High-level description
This code defines a Fastify plugin, `fastifySwagger`, which integrates Swagger documentation into a Fastify web server. It uses the `@fastify/swagger` and `@fastify/swagger-ui` plugins to generate and serve Swagger documentation, respectively. The plugin also configures basic information about the API, such as the title, description, version, and security schemes.

## Code Structure
The `fastifySwagger` function is an asynchronous function that takes a Fastify instance as an argument. It uses the `register` method to register the `swagger` and `swaggerUI` plugins. The `swagger` plugin is configured with a JSON schema transformation function and an OpenAPI object that defines the API documentation. The `swaggerUI` plugin is configured with a route prefix.

## References
- `jsonSchemaTransform`: This function is imported from `./fastify-zod` and is used to transform JSON schemas.

## Symbols
### `fastifySwagger`
#### Description
This function is a Fastify plugin that integrates Swagger documentation into a Fastify web server. It sets up the necessary routes and configurations for generating and serving Swagger documentation.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| fastify | FastifyInstance | An instance of a Fastify web server. |

#### Outputs
This function does not explicitly return any value.

#### Internal Logic
1. **Register `swagger` plugin:**
   - Uses `fastify.register` to register the `@fastify/swagger` plugin.
   - Configures the plugin with:
     - `transform`: A function to transform JSON schemas, imported from `./fastify-zod`.
     - `openapi`: An object containing OpenAPI specifications for the API documentation.
       - `info`: Basic information about the API, including title, description, and version.
       - `servers`: An array of server URLs where the API is accessible.
       - `components`: Defines security schemes for the API, in this case, bearer authentication using JWT.
2. **Register `swaggerUI` plugin:**
   - Uses `fastify.register` to register the `@fastify/swagger-ui` plugin.
   - Configures the plugin with:
     - `routePrefix`: Sets the base URL for accessing the Swagger UI, which is `/api/docs` in this case.
     - `prefix`:  Also set to `/api/docs`, ensuring that all Swagger UI assets are served under this path.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @fastify/swagger | Provides Swagger integration for Fastify, allowing for automatic generation of Swagger documentation from route schemas. |
| @fastify/swagger-ui | Serves the Swagger UI, a web-based interface for visualizing and interacting with the Swagger documentation. |
| fastify-plugin | Provides a standard way to create Fastify plugins. |

## Error Handling
This code does not implement specific error handling. Any errors during plugin registration will be propagated to the caller.

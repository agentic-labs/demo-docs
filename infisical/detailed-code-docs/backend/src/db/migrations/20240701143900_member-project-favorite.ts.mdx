---
title: "20240701143900_member-project-favorite.ts"
---

## High-level description
This database migration script adds a new column named `projectFavorites` to the `OrgMembership` table. This column is intended to store an array of text values representing the favorite projects of an organization member.

## Symbols
### `up`
#### Description
This asynchronous function handles the database migration to add the `projectFavorites` column to the `OrgMembership` table if it doesn't already exist.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | A Knex connection object used to interact with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (implicit) | Promise\&lt;void\&gt; | A promise that resolves when the migration is complete. |

#### Internal Logic
1. **Check for Existing Column:** It first checks if the `projectFavorites` column already exists in the `OrgMembership` table using `knex.schema.hasColumn`.
2. **Add Column:** If the column doesn't exist, it alters the `OrgMembership` table using `knex.schema.alterTable` and adds the `projectFavorites` column with the data type `text[]` using `tb.specificType`. This indicates that the column will store an array of text values.

### `down`
#### Description
This asynchronous function handles the database rollback by dropping the `projectFavorites` column from the `OrgMembership` table if it exists.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | A Knex connection object used to interact with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| (implicit) | Promise\&lt;void\&gt; | A promise that resolves when the rollback is complete. |

#### Internal Logic
1. **Check for Existing Column:** It first checks if the `projectFavorites` column exists in the `OrgMembership` table using `knex.schema.hasColumn`.
2. **Drop Column:** If the column exists, it alters the `OrgMembership` table using `knex.schema.alterTable` and drops the `projectFavorites` column using `t.dropColumn`.

## References
- `TableName`: This symbol is not defined in the provided code snippet. It's likely an enum or constant defined elsewhere that holds the names of database tables.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| knex       | Provides a connection to the database and methods for schema migration. |

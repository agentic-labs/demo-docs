---
title: "20240728010334_secret-sharing-name.ts"
---

## High-level description
This migration script adds two new columns, `name` and `lastViewedAt`, to the `SecretSharing` table in the database if they don't already exist. It also provides a rollback mechanism to drop these columns.

## References
- `TableName`: This symbol is referenced from another file and is assumed to hold the name of the database table for secret sharing.

## Symbols
### `up`
#### Description
This function is executed when the migration is applied. It checks if the `SecretSharing` table exists and adds the `name` and `lastViewedAt` columns if they are not present.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the operation is complete. |

#### Internal Logic
1. Checks if the `SecretSharing` table exists.
2. If the table exists, checks if the `name` column exists. If not, adds the column as a nullable string.
3. Checks if the `lastViewedAt` column exists. If not, adds the column as a nullable timestamp.

### `down`
#### Description
This function is executed when the migration is rolled back. It checks if the `SecretSharing` table exists and drops the `name` and `lastViewedAt` columns if they exist.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the operation is complete. |

#### Internal Logic
1. Checks if the `SecretSharing` table exists.
2. If the table exists, checks if the `name` column exists. If it does, drops the column.
3. Checks if the `lastViewedAt` column exists. If it does, drops the column.

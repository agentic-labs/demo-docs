---
title: "20240614184133_make-secret-sharing-public.ts"
---

## High-level description
This database migration script modifies the `SecretSharing` table to make the `orgId` and `userId` columns nullable. This suggests that secret sharing is being expanded to allow for scenarios where it's not tied to a specific organization or user.

## References
- `TableName`: An enum likely defined in `db/schemas` that holds the names of database tables.

## Symbols

### `up`
#### Description
This function defines the actions to apply the migration, making the `orgId` and `userId` columns in the `SecretSharing` table nullable.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for interacting with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the migration is applied. |

#### Internal Logic
1. Check if the `SecretSharing` table exists.
2. Check if the `orgId` and `userId` columns exist in the table.
3. If the columns exist, alter the table schema to make them nullable.

### `down`
#### Description
This function defines the actions to rollback the migration, reverting the `orgId` and `userId` columns in the `SecretSharing` table back to being non-nullable.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for interacting with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the migration rollback is complete. |

#### Internal Logic
1. Check if the `SecretSharing` table exists.
2. Check if the `orgId` and `userId` columns exist in the table.
3. If the columns exist, alter the table schema to make them non-nullable.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| knex       | Provides a query builder and schema builder for interacting with relational databases. |

---
title: "20240715113110_org-membership-active-status.ts"
---

## High-level description
This code defines a database migration that adds an `isActive` status column to the `OrgMembership` table and creates an index on the `userId` and `orgId` columns. It also provides the corresponding down migration to revert these changes.

## Symbols

### `up`
#### Description
This function defines the steps to apply the migration. It adds an `isActive` column to the `OrgMembership` table and creates an index on `userId` and `orgId` if they exist.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | Resolves when the migration is applied successfully. |

#### Internal Logic
1. Checks if the `OrgMembership` table exists.
2. Checks if `userId` and `orgId` columns exist in the table.
3. Alters the `OrgMembership` table:
    - Adds a boolean column `isActive` with a default value of `true`.
    - Creates an index on `userId` and `orgId` if both columns exist.

### `down`
#### Description
This function defines the steps to revert the migration. It removes the `isActive` column and drops the index on `userId` and `orgId` from the `OrgMembership` table.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | Resolves when the migration is reverted successfully. |

#### Internal Logic
1. Checks if the `OrgMembership` table exists.
2. Checks if `userId` and `orgId` columns exist in the table.
3. Alters the `OrgMembership` table:
    - Drops the `isActive` column.
    - Drops the index on `userId` and `orgId` if both columns exist.

## References
- `TableName`: An enum or object defining table names, likely imported from `../schemas`.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| knex       | Provides database interaction capabilities. |

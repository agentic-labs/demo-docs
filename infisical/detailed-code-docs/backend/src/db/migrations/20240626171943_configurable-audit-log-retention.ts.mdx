---
title: "20240626171943_configurable-audit-log-retention.ts"
---

## High-level description
This code defines a database migration using Knex.js. It aims to add a new column named `auditLogsRetentionDays` to the `Project` table, allowing for configurable retention periods for audit logs on a per-project basis.

## Symbols

### `up`
#### Description
This function defines the steps to apply the migration, adding the `auditLogsRetentionDays` column to the `Project` table if it doesn't already exist.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the migration is complete. |

#### Internal Logic
1. Checks if the `auditLogsRetentionDays` column already exists in the `Project` table.
2. If the column doesn't exist, it alters the `Project` table to add the `auditLogsRetentionDays` column as an integer with a nullable constraint.

### `down`
#### Description
This function defines the steps to rollback the migration, removing the `auditLogsRetentionDays` column from the `Project` table if it exists.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | Knex instance for database interaction. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| Promise\&lt;void\&gt; | Promise | A promise that resolves when the migration rollback is complete. |

#### Internal Logic
1. Checks if the `auditLogsRetentionDays` column exists in the `Project` table.
2. If the column exists, it alters the `Project` table to drop the `auditLogsRetentionDays` column.

## References
- `TableName`: This symbol likely refers to an enum or constant that defines the names of database tables used in the application.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| knex       | Provides a connection to the database and allows for schema manipulation. |

---
title: "2-org.ts"
---

## High-level description
The code defines a database seed function `seed` that populates the `Organization` and `OrgMembership` tables with initial data. This data represents the Infisical organization and its admin user defined in the `seedData1` object.

## References
- `TableName`: An enum from `../schemas` that defines the names of database tables.
- `OrgMembershipRole`: An enum from `../schemas` that defines the roles of organization members.
- `OrgMembershipStatus`: An enum from `../schemas` that defines the status of organization memberships.
- `seedData1`: An object from `../seed-data` that likely contains the initial data for seeding.

## Symbols

### `seed`
#### Description
This asynchronous function seeds the database with an organization and its admin user. It first deletes all existing entries in the `Organization` and `OrgMembership` tables. Then, it retrieves the user with the email defined in `seedData1`. If the user exists, it creates a new organization entry with the data from `seedData1` and inserts a new `OrgMembership` entry associating the user as an admin of the newly created organization.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| knex | Knex | A Knex client instance for interacting with the database. |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| void | void | This function does not return any value. |

#### Internal Logic
1. **Delete existing data:** Deletes all entries from the `Organization` and `OrgMembership` tables.
2. **Retrieve user:** Queries the `Users` table for a user with the email specified in `seedData1`. Throws an error if no user is found.
3. **Insert organization:** Inserts a new organization into the `Organization` table using data from `seedData1`.
4. **Insert organization membership:** Inserts a new organization membership into the `OrgMembership` table, associating the retrieved user as an admin of the newly created organization.

## Side Effects
This function modifies the database by deleting existing data and inserting new data into the `Organization` and `OrgMembership` tables.

## Dependencies
- **knex:** A query builder for PostgreSQL, MySQL, and SQLite3.

## Error Handling
The function throws an error if it cannot find a user with the email specified in `seedData1`.

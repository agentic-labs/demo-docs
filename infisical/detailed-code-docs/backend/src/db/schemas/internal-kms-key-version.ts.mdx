---
title: "internal-kms-key-version.ts"
---

## High-level description
This file defines a Zod schema for an internal KMS (Key Management System) key version. It provides type definitions and validation for the structure of an internal KMS key version object, which includes properties such as id, encryptedKey, version, and internalKmsId.

## Code Structure
The code defines a Zod schema `InternalKmsKeyVersionSchema` and derives TypeScript types from it. It also exports types for insert and update operations, omitting immutable database keys.

## References
- `@app/lib/zod`: Imports the `zodBuffer` utility
- `./models`: Imports the `TImmutableDBKeys` type

## Symbols

### `InternalKmsKeyVersionSchema`
#### Description
A Zod schema that defines the structure and validation rules for an internal KMS key version object.

#### Inputs
N/A (This is a schema definition, not a function)

#### Outputs
N/A (This is a schema definition, not a function)

#### Internal Logic
The schema defines four properties:
1. `id`: A UUID string
2. `encryptedKey`: A buffer (using the custom `zodBuffer` validator)
3. `version`: A number
4. `internalKmsId`: A UUID string

### `TInternalKmsKeyVersion`
#### Description
A TypeScript type inferred from the `InternalKmsKeyVersionSchema`, representing the structure of an internal KMS key version object.

### `TInternalKmsKeyVersionInsert`
#### Description
A TypeScript type for inserting a new internal KMS key version, omitting immutable database keys.

### `TInternalKmsKeyVersionUpdate`
#### Description
A TypeScript type for updating an existing internal KMS key version, making all fields optional and omitting immutable database keys.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| zod | Used for schema definition and validation |
| @app/lib/zod | Provides the `zodBuffer` utility for buffer validation |
| ./models | Provides the `TImmutableDBKeys` type |

## TODOs
The file includes a comment indicating that it is generated by an automation script and should not be edited manually. To update the schema, the instruction is to run `npm run generate:schema`.
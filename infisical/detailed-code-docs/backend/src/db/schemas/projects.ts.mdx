---
title: "projects.ts"
---

## High-level description
This code defines the Zod schema for the `Projects` table in the database. It uses the `zod` library to define the type and validation rules for each field in the `Projects` table. This schema is used to validate data before it is inserted or updated in the database.

## References
- `@app/lib/zod`: This reference points to a custom Zod utility function `zodBuffer` used for validating buffer types.
- `./models`: This reference likely points to a file where the `TImmutableDBKeys` type is defined, which is used to exclude certain fields from insert and update operations.

## Symbols

### `ProjectsSchema`
#### Description
This symbol defines a Zod schema for the `Projects` table. It outlines the structure of a `Project` entity and enforces data types and validation rules for each field.

#### Inputs
This is a Zod schema definition, not a function, so it doesn't have explicit inputs.

#### Outputs
This is a Zod schema definition, not a function, so it doesn't have explicit outputs.

#### Internal Logic
The schema defines each field of the `Projects` table along with its type and validation rules:
- `id`: A required string field representing the project's unique identifier.
- `name`: A required string field representing the project's name.
- `slug`: A required string field representing the project's slug (URL-friendly name).
- `autoCapitalization`: An optional boolean field with a default value of `true`, indicating whether auto-capitalization is enabled for the project.
- `orgId`: A required UUID string field representing the ID of the organization the project belongs to.
- `createdAt`: A required date field representing the project's creation timestamp.
- `updatedAt`: A required date field representing the project's last update timestamp.
- `version`: A number field with a default value of `1`, representing the project's version number.
- `upgradeStatus`: An optional nullable string field representing the project's upgrade status.
- `pitVersionLimit`: A number field with a default value of `10`, representing the limit of PIT (Point-in-Time) versions for the project.
- `kmsCertificateKeyId`: An optional nullable UUID string field representing the ID of the KMS certificate key used for encryption.
- `auditLogsRetentionDays`: An optional nullable number field representing the retention period in days for audit logs.
- `kmsSecretManagerKeyId`: An optional nullable UUID string field representing the ID of the KMS secret manager key.
- `kmsSecretManagerEncryptedDataKey`: An optional nullable buffer field validated by the `zodBuffer` utility, representing the encrypted data key.

### `TProjects`
#### Description
This symbol defines a TypeScript type based on the inferred type of the `ProjectsSchema`. It represents the structure of a `Project` object.

### `TProjectsInsert`
#### Description
This symbol defines a TypeScript type that represents the structure of a `Project` object used for inserting new records into the `Projects` table. It omits fields defined in `TImmutableDBKeys` from the `TProjects` type, likely excluding fields like `id`, `createdAt`, and `updatedAt` which are typically generated by the database.

### `TProjectsUpdate`
#### Description
This symbol defines a TypeScript type that represents the structure of a `Project` object used for updating existing records in the `Projects` table. It's a partial type of `TProjectsInsert`, meaning it allows only a subset of fields to be provided for updates.

## Dependencies
- `zod`: A library for schema validation and type inference in TypeScript.

## Error Handling
This code doesn't implement specific error handling mechanisms. Zod will throw errors if the data doesn't match the defined schema during validation.

---
title: "user-encryption-keys.ts"
---

## High-level description
This file defines a Zod schema for user encryption keys in a TypeScript-based backend application. It provides type definitions and validation rules for various encryption-related properties associated with user accounts, facilitating type safety and data integrity in the application's database operations.

## Code Structure
The file exports a Zod schema (`UserEncryptionKeysSchema`) and three derived types (`TUserEncryptionKeys`, `TUserEncryptionKeysInsert`, and `TUserEncryptionKeysUpdate`). These types are used to ensure type safety when working with user encryption key data in the application.

## Symbols

### UserEncryptionKeysSchema
#### Description
A Zod schema that defines the structure and validation rules for user encryption keys.

#### Inputs
This schema doesn't have direct inputs, but it defines the shape of objects that conform to the user encryption keys structure.

#### Outputs
When used for validation or parsing, it produces an object conforming to the defined schema or throws an error if validation fails.

#### Internal Logic
The schema defines various fields related to user encryption, including:
- Unique identifiers (`id`, `userId`)
- Public and private keys (`clientPublicKey`, `serverPrivateKey`, `publicKey`, `encryptedPrivateKey`)
- Encryption-related data (`iv`, `tag`, `salt`, `verifier`)
- Protected key information (`protectedKey`, `protectedKeyIV`, `protectedKeyTag`)
- Server-side encryption data (`serverEncryptedPrivateKey`, `serverEncryptedPrivateKeyIV`, `serverEncryptedPrivateKeyTag`, `serverEncryptedPrivateKeyEncoding`)
- Other metadata (`encryptionVersion`, `hashedPassword`)

Most fields are defined as nullable and optional, allowing for flexibility in data storage and retrieval.

### TUserEncryptionKeys
#### Description
A TypeScript type inferred from the `UserEncryptionKeysSchema`, representing the complete structure of a user encryption keys object.

### TUserEncryptionKeysInsert
#### Description
A TypeScript type derived from `UserEncryptionKeysSchema`, omitting immutable database keys (defined by `TImmutableDBKeys`). This type is likely used for inserting new user encryption key records into the database.

### TUserEncryptionKeysUpdate
#### Description
A TypeScript type similar to `TUserEncryptionKeysInsert`, but with all properties made optional. This type is likely used for updating existing user encryption key records in the database, allowing partial updates.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| zod | Used for schema definition and validation |

## Notes
- The file is generated automatically by a script and should not be edited manually.
- The schema generation process involves pulling database information and creating a Zod schema based on it.
- The script was written by akhilmhdh.
- The `TImmutableDBKeys` type is imported from a separate file (`./models`) and is used to exclude certain fields from insert and update operations.

This schema and its derived types play a crucial role in maintaining data integrity and type safety when dealing with user encryption keys in the application's database operations.
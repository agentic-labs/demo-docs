---
title: "secret-versions-v2.ts"
---

## High-level description
This code defines a Zod schema for the `SecretVersionsV2` table in a database. It includes various fields related to secret versions, such as id, version, type, key, encrypted values, and metadata. The schema is used for data validation and type inference in TypeScript.

## Symbols

### `SecretVersionsV2Schema`
#### Description
This constant defines a Zod schema for the `SecretVersionsV2` table. It specifies the structure and validation rules for each field in the table.

#### Inputs
N/A (This is a schema definition, not a function)

#### Outputs
N/A (This is a schema definition, not a function)

#### Internal Logic
The schema defines the following fields with their respective types and validation rules:
- `id`: UUID string
- `version`: Number with a default value of 1
- `type`: String with a default value of "shared"
- `key`: String
- `encryptedValue`: Nullable buffer (optional)
- `encryptedComment`: Nullable buffer (optional)
- `reminderNote`: Nullable string (optional)
- `reminderRepeatDays`: Nullable number (optional)
- `skipMultilineEncoding`: Nullable boolean with a default value of false (optional)
- `metadata`: Nullable unknown type (optional)
- `envId`: Nullable UUID string (optional)
- `secretId`: UUID string
- `folderId`: UUID string
- `userId`: Nullable UUID string (optional)
- `createdAt`: Date
- `updatedAt`: Date

### `TSecretVersionsV2`
#### Description
This type is inferred from the `SecretVersionsV2Schema` using Zod's `z.infer&lt;&gt;` utility. It represents the TypeScript type for a secret version record.

### `TSecretVersionsV2Insert`
#### Description
This type represents the shape of data required for inserting a new secret version record. It omits immutable database keys from the `SecretVersionsV2Schema`.

### `TSecretVersionsV2Update`
#### Description
This type represents the shape of data allowed for updating an existing secret version record. It makes all fields from `SecretVersionsV2Schema` optional, except for immutable database keys which are omitted.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| zod | Used for schema definition and validation |
| @app/lib/zod | Imports `zodBuffer` utility |
| @app/db/schemas | Imports `TImmutableDBKeys` type |

## Notes
1. The file is generated by an automation script and should not be manually edited.
2. The schema uses custom Zod types like `zodBuffer`, which is likely a custom extension to Zod for handling Buffer types.
3. The schema includes fields for versioning, encryption, and metadata, suggesting a robust secret management system.
4. The use of nullable and optional fields provides flexibility in the data structure.
5. The schema is designed to work with a database, as evidenced by the inclusion of `createdAt` and `updatedAt` fields.

This schema definition is crucial for maintaining data integrity and type safety when working with secret versions in the application's database.
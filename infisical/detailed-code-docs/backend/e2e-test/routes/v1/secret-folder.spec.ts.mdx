---
title: "secret-folder.spec.ts"
---

## High-level description
This file contains end-to-end tests for the Secret Folder Router API. It tests various operations on folders, including creation, retrieval, updating, and deletion, within different paths and environments.

## Code Structure
The code is structured as a series of test cases using Jest. It includes helper functions for creating and deleting folders, and several test cases that cover different scenarios for folder operations.

## Symbols

### `createFolder`
#### Description
A helper function that creates a folder using the API and returns the created folder object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dto | object | An object containing the path and name of the folder to be created |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| folder | object | The created folder object |

#### Internal Logic
1. Sends a POST request to create a folder
2. Checks if the status code is 200
3. Returns the created folder object

### `deleteFolder`
#### Description
A helper function that deletes a folder using the API and returns the deleted folder object.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| dto | object | An object containing the path and id of the folder to be deleted |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| folder | object | The deleted folder object |

#### Internal Logic
1. Sends a DELETE request to delete a folder
2. Checks if the status code is 200
3. Returns the deleted folder object

### `describe("Secret Folder Router", ...)`
#### Description
The main test suite for the Secret Folder Router API.

#### Internal Logic
Contains multiple test cases for different folder operations:

1. "Create folder $name in $path"
   - Tests folder creation in various paths
   - Verifies the created folder object
   - Deletes the created folder after verification

2. "Get folders $path"
   - Tests retrieving folders from different paths
   - Creates folders, verifies the GET response, then deletes the created folders

3. "Update a deep folder"
   - Tests creating a folder in a deep path
   - Verifies the folder was created correctly
   - Checks if the folder appears in the GET response
   - Deletes the created folder

4. "Delete a deep folder"
   - Tests creating a folder in a deep path
   - Deletes the folder and verifies the deletion
   - Checks that the folder no longer appears in the GET response

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @app/db/seed-data | Provides seed data for testing |

## Error Handling
The tests use Jest's `expect` assertions to check for correct responses and error conditions.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /api/v1/folders | POST | Folder creation details | Created folder object | Creates a new folder |
| /api/v1/folders/${id} | DELETE | Folder deletion details | Deleted folder object | Deletes a folder |
| /api/v1/folders | GET | Query parameters | List of folders | Retrieves folders in a specific path |

Note: All endpoints require JWT authentication via the `authorization` header.
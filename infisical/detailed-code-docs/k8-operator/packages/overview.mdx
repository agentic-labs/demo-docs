---
title: "Overview"
---

## High-level description
The `packages` directory contains essential components for the Infisical Kubernetes operator. It includes packages for API interaction, cryptographic operations, data modeling, and utility functions. These packages work together to provide a comprehensive set of tools for managing secrets, authenticating with various services, and interacting with both Kubernetes and Infisical APIs.

## What does it do?
The packages in this directory collectively enable the Kubernetes operator to:

1. Communicate with the Infisical API to manage service tokens, machine identities, workspace keys, and secrets.
2. Perform cryptographic operations such as symmetric and asymmetric decryption.
3. Define data structures for representing service accounts, machine identities, and environment variables.
4. Provide utility functions for authentication, secret management, and interaction with Kubernetes and Infisical services.

These functionalities allow the operator to securely access and manage secrets stored in Infisical, integrate them into the Kubernetes environment, and handle various aspects of authentication and secret retrieval.

## Key Files

### api/api.go
This file contains the main API functions for interacting with the Infisical service. It includes functions for retrieving service token details, getting service account information, performing machine identity authentication, refreshing access tokens, fetching workspace permissions, and retrieving service account keys.

### crypto/crypto.go
This file provides cryptographic functions for symmetric and asymmetric decryption, as well as a function to compute an ETag (Entity Tag) for data. It utilizes the AES-GCM algorithm for symmetric decryption and the NaCl box for asymmetric decryption.

### model/model.go
This file defines several data structures used for representing various types of information related to service accounts, machine identities, request updates, and environment variables.

### util/secrets.go
This file provides utility functions for handling secrets in the Infisical system. It includes methods for verifying and processing service tokens, retrieving service token details, and fetching plaintext secrets using different authentication methods.

## Dependencies
The packages in this directory rely on several external libraries and frameworks:

1. github.com/go-resty/resty/v2: HTTP client for making API requests
2. golang.org/x/crypto/nacl/box: Provides NaCl box encryption functionality
3. Kubernetes client-go (k8s.io/api/core/v1, sigs.k8s.io/controller-runtime/pkg/client): Used for interacting with the Kubernetes API
4. github.com/infisical/go-sdk: Infisical Go SDK for interacting with the Infisical API

These dependencies were chosen to provide robust interaction with Kubernetes and Infisical services, as well as to leverage existing functionality within the Infisical ecosystem.

## Configuration
The main configuration option for the API package is the `API_HOST_URL` variable defined in `api/variables.go`:

```go
var API_HOST_URL = "https://app.infisical.com/api"
```

This URL serves as the base for all API requests made by the package. While it's defined as a variable, it appears to be intended as a constant configuration value.

Additionally, proper configuration of the Kubernetes and Infisical environments is crucial for the correct functioning of the utilities provided in these packages.

In summary, the `packages` directory provides a comprehensive set of tools for the Infisical Kubernetes operator to handle authentication, secret management, cryptographic operations, and API interactions. These packages work together to enable secure and efficient integration of Infisical's secret management capabilities into the Kubernetes environment.
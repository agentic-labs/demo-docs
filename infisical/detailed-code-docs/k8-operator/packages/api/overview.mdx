---
title: "Overview"
---

## High-level description
This directory contains the API package for a Kubernetes operator that interacts with the Infisical service. It provides a set of functions and data structures for managing service tokens, machine identities, workspace keys, and secrets. The package is designed to facilitate communication between the Kubernetes operator and the Infisical API, handling authentication, secret retrieval, and various other operations related to secret management.

## What does it do?
The API package serves as an interface between the Kubernetes operator and the Infisical secret management service. It allows the operator to:

1. Retrieve service token details and account information
2. Perform machine identity authentication and token refresh
3. Fetch workspace permissions for service accounts
4. Retrieve service account keys
5. Get encrypted and decrypted secrets for specific workspaces and environments
6. Handle workspace key management

These functionalities enable the Kubernetes operator to securely access and manage secrets stored in Infisical, integrating them into the Kubernetes environment.

## Key Files

### api.go
This file contains the main API functions for interacting with the Infisical service. It includes functions for:

- Retrieving service token details
- Getting service account information
- Performing machine identity authentication
- Refreshing access tokens
- Fetching workspace permissions
- Retrieving service account keys

Each function in this file makes HTTP requests to specific endpoints of the Infisical API, handling the responses and potential errors.

### models.go
This file defines the data structures used for API requests and responses. It includes models for:

- Encrypted and decrypted secrets
- Workspace keys
- Service tokens
- Machine identity authentication
- Service account permissions and keys

These structures provide a clear representation of the data exchanged between the Kubernetes operator and the Infisical API.

### variables.go
This file defines the base URL for the Infisical API (`API_HOST_URL`), which is used throughout the package for making API requests.

## Dependencies
The package primarily relies on the following external library:

| Dependency | Version | Purpose |
|:-----------|:--------|:--------|
| github.com/go-resty/resty/v2 | v2 | HTTP client library for making API requests |

The `resty` library is used to simplify HTTP request handling and provide a more convenient way to interact with the Infisical API.

## Configuration
The main configuration option for this package is the `API_HOST_URL` variable defined in `variables.go`:

```go
var API_HOST_URL = "https://app.infisical.com/api"
```

This URL serves as the base for all API requests made by the package. While it's defined as a variable, it appears to be intended as a constant configuration value. If needed, this could be modified to allow for different Infisical API endpoints.

Additionally, the package uses a constant `USER_AGENT_NAME` in the API requests, which is likely defined elsewhere in the codebase.

In summary, this API package provides a comprehensive set of tools for the Kubernetes operator to interact with the Infisical secret management service, handling various aspects of authentication, secret retrieval, and account management. It abstracts the complexities of API communication and data structures, allowing for easier integration of Infisical's secret management capabilities into the Kubernetes environment.
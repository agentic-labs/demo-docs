---
title: "CreateRotationForm.tsx"
---

## High-level description
This code defines a React component called `CreateRotationForm` that implements a two-step wizard for creating secret rotations. It manages the form state, handles user interactions, and communicates with an API to create secret rotations.

## Code Structure
The main component `CreateRotationForm` uses several sub-components and hooks to manage the form state and UI. It utilizes a `useRef` hook to store form data across steps and a `useState` hook to manage the current step of the wizard.

## Symbols

### CreateRotationForm
#### Description
A React component that renders a modal with a two-step form for creating secret rotations.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| isOpen | boolean | Controls the visibility of the modal |
| onToggle | function | Callback to toggle the modal's open state |
| provider | TSecretRotationProviderTemplate | The secret rotation provider template |
| workspaceId | string | The ID of the workspace |
| customProvider | string | Optional custom provider name |

#### Internal Logic
1. Initializes the wizard step state and a ref to store form data.
2. Defines handlers for form cancellation and submission.
3. Renders a modal with a stepper and animated form steps.
4. Uses `AnimatePresence` and `motion.div` for smooth transitions between steps.
5. Renders either `RotationInputForm` or `RotationOutputForm` based on the current step.
6. On final submission, calls the `createSecretRotation` API and handles success/error.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| framer-motion | Animation library for smooth transitions |
| @app/components/notifications | For creating notifications |
| @app/components/v2 | UI components (Modal, ModalContent, Step, Stepper) |
| @app/hooks/api | Custom hook for creating secret rotations |

## Error Handling
The component implements basic error handling in the `handleFormSubmit` function. If an error occurs during the API call, it logs the error to the console and displays an error notification to the user.

## API/Interface Reference
| Function | Purpose |
|:---------|:--------|
| createSecretRotation | Asynchronous function to create a secret rotation |

## Performance Considerations
The component uses `AnimatePresence` and `motion.div` for animations, which may impact performance on lower-end devices. However, the impact should be minimal for most use cases.
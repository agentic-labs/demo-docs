---
title: "AuditLogsRetentionSection.tsx"
---

## High-level description
This code defines the `AuditLogsRetentionSection` component, which allows users to set the retention period for audit logs in a project. It includes form validation, permission checks, and integration with the workspace and subscription context.

## Code Structure
The main component `AuditLogsRetentionSection` uses several hooks and components to manage form state, API calls, and UI elements. It interacts with the workspace and subscription context to determine the current settings and user permissions.

## Symbols

### `AuditLogsRetentionSection`
#### Description
This is the main functional component that renders the audit logs retention section of the project settings page.

#### Internal Logic
1. Initializes form using `react-hook-form` with Zod schema validation.
2. Fetches current workspace and subscription data.
3. Handles form submission, including permission and subscription checks.
4. Renders the form and an upgrade plan modal when necessary.
5. Conditionally renders based on the current environment (not shown for specific Infisical instances).

### `formSchema`
#### Description
Defines the validation schema for the audit logs retention form using Zod.

#### Internal Logic
Validates that the `auditLogsRetentionDays` field is a number and at least 0.

### `handleAuditLogsRetentionSubmit`
#### Description
Async function that handles the form submission for updating audit logs retention.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| auditLogsRetentionDays | number | The number of days to retain audit logs |

#### Internal Logic
1. Checks if the user has the necessary subscription for audit logs.
2. Verifies if the requested retention period is within the subscription limits.
3. Updates the workspace audit logs retention using the API.
4. Displays a success or error notification based on the result.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management and validation |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| zod | Schema validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components (Button, FormControl, Input, UpgradePlanModal) |
| @app/context | Hooks for project permission, subscription, and workspace data |
| @app/hooks | Custom hooks (usePopUp) |
| @app/hooks/api/roles/types | Project membership role types |
| @app/hooks/api/workspace/queries | API query hook for updating workspace audit logs retention |

## Error Handling
The component uses try-catch blocks to handle errors during form submission and displays error notifications using the `createNotification` function.

## Performance Considerations
The component uses React hooks for efficient state management and re-rendering. It also conditionally renders based on the current environment and user permissions to optimize performance.

## TODOs
There are no explicit TODOs in the code.
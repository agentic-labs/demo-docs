---
title: "AddEnvironmentModal.tsx"
---

## High-level description
This code defines a React component `AddEnvironmentModal` that renders a modal for creating a new environment in a workspace. It uses React Hook Form for form management, Yup for form validation, and custom hooks for API interactions and workspace context.

## Code Structure
The main component `AddEnvironmentModal` uses several hooks and utilities to manage form state, validation, and API calls. It renders a modal with a form containing inputs for environment name and slug, along with submission and cancellation buttons.

## Symbols

### `AddEnvironmentModal`
#### Description
A React functional component that renders a modal for creating a new environment.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| popUp | UsePopUpState&lt;["createEnv"]&gt; | State object for managing the modal's open/close state |
| handlePopUpClose | function | Function to close the modal |
| handlePopUpToggle | function | Function to toggle the modal's state |

#### Internal Logic
1. Uses `useWorkspace` hook to get the current workspace.
2. Uses `useCreateWsEnvironment` hook for the API call to create an environment.
3. Sets up form management with `useForm` hook from react-hook-form.
4. Defines `onFormSubmit` function to handle form submission:
   - Calls the API to create a new environment.
   - Shows a success or error notification.
   - Closes the modal on success.
5. Renders a `Modal` component with two `Controller` components for name and slug inputs.
6. Includes "Create" and "Cancel" buttons for form submission and modal closure.

### `schema`
#### Description
Yup validation schema for the environment creation form.

#### Internal Logic
Defines validation rules for:
- `environmentName`: Required string.
- `environmentSlug`: Required string, must be a valid slug.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management |
| @hookform/resolvers/yup | Yup resolver for react-hook-form |
| @sindresorhus/slugify | Slug validation |
| yup | Schema validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components |
| @app/context | Workspace context |
| @app/hooks/api | API hooks |
| @app/hooks/usePopUp | Modal state management |

## Error Handling
The component uses try-catch block in the `onFormSubmit` function to handle errors during environment creation. It logs errors to the console and displays an error notification to the user.

## Logging
The component logs errors to the console using `console.error` when environment creation fails.

This component provides a user-friendly interface for creating new environments within a workspace, with proper form validation, error handling, and user feedback through notifications.
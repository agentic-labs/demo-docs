---
title: "OrgEncryptionTab.tsx"
---

## High-level description
This code defines the `OrgEncryptionTab` component, which is responsible for displaying and managing external Key Management System (KMS) configurations for an organization. It allows users to view, add, edit, and delete external KMS providers, with appropriate permission checks and plan restrictions.

## Code Structure
The main component `OrgEncryptionTab` is wrapped with a permission check using `withPermission`. It uses various hooks and components to fetch data, manage state, and render the UI. The component includes a table to display KMS providers and modals for adding, editing, and deleting KMS configurations.

## Symbols

### OrgEncryptionTab
#### Description
This is the main component that renders the KMS management interface. It displays a table of external KMS providers and provides options to add, edit, and delete them.

#### Internal Logic
1. Fetches the current organization and subscription data.
2. Uses the `usePopUp` hook to manage various modal states.
3. Fetches the list of external KMS providers using `useGetExternalKmsList`.
4. Renders a table with KMS provider information.
5. Implements add, edit, and delete functionality for KMS providers.
6. Checks for user permissions and subscription status before allowing certain actions.

#### Performance Considerations
The component uses React Query hooks (`useGetExternalKmsList`, `useRemoveExternalKms`) for efficient data fetching and caching.

### handleRemoveExternalKms
#### Description
This function handles the removal of an external KMS provider.

#### Internal Logic
1. Extracts the `kmsId` from the popup data.
2. Calls the `removeExternalKms` mutation.
3. Displays a success notification on successful deletion.
4. Closes the removal confirmation modal.
5. Handles and logs any errors that occur during the process.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @fortawesome/react-fontawesome | For rendering icons |
| tailwind-merge | For merging Tailwind CSS classes |
| @app/components | Various UI components and utilities |
| @app/context | Organization and subscription context |
| @app/hoc | Higher-order components for permissions |
| @app/hooks | Custom hooks for API calls and UI management |

## Error Handling
The component includes basic error handling, logging errors to the console when they occur during KMS removal.

## API/Interface Reference
The component interacts with the following API endpoints (implied from the hooks used):
- Get external KMS list
- Remove external KMS

## TODOs
There are no explicit TODOs in the code.

This component is part of a larger application dealing with organization settings and encryption management. It relies on various context providers and custom hooks to access organization data, subscription information, and perform API operations.
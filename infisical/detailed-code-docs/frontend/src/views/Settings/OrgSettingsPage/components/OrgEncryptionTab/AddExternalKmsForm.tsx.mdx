---
title: "AddExternalKmsForm.tsx"
---

## High-level description
This code defines a React component called `AddExternalKmsForm` that implements a wizard-like interface for adding an external Key Management System (KMS) to an organization's settings. It allows users to select a KMS provider (currently only AWS) and then enter the necessary details for that provider.

## Code Structure
The main component `AddExternalKmsForm` uses React hooks to manage its state and renders a modal with different content based on the current step of the wizard. It imports and uses several UI components and icons, as well as animation utilities from Framer Motion.

## Symbols

### `AddExternalKmsForm`
#### Description
This is the main functional component that renders the form for adding an external KMS.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| isOpen | boolean | Optional. Determines if the modal is open |
| onToggle | function | Callback function to toggle the modal's open state |

#### Internal Logic
1. Initializes state for the current wizard step and selected provider.
2. Defines a `handleFormReset` function to reset the form state.
3. Renders a `Modal` component with `ModalContent` inside.
4. Uses `AnimatePresence` and `motion.div` for smooth transitions between steps.
5. Renders either the provider selection step or the AWS KMS form based on the current wizard step.

### `WizardSteps` (enum)
#### Description
An enumeration defining the possible steps in the wizard.

| Name | Value | Description |
|:-----|:------|:------------|
| SelectProvider | "select-provider" | Step for selecting the KMS provider |
| ProviderInputs | "provider-inputs" | Step for inputting provider-specific details |

### `EXTERNAL_KMS_LIST` (constant)
#### Description
An array of objects defining the available external KMS providers.

| Property | Type | Description |
|:---------|:-----|:------------|
| icon | IconDefinition | FontAwesome icon for the provider |
| provider | ExternalKmsProvider | Enum value representing the provider |
| title | string | Display name of the provider |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| @fortawesome/free-brands-svg-icons | Provides brand icons (e.g., AWS) |
| @fortawesome/react-fontawesome | FontAwesome component for React |
| framer-motion | Animation library for React |
| @app/components/v2 | Custom UI components (Modal, ModalContent) |
| @app/hooks/api/kms/types | Types related to KMS (ExternalKmsProvider) |
| ./AwsKmsForm | Component for AWS KMS specific inputs |

## Side Effects
The component manages the open state of a modal and transitions between different steps of the form wizard. It doesn't directly modify any external state or resources.

## Performance Considerations
The component uses `AnimatePresence` from Framer Motion, which may have a slight performance impact for animations. However, given the simplicity of the animations and the limited scope of the component, this is unlikely to cause significant performance issues.
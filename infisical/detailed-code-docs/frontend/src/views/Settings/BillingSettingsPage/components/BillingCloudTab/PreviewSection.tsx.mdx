---
title: "PreviewSection.tsx"
---

## High-level description
This code defines a React component called `PreviewSection` that displays billing and subscription information for an organization. It includes upgrade options, current plan details, and a modal for managing plans.

## Code Structure
The `PreviewSection` component uses several hooks and components to fetch and display data. It interacts with the organization and subscription contexts, and uses custom hooks for API calls and managing pop-ups.

## Symbols

### `PreviewSection`
#### Description
A functional component that renders the billing preview section, including upgrade options, current plan details, and billing information.

#### Internal Logic
1. Fetches organization and subscription data using context hooks.
2. Retrieves billing information using the `useGetOrgPlanBillingInfo` hook.
3. Handles upgrading to a pro plan or starting a trial.
4. Formats and displays billing information such as amount and dates.
5. Renders different sections based on the current subscription status.

#### Side Effects
- Makes API calls to fetch billing information and create customer portal sessions.
- May redirect the user to external URLs for upgrading plans or starting trials.

### Helper Functions

#### `formatAmount`
Formats a number as a USD currency string.

#### `formatDate`
Converts a Unix timestamp to a formatted date string (DD/MM/YYYY).

#### `formatPlanSlug`
Formats a plan slug string by capitalizing words and replacing hyphens with spaces.

#### `handleUpgradeBtnClick`
Handles the logic for upgrading a plan or starting a trial, including API calls and redirects.

## Dependencies
- React and various hooks (useState, useEffect)
- Next.js Link component
- FontAwesome icons
- Custom components: OrgPermissionCan, Button, ManagePlansModal
- Custom hooks: useOrganization, useSubscription, useGetOrgPlanBillingInfo, useGetOrgTrialUrl, useCreateCustomerPortalSession, usePopUp

## Error Handling
The code includes basic error handling, such as logging errors to the console when upgrading fails.

## Performance Considerations
The component uses the `useGetOrgPlanBillingInfo` hook with the organization ID, which may trigger API calls. Proper memoization and caching strategies should be considered for optimal performance.

## TODOs
There are no explicit TODOs in the code.
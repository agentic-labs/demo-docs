---
title: "SecretV2MigrationSection.tsx"
---

## High-level description
This code defines a React component called `SecretV2MigrationSection` that handles the upgrade process of a project from V2 to V3 in the Infisical secrets engine. It provides a user interface for initiating the upgrade, checks for necessary requirements, and manages the upgrade process.

## Code Structure
The main component `SecretV2MigrationSection` uses several hooks and sub-components to manage the upgrade process. It interacts with the API using custom hooks and displays various UI elements based on the current state of the upgrade.

## Symbols

### `SecretV2MigrationSection`
#### Description
This is the main functional component that renders the upgrade section for migrating secrets from V2 to V3.

#### Internal Logic
1. Initializes various hooks for form handling, API calls, and UI state management.
2. Checks if the project is already upgraded or in the process of upgrading.
3. Renders a button to initiate the upgrade process if the user is an admin.
4. Displays a modal with a checklist of requirements before allowing the upgrade.
5. Handles the upgrade process, including API calls and notifications.

#### Side Effects
- Fetches workspace details at regular intervals if an upgrade is in progress.
- Resets the form when the modal is closed.
- Displays notifications for successful or failed upgrades.

### `ProjectUpgradeStatus` (enum)
#### Description
Defines the possible states of the project upgrade process.

### `formSchema` (const)
#### Description
Defines the Zod schema for form validation, ensuring all checkboxes are checked before allowing the upgrade.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form handling and validation |
| @fortawesome/free-solid-svg-icons | Icon library |
| @fortawesome/react-fontawesome | FontAwesome component for React |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| zod | Schema validation library |
| @app/components/notifications | Custom notification component |
| @app/components/v2 | Various UI components |
| @app/context | Context providers for workspace and project permissions |
| @app/hooks | Custom hooks for UI and API interactions |

## Error Handling
The component handles errors during the upgrade process by displaying error notifications using the `createNotification` function.

## API/Interface Reference
| Hook | Purpose |
|:-----|:--------|
| useGetWorkspaceById | Fetches workspace details |
| useMigrateProjectToV3 | Initiates the project migration to V3 |

## Performance Considerations
The component uses `refetchInterval` to periodically check the upgrade status, which may impact performance if not managed carefully.
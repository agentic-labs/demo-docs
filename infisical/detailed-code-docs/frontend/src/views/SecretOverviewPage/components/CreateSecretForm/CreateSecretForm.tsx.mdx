---
title: "CreateSecretForm.tsx"
---

## High-level description
This code defines a React component called `CreateSecretForm` that provides a form for creating and updating secrets across multiple environments in a workspace. It uses React Hook Form for form management, Zod for schema validation, and various custom hooks and components for API interactions and UI elements.

## Code Structure
The main component `CreateSecretForm` contains form logic, API calls, and rendering of form elements. It uses several custom hooks and components from the application's ecosystem to handle permissions, workspace data, and API operations.

## Symbols

### `CreateSecretForm`
#### Description
A React component that renders a modal form for creating and updating secrets across multiple environments.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| secretPath | string | The path where the secret will be created (default: "/") |
| getSecretByKey | function | A function to retrieve an existing secret by key |
| isOpen | boolean | Controls the visibility of the modal |
| onClose | function | Callback function to close the modal |
| onTogglePopUp | function | Callback function to toggle the modal's visibility |

#### Internal Logic
1. Initializes form using `useForm` hook with Zod schema validation
2. Fetches workspace and permission data using custom hooks
3. Handles form submission:
   - Validates selected environments
   - Creates folders if necessary
   - Creates or updates secrets in selected environments
4. Manages clipboard paste events to auto-fill form fields
5. Renders form fields, environment checkboxes, and submission buttons

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management and validation |
| @casl/ability | Permission checking |
| @fortawesome | Icons |
| zod | Schema validation |
| @app/components | UI components and notifications |
| @app/context | Project permissions and workspace data |
| @app/hooks/api | API interaction hooks |

## Error Handling
The component uses form validation and displays error messages for invalid inputs. It also shows notifications for successful or failed secret creation/update operations.

## API/Interface Reference
| Hook | Purpose |
|:-----|:--------|
| useCreateSecretV3 | Creates a new secret |
| useUpdateSecretV3 | Updates an existing secret |
| useCreateFolder | Creates a new folder for secrets |

## Performance Considerations
The component uses React Hook Form for efficient form state management and Zod for schema validation, which helps in optimizing performance for form handling and validation.
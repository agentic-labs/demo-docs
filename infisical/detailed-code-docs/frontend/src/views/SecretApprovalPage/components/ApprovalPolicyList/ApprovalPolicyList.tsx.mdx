---
title: "ApprovalPolicyList.tsx"
---

## High-level description
This code defines a React component called `ApprovalPolicyList` that displays a list of approval policies for a workspace. It allows users to view, create, edit, and delete policies, with filtering options for different policy types.

## Code Structure
The main component `ApprovalPolicyList` uses several custom hooks and sub-components to manage state, fetch data, and render the UI. It interacts with API hooks for fetching and manipulating policy data, and uses context providers for workspace and permission management.

## Symbols

### `useApprovalPolicies`
#### Description
A custom hook that fetches and combines both access and secret approval policies for a given workspace.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| permission | TProjectPermission | Project permissions object |
| currentWorkspace | Workspace | Current workspace object |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| policies | Array | Combined and sorted list of access and secret policies |
| isLoading | boolean | Loading state for policy fetching |

#### Internal Logic
1. Fetches access and secret policies using separate API hooks.
2. Combines and sorts the policies based on their `updatedAt` timestamp.
3. Returns the combined policies and loading state.

### `ApprovalPolicyList`
#### Description
The main component that renders the approval policy list and manages user interactions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| workspaceId | string | ID of the current workspace |

#### Internal Logic
1. Uses various hooks to manage state and fetch data (policies, workspace users, permissions).
2. Implements filtering logic for policy types.
3. Handles policy creation, editing, and deletion.
4. Renders the policy list table with sorting and filtering options.
5. Manages modals for policy form, deletion confirmation, and plan upgrade.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| @fortawesome/free-solid-svg-icons | Icons for UI elements |
| @fortawesome/react-fontawesome | FontAwesome icon component |
| @app/components/notifications | Notification creation utility |
| @app/components/permissions | Permission-based rendering component |
| @app/components/v2 | Various UI components |
| @app/context | Context providers for project permissions, subscription, and workspace |
| @app/hooks | Custom hooks for UI management |
| @app/hooks/api | API hooks for data fetching and manipulation |

## Error Handling
The component implements basic error handling for policy deletion, displaying error notifications using the `createNotification` function.

## Logging
The component logs errors to the console when policy deletion fails.

## API/Interface Reference
The component interacts with several API endpoints through custom hooks:
- `useGetAccessApprovalPolicies`
- `useGetSecretApprovalPolicies`
- `useGetWorkspaceUsers`
- `useDeleteSecretApprovalPolicy`
- `useDeleteAccessApprovalPolicy`

These hooks handle the API calls and return the necessary data and mutation functions.
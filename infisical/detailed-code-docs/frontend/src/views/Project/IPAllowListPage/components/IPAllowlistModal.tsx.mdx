---
title: "IPAllowlistModal.tsx"
---

## High-level description
This code defines a React component called `IPAllowlistModal` that renders a modal for adding or updating trusted IP addresses. It uses React Hook Form for form management, Yup for form validation, and custom hooks for API interactions.

## Code Structure
The main component `IPAllowlistModal` uses several hooks and components to manage its state and render the UI. It interacts with the API using custom hooks for adding and updating trusted IPs.

## Symbols

### `IPAllowlistModal`
#### Description
A React component that renders a modal for adding or updating trusted IP addresses.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| popUp | UsePopUpState&lt;["trustedIp"]&gt; | State of the popup |
| handlePopUpClose | function | Function to close the popup |
| handlePopUpToggle | function | Function to toggle the popup state |

#### Internal Logic
1. Uses `useForm` hook to manage form state and validation.
2. Uses `useEffect` to reset form fields when the modal opens or closes.
3. Handles form submission by calling the appropriate API function (add or update).
4. Renders a form with input fields for IP address and comment.
5. Provides a button to automatically fill in the user's current IP address.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management |
| @hookform/resolvers/yup | Yup resolver for react-hook-form |
| yup | Form validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components |
| @app/context | Workspace context |
| @app/hooks/api | API interaction hooks |
| @app/hooks/usePopUp | Popup state management |

## Error Handling
The component uses try-catch blocks to handle errors during form submission. It displays error notifications using the `createNotification` function.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /api/v1/workspace/${workspaceId}/trusted-ips | POST | { ipAddress, comment, isActive } | - | Add a new trusted IP |
| /api/v1/workspace/${workspaceId}/trusted-ips/${trustedIpId} | PATCH | { ipAddress, comment, isActive } | - | Update an existing trusted IP |

Note: The actual API calls are abstracted away in the custom hooks `useAddTrustedIp` and `useUpdateTrustedIp`.
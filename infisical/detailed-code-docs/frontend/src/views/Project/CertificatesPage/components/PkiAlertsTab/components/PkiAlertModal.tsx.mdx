---
title: "PkiAlertModal.tsx"
---

## High-level description
This code defines a React component `PkiAlertModal` that renders a modal for creating or editing PKI (Public Key Infrastructure) alerts. It uses React Hook Form for form management and Zod for schema validation. The component allows users to set up alerts for certificate collections, specifying alert timing and recipient emails.

## Code Structure
The main component `PkiAlertModal` uses several hooks for form management, API calls, and workspace context. It defines a form schema, handles form submission, and renders form fields for alert creation/editing.

## Symbols

### `PkiAlertModal`
#### Description
A React component that renders a modal for creating or editing PKI alerts.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| popUp | UsePopUpState&lt;["pkiAlert"]&gt; | State for controlling the modal's visibility |
| handlePopUpToggle | function | Function to toggle the modal's visibility |

#### Internal Logic
1. Fetches existing alert data if editing
2. Fetches PKI collections for the current workspace
3. Sets up form with React Hook Form and Zod validation
4. Handles form submission, creating or updating the alert
5. Renders form fields for alert details

### `convertToDays`
#### Description
A utility function that converts a time unit and value to days.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| unit | TimeUnit | The time unit (day, week, month, year) |
| value | number | The number of units |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| days | number | The equivalent number of days |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form state management and validation |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| zod | Schema declaration and validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components |
| @app/context | Workspace context |
| @app/hooks/api | API hooks for PKI operations |
| @app/hooks/usePopUp | Custom hook for managing pop-up state |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| TimeUnit | enum | - | Defines time units for alert timing |

## Error Handling
The component uses try-catch blocks to handle errors during form submission. Errors are logged to the console and displayed as notifications to the user.

## Logging
Console errors are logged for failed alert creation or updates.

## TODOs
- Add default collection: There's a TODO comment suggesting to add a default collection when resetting the form.
---
title: "CertificateModal.tsx"
---

## High-level description
This code defines a React component called `CertificateModal` that provides a form for creating or viewing certificates. It allows users to input certificate details, select certificate templates, and submit the form to create a new certificate or view an existing one.

## Code Structure
The main component `CertificateModal` uses React hooks and form handling libraries to manage state and form submission. It interacts with several API hooks to fetch and submit data related to certificates, certificate authorities (CAs), and PKI collections.

## Symbols

### CertificateModal
#### Description
A React functional component that renders a modal for creating or viewing certificates.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| popUp | UsePopUpState&lt;["certificate"]&gt; | State object for controlling the modal's visibility |
| handlePopUpToggle | function | Function to toggle the modal's visibility |

#### Internal Logic
1. Initializes form state using `react-hook-form` with Zod schema validation.
2. Fetches data for CAs, PKI collections, and certificate templates using custom hooks.
3. Handles form submission to create a new certificate.
4. Renders form fields for certificate details, including template selection, CA selection, and certificate properties.
5. Displays the created certificate details after successful submission.

### schema
#### Description
Zod schema object defining the structure and validation rules for the certificate form data.

### FormData
#### Description
TypeScript type derived from the Zod schema, representing the structure of the form data.

### TCertificateDetails
#### Description
TypeScript type defining the structure of certificate details returned after creation.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form handling and validation |
| @fortawesome/react-fontawesome | Icon components |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| zod | Schema validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components |
| @app/context | Workspace context |
| @app/hooks/api | API hooks for fetching and submitting data |

## Error Handling
The component uses try-catch blocks to handle errors during certificate creation. It displays error notifications using the `createNotification` function.

## Logging
The component logs errors to the console using `console.error` when certificate creation fails.

## Performance Considerations
The component uses React hooks like `useEffect` to optimize data fetching and form field updates based on changes in dependencies.

## TODOs
There are no explicit TODOs in the code.
---
title: "ExternalCaInstallForm.tsx"
---

## High-level description
This code defines a React component called `ExternalCaInstallForm` that allows users to install a certificate for a Certificate Authority (CA). It provides a form for users to input the certificate body and certificate chain, displays the Certificate Signing Request (CSR) for the CA, and handles the submission of the form to import the CA certificate.

## Code Structure
The main component `ExternalCaInstallForm` uses React Hook Form for form management, Zod for schema validation, and custom hooks for API interactions. It also utilizes various UI components from a custom component library.

## Symbols

### `ExternalCaInstallForm`
#### Description
A React functional component that renders a form for installing an external CA certificate.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| caId | string | The ID of the Certificate Authority |
| handlePopUpToggle | function | A function to toggle the popup state |

#### Internal Logic
1. Initializes form using `useForm` hook with Zod schema validation.
2. Fetches CSR data using `useGetCaCsr` hook.
3. Handles form submission using `onFormSubmit` function.
4. Renders CSR information with copy and download functionality.
5. Renders form inputs for certificate body and chain using `Controller` components.
6. Provides buttons for form submission and cancellation.

### `schema`
#### Description
Zod schema object defining the structure and validation rules for the form data.

### `onFormSubmit`
#### Description
Asynchronous function that handles the form submission.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| certificate | string | The certificate body |
| certificateChain | string | The certificate chain |

#### Internal Logic
1. Checks for the presence of required data.
2. Calls `importCaCertificate` mutation with form data.
3. Resets the form and displays a success notification on successful import.
4. Displays an error notification if the import fails.

### `downloadTxtFile`
#### Description
Function to download a text file with given filename and content.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| filename | string | The name of the file to be downloaded |
| content | string | The content of the file |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form state management and validation |
| @fortawesome/free-solid-svg-icons | Icons for UI elements |
| @fortawesome/react-fontawesome | FontAwesome icon component |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| file-saver | Library for saving files on the client-side |
| zod | Schema declaration and validation library |
| @app/components/notifications | Custom notification component |
| @app/components/v2 | Custom UI components |
| @app/context | Workspace context |
| @app/hooks | Custom hooks |
| @app/hooks/api | API-related hooks |

## Error Handling
The component uses try-catch blocks to handle errors during form submission. It displays error notifications using the `createNotification` function when errors occur.

## Logging
This component does not implement any specific logging mechanisms.
---
title: "AddPkiCollectionItemModal.tsx"
---

## High-level description
This code defines a React component `AddPkiCollectionItemModal` that renders a modal for adding either a Certificate Authority (CA) or a Certificate to a PKI (Public Key Infrastructure) collection. It uses React Hook Form for form management and Zod for schema validation.

## Code Structure
The main component `AddPkiCollectionItemModal` uses several hooks for data fetching and state management. It renders a form with a select input for choosing a CA or Certificate, depending on the `type` prop. The form submission triggers an API call to add the selected item to the PKI collection.

## Symbols

### `AddPkiCollectionItemModal`
#### Description
A React functional component that renders a modal for adding items to a PKI collection.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| collectionId | string | The ID of the PKI collection |
| type | PkiItemType | The type of item to add (CA or Certificate) |
| popUp | UsePopUpState&lt;["addPkiCollectionItem"]&gt; | State for controlling the modal visibility |
| handlePopUpToggle | function | Function to toggle the modal visibility |

#### Internal Logic
1. Fetches CAs and Certificates data based on the current workspace.
2. Uses React Hook Form to manage form state and submission.
3. Renders a form with a select input for choosing a CA or Certificate.
4. On form submission, calls the `addItemToPkiCollection` mutation and displays a success notification.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management |
| @hookform/resolvers/zod | Zod resolver for form validation |
| zod | Schema validation |
| @app/components/notifications | Notification creation |
| @app/components/v2 | UI components |
| @app/context | Workspace context |
| @app/hooks/api | API hooks for data fetching and mutations |
| @app/hooks/usePopUp | Custom hook for managing pop-up state |

## Error Handling
The component uses a try-catch block in the `onFormSubmit` function to handle errors during the API call. Errors are logged to the console.

## TODOs
There's a comment suggesting that the component should be optimized for easier finding of certificates and CAs.

## Notes
1. The code includes commented-out sections for a type selector, which is currently not in use.
2. The component uses Tailwind CSS classes for styling.
3. The modal's visibility is controlled by the `popUp` prop and `handlePopUpToggle` function.
4. The component is designed to work with either CAs or Certificates, determined by the `type` prop.
---
title: "SecretMainPage.tsx"
---

## High-level description
This code represents the main page for managing secrets in a project. It includes functionality for viewing, creating, editing, and deleting secrets and folders, as well as handling secret imports, dynamic secrets, and snapshots. The component integrates various features like permissions, filtering, sorting, and rollback capabilities.

## Code Structure
The `SecretMainPage` component is the main container, which uses several sub-components and hooks to manage different aspects of the secret management interface. It interacts with the API through custom hooks and manages the UI state using React hooks and a custom store.

## Symbols

### SecretMainPage
#### Description
The main component that renders the secret management interface.

#### Internal Logic
1. Fetches and displays secrets, folders, imports, and dynamic secrets.
2. Handles user interactions like sorting, filtering, and navigation.
3. Manages the visibility of secrets and the creation of new secrets.
4. Implements snapshot and rollback functionality.

### useGetProjectSecrets
#### Description
A custom hook that fetches project secrets from the API.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| workspaceId | string | The ID of the workspace |
| environment | string | The environment name |
| secretPath | string | The path of the secret |
| options | object | Additional options for the query |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | SecretV3RawSanitized[] | An array of sanitized secret objects |

### CreateSecretForm
#### Description
A component that renders a form for creating new secrets.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| environment | string | The environment name |
| workspaceId | string | The ID of the workspace |
| secretPath | string | The path of the secret |
| autoCapitalize | boolean | Whether to auto-capitalize secret keys |
| isProtectedBranch | boolean | Whether the branch is protected |

### FolderListView
#### Description
A component that displays a list of folders and handles folder-related actions.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| folders | TSecretFolder[] | An array of folder objects |
| environment | string | The environment name |
| workspaceId | string | The ID of the workspace |
| secretPath | string | The path of the secret |
| sortDir | SortDir | The sorting direction |
| searchTerm | string | The search term for filtering folders |

### SnapshotView
#### Description
A component that displays a snapshot of secrets and allows rollback functionality.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| snapshotId | string | The ID of the snapshot |
| environment | string | The environment name |
| workspaceId | string | The ID of the workspace |
| secretPath | string | The path of the secret |
| secrets | SecretV3RawSanitized[] | An array of current secrets |
| folders | TSecretFolder[] | An array of current folders |
| snapshotCount | number | The total number of snapshots |
| onGoBack | function | Callback for navigating back |
| onClickListSnapshot | function | Callback for listing snapshots |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form handling |
| @casl/ability | Permission management |
| @fortawesome | Icon library |
| @app/components | Custom UI components |
| @app/hooks | Custom React hooks |
| @app/context | Application context providers |

## Error Handling
The code implements error handling through try-catch blocks and displays notifications to the user using the `createNotification` function.

## Logging
The code uses `console.log` for logging errors in development.

## API/Interface Reference
The component interacts with various API endpoints through custom hooks like `useGetProjectSecrets`, `useGetDynamicSecrets`, and `useGetSecretImports`.

## Performance Considerations
The component uses React Query for efficient data fetching and caching. It also implements pagination for snapshots to improve performance when dealing with large datasets.
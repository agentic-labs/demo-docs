---
title: "SecretListView.tsx"
---

## High-level description
This code defines a React component called `SecretListView` that displays a list of secrets with various functionalities such as filtering, sorting, and grouping. It also includes modals for deleting secrets, viewing secret details, creating tags, and sharing secrets.

## Code Structure
The main `SecretListView` component uses several custom hooks and utility functions to manage state and perform operations on secrets. It renders a list of secrets grouped by namespace (if applicable) and includes child components for individual secret items and modals for various actions.

## Symbols

### `SecretListView`
#### Description
The main component that renders the list of secrets and manages various operations on them.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| secrets | SecretV3RawSanitized[] | Array of secret objects |
| environment | string | Current environment |
| workspaceId | string | ID of the current workspace |
| secretPath | string | Path of the secret |
| filter | Filter | Filter object for secrets |
| sortDir | SortDir | Sort direction for secrets |
| tags | WsTag[] | Array of workspace tags |
| isVisible | boolean | Visibility flag |
| isProtectedBranch | boolean | Flag indicating if the branch is protected |

#### Internal Logic
1. Uses custom hooks for managing popups and secret operations.
2. Implements functions for handling secret operations (create, update, delete).
3. Renders secrets grouped by namespace if applicable.
4. Renders modals for various actions (delete, detail view, create tag, share secret).

### `reorderSecretGroupByUnderscore`
#### Description
A utility function that groups secrets by their namespace based on the last underscore in the key.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| secrets | SecretV3RawSanitized[] | Array of secret objects |
| sortDir | SortDir | Sort direction for namespaces |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Array&lt;{namespace: string, secrets: SecretV3RawSanitized[]}&gt; | Grouped and sorted secrets |

### `reorderSecret`
#### Description
A utility function that reorders secrets based on the provided filter and sort direction.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| secrets | SecretV3RawSanitized[] | Array of secret objects |
| sortDir | SortDir | Sort direction for secrets |
| filter | GroupBy \| null | Optional grouping filter |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Array&lt;{namespace: string, secrets: SecretV3RawSanitized[]}&gt; | Reordered secrets |

### `filterSecrets`
#### Description
A utility function that filters secrets based on the provided filter criteria.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| secrets | SecretV3RawSanitized[] | Array of secret objects |
| filter | Filter | Filter object containing search and tag filters |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | SecretV3RawSanitized[] | Filtered array of secrets |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| @fortawesome/react-fontawesome | Font Awesome icon component |
| @tanstack/react-query | Data fetching and caching library |
| tailwind-merge | Utility for merging Tailwind CSS classes |
| Various custom components and hooks | UI components and application-specific hooks |

## Error Handling
The component implements basic error handling for secret operations, logging errors to the console and displaying error notifications to the user.

## Logging
The component uses `console.log` for logging errors during secret operations.

## TODOs
- There's a comment suggesting to wrap the query invalidation logic in another function for reuse.

This component is a complex and feature-rich implementation of a secret list view with various operations and state management. It demonstrates the use of React hooks, custom components, and utility functions to create a modular and maintainable codebase.
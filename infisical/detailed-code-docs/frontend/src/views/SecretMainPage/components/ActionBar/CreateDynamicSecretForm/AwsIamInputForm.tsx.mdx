---
title: "AwsIamInputForm.tsx"
---

## High-level description
This code defines a React component called `AwsIamInputForm` that renders a form for creating AWS IAM dynamic secrets. It uses React Hook Form for form management and Zod for schema validation. The form collects various AWS-related inputs and submits them to create a dynamic secret.

## Code Structure
The main component `AwsIamInputForm` uses several hooks and components to manage form state, validation, and submission. It defines a form schema using Zod and utilizes React Hook Form's `useForm` hook for form handling. The component renders form fields for AWS configuration and secret settings.

## Symbols

### `formSchema`
#### Description
Defines the validation schema for the form using Zod.

#### Internal Logic
- Validates various AWS-related inputs
- Implements custom validation for TTL fields
- Ensures the secret name is lowercase

### `AwsIamInputForm`
#### Description
The main React component that renders the form for creating AWS IAM dynamic secrets.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| onCompleted | function | Callback function called when form submission is successful |
| onCancel | function | Callback function called when the form is cancelled |
| secretPath | string | Path where the secret will be stored |
| projectSlug | string | Identifier for the project |
| environment | string | Environment identifier |

#### Internal Logic
1. Uses `useForm` hook to manage form state and validation
2. Implements `handleCreateDynamicSecret` function to submit the form data
3. Renders form fields for AWS configuration and secret settings
4. Uses `Controller` components from React Hook Form to manage individual form inputs
5. Implements error handling and displays notifications on submission failure

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management and validation |
| @hookform/resolvers/zod | Zod resolver for React Hook Form |
| ms | Parsing time strings |
| zod | Schema definition and validation |
| @app/components/features | Custom form components |
| @app/components/notifications | Notification management |
| @app/components/v2 | UI components |
| @app/hooks/api | API hooks for creating dynamic secrets |

## Error Handling
The component uses Zod for input validation and displays error messages for invalid inputs. It also handles API errors by showing a notification when the dynamic secret creation fails.

## API/Interface Reference
The component interacts with an API through the `useCreateDynamicSecret` hook. The form submission sends the following data:

| Field | Description |
|:------|:------------|
| provider | AWS IAM provider configuration |
| maxTTL | Maximum time-to-live for the secret |
| name | Name of the dynamic secret |
| path | Path where the secret will be stored |
| defaultTTL | Default time-to-live for the secret |
| projectSlug | Project identifier |
| environmentSlug | Environment identifier |

This component provides a comprehensive interface for creating AWS IAM dynamic secrets with various configuration options and validation rules.
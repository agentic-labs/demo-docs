---
title: "IdentityUniversalAuthForm.tsx"
---

## High-level description
This code defines a React component called `IdentityUniversalAuthForm` that handles the configuration of universal authentication for an identity in an organization. It provides a form for setting up or updating various authentication parameters such as access token TTL, trusted IPs, and usage limits.

## Code Structure
The component uses React Hook Form for form management and validation, and integrates with API hooks for data fetching and mutation. It also utilizes context hooks for accessing organization and subscription data.

## Symbols

### `IdentityUniversalAuthForm`
#### Description
This is the main component that renders the form for configuring universal authentication for an identity.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handlePopUpOpen | function | Function to open a popup |
| handlePopUpToggle | function | Function to toggle a popup |
| identityAuthMethodData | object | Data about the identity and its authentication method |

#### Internal Logic
1. Initializes form with React Hook Form and Yup schema validation.
2. Uses `useFieldArray` for managing dynamic input fields for trusted IPs.
3. Fetches existing universal auth data if available and populates the form.
4. Handles form submission by calling the appropriate API mutation (add or update).
5. Manages the display of form fields and buttons based on the current state and user permissions.

## Side Effects
- Calls API endpoints to add or update universal auth configuration.
- Creates notifications to inform the user about the success or failure of operations.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management and validation |
| yup | Schema validation for form fields |
| @fortawesome | Icons for the UI |
| @app/components | UI components and notification system |
| @app/context | Access to organization and subscription data |
| @app/hooks/api | API hooks for data fetching and mutation |

## Error Handling
The component handles API errors by catching exceptions and displaying error notifications to the user.

## Performance Considerations
The component uses `useEffect` to reset form data when the fetched data changes, which could potentially cause unnecessary re-renders if not managed carefully.

## TODOs
There are no explicit TODOs in the code.
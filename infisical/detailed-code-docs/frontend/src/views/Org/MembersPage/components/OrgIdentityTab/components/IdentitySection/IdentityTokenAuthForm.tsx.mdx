---
title: "IdentityTokenAuthForm.tsx"
---

## High-level description
This code defines a React component called `IdentityTokenAuthForm` that renders a form for configuring or updating identity token authentication settings. It uses React Hook Form for form management and Zod for schema validation. The component allows users to set various token-related parameters and manage trusted IP addresses.

## Code Structure
The main component `IdentityTokenAuthForm` uses several hooks and utilities to manage form state, perform API calls, and handle user interactions. It renders form fields for token TTL, max TTL, number of uses, and trusted IP addresses, along with buttons for submitting, canceling, and removing the auth method.

## Symbols

### `IdentityTokenAuthForm`
#### Description
A React functional component that renders a form for configuring or updating identity token authentication settings.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| handlePopUpOpen | Function | Function to open a popup |
| handlePopUpToggle | Function | Function to toggle a popup state |
| identityAuthMethodData | Object | Contains identity and auth method data |

#### Internal Logic
1. Uses React Hook Form to manage form state and validation.
2. Utilizes useFieldArray for managing dynamic IP address inputs.
3. Handles form submission by calling the appropriate API mutation (add or update).
4. Renders form fields for token TTL, max TTL, number of uses, and trusted IP addresses.
5. Provides buttons for submitting the form, canceling, and removing the auth method.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form state management and validation |
| @fortawesome/free-solid-svg-icons | Icons for UI elements |
| @fortawesome/react-fontawesome | FontAwesome icon component |
| @hookform/resolvers/zod | Zod resolver for form validation |
| zod | Schema definition and validation |
| @app/components/notifications | Notification creation utility |
| @app/components/v2 | UI components |
| @app/context | Organization and subscription context |
| @app/hooks/api | API hooks for identity token auth operations |
| @app/hooks/usePopUp | Custom hook for managing popup state |

## Configuration
The component uses a Zod schema to define and validate the form data:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| accessTokenTTL | string | "2592000" | Access Token Time-to-Live in seconds |
| accessTokenMaxTTL | string | "2592000" | Maximum Access Token Time-to-Live in seconds |
| accessTokenNumUsesLimit | string | "0" | Maximum number of uses for the access token |
| accessTokenTrustedIps | array | [{ipAddress: "0.0.0.0/0"}, {ipAddress: "::/0"}] | Array of trusted IP addresses |

## Error Handling
The component uses React Hook Form's built-in error handling and displays error messages for invalid inputs. It also creates notifications for successful or failed form submissions.

## API/Interface Reference
The component interacts with the following API endpoints through custom hooks:

| Hook | Purpose |
|:-----|:--------|
| useAddIdentityTokenAuth | Add new identity token auth configuration |
| useUpdateIdentityTokenAuth | Update existing identity token auth configuration |
| useGetIdentityTokenAuth | Fetch existing identity token auth configuration |

These hooks are called with the necessary parameters during form submission.
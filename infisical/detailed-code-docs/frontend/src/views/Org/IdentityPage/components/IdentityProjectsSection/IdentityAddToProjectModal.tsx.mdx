---
title: "IdentityAddToProjectModal.tsx"
---

## High-level description
This code defines a React component called `IdentityAddToProjectModal` that renders a modal for adding an identity to a project. It uses React Hook Form for form management and Zod for schema validation. The component allows users to select a project and a role for the identity, then submits the form to add the identity to the selected project.

## Code Structure
The main component `IdentityAddToProjectModal` uses several hooks and components to manage its state and render the UI. It interacts with the API using custom hooks for fetching and mutating data.

## Symbols

### IdentityAddToProjectModal
#### Description
This is the main component that renders the modal for adding an identity to a project.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| identityId | string | The ID of the identity being added to a project |
| popUp | UsePopUpState&lt;["addIdentityToProject"]&gt; | The state of the popup modal |
| handlePopUpToggle | function | Function to toggle the popup state |

#### Internal Logic
1. Uses React Hook Form to manage form state and validation
2. Fetches project memberships, roles, and workspaces using custom hooks
3. Filters workspaces to show only those the identity is not already a member of
4. Handles form submission by calling the `addIdentityToWorkspace` mutation
5. Displays success or error notifications after form submission
6. Renders a modal with form inputs for project selection and role assignment

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form state management and validation |
| @hookform/resolvers/zod | Zod resolver for React Hook Form |
| zod | Schema validation |
| @app/components/notifications | Custom notification component |
| @app/components/v2 | UI components |
| @app/context | Context providers for organization and workspace data |
| @app/hooks/api | Custom API hooks for data fetching and mutation |
| @app/hooks/usePopUp | Custom hook for managing popup state |

## Error Handling
The component implements error handling in the `onFormSubmit` function. It catches any errors during the API call, logs them to the console, and displays an error notification to the user.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| addIdentityToWorkspace | POST | { workspaceId, identityId, role } | - | Adds an identity to a workspace with a specified role |

This component relies on several custom hooks for API interactions, including `useAddIdentityToWorkspace`, `useGetIdentityProjectMemberships`, `useGetProjectRoles`, and `useGetWorkspaceById`.
---
title: "IdentityTokenModal.tsx"
---

## High-level description
This code defines a React component called `IdentityTokenModal` that provides functionality for creating and updating access tokens. It includes a form for entering token details and displays the newly created token with a copy-to-clipboard feature.

## Code Structure
The main component `IdentityTokenModal` uses React hooks and external libraries to manage form state, API calls, and UI interactions. It conditionally renders either a form for creating/updating tokens or a display of the newly created token.

## Symbols

### IdentityTokenModal
#### Description
A React component that renders a modal for creating or updating access tokens.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| popUp | UsePopUpState&lt;["token"]&gt; | State object for controlling the modal's visibility |
| handlePopUpToggle | function | Function to toggle the modal's visibility |

#### Internal Logic
1. Uses React hooks (useState, useEffect) and react-hook-form for form management.
2. Utilizes custom hooks for API calls (useCreateTokenIdentityTokenAuth, useUpdateIdentityTokenAuthToken).
3. Implements form validation using Zod schema.
4. Conditionally renders form or token display based on the current state.
5. Handles form submission for creating or updating tokens.
6. Provides copy-to-clipboard functionality for the newly created token.

### onFormSubmit
#### Description
Asynchronous function that handles form submission for creating or updating tokens.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| name | string | The name of the token |

#### Internal Logic
1. Determines whether to create or update a token based on the presence of `tokenId`.
2. Calls the appropriate API function (createToken or updateToken).
3. Updates the component state and displays a success notification.
4. Handles errors and displays error notifications.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form state management |
| @fortawesome/free-solid-svg-icons | Icons for UI |
| @fortawesome/react-fontawesome | FontAwesome icon component |
| @hookform/resolvers/zod | Zod resolver for react-hook-form |
| zod | Schema validation |
| @app/components/notifications | Custom notification component |
| @app/components/v2 | Custom UI components |
| @app/hooks | Custom hooks |
| @app/hooks/api | API-related custom hooks |
| @app/hooks/usePopUp | Custom hook for managing pop-up state |

## Error Handling
The component implements error handling in the `onFormSubmit` function. It catches any errors during token creation or update, logs them to the console, and displays an error notification to the user.

## Logging
The component uses `console.error` to log any errors that occur during form submission.

## Performance Considerations
The component uses the `useTimedReset` hook for managing the copy-to-clipboard state, which may help in optimizing re-renders.

This documentation provides a comprehensive overview of the `IdentityTokenModal` component, its functionality, and its implementation details. It should help engineers and technical PMs understand the purpose and structure of the code.
---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a TeamCity integration authorization page. It allows users to input their TeamCity access token and server URL, validates the inputs, and saves the integration access token upon successful submission.

## Symbols

### TeamCityCreateIntegrationPage
#### Description
This is the main functional component that renders the TeamCity integration authorization page. It manages the state for input fields, handles form submission, and displays error messages if needed.

#### Inputs
This component doesn't take any props.

#### Outputs
Returns a JSX element representing the TeamCity integration authorization page.

#### Internal Logic
1. Initializes state variables for API key, server URL, error messages, and loading state.
2. Uses the `useSaveIntegrationAccessToken` hook for saving the integration access token.
3. Defines a `handleButtonClick` function to validate inputs and submit the form.
4. Renders a card with input fields for TeamCity access token and server URL.
5. Displays error messages if validation fails.
6. Provides a button to submit the form and initiate the integration process.

### handleButtonClick
#### Description
An asynchronous function that handles the form submission when the "Connect to TeamCity" button is clicked.

#### Internal Logic
1. Clears any existing error messages.
2. Validates that both API key and server URL are not empty.
3. Sets loading state to true.
4. Calls the `mutateAsync` function from the `useSaveIntegrationAccessToken` hook to save the integration access token.
5. Redirects the user to the TeamCity integration creation page upon successful submission.
6. Handles errors by logging them to the console.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | For using React hooks and components |
| next/head | For setting the page title and favicon |
| next/image | For optimized image rendering |
| next/link | For client-side navigation |
| next/router | For programmatic routing |
| @fortawesome/free-solid-svg-icons | For icon components |
| @fortawesome/react-fontawesome | For rendering FontAwesome icons |
| @app/hooks/api | Custom hook for saving integration access token |
| ../../../components/v2 | Custom UI components |

## Configuration
The component uses the following configuration:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| TeamCityCreateIntegrationPage.requireAuth | boolean | true | Indicates that authentication is required for this page |

## Error Handling
The component implements basic error handling by displaying error messages for empty input fields. It also catches and logs any errors that occur during the form submission process.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| N/A | POST | { workspaceId, integration, accessToken, url } | Integration auth object | Saves the TeamCity integration access token |

Note: The actual API endpoint is abstracted away in the `useSaveIntegrationAccessToken` hook.
---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating an Azure DevOps integration. It allows users to select a source environment from Infisical, specify a secrets path, and choose a target Azure DevOps project to sync secrets with.

## Code Structure
The main component `AzureDevopsCreateIntegrationPage` uses several hooks to fetch data and manage state. It renders a form with select inputs for environment and project selection, and an input for the secrets path. The component also handles the creation of the integration when the user submits the form.

## References
- `useCreateIntegration` from "@app/hooks/api"
- Various components from "../../../components/v2"
- `useGetIntegrationAuthApps`, `useGetIntegrationAuthById`, `useGetWorkspaceById` from "../../../hooks/api"

## Symbols

### AzureDevopsCreateIntegrationPage
#### Description
This is the main functional component that renders the Azure DevOps integration creation page.

#### Inputs
This component doesn't take any props.

#### Outputs
Returns a JSX element representing the integration creation form.

#### Internal Logic
1. Fetches workspace, integration auth, and integration auth apps data using custom hooks.
2. Manages state for selected source environment, secret path, and target app.
3. Handles form submission by calling the `createIntegration` mutation.
4. Renders a form with inputs for selecting source environment, secret path, and target Azure DevOps project.

### useEffect hooks
#### Description
Two `useEffect` hooks are used to set initial values for `selectedSourceEnvironment` and `targetApp` when data is loaded.

### handleButtonClick
#### Description
An async function that handles the form submission.

#### Internal Logic
1. Calls the `mutateAsync` function from `useCreateIntegration` hook with form data.
2. Redirects to the integrations page on success.

## Side Effects
- Uses localStorage to store and retrieve project data and Azure DevOps organization name.
- Navigates to a different page on successful integration creation.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| next | Next.js framework components |
| @fortawesome | Font Awesome icons |
| query-string | Parsing query strings |

## Configuration
The component uses some hardcoded values and localStorage items for configuration:
- `localStorage.getItem("projectData.id")`: Used to fetch workspace data
- `localStorage.getItem("azure-devops-org-name")`: Used in API calls and form submission

## Error Handling
Error handling is minimal, with errors being logged to the console in the `handleButtonClick` function.

## API/Interface Reference
The component interacts with several API endpoints through custom hooks:
- `useGetWorkspaceById`: Fetches workspace data
- `useGetIntegrationAuthById`: Fetches integration auth data
- `useGetIntegrationAuthApps`: Fetches Azure DevOps projects
- `useCreateIntegration`: Creates the integration
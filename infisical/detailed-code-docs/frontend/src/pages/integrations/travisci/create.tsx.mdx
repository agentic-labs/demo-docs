---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating a Travis CI integration. It allows users to select a project environment, specify a secrets path, and choose a Travis CI project to integrate with. The component handles the creation of the integration and redirects the user upon successful creation.

## Code Structure
The main component `TravisCICreateIntegrationPage` uses several hooks for data fetching and state management. It renders a form with select inputs and a button to create the integration. The component also handles loading states and error scenarios.

## Symbols

### TravisCICreateIntegrationPage
#### Description
This is the main functional component that renders the Travis CI integration creation form.

#### Inputs
This component doesn't take any props directly.

#### Outputs
Returns a JSX element representing the integration creation form or an empty div if data is not yet loaded.

#### Internal Logic
1. Fetches necessary data using custom hooks (workspace, integration auth, integration auth apps).
2. Manages local state for form inputs (source environment, target app, secret path).
3. Handles form submission by calling the `createIntegration` mutation.
4. Redirects the user to the integrations page upon successful creation.

#### Side Effects
- Fetches data from API endpoints.
- Modifies local storage.
- Navigates to a different page on successful integration creation.

### useEffect hooks
#### Description
Two `useEffect` hooks are used to set initial values for `selectedSourceEnvironment` and `targetApp` based on fetched data.

### handleButtonClick
#### Description
An asynchronous function that handles the creation of the integration when the user clicks the "Create Integration" button.

#### Internal Logic
1. Checks if `integrationAuth.id` exists.
2. Sets loading state.
3. Calls the `mutateAsync` function with integration details.
4. Resets loading state.
5. Redirects to the integrations page.
6. Catches and logs any errors.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| next/router | Next.js routing |
| query-string | Parsing query parameters |
| @app/hooks/api | Custom API hooks |
| ../../../components/v2 | UI components |
| ../../../hooks/api/integrationAuth | Integration auth API hooks |
| ../../../hooks/api/workspace | Workspace API hooks |

## Configuration
The component uses a configuration option:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| requireAuth | boolean | true | Indicates that authentication is required for this page |

## Error Handling
The component includes basic error handling in the `handleButtonClick` function, where errors are caught and logged to the console.

## API/Interface Reference
The component interacts with several API endpoints through custom hooks:

| Hook | Purpose |
|:-----|:--------|
| useCreateIntegration | Creates a new integration |
| useGetWorkspaceById | Fetches workspace data |
| useGetIntegrationAuthById | Fetches integration auth data |
| useGetIntegrationAuthApps | Fetches integration auth apps |

These hooks likely correspond to API endpoints, but the exact details are not visible in this file.
---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a CircleCI integration authorization page. It allows users to input a CircleCI API token, validates the input, and initiates the integration process by saving the token and redirecting to the next step.

## Symbols

### `CircleCICreateIntegrationPage`
#### Description
This is the main functional component that renders the CircleCI integration authorization page. It manages the state for the API key input, error handling, and loading state. It also handles the submission of the API key to initiate the integration process.

#### Inputs
This component doesn't take any props.

#### Outputs
Returns a JSX element representing the entire page content.

#### Internal Logic
1. Uses React hooks for state management (`useState`) and routing (`useRouter`).
2. Utilizes a custom hook `useSaveIntegrationAccessToken` for saving the integration token.
3. Renders a form with an input field for the CircleCI API token.
4. Implements form validation and error handling.
5. On form submission, saves the token and redirects to the next step of the integration process.

#### Side Effects
- Saves the integration access token to the server using the `mutateAsync` function.
- Redirects the user to the next page upon successful token submission.
- Stores and retrieves the project ID from localStorage.

### `handleButtonClick`
#### Description
An asynchronous function that handles the form submission when the user clicks the "Connect to CircleCI" button.

#### Internal Logic
1. Validates the API key input.
2. If valid, sets the loading state and attempts to save the integration access token.
3. On success, redirects the user to the next step of the integration process.
4. Handles errors by logging them to the console.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library for building the UI |
| next/head | Next.js component for modifying the document head |
| next/image | Next.js component for optimized image rendering |
| next/link | Next.js component for client-side navigation |
| next/router | Next.js routing functionality |
| @fortawesome/free-solid-svg-icons | Icon library |
| @fortawesome/react-fontawesome | React component for FontAwesome icons |
| @app/hooks/api | Custom hook for API interactions |
| ../../../components/v2 | Custom UI components |

## Configuration
The component uses a static configuration:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| requireAuth | boolean | true | Indicates that authentication is required for this page |

## Error Handling
The component implements basic error handling:
- Displays an error message if the API key is blank.
- Logs any errors that occur during the token saving process to the console.

## API/Interface Reference
The component interacts with an API through the `useSaveIntegrationAccessToken` hook:

| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| Unspecified | POST | `{ workspaceId: string, integration: string, accessToken: string }` | `{ id: string }` | Saves the integration access token |

Note: The actual endpoint is abstracted by the custom hook and is not visible in this component.
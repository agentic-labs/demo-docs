---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a Windmill integration authorization page. It allows users to input a Windmill API key, validates the input, and saves the integration access token before redirecting to the creation page.

## Symbols

### WindmillCreateIntegrationPage
#### Description
This is the main functional component that renders the Windmill integration authorization page. It manages the state for the API key input, error handling, and loading state. It also handles the submission of the API key and redirection upon successful authorization.

#### Inputs
This component doesn't take any props.

#### Outputs
Returns a JSX element representing the authorization page UI.

#### Internal Logic
1. Initializes state variables for API key, error text, and loading state.
2. Defines a `handleButtonClick` function to process the form submission:
   - Validates the API key input
   - Calls the `mutateAsync` function to save the integration access token
   - Redirects to the creation page on success
3. Renders a card with an input field for the API key and a submit button
4. Displays error messages if the API key is invalid

### handleButtonClick
#### Description
An asynchronous function that handles the form submission when the user clicks the "Connect to Windmill" button.

#### Inputs
This function doesn't take any parameters, but it uses the `apiKey` state variable.

#### Outputs
This function doesn't return a value, but it triggers side effects:
- Updates error state
- Saves the integration access token
- Redirects to the creation page

#### Internal Logic
1. Clears any existing error messages
2. Validates that the API key is not empty
3. Sets the loading state to true
4. Calls `mutateAsync` to save the integration access token
5. Sets the loading state to false
6. Redirects to the creation page with the new integration auth ID
7. Catches and logs any errors that occur during the process

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | For using React hooks and components |
| next/router | For routing and navigation |
| @app/hooks/api | Custom hook for saving integration access token |
| ../../../components/v2 | UI components used in the page |

## Side Effects
- Uses `localStorage` to retrieve the project ID
- Performs an API call to save the integration access token
- Redirects the user to another page on successful authorization

## Error Handling
- Displays an error message if the API key is empty
- Logs any errors that occur during the authorization process to the console

## Configuration
The component has a static property:
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| requireAuth | boolean | true | Indicates that this page requires authentication |

This documentation provides a comprehensive overview of the WindmillCreateIntegrationPage component and its functionality, focusing on the main aspects of the code without exceeding the specified length limits.
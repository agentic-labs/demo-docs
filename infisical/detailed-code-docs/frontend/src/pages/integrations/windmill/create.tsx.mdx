---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating a Windmill integration. It allows users to select a project environment, specify a secrets path, and choose a Windmill workspace. The component handles form input and submission, creating an integration using the provided data.

## Code Structure
The main component `WindmillCreateIntegrationPage` uses several hooks for data fetching and state management. It renders a form with select inputs and a button to create the integration. The component is wrapped with authentication requirements.

## References
- `useCreateIntegration` hook from "@app/hooks/api"
- Various UI components from "../../../components/v2"
- API hooks from "../../../hooks/api/integrationAuth" and "../../../hooks/api/workspace"

## Symbols

### WindmillCreateIntegrationPage
#### Description
This is the main functional component that renders the Windmill integration creation form.

#### Inputs
No direct inputs, but it uses query parameters and local storage for data.

#### Outputs
Renders a React component.

#### Internal Logic
1. Fetches workspace, integration auth, and integration auth apps data using custom hooks.
2. Manages state for form inputs (source environment, secret path, target app).
3. Handles form submission by calling the `createIntegration` mutation.
4. Renders a form with select inputs for environment and workspace, and an input for secret path.

### handleButtonClick
#### Description
An async function that handles the form submission.

#### Inputs
No direct inputs, but uses component state.

#### Outputs
No direct outputs, but triggers a mutation and navigation.

#### Internal Logic
1. Checks if integration auth ID exists.
2. Sets loading state.
3. Calls the `mutateAsync` function with form data.
4. Navigates to the integrations page on success.

## Side Effects
- Uses local storage to get and set data.
- Navigates to a different page on successful form submission.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| next/router | Next.js routing |
| query-string | Parsing URL query parameters |
| @app/hooks/api | Custom API hooks |

## Error Handling
The code includes basic error handling in the `handleButtonClick` function, logging errors to the console.

## API/Interface Reference
The component interacts with several API endpoints through custom hooks:
- `useCreateIntegration`
- `useGetWorkspaceById`
- `useGetIntegrationAuthById`
- `useGetIntegrationAuthApps`

These hooks likely handle API requests to create integrations and fetch necessary data.
---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a page that allows users to authorize integration with Hasura Cloud. It provides a form for users to input their Hasura Cloud Access Token, which is then used to set up the integration with Infisical.

## Code Structure
The main component `HasuraCloudAuthorizeIntegrationPage` uses React hooks and external libraries to manage form state, validation, and API calls. It renders a card with a form for token input and submission.

## Symbols

### `HasuraCloudAuthorizeIntegrationPage`
#### Description
This is the main functional component that renders the Hasura Cloud authorization page. It manages the form state, handles form submission, and navigates to the next step upon successful authorization.

#### Internal Logic
1. Sets up form control and validation using `react-hook-form` and `yup`.
2. Handles form submission by calling the `useSaveIntegrationAccessToken` mutation.
3. On successful token saving, redirects to the integration creation page.
4. Renders a card with a form for inputting the Hasura Cloud Access Token.

#### Side Effects
- Updates loading state during form submission.
- Navigates to a new page on successful authorization.
- Saves the integration access token to the backend.

### `schema`
#### Description
Defines the validation schema for the form using `yup`.

#### Internal Logic
Requires a non-empty string for the `accessToken` field.

### `onFormSubmit`
#### Description
Asynchronous function that handles the form submission.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| accessToken | string | The Hasura Cloud Access Token entered by the user |

#### Internal Logic
1. Sets loading state to true.
2. Calls the `mutateAsync` function to save the integration access token.
3. On success, navigates to the integration creation page.
4. Sets loading state to false after completion or on error.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library |
| react-hook-form | Form state management and validation |
| next/head | Managing document head |
| next/image | Optimized image component |
| next/link | Navigation between pages |
| next/router | Routing functionality |
| @fortawesome/react-fontawesome | Icon components |
| @hookform/resolvers/yup | Yup resolver for react-hook-form |
| yup | Schema validation |
| @app/components/v2 | Custom UI components |
| @app/hooks/api | Custom API hooks |

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| APP_NAME | string | "Hasura Cloud" | The name of the application being integrated |

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| N/A | POST | { workspaceId: string, integration: string, accessToken: string } | { id: string } | Saves the integration access token |

Note: The actual API endpoint is abstracted by the `useSaveIntegrationAccessToken` hook.
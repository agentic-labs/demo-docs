---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating a Cloudflare Pages integration in an Infisical project. It allows users to select source and target environments, configure secret paths, and set up auto-redeployment options for syncing secrets between Infisical and Cloudflare Pages.

## Code Structure
The main component `CloudflarePagesIntegrationPage` uses several hooks for data fetching and state management. It renders a form with various input fields and a submit button to create the integration.

## Symbols

### CloudflarePagesIntegrationPage
#### Description
This is the main functional component that renders the Cloudflare Pages integration creation form.

#### Internal Logic
1. Fetches necessary data using custom hooks (workspace, integration auth, integration auth apps).
2. Manages form state using React's `useState` hooks.
3. Handles form submission and integration creation.
4. Renders a form with various input fields for configuring the integration.

### handleButtonClick
#### Description
An asynchronous function that handles the form submission and integration creation.

#### Internal Logic
1. Validates the presence of `integrationAuth.id`.
2. Sets loading state.
3. Calls the `mutateAsync` function to create the integration.
4. Handles success by redirecting to the integrations page.
5. Handles errors by displaying a notification.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | Core React library for building the component |
| next/router | Next.js routing functionality |
| axios | HTTP client for making API requests |
| query-string | Parsing URL query parameters |
| @app/components/notifications | Creating notifications |
| @app/components/v2/SecretPathInput | Custom input component for secret paths |
| @app/hooks/api | Custom hooks for API interactions |
| ../../../components/v2 | Various UI components |
| ../../../hooks/api/integrationAuth | Hooks for integration authentication |

## Configuration
The component uses a predefined array of Cloudflare environments:
```javascript
const cloudflareEnvironments = [
  { name: "Production", slug: "production" },
  { name: "Preview", slug: "preview" }
];
```

## Error Handling
Error handling is implemented in the `handleButtonClick` function. It catches errors, logs them to the console, and displays a user-friendly error message using the `createNotification` function.

## API/Interface Reference
The component interacts with several API endpoints through custom hooks:
- `useCreateIntegration`: Creates the integration
- `useGetWorkspaceById`: Fetches workspace data
- `useGetIntegrationAuthById`: Fetches integration authentication data
- `useGetIntegrationAuthApps`: Fetches integration authentication apps

## Notes
- The component requires authentication, as indicated by the `CloudflarePagesIntegrationPage.requireAuth = true;` statement at the end.
- The component uses various custom UI components from the project's component library, such as `Button`, `Card`, `FormControl`, `Select`, and `Switch`.
- The `SecretPathInput` component is used for inputting the secret path, which likely provides additional functionality specific to secret management.
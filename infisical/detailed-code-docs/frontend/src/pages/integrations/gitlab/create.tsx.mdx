---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating a GitLab integration in the Infisical application. It provides a form for users to configure the integration, including selecting source and target environments, setting up secret paths, and defining various options for secret management in GitLab.

## Code Structure
The main component `GitLabCreateIntegrationPage` uses React hooks and form management libraries to handle user input and API interactions. It renders a form with multiple sections for connection details and options, utilizing various UI components from the application's component library.

## Symbols

### `GitLabCreateIntegrationPage`
#### Description
This is the main functional component that renders the GitLab integration creation page. It manages the form state, handles form submission, and interacts with various API hooks to fetch and submit data.

#### Internal Logic
1. Initializes form state using `react-hook-form` with validation schema.
2. Fetches necessary data (workspace, integration auth, apps, teams) using custom hooks.
3. Renders a form with two main sections: Connection and Options.
4. Handles form submission, including a confirmation step for potential secret overwriting.
5. Creates the integration using the `useCreateIntegration` hook upon form submission.

#### Side Effects
- Fetches data from API endpoints on component mount and when certain form fields change.
- Updates form values based on fetched data and user selections.
- Navigates to a different page after successful integration creation.

### Form Fields
The form includes several fields managed by `react-hook-form`:
- `selectedSourceEnvironment`: Project environment selection
- `secretPath`: Path for secrets in Infisical
- `targetEntity`: GitLab integration type (individual or group)
- `targetTeamId`: GitLab group selection (if applicable)
- `targetAppId`: GitLab project selection
- `targetEnvironment`: GitLab environment scope
- `secretPrefix` and `secretSuffix`: Optional prefixes/suffixes for secrets
- `shouldMaskSecrets` and `shouldProtectSecrets`: Options for secret management in GitLab

### API Hooks
The component uses several custom API hooks:
- `useCreateIntegration`: For creating the integration
- `useGetIntegrationAuthApps`: Fetches available GitLab apps
- `useGetIntegrationAuthTeams`: Fetches available GitLab teams
- `useGetIntegrationAuthById`: Fetches integration auth details
- `useGetWorkspaceById`: Fetches workspace details

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| React | Core library for building the UI |
| react-hook-form | Form state management and validation |
| next/router | Routing functionality |
| yup | Schema validation |
| @fortawesome/react-fontawesome | Icon components |
| framer-motion | Animation library for UI transitions |
| Various custom components and hooks | UI elements and API interactions |

## Error Handling
The component includes basic error handling, logging errors to the console and displaying a generic error message to the user if data fetching fails.

## Performance Considerations
The component uses React hooks like `useEffect` to manage side effects and update form state based on API responses, which helps in optimizing re-renders and data fetching.
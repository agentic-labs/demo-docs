---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a GitLab integration authorization page. It allows users to connect Infisical with GitLab (either cloud or self-hosted) by initiating an OAuth flow.

## Code Structure
The main component `GitLabAuthorizeIntegrationPage` uses React Hook Form for form management and validation. It interacts with the `useGetCloudIntegrations` hook to fetch integration data and handles the OAuth flow initiation.

## Symbols

### `GitLabAuthorizeIntegrationPage`
#### Description
This is the main React component that renders the GitLab authorization page. It manages a form for optional self-hosted GitLab URL input and initiates the OAuth flow.

#### Inputs
This component doesn't take any props.

#### Outputs
Renders a React component.

#### Internal Logic
1. Sets up a form using `useForm` with validation schema.
2. Fetches cloud integrations data using `useGetCloudIntegrations` hook.
3. Defines `onFormSubmit` function to handle form submission:
   - Generates a CSRF token.
   - Constructs the OAuth authorization URL.
   - Redirects the user to the GitLab OAuth page.
4. Renders a card with GitLab logo, title, form for self-hosted URL, and a submit button.

### `schema`
#### Description
Defines the Yup validation schema for the form.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| gitLabURL | string | Optional self-hosted GitLab URL |

### `FormData`
#### Description
TypeScript type definition inferred from the Yup schema.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react-hook-form | Form management and validation |
| next/head | Managing document head |
| next/image | Optimized image component |
| next/link | Navigation between pages |
| @fortawesome/react-fontawesome | Icon components |
| @hookform/resolvers/yup | Yup resolver for react-hook-form |
| yup | Schema validation |
| @app/hooks/api | Custom hook for API calls |
| ../../../components/v2 | UI components |

## Side Effects
- Stores CSRF token in localStorage.
- Redirects the user to GitLab's OAuth authorization page.

## Configuration
| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| gitLabURL | string | "" | Self-hosted GitLab URL (optional) |

## Error Handling
The component uses Yup for form validation, but no specific error handling is implemented beyond that.

## Notes
The component has a `requireAuth = true` property, suggesting it requires authentication to access.
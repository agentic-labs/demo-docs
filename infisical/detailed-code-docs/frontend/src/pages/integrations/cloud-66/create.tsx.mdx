---
title: "create.tsx"
---

## High-level description
This code defines a React component for creating a Cloud 66 integration. It allows users to select a project environment, specify a secrets path, and choose a Cloud 66 application to integrate with. The component handles the creation of the integration and redirects the user upon successful creation.

## Code Structure
The main component `Cloud66CreateIntegrationPage` uses several hooks for data fetching and state management. It renders a form with select inputs for environment and application, and an input for the secrets path. The component also includes a button to trigger the integration creation.

## References
- `useCreateIntegration` hook
- `useGetIntegrationAuthApps` hook
- `useGetIntegrationAuthById` hook
- `useGetWorkspaceById` hook
- Various UI components from `"../../../components/v2"`

## Symbols

### Cloud66CreateIntegrationPage
#### Description
This is the main functional component that renders the Cloud 66 integration creation page.

#### Inputs
This component doesn't take any props directly.

#### Outputs
Returns a JSX element representing the integration creation form or an empty div if data is not yet loaded.

#### Internal Logic
1. Fetches necessary data using custom hooks (workspace, integration auth, integration auth apps).
2. Manages local state for form inputs (source environment, target app, secret path).
3. Handles form submission by calling the `mutateAsync` function from `useCreateIntegration` hook.
4. Renders a form with select inputs for environment and application, and a text input for the secrets path.
5. Includes error handling and loading states.

### handleButtonClick
#### Description
An asynchronous function that handles the form submission when the "Create Integration" button is clicked.

#### Inputs
No direct inputs, but uses state variables and data from hooks.

#### Internal Logic
1. Checks if `integrationAuth.id` exists.
2. Sets loading state.
3. Calls `mutateAsync` with integration details.
4. Resets loading state.
5. Redirects to the integrations page on success.
6. Logs any errors to the console.

## Side Effects
- Uses `localStorage` to get and set project data.
- Redirects the user to another page on successful integration creation.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | For using React hooks and components |
| next/router | For routing functionality |
| query-string | For parsing query parameters |
| @app/hooks/api | For the `useCreateIntegration` hook |
| ../../../components/v2 | For UI components |
| ../../../hooks/api/integrationAuth | For integration auth related hooks |
| ../../../hooks/api/workspace | For workspace related hooks |

## Configuration
The component includes a configuration option:

| Option | Type | Default | Description |
|:-------|:-----|:--------|:------------|
| requireAuth | boolean | true | Indicates that authentication is required for this page |

## Error Handling
The component includes basic error handling in the `handleButtonClick` function, where errors are logged to the console.

## API/Interface Reference
This component doesn't explicitly define an API, but it interacts with several API endpoints through custom hooks:

| Hook | Purpose |
|:-----|:--------|
| useCreateIntegration | Creates a new integration |
| useGetIntegrationAuthApps | Fetches available integration auth apps |
| useGetIntegrationAuthById | Fetches integration auth details |
| useGetWorkspaceById | Fetches workspace details |
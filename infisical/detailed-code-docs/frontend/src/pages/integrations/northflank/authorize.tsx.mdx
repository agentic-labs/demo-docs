---
title: "authorize.tsx"
---

## High-level description
This code defines a React component for a Northflank integration page. It allows users to input a Northflank API token, validates the input, and saves the token for integration with the application. The component uses Next.js for routing and custom hooks for API interactions.

## Code Structure
The main component `NorthflankCreateIntegrationPage` uses React hooks for state management and API calls. It renders a form with an input field for the API token and a submit button. The component handles form submission, validation, and navigation to the next step of the integration process.

## Symbols

### `NorthflankCreateIntegrationPage`
#### Description
This is the main functional component that renders the Northflank integration page. It manages the state for the API key input, error handling, and loading status. It also handles the form submission and API token saving process.

#### Inputs
This component doesn't take any props.

#### Internal Logic
1. Initializes state variables for API key, error text, and loading status.
2. Defines a `handleButtonClick` function to process form submission:
   - Validates the API key input
   - Calls the `mutateAsync` function to save the integration access token
   - Navigates to the next page on successful token saving
3. Renders a form with an input field for the API key and a submit button
4. Displays error messages if the API key is invalid

#### Side Effects
- Uses `localStorage` to retrieve the workspace ID
- Navigates to a new page on successful form submission

### `handleButtonClick`
#### Description
An asynchronous function that handles the form submission process.

#### Internal Logic
1. Clears any existing error messages
2. Validates the API key input
3. Sets the loading state
4. Calls the `mutateAsync` function to save the integration access token
5. Navigates to the next page on success
6. Handles and logs any errors that occur during the process

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| react | For using React hooks and components |
| next/router | For handling client-side routing |
| @app/hooks/api | Custom hook for saving integration access token |
| ../../../components/v2 | UI components for building the form |

## Configuration
The component sets a `requireAuth` property to `true`, indicating that authentication is required to access this page.

## Error Handling
The component implements basic error handling by displaying an error message if the API key is blank and logging any errors that occur during the token saving process to the console.

## API/Interface Reference
| Function | Input | Output | Description |
|:---------|:------|:-------|:------------|
| useSaveIntegrationAccessToken | None | { mutateAsync: Function } | Custom hook for saving the integration access token |
| mutateAsync | { workspaceId: string, integration: string, accessToken: string } | Promise&lt;{ id: string }&gt; | Saves the integration access token and returns the integration auth ID |

This component provides a user interface for integrating Northflank with the application by allowing users to input and save their Northflank API token. It handles input validation, API interactions, and navigation to the next step of the integration process.
---
title: "reactQuery.tsx"
---

## High-level description
This code defines a React Query client configuration and token management system for an application. It sets up error handling, caching, and provides functions for managing authentication tokens in memory.

## Code Structure
The code is organized into three main parts:
1. React Query client configuration
2. Token storage implementation
3. Token management functions

## Symbols

### `queryClient`
#### Description
Creates and configures a new QueryClient instance for React Query.

#### Internal Logic
- Sets up a mutation cache with custom error handling
- Configures default options for queries

### `MemoryTokenStorage`
#### Description
A closure that creates an in-memory token storage system.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| setToken | function | Sets the token in memory |
| getToken | function | Retrieves the token from memory |

### Token Management Functions
#### Description
A set of functions for setting and getting different types of tokens.

#### Symbols
- `setSignupTempToken`
- `setMfaTempToken`
- `setAuthToken`
- `getSignupTempToken`
- `getMfaTempToken`
- `getAuthToken`
- `isLoggedIn`

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/react-query | Provides the QueryClient and MutationCache |
| axios | Used for making HTTP requests and error handling |
| @app/components/notifications | Used to create notifications |

## Error Handling
The `queryClient` configuration includes custom error handling for mutations:
- Handles validation errors by displaying detailed field-specific messages
- Manages unauthorized access (401 status code)
- Provides a generic error message for other types of errors

## Side Effects
The token management functions modify and access in-memory storage, which can be considered a side effect.

## Performance Considerations
The use of in-memory token storage provides fast access to tokens but doesn't persist across page reloads or browser sessions.

## TODOs
There is a comment indicating that the memory token storage will be moved to an apiRequest module in the future, and the getters will be scoped to apiRequest only.
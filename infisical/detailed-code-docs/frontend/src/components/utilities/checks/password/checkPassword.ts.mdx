---
title: "checkPassword.ts"
---

## High-level description
This code defines a function `checkPassword` that validates a password against various security criteria. It checks for length, character types, repeated characters, escape characters, low entropy data, and whether the password has been breached. The function returns a boolean indicating if the password passes all checks and sets error messages for any failed checks.

## Code Structure
The main function `checkPassword` uses several imported regular expressions and a helper function `checkIsPasswordBreached` to perform its checks. It defines an array of test objects, each with a name, validator function, and error message. The function then runs these tests and an additional breach check, accumulating any errors in an object.

## Symbols

### `checkPassword`
#### Description
This asynchronous function takes a password and a setter function for errors as input. It runs a series of validation checks on the password and returns a boolean indicating whether the password passed all checks.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| password | string | The password to be checked |
| setErrors | function | A function to set error messages |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Promise&lt;boolean&gt; | True if the password fails any check, false otherwise |

#### Internal Logic
1. Initialize an empty errors object.
2. Define an array of test objects, each containing a name, validator function, and error message.
3. Check if the password has been breached using `checkIsPasswordBreached`.
4. Run each test in the array, calling its validator function with the password.
5. If a test fails, add its error message to the errors object.
6. Call `setErrors` with the accumulated errors.
7. Return true if there are any errors, false otherwise.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| checkIsPasswordBreached | Checks if the password has been found in known data breaches |
| Various regex imports | Used for different password validation checks |

## Error Handling
The function accumulates errors in an object and sets them using the provided `setErrors` function. It doesn't throw exceptions but returns a boolean indicating the presence of errors.

## Performance Considerations
The function performs multiple regex checks and an asynchronous breach check, which could impact performance for very large numbers of password checks. The breach check involves an API call, which could be a potential bottleneck.

## TODOs
There are no explicit TODOs in the code.
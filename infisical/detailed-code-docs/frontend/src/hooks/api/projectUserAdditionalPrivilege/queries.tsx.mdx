---
title: "queries.tsx"
---

## High-level description
This code defines React Query hooks for fetching and managing project user privileges. It provides functionality to retrieve details of a specific privilege and list all privileges for a project membership.

## Code Structure
The code exports two main query hooks: `useGetProjectUserPrivilegeDetails` and `useListProjectUserPrivileges`. These hooks utilize the `apiRequest` function to make API calls and the `unpackRules` function from CASL to process permissions.

## Symbols

### `projectUserPrivilegeKeys`
#### Description
An object that defines query keys for React Query to manage caching and invalidation.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| details | Function | Returns a query key for privilege details |
| list | Function | Returns a query key for privilege list |

### `fetchProjectUserPrivilegeDetails`
#### Description
An async function that fetches details of a specific project user privilege.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| privilegeId | string | The ID of the privilege to fetch |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| privilege | Object | The fetched privilege details with unpacked permissions |

### `useGetProjectUserPrivilegeDetails`
#### Description
A React Query hook for fetching project user privilege details.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| privilegeId | string | The ID of the privilege to fetch |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | Object | React Query result object |

### `useListProjectUserPrivileges`
#### Description
A React Query hook for fetching a list of project user privileges.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| projectMembershipId | string | The ID of the project membership |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | Object | React Query result object |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @casl/ability/extra | Provides the `unpackRules` function for processing permissions |
| @tanstack/react-query | Provides the `useQuery` hook for data fetching |
| @app/config/request | Provides the `apiRequest` function for making API calls |

## Error Handling
The code relies on React Query's built-in error handling mechanisms. Errors from API calls will be captured and can be accessed through the query result objects.

## API/Interface Reference
| Endpoint | Method | Request | Response | Description |
|:---------|:-------|:--------|:---------|:------------|
| /api/v1/additional-privilege/users/${privilegeId} | GET | - | { privilege: TProjectUserPrivilege } | Fetch details of a specific privilege |
| /api/v1/additional-privilege/users | GET | { params: { projectMembershipId } } | { privileges: TProjectUserPrivilege[] } | Fetch list of privileges for a project membership |
---
title: "queries.tsx"
---

## High-level description
This code defines React hooks for managing secret folders in a project. It provides functionality for creating, updating, deleting, and fetching folders across different environments. The hooks utilize React Query for efficient data fetching and caching.

## Code Structure
The main symbols in this code are React Query hooks that interact with an API to perform CRUD operations on secret folders. These hooks are designed to work together, sharing common query keys and invalidation logic.

## Symbols

### `folderQueryKeys`
#### Description
An object that generates query keys for React Query, used to identify and cache folder-related queries.

#### Internal Logic
It creates a unique key based on the project ID, environment, and path.

### `fetchProjectFolders`
#### Description
An asynchronous function that fetches folders for a given workspace, environment, and path.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| workspaceId | string | The ID of the workspace |
| environment | string | The environment name |
| path | string | The folder path (default: "/") |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| folders | TSecretFolder[] | An array of secret folders |

### `useGetProjectFolders`
#### Description
A custom hook that fetches and returns project folders using React Query.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| projectId | string | The ID of the project |
| environment | string | The environment name |
| path | string | The folder path (default: "/") |
| options | UseQueryOptions | Additional React Query options |

#### Outputs
Returns a React Query result object containing the fetched folders and query status.

### `useGetFoldersByEnv`
#### Description
A custom hook that fetches folders for multiple environments and provides utility functions for working with the fetched data.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| path | string | The folder path (default: "/") |
| projectId | string | The ID of the project |
| environments | string[] | An array of environment names |

#### Outputs
Returns an object containing the fetched folders, folder names, and utility functions for checking folder presence and retrieval.

### `useCreateFolder`
#### Description
A custom hook that provides a mutation function for creating a new folder.

#### Outputs
Returns a React Query mutation object for creating a folder.

### `useUpdateFolder`
#### Description
A custom hook that provides a mutation function for updating an existing folder.

#### Outputs
Returns a React Query mutation object for updating a folder.

### `useDeleteFolder`
#### Description
A custom hook that provides a mutation function for deleting a folder.

#### Outputs
Returns a React Query mutation object for deleting a folder.

### `useUpdateFolderBatch`
#### Description
A custom hook that provides a mutation function for updating multiple folders in a batch.

#### Outputs
Returns a React Query mutation object for updating folders in batch.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/react-query | Provides the core functionality for data fetching and caching |
| @app/config/request | Contains the `apiRequest` utility for making API calls |

## Error Handling
These hooks rely on React Query's built-in error handling. Errors from API calls will be captured and can be accessed through the `error` property of the returned query or mutation objects.

## Side Effects
The mutation hooks (`useCreateFolder`, `useUpdateFolder`, `useDeleteFolder`, `useUpdateFolderBatch`) invalidate related queries upon successful completion, triggering a refetch of the affected data.
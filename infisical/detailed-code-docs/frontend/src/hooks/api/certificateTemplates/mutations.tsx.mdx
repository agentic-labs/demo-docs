---
title: "mutations.tsx"
---

## High-level description
This file contains custom React hooks for managing certificate template-related API mutations using React Query. It provides functionality for creating, updating, and deleting certificate templates, as well as creating and updating EST (Enrollment over Secure Transport) configurations.

## Code Structure
The file exports five custom hooks, each wrapping a useMutation hook from React Query. These hooks handle different operations related to certificate templates and EST configurations, including API calls and cache invalidation.

## References
- workspaceKeys from "../workspace/queries"
- certTemplateKeys from "./queries"
- Types from "./types"

## Symbols

### useCreateCertTemplate
#### Description
A custom hook for creating a new certificate template.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | TCreateCertificateTemplateDTO | Data for creating a new certificate template |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | React Query mutation result |

#### Internal Logic
1. Makes a POST request to "/api/v1/pki/certificate-templates" with the provided data.
2. On success, invalidates the workspace certificate templates query.

### useUpdateCertTemplate
#### Description
A custom hook for updating an existing certificate template.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | TUpdateCertificateTemplateDTO | Data for updating a certificate template |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | React Query mutation result |

#### Internal Logic
1. Makes a PATCH request to "/api/v1/pki/certificate-templates/{id}" with the provided data.
2. On success, invalidates the workspace certificate templates query and the specific certificate template query.

### useDeleteCertTemplate
#### Description
A custom hook for deleting a certificate template.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | TDeleteCertificateTemplateDTO | Data for deleting a certificate template |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | React Query mutation result |

#### Internal Logic
1. Makes a DELETE request to "/api/v1/pki/certificate-templates/{id}".
2. On success, invalidates the workspace certificate templates query and the specific certificate template query.

### useCreateEstConfig
#### Description
A custom hook for creating an EST configuration for a certificate template.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| body | TCreateEstConfigDTO | Data for creating an EST configuration |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | React Query mutation result |

#### Internal Logic
1. Makes a POST request to "/api/v1/pki/certificate-templates/{certificateTemplateId}/est-config" with the provided data.
2. On success, invalidates the EST configuration query for the specific certificate template.

### useUpdateEstConfig
#### Description
A custom hook for updating an EST configuration for a certificate template.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| body | TUpdateEstConfigDTO | Data for updating an EST configuration |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | React Query mutation result |

#### Internal Logic
1. Makes a PATCH request to "/api/v1/pki/certificate-templates/{certificateTemplateId}/est-config" with the provided data.
2. On success, invalidates the EST configuration query for the specific certificate template.

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/react-query | Provides useMutation and useQueryClient hooks for managing API mutations and cache |
| @app/config/request | Provides the apiRequest object for making API calls |

## Error Handling
Error handling is managed by React Query's built-in error handling mechanism. Errors from API calls will be captured and can be accessed through the mutation result object.
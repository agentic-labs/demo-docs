---
title: "Overview"
---

## High-level description
This directory contains TypeScript files that define and implement hooks and types for managing service tokens in a React application. It provides functionality for creating, deleting, and retrieving service tokens, as well as defining the necessary types and enumerations for working with these tokens.

## What does it do?
The code in this directory enables the frontend of the application to interact with service tokens. Here's a breakdown of the main functionalities:

1. Fetching service tokens: It allows the application to retrieve all service tokens associated with a specific workspace.
2. Creating service tokens: It provides a way to create new service tokens with specific scopes, permissions, and expiration times.
3. Deleting service tokens: It enables the removal of existing service tokens from the system.
4. Type definitions: It defines the structure of service tokens, including their scopes, metadata, and associated data transfer objects (DTOs).
5. Permission management: It defines an enumeration for token permissions, allowing for clear distinction between read and write access.

These functionalities are implemented using React Query for efficient data fetching and state management, ensuring that the application maintains an up-to-date view of the service tokens while minimizing unnecessary API calls.

## Key Files

1. `queries.tsx`:
   - Contains the main logic for interacting with service tokens.
   - Defines custom hooks: `useGetUserWsServiceTokens`, `useCreateServiceToken`, and `useDeleteServiceToken`.
   - Utilizes React Query for efficient data fetching and caching.

2. `types.ts`:
   - Defines TypeScript interfaces and types for service tokens and related data structures.
   - Includes definitions for `ServiceToken`, `ServiceTokenScope`, `CreateServiceTokenDTO`, and response types.

3. `enums.ts`:
   - Defines the `Permission` enumeration for service token access levels (READ and WRITE).

4. `index.ts`:
   - Acts as the entry point for the directory, exporting the custom hooks defined in `queries.tsx`.

## Dependencies
The main external dependency used in this directory is `@tanstack/react-query`, which provides the hooks for fetching, caching, and updating asynchronous data. The code also relies on an internal `apiRequest` object from `@app/config/request` for making API calls.

## Configuration
While there are no explicit configuration files in this directory, the code uses query keys defined in the `serviceTokenKeys` object to manage React Query's caching behavior. These keys are based on the workspace ID and are used to invalidate and update the cache when service tokens are created or deleted.

The `CreateServiceTokenDTO` interface in `types.ts` suggests that service tokens are created with encryption-related fields (`encryptedKey`, `iv`, `tag`, `randomBytes`), indicating that there may be some security configuration involved in the token creation process.

## Code Snippets

Here's an example of how the `useGetUserWsServiceTokens` hook is implemented:

```typescript
export const useGetUserWsServiceTokens = (workspaceID: string) =&gt; {
  return useQuery({
    queryKey: serviceTokenKeys.allWorkspace(workspaceID),
    queryFn: () =&gt; fetchWorkspaceServiceTokens(workspaceID),
  });
};
```

This hook uses React Query's `useQuery` to fetch and cache service tokens for a specific workspace. The `serviceTokenKeys.allWorkspace(workspaceID)` generates a unique key for the query, ensuring that the cache is properly managed for each workspace.

The `Permission` enum is defined as follows:

```typescript
export enum Permission {
  READ = "read",
  WRITE = "write",
}
```

This simple enumeration provides a type-safe way to represent and use service token permissions throughout the application.

In summary, this directory provides a comprehensive set of tools for managing service tokens in the frontend of the application, with a focus on type safety, efficient data management, and clear separation of concerns.
---
title: "queries.tsx"
---

## High-level description
This file contains React hooks and API functions for authentication-related operations in the frontend of an application. It includes functions for user login, organization selection, MFA verification, password reset, and other authentication processes.

## Code Structure
The file exports multiple functions and hooks that interact with the authentication API. These functions are organized into groups based on their functionality (e.g., login, password reset, MFA). The file uses React Query's `useMutation` and `useQuery` hooks for managing API requests and caching.

## Symbols

### `login1`
#### Description
Initiates the first step of the login process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| loginDetails | Login1DTO | Login details including email and client public key |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | Login1Res | Response data from the login1 API call |

### `useLogin1`
#### Description
A custom hook that wraps the `login1` function in a mutation.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | Mutation object for the login1 operation |

### `login2`
#### Description
Completes the second step of the login process.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| loginDetails | Login2DTO | Login details including email, client proof, and password |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | Login2Res | Response data from the login2 API call |

### `useLogin2`
#### Description
A custom hook that wraps the `login2` function in a mutation.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | Mutation object for the login2 operation |

### `selectOrganization`
#### Description
Selects an organization for the authenticated user.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| data | { organizationId: string } | Object containing the organization ID to select |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| res | { token: string } | Response containing the new authentication token |

### `useSelectOrganization`
#### Description
A custom hook that wraps the `selectOrganization` function in a mutation and handles token updates.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| mutation | UseMutationResult | Mutation object for the selectOrganization operation |

### `useGetAuthToken`
#### Description
A custom hook that fetches the authentication token using the refresh token.

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| query | UseQueryResult | Query object for fetching the auth token |

## Dependencies
| Dependency | Purpose |
|:-----------|:--------|
| @tanstack/react-query | Provides hooks for API data fetching and caching |
| @app/components/utilities/SecurityClient | Handles security-related operations like token management |
| @app/config/request | Provides the `apiRequest` function for making API calls |
| @app/reactQuery | Provides the `setAuthToken` function for updating the auth token |

## Error Handling
The code relies on React Query's built-in error handling mechanisms. Errors from API calls will be captured and can be accessed through the mutation and query objects returned by the custom hooks.

## API/Interface Reference
The file defines several API endpoints for authentication-related operations:
| Endpoint | Method | Description |
|:---------|:-------|:------------|
| /api/v3/auth/login1 | POST | First step of login process |
| /api/v3/auth/login2 | POST | Second step of login process |
| /api/v3/auth/select-organization | POST | Select an organization |
| /api/v1/auth/token | POST | Fetch authentication token |

Note: There are many more endpoints defined in the file for various authentication operations such as password reset, MFA verification, and account completion.
---
title: "findTextDifferences.ts"
---

## High-level description
This file implements the Patience Diff algorithm, which is used to find differences between two texts. It provides two main functions: `patienceDiff` for basic diff operations and `patienceDiffPlus` for advanced diff operations including detection of moved lines.

## Code Structure
The code consists of two main functions: `patienceDiff` and `patienceDiffPlus`. The `patienceDiff` function contains several nested helper functions that implement the core algorithm. `patienceDiffPlus` uses `patienceDiff` to provide additional functionality for detecting moved lines.

## Symbols

### `patienceDiff`
#### Description
This function implements the Patience Diff algorithm to find differences between two arrays of strings.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| textOld | string[] | The original text as an array of strings |
| textNew | string[] | The new text as an array of strings |
| diffPlusFlag | boolean (optional) | Flag to enable detection of moving segments |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| result | Object | An object containing the diff results |

#### Internal Logic
1. Uses helper functions to find unique common subsequences.
2. Implements the longest common subsequence (LCS) algorithm.
3. Recursively processes substrings to find matches and differences.
4. Builds a result array with information about each line (whether it's inserted, deleted, or unchanged).

### `patienceDiffPlus`
#### Description
This function extends `patienceDiff` to detect moved lines between the old and new text.

#### Inputs
| Name | Type | Description |
|:-----|:-----|:------------|
| textOld | string[] | The original text as an array of strings |
| textNew | string[] | The new text as an array of strings |

#### Outputs
| Name | Type | Description |
|:-----|:-----|:------------|
| difference | Object | An object containing the extended diff results, including moved lines |

#### Internal Logic
1. Calls `patienceDiff` with the `diffPlusFlag` set to true.
2. Iteratively processes potential moved lines to identify actual moves.
3. Updates the diff result to mark moved lines and adjust counters.

## Performance Considerations
The algorithm uses recursion and nested loops, which may impact performance for very large inputs. The TODO comment suggests that the implementation could be simplified and optimized using dynamic programming with space allocation strategy.

## TODOs
- The code needs to be simplified.
- The implementation should be changed from recursive to dynamic programming with space allocation strategy.
- ESLint is disabled due to the use of unary operators, which should be handled carefully.

## Dependencies
This file doesn't have any external dependencies.

## Error Handling
The code doesn't implement explicit error handling mechanisms. It assumes valid inputs and doesn't check for edge cases or invalid inputs.

In conclusion, this file implements a complex diff algorithm with potential for optimization. It provides detailed information about differences between two texts, including insertions, deletions, and (optionally) moved lines. The code is marked as needing simplification and optimization in the future.